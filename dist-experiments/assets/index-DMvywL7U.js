(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function Lo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var OB={exports:{}},AA={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ej=Symbol.for("react.transitional.element"),tj=Symbol.for("react.fragment");function UB(t,e,n){var i=null;if(n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),"key"in e){n={};for(var r in e)r!=="key"&&(n[r]=e[r])}else n=e;return e=n.ref,{$$typeof:ej,type:t,key:i,ref:e!==void 0?e:null,props:n}}AA.Fragment=tj;AA.jsx=UB;AA.jsxs=UB;OB.exports=AA;var B=OB.exports,zB={exports:{}},di={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hO=Symbol.for("react.transitional.element"),nj=Symbol.for("react.portal"),ij=Symbol.for("react.fragment"),rj=Symbol.for("react.strict_mode"),sj=Symbol.for("react.profiler"),aj=Symbol.for("react.consumer"),oj=Symbol.for("react.context"),lj=Symbol.for("react.forward_ref"),uj=Symbol.for("react.suspense"),cj=Symbol.for("react.memo"),IB=Symbol.for("react.lazy"),gI=Symbol.iterator;function fj(t){return t===null||typeof t!="object"?null:(t=gI&&t[gI]||t["@@iterator"],typeof t=="function"?t:null)}var LB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},PB=Object.assign,NB={};function rv(t,e,n){this.props=t,this.context=e,this.refs=NB,this.updater=n||LB}rv.prototype.isReactComponent={};rv.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rv.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function BB(){}BB.prototype=rv.prototype;function dO(t,e,n){this.props=t,this.context=e,this.refs=NB,this.updater=n||LB}var pO=dO.prototype=new BB;pO.constructor=dO;PB(pO,rv.prototype);pO.isPureReactComponent=!0;var vI=Array.isArray,Mr={H:null,A:null,T:null,S:null,V:null},kB=Object.prototype.hasOwnProperty;function mO(t,e,n,i,r,s){return n=s.ref,{$$typeof:hO,type:t,key:e,ref:n!==void 0?n:null,props:s}}function hj(t,e){return mO(t.type,e,void 0,void 0,void 0,t.props)}function gO(t){return typeof t=="object"&&t!==null&&t.$$typeof===hO}function dj(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var yI=/\/+/g;function zM(t,e){return typeof t=="object"&&t!==null&&t.key!=null?dj(""+t.key):e.toString(36)}function xI(){}function pj(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(xI,xI):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function Xg(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"bigint":case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case hO:case nj:a=!0;break;case IB:return a=t._init,Xg(a(t._payload),e,n,i,r)}}if(a)return r=r(t),a=i===""?"."+zM(t,0):i,vI(r)?(n="",a!=null&&(n=a.replace(yI,"$&/")+"/"),Xg(r,e,n,"",function(u){return u})):r!=null&&(gO(r)&&(r=hj(r,n+(r.key==null||t&&t.key===r.key?"":(""+r.key).replace(yI,"$&/")+"/")+a)),e.push(r)),1;a=0;var o=i===""?".":i+":";if(vI(t))for(var l=0;l<t.length;l++)i=t[l],s=o+zM(i,l),a+=Xg(i,e,n,s,r);else if(l=fj(t),typeof l=="function")for(t=l.call(t),l=0;!(i=t.next()).done;)i=i.value,s=o+zM(i,l++),a+=Xg(i,e,n,s,r);else if(s==="object"){if(typeof t.then=="function")return Xg(pj(t),e,n,i,r);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function fS(t,e,n){if(t==null)return t;var i=[],r=0;return Xg(t,i,"","",function(s){return e.call(n,s,r++)}),i}function mj(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var _I=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)};function gj(){}di.Children={map:fS,forEach:function(t,e,n){fS(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return fS(t,function(){e++}),e},toArray:function(t){return fS(t,function(e){return e})||[]},only:function(t){if(!gO(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};di.Component=rv;di.Fragment=ij;di.Profiler=sj;di.PureComponent=dO;di.StrictMode=rj;di.Suspense=uj;di.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Mr;di.__COMPILER_RUNTIME={__proto__:null,c:function(t){return Mr.H.useMemoCache(t)}};di.cache=function(t){return function(){return t.apply(null,arguments)}};di.cloneElement=function(t,e,n){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var i=PB({},t.props),r=t.key,s=void 0;if(e!=null)for(a in e.ref!==void 0&&(s=void 0),e.key!==void 0&&(r=""+e.key),e)!kB.call(e,a)||a==="key"||a==="__self"||a==="__source"||a==="ref"&&e.ref===void 0||(i[a]=e[a]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var o=Array(a),l=0;l<a;l++)o[l]=arguments[l+2];i.children=o}return mO(t.type,r,void 0,void 0,s,i)};di.createContext=function(t){return t={$$typeof:oj,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:aj,_context:t},t};di.createElement=function(t,e,n){var i,r={},s=null;if(e!=null)for(i in e.key!==void 0&&(s=""+e.key),e)kB.call(e,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var o=Array(a),l=0;l<a;l++)o[l]=arguments[l+2];r.children=o}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return mO(t,s,void 0,void 0,null,r)};di.createRef=function(){return{current:null}};di.forwardRef=function(t){return{$$typeof:lj,render:t}};di.isValidElement=gO;di.lazy=function(t){return{$$typeof:IB,_payload:{_status:-1,_result:t},_init:mj}};di.memo=function(t,e){return{$$typeof:cj,type:t,compare:e===void 0?null:e}};di.startTransition=function(t){var e=Mr.T,n={};Mr.T=n;try{var i=t(),r=Mr.S;r!==null&&r(n,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(gj,_I)}catch(s){_I(s)}finally{Mr.T=e}};di.unstable_useCacheRefresh=function(){return Mr.H.useCacheRefresh()};di.use=function(t){return Mr.H.use(t)};di.useActionState=function(t,e,n){return Mr.H.useActionState(t,e,n)};di.useCallback=function(t,e){return Mr.H.useCallback(t,e)};di.useContext=function(t){return Mr.H.useContext(t)};di.useDebugValue=function(){};di.useDeferredValue=function(t,e){return Mr.H.useDeferredValue(t,e)};di.useEffect=function(t,e,n){var i=Mr.H;if(typeof n=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return i.useEffect(t,e)};di.useId=function(){return Mr.H.useId()};di.useImperativeHandle=function(t,e,n){return Mr.H.useImperativeHandle(t,e,n)};di.useInsertionEffect=function(t,e){return Mr.H.useInsertionEffect(t,e)};di.useLayoutEffect=function(t,e){return Mr.H.useLayoutEffect(t,e)};di.useMemo=function(t,e){return Mr.H.useMemo(t,e)};di.useOptimistic=function(t,e){return Mr.H.useOptimistic(t,e)};di.useReducer=function(t,e,n){return Mr.H.useReducer(t,e,n)};di.useRef=function(t){return Mr.H.useRef(t)};di.useState=function(t){return Mr.H.useState(t)};di.useSyncExternalStore=function(t,e,n){return Mr.H.useSyncExternalStore(t,e,n)};di.useTransition=function(){return Mr.H.useTransition()};di.version="19.1.0";zB.exports=di;var V=zB.exports;const iu=Lo(V);var FB={exports:{}},TA={},GB={exports:{}},VB={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,k){var j=N.length;N.push(k);e:for(;0<j;){var X=j-1>>>1,Q=N[X];if(0<r(Q,k))N[X]=k,N[j]=Q,j=X;else break e}}function n(N){return N.length===0?null:N[0]}function i(N){if(N.length===0)return null;var k=N[0],j=N.pop();if(j!==k){N[0]=j;e:for(var X=0,Q=N.length,H=Q>>>1;X<H;){var $=2*(X+1)-1,ne=N[$],q=$+1,se=N[q];if(0>r(ne,j))q<Q&&0>r(se,ne)?(N[X]=se,N[q]=j,X=q):(N[X]=ne,N[$]=j,X=$);else if(q<Q&&0>r(se,j))N[X]=se,N[q]=j,X=q;else break e}}return k}function r(N,k){var j=N.sortIndex-k.sortIndex;return j!==0?j:N.id-k.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,h=null,d=3,m=!1,v=!1,_=!1,y=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function E(N){for(var k=n(u);k!==null;){if(k.callback===null)i(u);else if(k.startTime<=N)i(u),k.sortIndex=k.expirationTime,e(l,k);else break;k=n(u)}}function A(N){if(_=!1,E(N),!v)if(n(l)!==null)v=!0,T||(T=!0,F());else{var k=n(u);k!==null&&Y(A,k.startTime-N)}}var T=!1,C=-1,O=5,M=-1;function D(){return y?!0:!(t.unstable_now()-M<O)}function P(){if(y=!1,T){var N=t.unstable_now();M=N;var k=!0;try{e:{v=!1,_&&(_=!1,x(C),C=-1),m=!0;var j=d;try{t:{for(E(N),h=n(l);h!==null&&!(h.expirationTime>N&&D());){var X=h.callback;if(typeof X=="function"){h.callback=null,d=h.priorityLevel;var Q=X(h.expirationTime<=N);if(N=t.unstable_now(),typeof Q=="function"){h.callback=Q,E(N),k=!0;break t}h===n(l)&&i(l),E(N)}else i(l);h=n(l)}if(h!==null)k=!0;else{var H=n(u);H!==null&&Y(A,H.startTime-N),k=!1}}break e}finally{h=null,d=j,m=!1}k=void 0}}finally{k?F():T=!1}}}var F;if(typeof S=="function")F=function(){S(P)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,z=G.port2;G.port1.onmessage=P,F=function(){z.postMessage(null)}}else F=function(){g(P,0)};function Y(N,k){C=g(function(){N(t.unstable_now())},k)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_next=function(N){switch(d){case 1:case 2:case 3:var k=3;break;default:k=d}var j=d;d=k;try{return N()}finally{d=j}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(N,k){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var j=d;d=N;try{return k()}finally{d=j}},t.unstable_scheduleCallback=function(N,k,j){var X=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?X+j:X):j=X,N){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=j+Q,N={id:c++,callback:k,priorityLevel:N,startTime:j,expirationTime:Q,sortIndex:-1},j>X?(N.sortIndex=j,e(u,N),n(l)===null&&N===n(u)&&(_?(x(C),C=-1):_=!0,Y(A,j-X))):(N.sortIndex=Q,e(l,N),v||m||(v=!0,T||(T=!0,F()))),N},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(N){var k=d;return function(){var j=d;d=k;try{return N.apply(this,arguments)}finally{d=j}}}})(VB);GB.exports=VB;var vj=GB.exports,HB={exports:{}},Pa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yj=V;function jB(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function yh(){}var Ia={d:{f:yh,r:function(){throw Error(jB(522))},D:yh,C:yh,L:yh,m:yh,X:yh,S:yh,M:yh},p:0,findDOMNode:null},xj=Symbol.for("react.portal");function _j(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xj,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}var kx=yj.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function MA(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}Pa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ia;Pa.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(jB(299));return _j(t,e,null,n)};Pa.flushSync=function(t){var e=kx.T,n=Ia.p;try{if(kx.T=null,Ia.p=2,t)return t()}finally{kx.T=e,Ia.p=n,Ia.d.f()}};Pa.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,Ia.d.C(t,e))};Pa.prefetchDNS=function(t){typeof t=="string"&&Ia.d.D(t)};Pa.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var n=e.as,i=MA(n,e.crossOrigin),r=typeof e.integrity=="string"?e.integrity:void 0,s=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;n==="style"?Ia.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:s}):n==="script"&&Ia.d.X(t,{crossOrigin:i,integrity:r,fetchPriority:s,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};Pa.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var n=MA(e.as,e.crossOrigin);Ia.d.M(t,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&Ia.d.M(t)};Pa.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var n=e.as,i=MA(n,e.crossOrigin);Ia.d.L(t,n,{crossOrigin:i,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};Pa.preloadModule=function(t,e){if(typeof t=="string")if(e){var n=MA(e.as,e.crossOrigin);Ia.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else Ia.d.m(t)};Pa.requestFormReset=function(t){Ia.d.r(t)};Pa.unstable_batchedUpdates=function(t,e){return t(e)};Pa.useFormState=function(t,e,n){return kx.H.useFormState(t,e,n)};Pa.useFormStatus=function(){return kx.H.useHostTransitionStatus()};Pa.version="19.1.0";function WB(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(WB)}catch(t){console.error(t)}}WB(),HB.exports=Pa;var bj=HB.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zs=vj,XB=V,Sj=bj;function Dt(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function YB(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function x_(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ZB(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bI(t){if(x_(t)!==t)throw Error(Dt(188))}function Ej(t){var e=t.alternate;if(!e){if(e=x_(t),e===null)throw Error(Dt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return bI(r),t;if(s===i)return bI(r),e;s=s.sibling}throw Error(Dt(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,o=r.child;o;){if(o===n){a=!0,n=r,i=s;break}if(o===i){a=!0,i=r,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,i=r;break}if(o===i){a=!0,i=s,n=r;break}o=o.sibling}if(!a)throw Error(Dt(189))}}if(n.alternate!==i)throw Error(Dt(190))}if(n.tag!==3)throw Error(Dt(188));return n.stateNode.current===n?t:e}function qB(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=qB(t),e!==null)return e;t=t.sibling}return null}var br=Object.assign,wj=Symbol.for("react.element"),hS=Symbol.for("react.transitional.element"),Tx=Symbol.for("react.portal"),Kg=Symbol.for("react.fragment"),KB=Symbol.for("react.strict_mode"),Z3=Symbol.for("react.profiler"),Aj=Symbol.for("react.provider"),QB=Symbol.for("react.consumer"),af=Symbol.for("react.context"),vO=Symbol.for("react.forward_ref"),q3=Symbol.for("react.suspense"),K3=Symbol.for("react.suspense_list"),yO=Symbol.for("react.memo"),Uh=Symbol.for("react.lazy"),Q3=Symbol.for("react.activity"),Tj=Symbol.for("react.memo_cache_sentinel"),SI=Symbol.iterator;function zy(t){return t===null||typeof t!="object"?null:(t=SI&&t[SI]||t["@@iterator"],typeof t=="function"?t:null)}var Mj=Symbol.for("react.client.reference");function J3(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===Mj?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Kg:return"Fragment";case Z3:return"Profiler";case KB:return"StrictMode";case q3:return"Suspense";case K3:return"SuspenseList";case Q3:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case Tx:return"Portal";case af:return(t.displayName||"Context")+".Provider";case QB:return(t._context.displayName||"Context")+".Consumer";case vO:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case yO:return e=t.displayName||null,e!==null?e:J3(t.type)||"Memo";case Uh:e=t._payload,t=t._init;try{return J3(t(e))}catch{}}return null}var Mx=Array.isArray,Hn=XB.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Vi=Sj.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Dp={pending:!1,data:null,method:null,action:null},$3=[],Qg=-1;function oc(t){return{current:t}}function Zs(t){0>Qg||(t.current=$3[Qg],$3[Qg]=null,Qg--)}function Cr(t,e){Qg++,$3[Qg]=t.current,t.current=e}var qu=oc(null),y1=oc(null),Zh=oc(null),ME=oc(null);function CE(t,e){switch(Cr(Zh,e),Cr(y1,t),Cr(qu,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?ML(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=ML(e),t=p6(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}Zs(qu),Cr(qu,t)}function C0(){Zs(qu),Zs(y1),Zs(Zh)}function eR(t){t.memoizedState!==null&&Cr(ME,t);var e=qu.current,n=p6(e,t.type);e!==n&&(Cr(y1,t),Cr(qu,n))}function RE(t){y1.current===t&&(Zs(qu),Zs(y1)),ME.current===t&&(Zs(ME),C1._currentValue=Dp)}var tR=Object.prototype.hasOwnProperty,xO=zs.unstable_scheduleCallback,IM=zs.unstable_cancelCallback,Cj=zs.unstable_shouldYield,Rj=zs.unstable_requestPaint,Ku=zs.unstable_now,Dj=zs.unstable_getCurrentPriorityLevel,JB=zs.unstable_ImmediatePriority,$B=zs.unstable_UserBlockingPriority,DE=zs.unstable_NormalPriority,Oj=zs.unstable_LowPriority,ek=zs.unstable_IdlePriority,Uj=zs.log,zj=zs.unstable_setDisableYieldValue,__=null,To=null;function Gh(t){if(typeof Uj=="function"&&zj(t),To&&typeof To.setStrictMode=="function")try{To.setStrictMode(__,t)}catch{}}var Mo=Math.clz32?Math.clz32:Pj,Ij=Math.log,Lj=Math.LN2;function Pj(t){return t>>>=0,t===0?32:31-(Ij(t)/Lj|0)|0}var dS=256,pS=4194304;function vp(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function CA(t,e,n){var i=t.pendingLanes;if(i===0)return 0;var r=0,s=t.suspendedLanes,a=t.pingedLanes;t=t.warmLanes;var o=i&134217727;return o!==0?(i=o&~s,i!==0?r=vp(i):(a&=o,a!==0?r=vp(a):n||(n=o&~t,n!==0&&(r=vp(n))))):(o=i&~s,o!==0?r=vp(o):a!==0?r=vp(a):n||(n=i&~t,n!==0&&(r=vp(n)))),r===0?0:e!==0&&e!==r&&!(e&s)&&(s=r&-r,n=e&-e,s>=n||s===32&&(n&4194048)!==0)?e:r}function b_(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function Nj(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tk(){var t=dS;return dS<<=1,!(dS&4194048)&&(dS=256),t}function nk(){var t=pS;return pS<<=1,!(pS&62914560)&&(pS=4194304),t}function LM(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function S_(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Bj(t,e,n,i,r,s){var a=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var o=t.entanglements,l=t.expirationTimes,u=t.hiddenUpdates;for(n=a&~n;0<n;){var c=31-Mo(n),h=1<<c;o[c]=0,l[c]=-1;var d=u[c];if(d!==null)for(u[c]=null,c=0;c<d.length;c++){var m=d[c];m!==null&&(m.lane&=-536870913)}n&=~h}i!==0&&ik(t,i,0),s!==0&&r===0&&t.tag!==0&&(t.suspendedLanes|=s&~(a&~e))}function ik(t,e,n){t.pendingLanes|=e,t.suspendedLanes&=~e;var i=31-Mo(e);t.entangledLanes|=e,t.entanglements[i]=t.entanglements[i]|1073741824|n&4194090}function rk(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Mo(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}function _O(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function bO(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function sk(){var t=Vi.p;return t!==0?t:(t=window.event,t===void 0?32:w6(t.type))}function kj(t,e){var n=Vi.p;try{return Vi.p=t,e()}finally{Vi.p=n}}var cd=Math.random().toString(36).slice(2),_a="__reactFiber$"+cd,ao="__reactProps$"+cd,sv="__reactContainer$"+cd,nR="__reactEvents$"+cd,Fj="__reactListeners$"+cd,Gj="__reactHandles$"+cd,EI="__reactResources$"+cd,E_="__reactMarker$"+cd;function SO(t){delete t[_a],delete t[ao],delete t[nR],delete t[Fj],delete t[Gj]}function Jg(t){var e=t[_a];if(e)return e;for(var n=t.parentNode;n;){if(e=n[sv]||n[_a]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=DL(t);t!==null;){if(n=t[_a])return n;t=DL(t)}return e}t=n,n=t.parentNode}return null}function av(t){if(t=t[_a]||t[sv]){var e=t.tag;if(e===5||e===6||e===13||e===26||e===27||e===3)return t}return null}function Cx(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(Dt(33))}function d0(t){var e=t[EI];return e||(e=t[EI]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function Xs(t){t[E_]=!0}var ak=new Set,ok={};function om(t,e){R0(t,e),R0(t+"Capture",e)}function R0(t,e){for(ok[t]=e,t=0;t<e.length;t++)ak.add(e[t])}var Vj=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wI={},AI={};function Hj(t){return tR.call(AI,t)?!0:tR.call(wI,t)?!1:Vj.test(t)?AI[t]=!0:(wI[t]=!0,!1)}function Y2(t,e,n){if(Hj(e))if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var i=e.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+n)}}function mS(t,e,n){if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+n)}}function Nc(t,e,n,i){if(i===null)t.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttributeNS(e,n,""+i)}}var PM,TI;function Yg(t){if(PM===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);PM=e&&e[1]||"",TI=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+PM+t+TI}var NM=!1;function BM(t,e){if(!t||NM)return"";NM=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(e){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(m){var d=m}Reflect.construct(t,[],h)}else{try{h.call()}catch(m){d=m}t.call(h.prototype)}}else{try{throw Error()}catch(m){d=m}(h=t())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(m){if(m&&d&&typeof m.stack=="string")return[m.stack,d.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=i.DetermineComponentFrameRoot(),a=s[0],o=s[1];if(a&&o){var l=a.split(`
`),u=o.split(`
`);for(r=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;r<u.length&&!u[r].includes("DetermineComponentFrameRoot");)r++;if(i===l.length||r===u.length)for(i=l.length-1,r=u.length-1;1<=i&&0<=r&&l[i]!==u[r];)r--;for(;1<=i&&0<=r;i--,r--)if(l[i]!==u[r]){if(i!==1||r!==1)do if(i--,r--,0>r||l[i]!==u[r]){var c=`
`+l[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=r);break}}}finally{NM=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:"")?Yg(n):""}function jj(t){switch(t.tag){case 26:case 27:case 5:return Yg(t.type);case 16:return Yg("Lazy");case 13:return Yg("Suspense");case 19:return Yg("SuspenseList");case 0:case 15:return BM(t.type,!1);case 11:return BM(t.type.render,!1);case 1:return BM(t.type,!0);case 31:return Yg("Activity");default:return""}}function MI(t){try{var e="";do e+=jj(t),t=t.return;while(t);return e}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function el(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function lk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Wj(t){var e=lk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function OE(t){t._valueTracker||(t._valueTracker=Wj(t))}function uk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=lk(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function UE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Xj=/[\n"\\]/g;function sl(t){return t.replace(Xj,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function iR(t,e,n,i,r,s,a,o){t.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?t.type=a:t.removeAttribute("type"),e!=null?a==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+el(e)):t.value!==""+el(e)&&(t.value=""+el(e)):a!=="submit"&&a!=="reset"||t.removeAttribute("value"),e!=null?rR(t,a,el(e)):n!=null?rR(t,a,el(n)):i!=null&&t.removeAttribute("value"),r==null&&s!=null&&(t.defaultChecked=!!s),r!=null&&(t.checked=r&&typeof r!="function"&&typeof r!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?t.name=""+el(o):t.removeAttribute("name")}function ck(t,e,n,i,r,s,a,o){if(s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(t.type=s),e!=null||n!=null){if(!(s!=="submit"&&s!=="reset"||e!=null))return;n=n!=null?""+el(n):"",e=e!=null?""+el(e):n,o||e===t.value||(t.value=e),t.defaultValue=e}i=i??r,i=typeof i!="function"&&typeof i!="symbol"&&!!i,t.checked=o?t.checked:!!i,t.defaultChecked=!!i,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(t.name=a)}function rR(t,e,n){e==="number"&&UE(t.ownerDocument)===t||t.defaultValue===""+n||(t.defaultValue=""+n)}function p0(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+el(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function fk(t,e,n){if(e!=null&&(e=""+el(e),e!==t.value&&(t.value=e),n==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=n!=null?""+el(n):""}function hk(t,e,n,i){if(e==null){if(i!=null){if(n!=null)throw Error(Dt(92));if(Mx(i)){if(1<i.length)throw Error(Dt(93));i=i[0]}n=i}n==null&&(n=""),e=n}n=el(e),t.defaultValue=n,i=t.textContent,i===n&&i!==""&&i!==null&&(t.value=i)}function D0(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Yj=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function CI(t,e,n){var i=e.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":i?t.setProperty(e,n):typeof n!="number"||n===0||Yj.has(e)?e==="float"?t.cssFloat=n:t[e]=(""+n).trim():t[e]=n+"px"}function dk(t,e,n){if(e!=null&&typeof e!="object")throw Error(Dt(62));if(t=t.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||e!=null&&e.hasOwnProperty(i)||(i.indexOf("--")===0?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="");for(var r in e)i=e[r],e.hasOwnProperty(r)&&n[r]!==i&&CI(t,r,i)}else for(var s in e)e.hasOwnProperty(s)&&CI(t,s,e[s])}function EO(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zj=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qj=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Z2(t){return qj.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var sR=null;function wO(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $g=null,m0=null;function RI(t){var e=av(t);if(e&&(t=e.stateNode)){var n=t[ao]||null;e:switch(t=e.stateNode,e.type){case"input":if(iR(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+sl(""+e)+'"][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=i[ao]||null;if(!r)throw Error(Dt(90));iR(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(e=0;e<n.length;e++)i=n[e],i.form===t.form&&uk(i)}break e;case"textarea":fk(t,n.value,n.defaultValue);break e;case"select":e=n.value,e!=null&&p0(t,!!n.multiple,e,!1)}}}var kM=!1;function pk(t,e,n){if(kM)return t(e,n);kM=!0;try{var i=t(e);return i}finally{if(kM=!1,($g!==null||m0!==null)&&(BA(),$g&&(e=$g,t=m0,m0=$g=null,RI(e),t)))for(e=0;e<t.length;e++)RI(t[e])}}function x1(t,e){var n=t.stateNode;if(n===null)return null;var i=n[ao]||null;if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Dt(231,e,typeof n));return n}var _f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),aR=!1;if(_f)try{var Iy={};Object.defineProperty(Iy,"passive",{get:function(){aR=!0}}),window.addEventListener("test",Iy,Iy),window.removeEventListener("test",Iy,Iy)}catch{aR=!1}var Vh=null,AO=null,q2=null;function mk(){if(q2)return q2;var t,e=AO,n=e.length,i,r="value"in Vh?Vh.value:Vh.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(i=1;i<=a&&e[n-i]===r[s-i];i++);return q2=r.slice(t,1<i?1-i:void 0)}function K2(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gS(){return!0}function DI(){return!1}function oo(t){function e(n,i,r,s,a){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?gS:DI,this.isPropagationStopped=DI,this}return br(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=gS)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=gS)},persist:function(){},isPersistent:gS}),e}var lm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},RA=oo(lm),w_=br({},lm,{view:0,detail:0}),Kj=oo(w_),FM,GM,Ly,DA=br({},w_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:TO,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ly&&(Ly&&t.type==="mousemove"?(FM=t.screenX-Ly.screenX,GM=t.screenY-Ly.screenY):GM=FM=0,Ly=t),FM)},movementY:function(t){return"movementY"in t?t.movementY:GM}}),OI=oo(DA),Qj=br({},DA,{dataTransfer:0}),Jj=oo(Qj),$j=br({},w_,{relatedTarget:0}),VM=oo($j),eW=br({},lm,{animationName:0,elapsedTime:0,pseudoElement:0}),tW=oo(eW),nW=br({},lm,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),iW=oo(nW),rW=br({},lm,{data:0}),UI=oo(rW),sW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=oW[t])?!!e[t]:!1}function TO(){return lW}var uW=br({},w_,{key:function(t){if(t.key){var e=sW[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=K2(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?aW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:TO,charCode:function(t){return t.type==="keypress"?K2(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?K2(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),cW=oo(uW),fW=br({},DA,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zI=oo(fW),hW=br({},w_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:TO}),dW=oo(hW),pW=br({},lm,{propertyName:0,elapsedTime:0,pseudoElement:0}),mW=oo(pW),gW=br({},DA,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vW=oo(gW),yW=br({},lm,{newState:0,oldState:0}),xW=oo(yW),_W=[9,13,27,32],MO=_f&&"CompositionEvent"in window,Fx=null;_f&&"documentMode"in document&&(Fx=document.documentMode);var bW=_f&&"TextEvent"in window&&!Fx,gk=_f&&(!MO||Fx&&8<Fx&&11>=Fx),II=" ",LI=!1;function vk(t,e){switch(t){case"keyup":return _W.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yk(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var e0=!1;function SW(t,e){switch(t){case"compositionend":return yk(e);case"keypress":return e.which!==32?null:(LI=!0,II);case"textInput":return t=e.data,t===II&&LI?null:t;default:return null}}function EW(t,e){if(e0)return t==="compositionend"||!MO&&vk(t,e)?(t=mk(),q2=AO=Vh=null,e0=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gk&&e.locale!=="ko"?null:e.data;default:return null}}var wW={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function PI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!wW[t.type]:e==="textarea"}function xk(t,e,n,i){$g?m0?m0.push(i):m0=[i]:$g=i,e=KE(e,"onChange"),0<e.length&&(n=new RA("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Gx=null,_1=null;function AW(t){f6(t,0)}function OA(t){var e=Cx(t);if(uk(e))return t}function NI(t,e){if(t==="change")return e}var _k=!1;if(_f){var HM;if(_f){var jM="oninput"in document;if(!jM){var BI=document.createElement("div");BI.setAttribute("oninput","return;"),jM=typeof BI.oninput=="function"}HM=jM}else HM=!1;_k=HM&&(!document.documentMode||9<document.documentMode)}function kI(){Gx&&(Gx.detachEvent("onpropertychange",bk),_1=Gx=null)}function bk(t){if(t.propertyName==="value"&&OA(_1)){var e=[];xk(e,_1,t,wO(t)),pk(AW,e)}}function TW(t,e,n){t==="focusin"?(kI(),Gx=e,_1=n,Gx.attachEvent("onpropertychange",bk)):t==="focusout"&&kI()}function MW(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return OA(_1)}function CW(t,e){if(t==="click")return OA(e)}function RW(t,e){if(t==="input"||t==="change")return OA(e)}function DW(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Oo=typeof Object.is=="function"?Object.is:DW;function b1(t,e){if(Oo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!tR.call(e,r)||!Oo(t[r],e[r]))return!1}return!0}function FI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function GI(t,e){var n=FI(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=FI(n)}}function Sk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Sk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ek(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=UE(t.document);e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=UE(t.document)}return e}function CO(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var OW=_f&&"documentMode"in document&&11>=document.documentMode,t0=null,oR=null,Vx=null,lR=!1;function VI(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;lR||t0==null||t0!==UE(i)||(i=t0,"selectionStart"in i&&CO(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Vx&&b1(Vx,i)||(Vx=i,i=KE(oR,"onSelect"),0<i.length&&(e=new RA("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=t0)))}function $d(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var n0={animationend:$d("Animation","AnimationEnd"),animationiteration:$d("Animation","AnimationIteration"),animationstart:$d("Animation","AnimationStart"),transitionrun:$d("Transition","TransitionRun"),transitionstart:$d("Transition","TransitionStart"),transitioncancel:$d("Transition","TransitionCancel"),transitionend:$d("Transition","TransitionEnd")},WM={},wk={};_f&&(wk=document.createElement("div").style,"AnimationEvent"in window||(delete n0.animationend.animation,delete n0.animationiteration.animation,delete n0.animationstart.animation),"TransitionEvent"in window||delete n0.transitionend.transition);function um(t){if(WM[t])return WM[t];if(!n0[t])return t;var e=n0[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in wk)return WM[t]=e[n];return t}var Ak=um("animationend"),Tk=um("animationiteration"),Mk=um("animationstart"),UW=um("transitionrun"),zW=um("transitionstart"),IW=um("transitioncancel"),Ck=um("transitionend"),Rk=new Map,uR="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");uR.push("scrollEnd");function lu(t,e){Rk.set(t,e),om(e,[t])}var HI=new WeakMap;function al(t,e){if(typeof t=="object"&&t!==null){var n=HI.get(t);return n!==void 0?n:(e={value:t,source:e,stack:MI(e)},HI.set(t,e),e)}return{value:t,source:e,stack:MI(e)}}var Jo=[],i0=0,RO=0;function UA(){for(var t=i0,e=RO=i0=0;e<t;){var n=Jo[e];Jo[e++]=null;var i=Jo[e];Jo[e++]=null;var r=Jo[e];Jo[e++]=null;var s=Jo[e];if(Jo[e++]=null,i!==null&&r!==null){var a=i.pending;a===null?r.next=r:(r.next=a.next,a.next=r),i.pending=r}s!==0&&Dk(n,r,s)}}function zA(t,e,n,i){Jo[i0++]=t,Jo[i0++]=e,Jo[i0++]=n,Jo[i0++]=i,RO|=i,t.lanes|=i,t=t.alternate,t!==null&&(t.lanes|=i)}function DO(t,e,n,i){return zA(t,e,n,i),zE(t)}function ov(t,e){return zA(t,null,null,e),zE(t)}function Dk(t,e,n){t.lanes|=n;var i=t.alternate;i!==null&&(i.lanes|=n);for(var r=!1,s=t.return;s!==null;)s.childLanes|=n,i=s.alternate,i!==null&&(i.childLanes|=n),s.tag===22&&(t=s.stateNode,t===null||t._visibility&1||(r=!0)),t=s,s=s.return;return t.tag===3?(s=t.stateNode,r&&e!==null&&(r=31-Mo(n),t=s.hiddenUpdates,i=t[r],i===null?t[r]=[e]:i.push(e),e.lane=n|536870912),s):null}function zE(t){if(50<Jx)throw Jx=0,DR=null,Error(Dt(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var r0={};function LW(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ao(t,e,n,i){return new LW(t,e,n,i)}function OO(t){return t=t.prototype,!(!t||!t.isReactComponent)}function df(t,e){var n=t.alternate;return n===null?(n=Ao(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&65011712,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function Ok(t,e){t.flags&=65011714;var n=t.alternate;return n===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function Q2(t,e,n,i,r,s){var a=0;if(i=t,typeof t=="function")OO(t)&&(a=1);else if(typeof t=="string")a=NX(t,n,qu.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case Q3:return t=Ao(31,n,e,r),t.elementType=Q3,t.lanes=s,t;case Kg:return Op(n.children,r,s,e);case KB:a=8,r|=24;break;case Z3:return t=Ao(12,n,e,r|2),t.elementType=Z3,t.lanes=s,t;case q3:return t=Ao(13,n,e,r),t.elementType=q3,t.lanes=s,t;case K3:return t=Ao(19,n,e,r),t.elementType=K3,t.lanes=s,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Aj:case af:a=10;break e;case QB:a=9;break e;case vO:a=11;break e;case yO:a=14;break e;case Uh:a=16,i=null;break e}a=29,n=Error(Dt(130,t===null?"null":typeof t,"")),i=null}return e=Ao(a,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function Op(t,e,n,i){return t=Ao(7,t,i,e),t.lanes=n,t}function XM(t,e,n){return t=Ao(6,t,null,e),t.lanes=n,t}function YM(t,e,n){return e=Ao(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var s0=[],a0=0,IE=null,LE=0,tl=[],nl=0,Up=null,of=1,lf="";function yp(t,e){s0[a0++]=LE,s0[a0++]=IE,IE=t,LE=e}function Uk(t,e,n){tl[nl++]=of,tl[nl++]=lf,tl[nl++]=Up,Up=t;var i=of;t=lf;var r=32-Mo(i)-1;i&=~(1<<r),n+=1;var s=32-Mo(e)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,of=1<<32-Mo(e)+r|n<<r|i,lf=s+t}else of=1<<s|n<<r|i,lf=t}function UO(t){t.return!==null&&(yp(t,1),Uk(t,1,0))}function zO(t){for(;t===IE;)IE=s0[--a0],s0[a0]=null,LE=s0[--a0],s0[a0]=null;for(;t===Up;)Up=tl[--nl],tl[nl]=null,lf=tl[--nl],tl[nl]=null,of=tl[--nl],tl[nl]=null}var Oa=null,Jr=null,Gi=!1,zp=null,Wu=!1,cR=Error(Dt(519));function Xp(t){var e=Error(Dt(418,""));throw S1(al(e,t)),cR}function jI(t){var e=t.stateNode,n=t.type,i=t.memoizedProps;switch(e[_a]=t,e[ao]=i,n){case"dialog":vi("cancel",e),vi("close",e);break;case"iframe":case"object":case"embed":vi("load",e);break;case"video":case"audio":for(n=0;n<A1.length;n++)vi(A1[n],e);break;case"source":vi("error",e);break;case"img":case"image":case"link":vi("error",e),vi("load",e);break;case"details":vi("toggle",e);break;case"input":vi("invalid",e),ck(e,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),OE(e);break;case"select":vi("invalid",e);break;case"textarea":vi("invalid",e),hk(e,i.value,i.defaultValue,i.children),OE(e)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||e.textContent===""+n||i.suppressHydrationWarning===!0||d6(e.textContent,n)?(i.popover!=null&&(vi("beforetoggle",e),vi("toggle",e)),i.onScroll!=null&&vi("scroll",e),i.onScrollEnd!=null&&vi("scrollend",e),i.onClick!=null&&(e.onclick=GA),e=!0):e=!1,e||Xp(t)}function WI(t){for(Oa=t.return;Oa;)switch(Oa.tag){case 5:case 13:Wu=!1;return;case 27:case 3:Wu=!0;return;default:Oa=Oa.return}}function Py(t){if(t!==Oa)return!1;if(!Gi)return WI(t),Gi=!0,!1;var e=t.tag,n;if((n=e!==3&&e!==27)&&((n=e===5)&&(n=t.type,n=!(n!=="form"&&n!=="button")||PR(t.type,t.memoizedProps)),n=!n),n&&Jr&&Xp(t),WI(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Dt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8)if(n=t.data,n==="/$"){if(e===0){Jr=ru(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++;t=t.nextSibling}Jr=null}}else e===27?(e=Jr,fd(t.type)?(t=kR,kR=null,Jr=t):Jr=e):Jr=Oa?ru(t.stateNode.nextSibling):null;return!0}function A_(){Jr=Oa=null,Gi=!1}function XI(){var t=zp;return t!==null&&(eo===null?eo=t:eo.push.apply(eo,t),zp=null),t}function S1(t){zp===null?zp=[t]:zp.push(t)}var fR=oc(null),cm=null,uf=null;function Ph(t,e,n){Cr(fR,e._currentValue),e._currentValue=n}function pf(t){t._currentValue=fR.current,Zs(fR)}function hR(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function dR(t,e,n,i){var r=t.child;for(r!==null&&(r.return=t);r!==null;){var s=r.dependencies;if(s!==null){var a=r.child;s=s.firstContext;e:for(;s!==null;){var o=s;s=r;for(var l=0;l<e.length;l++)if(o.context===e[l]){s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),hR(s.return,n,t),i||(a=null);break e}s=o.next}}else if(r.tag===18){if(a=r.return,a===null)throw Error(Dt(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),hR(a,n,t),a=null}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===t){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}}function T_(t,e,n,i){t=null;for(var r=e,s=!1;r!==null;){if(!s){if(r.flags&524288)s=!0;else if(r.flags&262144)break}if(r.tag===10){var a=r.alternate;if(a===null)throw Error(Dt(387));if(a=a.memoizedProps,a!==null){var o=r.type;Oo(r.pendingProps.value,a.value)||(t!==null?t.push(o):t=[o])}}else if(r===ME.current){if(a=r.alternate,a===null)throw Error(Dt(387));a.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(t!==null?t.push(C1):t=[C1])}r=r.return}t!==null&&dR(e,t,n,i),e.flags|=262144}function PE(t){for(t=t.firstContext;t!==null;){if(!Oo(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Yp(t){cm=t,uf=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function ba(t){return zk(cm,t)}function vS(t,e){return cm===null&&Yp(t),zk(t,e)}function zk(t,e){var n=e._currentValue;if(e={context:e,memoizedValue:n,next:null},uf===null){if(t===null)throw Error(Dt(308));uf=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else uf=uf.next=e;return n}var PW=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(n,i){t.push(i)}};this.abort=function(){e.aborted=!0,t.forEach(function(n){return n()})}},NW=zs.unstable_scheduleCallback,BW=zs.unstable_NormalPriority,Rs={$$typeof:af,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function IO(){return{controller:new PW,data:new Map,refCount:0}}function M_(t){t.refCount--,t.refCount===0&&NW(BW,function(){t.controller.abort()})}var Hx=null,pR=0,O0=0,g0=null;function kW(t,e){if(Hx===null){var n=Hx=[];pR=0,O0=iU(),g0={status:"pending",value:void 0,then:function(i){n.push(i)}}}return pR++,e.then(YI,YI),e}function YI(){if(--pR===0&&Hx!==null){g0!==null&&(g0.status="fulfilled");var t=Hx;Hx=null,O0=0,g0=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function FW(t,e){var n=[],i={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return t.then(function(){i.status="fulfilled",i.value=e;for(var r=0;r<n.length;r++)(0,n[r])(e)},function(r){for(i.status="rejected",i.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),i}var ZI=Hn.S;Hn.S=function(t,e){typeof e=="object"&&e!==null&&typeof e.then=="function"&&kW(t,e),ZI!==null&&ZI(t,e)};var Ip=oc(null);function LO(){var t=Ip.current;return t!==null?t:yr.pooledCache}function J2(t,e){e===null?Cr(Ip,Ip.current):Cr(Ip,e.pool)}function Ik(){var t=LO();return t===null?null:{parent:Rs._currentValue,pool:t}}var C_=Error(Dt(460)),Lk=Error(Dt(474)),IA=Error(Dt(542)),mR={then:function(){}};function qI(t){return t=t.status,t==="fulfilled"||t==="rejected"}function yS(){}function Pk(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then(yS,yS),e=n),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,QI(t),t;default:if(typeof e.status=="string")e.then(yS,yS);else{if(t=yr,t!==null&&100<t.shellSuspendCounter)throw Error(Dt(482));t=e,t.status="pending",t.then(function(i){if(e.status==="pending"){var r=e;r.status="fulfilled",r.value=i}},function(i){if(e.status==="pending"){var r=e;r.status="rejected",r.reason=i}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,QI(t),t}throw jx=e,C_}}var jx=null;function KI(){if(jx===null)throw Error(Dt(459));var t=jx;return jx=null,t}function QI(t){if(t===C_||t===IA)throw Error(Dt(483))}var zh=!1;function PO(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gR(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function qh(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Kh(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Ji&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,e=zE(t),Dk(t,null,n),e}return zA(t,i,e,n),zE(t)}function Wx(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194048)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,rk(t,n)}}function ZM(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};s===null?r=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,callbacks:i.callbacks},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}var vR=!1;function Xx(){if(vR){var t=g0;if(t!==null)throw t}}function Yx(t,e,n,i){vR=!1;var r=t.updateQueue;zh=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=r.baseState;a=0,c=u=l=null,o=s;do{var d=o.lane&-536870913,m=d!==o.lane;if(m?(wi&d)===d:(i&d)===d){d!==0&&d===O0&&(vR=!0),c!==null&&(c=c.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var v=t,_=o;d=e;var y=n;switch(_.tag){case 1:if(v=_.payload,typeof v=="function"){h=v.call(y,h,d);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=_.payload,d=typeof v=="function"?v.call(y,h,d):v,d==null)break e;h=br({},h,d);break e;case 2:zh=!0}}d=o.callback,d!==null&&(t.flags|=64,m&&(t.flags|=8192),m=r.callbacks,m===null?r.callbacks=[d]:m.push(d))}else m={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=m,l=h):c=c.next=m,a|=d;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;m=o,o=m.next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}while(!0);c===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,s===null&&(r.shared.lanes=0),sd|=a,t.lanes=a,t.memoizedState=h}}function Nk(t,e){if(typeof t!="function")throw Error(Dt(191,t));t.call(e)}function Bk(t,e){var n=t.callbacks;if(n!==null)for(t.callbacks=null,t=0;t<n.length;t++)Nk(n[t],e)}var U0=oc(null),NE=oc(0);function JI(t,e){t=Ef,Cr(NE,t),Cr(U0,e),Ef=t|e.baseLanes}function yR(){Cr(NE,Ef),Cr(U0,U0.current)}function NO(){Ef=NE.current,Zs(U0),Zs(NE)}var id=0,mi=null,sr=null,gs=null,BE=!1,v0=!1,Zp=!1,kE=0,E1=0,y0=null,GW=0;function rs(){throw Error(Dt(321))}function BO(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Oo(t[n],e[n]))return!1;return!0}function kO(t,e,n,i,r,s){return id=s,mi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Hn.H=t===null||t.memoizedState===null?mF:gF,Zp=!1,s=n(i,r),Zp=!1,v0&&(s=Fk(e,n,i,r)),kk(t),s}function kk(t){Hn.H=FE;var e=sr!==null&&sr.next!==null;if(id=0,gs=sr=mi=null,BE=!1,E1=0,y0=null,e)throw Error(Dt(300));t===null||Ys||(t=t.dependencies,t!==null&&PE(t)&&(Ys=!0))}function Fk(t,e,n,i){mi=t;var r=0;do{if(v0&&(y0=null),E1=0,v0=!1,25<=r)throw Error(Dt(301));if(r+=1,gs=sr=null,t.updateQueue!=null){var s=t.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,s.memoCache!=null&&(s.memoCache.index=0)}Hn.H=ZW,s=e(n,i)}while(v0);return s}function VW(){var t=Hn.H,e=t.useState()[0];return e=typeof e.then=="function"?R_(e):e,t=t.useState()[0],(sr!==null?sr.memoizedState:null)!==t&&(mi.flags|=1024),e}function FO(){var t=kE!==0;return kE=0,t}function GO(t,e,n){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n}function VO(t){if(BE){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}BE=!1}id=0,gs=sr=mi=null,v0=!1,E1=kE=0,y0=null}function Ja(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gs===null?mi.memoizedState=gs=t:gs=gs.next=t,gs}function _s(){if(sr===null){var t=mi.alternate;t=t!==null?t.memoizedState:null}else t=sr.next;var e=gs===null?mi.memoizedState:gs.next;if(e!==null)gs=e,sr=t;else{if(t===null)throw mi.alternate===null?Error(Dt(467)):Error(Dt(310));sr=t,t={memoizedState:sr.memoizedState,baseState:sr.baseState,baseQueue:sr.baseQueue,queue:sr.queue,next:null},gs===null?mi.memoizedState=gs=t:gs=gs.next=t}return gs}function HO(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function R_(t){var e=E1;return E1+=1,y0===null&&(y0=[]),t=Pk(y0,t,e),e=mi,(gs===null?e.memoizedState:gs.next)===null&&(e=e.alternate,Hn.H=e===null||e.memoizedState===null?mF:gF),t}function LA(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return R_(t);if(t.$$typeof===af)return ba(t)}throw Error(Dt(438,String(t)))}function jO(t){var e=null,n=mi.updateQueue;if(n!==null&&(e=n.memoCache),e==null){var i=mi.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(e={data:i.data.map(function(r){return r.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),n===null&&(n=HO(),mi.updateQueue=n),n.memoCache=e,n=e.data[e.index],n===void 0)for(n=e.data[e.index]=Array(t),i=0;i<t;i++)n[i]=Tj;return e.index++,n}function bf(t,e){return typeof e=="function"?e(t):e}function $2(t){var e=_s();return WO(e,sr,t)}function WO(t,e,n){var i=t.queue;if(i===null)throw Error(Dt(311));i.lastRenderedReducer=n;var r=t.baseQueue,s=i.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}e.baseQueue=r=s,i.pending=null}if(s=t.baseState,r===null)t.memoizedState=s;else{e=r.next;var o=a=null,l=null,u=e,c=!1;do{var h=u.lane&-536870913;if(h!==u.lane?(wi&h)===h:(id&h)===h){var d=u.revertLane;if(d===0)l!==null&&(l=l.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===O0&&(c=!0);else if((id&d)===d){u=u.next,d===O0&&(c=!0);continue}else h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(o=l=h,a=s):l=l.next=h,mi.lanes|=d,sd|=d;h=u.action,Zp&&n(s,h),s=u.hasEagerState?u.eagerState:n(s,h)}else d={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(o=l=d,a=s):l=l.next=d,mi.lanes|=h,sd|=h;u=u.next}while(u!==null&&u!==e);if(l===null?a=s:l.next=o,!Oo(s,t.memoizedState)&&(Ys=!0,c&&(n=g0,n!==null)))throw n;t.memoizedState=s,t.baseState=a,t.baseQueue=l,i.lastRenderedState=s}return r===null&&(i.lanes=0),[t.memoizedState,i.dispatch]}function qM(t){var e=_s(),n=e.queue;if(n===null)throw Error(Dt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do s=t(s,a.action),a=a.next;while(a!==r);Oo(s,e.memoizedState)||(Ys=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function Gk(t,e,n){var i=mi,r=_s(),s=Gi;if(s){if(n===void 0)throw Error(Dt(407));n=n()}else n=e();var a=!Oo((sr||r).memoizedState,n);a&&(r.memoizedState=n,Ys=!0),r=r.queue;var o=jk.bind(null,i,r,t);if(D_(2048,8,o,[t]),r.getSnapshot!==e||a||gs!==null&&gs.memoizedState.tag&1){if(i.flags|=2048,z0(9,PA(),Hk.bind(null,i,r,n,e),null),yr===null)throw Error(Dt(349));s||id&124||Vk(i,e,n)}return n}function Vk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=mi.updateQueue,e===null?(e=HO(),mi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Hk(t,e,n,i){e.value=n,e.getSnapshot=i,Wk(e)&&Xk(t)}function jk(t,e,n){return n(function(){Wk(e)&&Xk(t)})}function Wk(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Oo(t,n)}catch{return!0}}function Xk(t){var e=ov(t,2);e!==null&&Ro(e,t,2)}function xR(t){var e=Ja();if(typeof t=="function"){var n=t;if(t=n(),Zp){Gh(!0);try{n()}finally{Gh(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bf,lastRenderedState:t},e}function Yk(t,e,n,i){return t.baseState=n,WO(t,sr,typeof i=="function"?i:bf)}function HW(t,e,n,i,r){if(NA(t))throw Error(Dt(485));if(t=e.action,t!==null){var s={payload:r,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){s.listeners.push(a)}};Hn.T!==null?n(!0):s.isTransition=!1,i(s),n=e.pending,n===null?(s.next=e.pending=s,Zk(e,s)):(s.next=n.next,e.pending=n.next=s)}}function Zk(t,e){var n=e.action,i=e.payload,r=t.state;if(e.isTransition){var s=Hn.T,a={};Hn.T=a;try{var o=n(r,i),l=Hn.S;l!==null&&l(a,o),$I(t,e,o)}catch(u){_R(t,e,u)}finally{Hn.T=s}}else try{s=n(r,i),$I(t,e,s)}catch(u){_R(t,e,u)}}function $I(t,e,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){eL(t,e,i)},function(i){return _R(t,e,i)}):eL(t,e,n)}function eL(t,e,n){e.status="fulfilled",e.value=n,qk(e),t.state=n,e=t.pending,e!==null&&(n=e.next,n===e?t.pending=null:(n=n.next,e.next=n,Zk(t,n)))}function _R(t,e,n){var i=t.pending;if(t.pending=null,i!==null){i=i.next;do e.status="rejected",e.reason=n,qk(e),e=e.next;while(e!==i)}t.action=null}function qk(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function Kk(t,e){return e}function tL(t,e){if(Gi){var n=yr.formState;if(n!==null){e:{var i=mi;if(Gi){if(Jr){t:{for(var r=Jr,s=Wu;r.nodeType!==8;){if(!s){r=null;break t}if(r=ru(r.nextSibling),r===null){r=null;break t}}s=r.data,r=s==="F!"||s==="F"?r:null}if(r){Jr=ru(r.nextSibling),i=r.data==="F!";break e}}Xp(i)}i=!1}i&&(e=n[0])}}return n=Ja(),n.memoizedState=n.baseState=e,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kk,lastRenderedState:e},n.queue=i,n=hF.bind(null,mi,i),i.dispatch=n,i=xR(!1),s=qO.bind(null,mi,!1,i.queue),i=Ja(),r={state:e,dispatch:null,action:t,pending:null},i.queue=r,n=HW.bind(null,mi,r,s,n),r.dispatch=n,i.memoizedState=t,[e,n,!1]}function nL(t){var e=_s();return Qk(e,sr,t)}function Qk(t,e,n){if(e=WO(t,e,Kk)[0],t=$2(bf)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var i=R_(e)}catch(a){throw a===C_?IA:a}else i=e;e=_s();var r=e.queue,s=r.dispatch;return n!==e.memoizedState&&(mi.flags|=2048,z0(9,PA(),jW.bind(null,r,n),null)),[i,s,t]}function jW(t,e){t.action=e}function iL(t){var e=_s(),n=sr;if(n!==null)return Qk(e,n,t);_s(),e=e.memoizedState,n=_s();var i=n.queue.dispatch;return n.memoizedState=t,[e,i,!1]}function z0(t,e,n,i){return t={tag:t,create:n,deps:i,inst:e,next:null},e=mi.updateQueue,e===null&&(e=HO(),mi.updateQueue=e),n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function PA(){return{destroy:void 0,resource:void 0}}function Jk(){return _s().memoizedState}function eE(t,e,n,i){var r=Ja();i=i===void 0?null:i,mi.flags|=t,r.memoizedState=z0(1|e,PA(),n,i)}function D_(t,e,n,i){var r=_s();i=i===void 0?null:i;var s=r.memoizedState.inst;sr!==null&&i!==null&&BO(i,sr.memoizedState.deps)?r.memoizedState=z0(e,s,n,i):(mi.flags|=t,r.memoizedState=z0(1|e,s,n,i))}function rL(t,e){eE(8390656,8,t,e)}function $k(t,e){D_(2048,8,t,e)}function eF(t,e){return D_(4,2,t,e)}function tF(t,e){return D_(4,4,t,e)}function nF(t,e){if(typeof e=="function"){t=t();var n=e(t);return function(){typeof n=="function"?n():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function iF(t,e,n){n=n!=null?n.concat([t]):null,D_(4,4,nF.bind(null,e,t),n)}function XO(){}function rF(t,e){var n=_s();e=e===void 0?null:e;var i=n.memoizedState;return e!==null&&BO(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function sF(t,e){var n=_s();e=e===void 0?null:e;var i=n.memoizedState;if(e!==null&&BO(e,i[1]))return i[0];if(i=t(),Zp){Gh(!0);try{t()}finally{Gh(!1)}}return n.memoizedState=[i,e],i}function YO(t,e,n){return n===void 0||id&1073741824?t.memoizedState=e:(t.memoizedState=n,t=qF(),mi.lanes|=t,sd|=t,n)}function aF(t,e,n,i){return Oo(n,e)?n:U0.current!==null?(t=YO(t,n,i),Oo(t,e)||(Ys=!0),t):id&42?(t=qF(),mi.lanes|=t,sd|=t,e):(Ys=!0,t.memoizedState=n)}function oF(t,e,n,i,r){var s=Vi.p;Vi.p=s!==0&&8>s?s:8;var a=Hn.T,o={};Hn.T=o,qO(t,!1,e,n);try{var l=r(),u=Hn.S;if(u!==null&&u(o,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=FW(l,i);Zx(t,e,c,Co(t))}else Zx(t,e,i,Co(t))}catch(h){Zx(t,e,{then:function(){},status:"rejected",reason:h},Co())}finally{Vi.p=s,Hn.T=a}}function WW(){}function bR(t,e,n,i){if(t.tag!==5)throw Error(Dt(476));var r=lF(t).queue;oF(t,r,e,Dp,n===null?WW:function(){return uF(t),n(i)})}function lF(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:Dp,baseState:Dp,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bf,lastRenderedState:Dp},next:null};var n={};return e.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bf,lastRenderedState:n},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function uF(t){var e=lF(t).next.queue;Zx(t,e,{},Co())}function ZO(){return ba(C1)}function cF(){return _s().memoizedState}function fF(){return _s().memoizedState}function XW(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var n=Co();t=qh(n);var i=Kh(e,t,n);i!==null&&(Ro(i,e,n),Wx(i,e,n)),e={cache:IO()},t.payload=e;return}e=e.return}}function YW(t,e,n){var i=Co();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},NA(t)?dF(e,n):(n=DO(t,e,n,i),n!==null&&(Ro(n,t,i),pF(n,e,i)))}function hF(t,e,n){var i=Co();Zx(t,e,n,i)}function Zx(t,e,n,i){var r={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(NA(t))dF(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,Oo(o,a))return zA(t,e,r,0),yr===null&&UA(),!1}catch{}finally{}if(n=DO(t,e,r,i),n!==null)return Ro(n,t,i),pF(n,e,i),!0}return!1}function qO(t,e,n,i){if(i={lane:2,revertLane:iU(),action:i,hasEagerState:!1,eagerState:null,next:null},NA(t)){if(e)throw Error(Dt(479))}else e=DO(t,n,i,2),e!==null&&Ro(e,t,2)}function NA(t){var e=t.alternate;return t===mi||e!==null&&e===mi}function dF(t,e){v0=BE=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function pF(t,e,n){if(n&4194048){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,rk(t,n)}}var FE={readContext:ba,use:LA,useCallback:rs,useContext:rs,useEffect:rs,useImperativeHandle:rs,useLayoutEffect:rs,useInsertionEffect:rs,useMemo:rs,useReducer:rs,useRef:rs,useState:rs,useDebugValue:rs,useDeferredValue:rs,useTransition:rs,useSyncExternalStore:rs,useId:rs,useHostTransitionStatus:rs,useFormState:rs,useActionState:rs,useOptimistic:rs,useMemoCache:rs,useCacheRefresh:rs},mF={readContext:ba,use:LA,useCallback:function(t,e){return Ja().memoizedState=[t,e===void 0?null:e],t},useContext:ba,useEffect:rL,useImperativeHandle:function(t,e,n){n=n!=null?n.concat([t]):null,eE(4194308,4,nF.bind(null,e,t),n)},useLayoutEffect:function(t,e){return eE(4194308,4,t,e)},useInsertionEffect:function(t,e){eE(4,2,t,e)},useMemo:function(t,e){var n=Ja();e=e===void 0?null:e;var i=t();if(Zp){Gh(!0);try{t()}finally{Gh(!1)}}return n.memoizedState=[i,e],i},useReducer:function(t,e,n){var i=Ja();if(n!==void 0){var r=n(e);if(Zp){Gh(!0);try{n(e)}finally{Gh(!1)}}}else r=e;return i.memoizedState=i.baseState=r,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:r},i.queue=t,t=t.dispatch=YW.bind(null,mi,t),[i.memoizedState,t]},useRef:function(t){var e=Ja();return t={current:t},e.memoizedState=t},useState:function(t){t=xR(t);var e=t.queue,n=hF.bind(null,mi,e);return e.dispatch=n,[t.memoizedState,n]},useDebugValue:XO,useDeferredValue:function(t,e){var n=Ja();return YO(n,t,e)},useTransition:function(){var t=xR(!1);return t=oF.bind(null,mi,t.queue,!0,!1),Ja().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,n){var i=mi,r=Ja();if(Gi){if(n===void 0)throw Error(Dt(407));n=n()}else{if(n=e(),yr===null)throw Error(Dt(349));wi&124||Vk(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,rL(jk.bind(null,i,s,t),[t]),i.flags|=2048,z0(9,PA(),Hk.bind(null,i,s,n,e),null),n},useId:function(){var t=Ja(),e=yr.identifierPrefix;if(Gi){var n=lf,i=of;n=(i&~(1<<32-Mo(i)-1)).toString(32)+n,e="«"+e+"R"+n,n=kE++,0<n&&(e+="H"+n.toString(32)),e+="»"}else n=GW++,e="«"+e+"r"+n.toString(32)+"»";return t.memoizedState=e},useHostTransitionStatus:ZO,useFormState:tL,useActionState:tL,useOptimistic:function(t){var e=Ja();e.memoizedState=e.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=n,e=qO.bind(null,mi,!0,n),n.dispatch=e,[t,e]},useMemoCache:jO,useCacheRefresh:function(){return Ja().memoizedState=XW.bind(null,mi)}},gF={readContext:ba,use:LA,useCallback:rF,useContext:ba,useEffect:$k,useImperativeHandle:iF,useInsertionEffect:eF,useLayoutEffect:tF,useMemo:sF,useReducer:$2,useRef:Jk,useState:function(){return $2(bf)},useDebugValue:XO,useDeferredValue:function(t,e){var n=_s();return aF(n,sr.memoizedState,t,e)},useTransition:function(){var t=$2(bf)[0],e=_s().memoizedState;return[typeof t=="boolean"?t:R_(t),e]},useSyncExternalStore:Gk,useId:cF,useHostTransitionStatus:ZO,useFormState:nL,useActionState:nL,useOptimistic:function(t,e){var n=_s();return Yk(n,sr,t,e)},useMemoCache:jO,useCacheRefresh:fF},ZW={readContext:ba,use:LA,useCallback:rF,useContext:ba,useEffect:$k,useImperativeHandle:iF,useInsertionEffect:eF,useLayoutEffect:tF,useMemo:sF,useReducer:qM,useRef:Jk,useState:function(){return qM(bf)},useDebugValue:XO,useDeferredValue:function(t,e){var n=_s();return sr===null?YO(n,t,e):aF(n,sr.memoizedState,t,e)},useTransition:function(){var t=qM(bf)[0],e=_s().memoizedState;return[typeof t=="boolean"?t:R_(t),e]},useSyncExternalStore:Gk,useId:cF,useHostTransitionStatus:ZO,useFormState:iL,useActionState:iL,useOptimistic:function(t,e){var n=_s();return sr!==null?Yk(n,sr,t,e):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:jO,useCacheRefresh:fF},x0=null,w1=0;function xS(t){var e=w1;return w1+=1,x0===null&&(x0=[]),Pk(x0,t,e)}function Ny(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function _S(t,e){throw e.$$typeof===wj?Error(Dt(525)):(t=Object.prototype.toString.call(e),Error(Dt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function sL(t){var e=t._init;return e(t._payload)}function vF(t){function e(g,x){if(t){var S=g.deletions;S===null?(g.deletions=[x],g.flags|=16):S.push(x)}}function n(g,x){if(!t)return null;for(;x!==null;)e(g,x),x=x.sibling;return null}function i(g){for(var x=new Map;g!==null;)g.key!==null?x.set(g.key,g):x.set(g.index,g),g=g.sibling;return x}function r(g,x){return g=df(g,x),g.index=0,g.sibling=null,g}function s(g,x,S){return g.index=S,t?(S=g.alternate,S!==null?(S=S.index,S<x?(g.flags|=67108866,x):S):(g.flags|=67108866,x)):(g.flags|=1048576,x)}function a(g){return t&&g.alternate===null&&(g.flags|=67108866),g}function o(g,x,S,E){return x===null||x.tag!==6?(x=XM(S,g.mode,E),x.return=g,x):(x=r(x,S),x.return=g,x)}function l(g,x,S,E){var A=S.type;return A===Kg?c(g,x,S.props.children,E,S.key):x!==null&&(x.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Uh&&sL(A)===x.type)?(x=r(x,S.props),Ny(x,S),x.return=g,x):(x=Q2(S.type,S.key,S.props,null,g.mode,E),Ny(x,S),x.return=g,x)}function u(g,x,S,E){return x===null||x.tag!==4||x.stateNode.containerInfo!==S.containerInfo||x.stateNode.implementation!==S.implementation?(x=YM(S,g.mode,E),x.return=g,x):(x=r(x,S.children||[]),x.return=g,x)}function c(g,x,S,E,A){return x===null||x.tag!==7?(x=Op(S,g.mode,E,A),x.return=g,x):(x=r(x,S),x.return=g,x)}function h(g,x,S){if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return x=XM(""+x,g.mode,S),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case hS:return S=Q2(x.type,x.key,x.props,null,g.mode,S),Ny(S,x),S.return=g,S;case Tx:return x=YM(x,g.mode,S),x.return=g,x;case Uh:var E=x._init;return x=E(x._payload),h(g,x,S)}if(Mx(x)||zy(x))return x=Op(x,g.mode,S,null),x.return=g,x;if(typeof x.then=="function")return h(g,xS(x),S);if(x.$$typeof===af)return h(g,vS(g,x),S);_S(g,x)}return null}function d(g,x,S,E){var A=x!==null?x.key:null;if(typeof S=="string"&&S!==""||typeof S=="number"||typeof S=="bigint")return A!==null?null:o(g,x,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case hS:return S.key===A?l(g,x,S,E):null;case Tx:return S.key===A?u(g,x,S,E):null;case Uh:return A=S._init,S=A(S._payload),d(g,x,S,E)}if(Mx(S)||zy(S))return A!==null?null:c(g,x,S,E,null);if(typeof S.then=="function")return d(g,x,xS(S),E);if(S.$$typeof===af)return d(g,x,vS(g,S),E);_S(g,S)}return null}function m(g,x,S,E,A){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return g=g.get(S)||null,o(x,g,""+E,A);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case hS:return g=g.get(E.key===null?S:E.key)||null,l(x,g,E,A);case Tx:return g=g.get(E.key===null?S:E.key)||null,u(x,g,E,A);case Uh:var T=E._init;return E=T(E._payload),m(g,x,S,E,A)}if(Mx(E)||zy(E))return g=g.get(S)||null,c(x,g,E,A,null);if(typeof E.then=="function")return m(g,x,S,xS(E),A);if(E.$$typeof===af)return m(g,x,S,vS(x,E),A);_S(x,E)}return null}function v(g,x,S,E){for(var A=null,T=null,C=x,O=x=0,M=null;C!==null&&O<S.length;O++){C.index>O?(M=C,C=null):M=C.sibling;var D=d(g,C,S[O],E);if(D===null){C===null&&(C=M);break}t&&C&&D.alternate===null&&e(g,C),x=s(D,x,O),T===null?A=D:T.sibling=D,T=D,C=M}if(O===S.length)return n(g,C),Gi&&yp(g,O),A;if(C===null){for(;O<S.length;O++)C=h(g,S[O],E),C!==null&&(x=s(C,x,O),T===null?A=C:T.sibling=C,T=C);return Gi&&yp(g,O),A}for(C=i(C);O<S.length;O++)M=m(C,g,O,S[O],E),M!==null&&(t&&M.alternate!==null&&C.delete(M.key===null?O:M.key),x=s(M,x,O),T===null?A=M:T.sibling=M,T=M);return t&&C.forEach(function(P){return e(g,P)}),Gi&&yp(g,O),A}function _(g,x,S,E){if(S==null)throw Error(Dt(151));for(var A=null,T=null,C=x,O=x=0,M=null,D=S.next();C!==null&&!D.done;O++,D=S.next()){C.index>O?(M=C,C=null):M=C.sibling;var P=d(g,C,D.value,E);if(P===null){C===null&&(C=M);break}t&&C&&P.alternate===null&&e(g,C),x=s(P,x,O),T===null?A=P:T.sibling=P,T=P,C=M}if(D.done)return n(g,C),Gi&&yp(g,O),A;if(C===null){for(;!D.done;O++,D=S.next())D=h(g,D.value,E),D!==null&&(x=s(D,x,O),T===null?A=D:T.sibling=D,T=D);return Gi&&yp(g,O),A}for(C=i(C);!D.done;O++,D=S.next())D=m(C,g,O,D.value,E),D!==null&&(t&&D.alternate!==null&&C.delete(D.key===null?O:D.key),x=s(D,x,O),T===null?A=D:T.sibling=D,T=D);return t&&C.forEach(function(F){return e(g,F)}),Gi&&yp(g,O),A}function y(g,x,S,E){if(typeof S=="object"&&S!==null&&S.type===Kg&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case hS:e:{for(var A=S.key;x!==null;){if(x.key===A){if(A=S.type,A===Kg){if(x.tag===7){n(g,x.sibling),E=r(x,S.props.children),E.return=g,g=E;break e}}else if(x.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Uh&&sL(A)===x.type){n(g,x.sibling),E=r(x,S.props),Ny(E,S),E.return=g,g=E;break e}n(g,x);break}else e(g,x);x=x.sibling}S.type===Kg?(E=Op(S.props.children,g.mode,E,S.key),E.return=g,g=E):(E=Q2(S.type,S.key,S.props,null,g.mode,E),Ny(E,S),E.return=g,g=E)}return a(g);case Tx:e:{for(A=S.key;x!==null;){if(x.key===A)if(x.tag===4&&x.stateNode.containerInfo===S.containerInfo&&x.stateNode.implementation===S.implementation){n(g,x.sibling),E=r(x,S.children||[]),E.return=g,g=E;break e}else{n(g,x);break}else e(g,x);x=x.sibling}E=YM(S,g.mode,E),E.return=g,g=E}return a(g);case Uh:return A=S._init,S=A(S._payload),y(g,x,S,E)}if(Mx(S))return v(g,x,S,E);if(zy(S)){if(A=zy(S),typeof A!="function")throw Error(Dt(150));return S=A.call(S),_(g,x,S,E)}if(typeof S.then=="function")return y(g,x,xS(S),E);if(S.$$typeof===af)return y(g,x,vS(g,S),E);_S(g,S)}return typeof S=="string"&&S!==""||typeof S=="number"||typeof S=="bigint"?(S=""+S,x!==null&&x.tag===6?(n(g,x.sibling),E=r(x,S),E.return=g,g=E):(n(g,x),E=XM(S,g.mode,E),E.return=g,g=E),a(g)):n(g,x)}return function(g,x,S,E){try{w1=0;var A=y(g,x,S,E);return x0=null,A}catch(C){if(C===C_||C===IA)throw C;var T=Ao(29,C,null,g.mode);return T.lanes=E,T.return=g,T}finally{}}}var I0=vF(!0),yF=vF(!1),dl=oc(null),Qu=null;function Nh(t){var e=t.alternate;Cr(Os,Os.current&1),Cr(dl,t),Qu===null&&(e===null||U0.current!==null||e.memoizedState!==null)&&(Qu=t)}function xF(t){if(t.tag===22){if(Cr(Os,Os.current),Cr(dl,t),Qu===null){var e=t.alternate;e!==null&&e.memoizedState!==null&&(Qu=t)}}else Bh()}function Bh(){Cr(Os,Os.current),Cr(dl,dl.current)}function cf(t){Zs(dl),Qu===t&&(Qu=null),Zs(Os)}var Os=oc(0);function GE(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||BR(n)))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function KM(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:br({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var SR={enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Co(),r=qh(i);r.payload=e,n!=null&&(r.callback=n),e=Kh(t,r,i),e!==null&&(Ro(e,t,i),Wx(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Co(),r=qh(i);r.tag=1,r.payload=e,n!=null&&(r.callback=n),e=Kh(t,r,i),e!==null&&(Ro(e,t,i),Wx(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Co(),i=qh(n);i.tag=2,e!=null&&(i.callback=e),e=Kh(t,i,n),e!==null&&(Ro(e,t,n),Wx(e,t,n))}};function aL(t,e,n,i,r,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,a):e.prototype&&e.prototype.isPureReactComponent?!b1(n,i)||!b1(r,s):!0}function oL(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&SR.enqueueReplaceState(e,e.state,null)}function qp(t,e){var n=e;if("ref"in e){n={};for(var i in e)i!=="ref"&&(n[i]=e[i])}if(t=t.defaultProps){n===e&&(n=br({},n));for(var r in t)n[r]===void 0&&(n[r]=t[r])}return n}var VE=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)};function _F(t){VE(t)}function bF(t){console.error(t)}function SF(t){VE(t)}function HE(t,e){try{var n=t.onUncaughtError;n(e.value,{componentStack:e.stack})}catch(i){setTimeout(function(){throw i})}}function lL(t,e,n){try{var i=t.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function ER(t,e,n){return n=qh(n),n.tag=3,n.payload={element:null},n.callback=function(){HE(t,e)},n}function EF(t){return t=qh(t),t.tag=3,t}function wF(t,e,n,i){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=i.value;t.payload=function(){return r(s)},t.callback=function(){lL(e,n,i)}}var a=n.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){lL(e,n,i),typeof r!="function"&&(Qh===null?Qh=new Set([this]):Qh.add(this));var o=i.stack;this.componentDidCatch(i.value,{componentStack:o!==null?o:""})})}function qW(t,e,n,i,r){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(e=n.alternate,e!==null&&T_(e,n,r,!0),n=dl.current,n!==null){switch(n.tag){case 13:return Qu===null?OR():n.alternate===null&&$r===0&&($r=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===mR?n.flags|=16384:(e=n.updateQueue,e===null?n.updateQueue=new Set([i]):e.add(i),oC(t,i,r)),!1;case 22:return n.flags|=65536,i===mR?n.flags|=16384:(e=n.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=e):(n=e.retryQueue,n===null?e.retryQueue=new Set([i]):n.add(i)),oC(t,i,r)),!1}throw Error(Dt(435,n.tag))}return oC(t,i,r),OR(),!1}if(Gi)return e=dl.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=r,i!==cR&&(t=Error(Dt(422),{cause:i}),S1(al(t,n)))):(i!==cR&&(e=Error(Dt(423),{cause:i}),S1(al(e,n))),t=t.current.alternate,t.flags|=65536,r&=-r,t.lanes|=r,i=al(i,n),r=ER(t.stateNode,i,r),ZM(t,r),$r!==4&&($r=2)),!1;var s=Error(Dt(520),{cause:i});if(s=al(s,n),Qx===null?Qx=[s]:Qx.push(s),$r!==4&&($r=2),e===null)return!0;i=al(i,n),n=e;do{switch(n.tag){case 3:return n.flags|=65536,t=r&-r,n.lanes|=t,t=ER(n.stateNode,i,t),ZM(n,t),!1;case 1:if(e=n.type,s=n.stateNode,(n.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||s!==null&&typeof s.componentDidCatch=="function"&&(Qh===null||!Qh.has(s))))return n.flags|=65536,r&=-r,n.lanes|=r,r=EF(r),wF(r,t,n,i),ZM(n,r),!1}n=n.return}while(n!==null);return!1}var AF=Error(Dt(461)),Ys=!1;function $s(t,e,n,i){e.child=t===null?yF(e,null,n,i):I0(e,t.child,n,i)}function uL(t,e,n,i,r){n=n.render;var s=e.ref;if("ref"in i){var a={};for(var o in i)o!=="ref"&&(a[o]=i[o])}else a=i;return Yp(e),i=kO(t,e,n,a,s,r),o=FO(),t!==null&&!Ys?(GO(t,e,r),Sf(t,e,r)):(Gi&&o&&UO(e),e.flags|=1,$s(t,e,i,r),e.child)}function cL(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!OO(s)&&s.defaultProps===void 0&&n.compare===null?(e.tag=15,e.type=s,TF(t,e,s,i,r)):(t=Q2(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!KO(t,r)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:b1,n(a,i)&&t.ref===e.ref)return Sf(t,e,r)}return e.flags|=1,t=df(s,i),t.ref=e.ref,t.return=e,e.child=t}function TF(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(b1(s,i)&&t.ref===e.ref)if(Ys=!1,e.pendingProps=i=s,KO(t,r))t.flags&131072&&(Ys=!0);else return e.lanes=t.lanes,Sf(t,e,r)}return wR(t,e,n,i,r)}function MF(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden"){if(e.flags&128){if(i=s!==null?s.baseLanes|n:n,t!==null){for(r=e.child=t.child,s=0;r!==null;)s=s|r.lanes|r.childLanes,r=r.sibling;e.childLanes=s&~i}else e.childLanes=0,e.child=null;return fL(t,e,i,n)}if(n&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&J2(e,s!==null?s.cachePool:null),s!==null?JI(e,s):yR(),xF(e);else return e.lanes=e.childLanes=536870912,fL(t,e,s!==null?s.baseLanes|n:n,n)}else s!==null?(J2(e,s.cachePool),JI(e,s),Bh(),e.memoizedState=null):(t!==null&&J2(e,null),yR(),Bh());return $s(t,e,r,n),e.child}function fL(t,e,n,i){var r=LO();return r=r===null?null:{parent:Rs._currentValue,pool:r},e.memoizedState={baseLanes:n,cachePool:r},t!==null&&J2(e,null),yR(),xF(e),t!==null&&T_(t,e,i,!0),null}function tE(t,e){var n=e.ref;if(n===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(Dt(284));(t===null||t.ref!==n)&&(e.flags|=4194816)}}function wR(t,e,n,i,r){return Yp(e),n=kO(t,e,n,i,void 0,r),i=FO(),t!==null&&!Ys?(GO(t,e,r),Sf(t,e,r)):(Gi&&i&&UO(e),e.flags|=1,$s(t,e,n,r),e.child)}function hL(t,e,n,i,r,s){return Yp(e),e.updateQueue=null,n=Fk(e,i,n,r),kk(t),i=FO(),t!==null&&!Ys?(GO(t,e,s),Sf(t,e,s)):(Gi&&i&&UO(e),e.flags|=1,$s(t,e,n,s),e.child)}function dL(t,e,n,i,r){if(Yp(e),e.stateNode===null){var s=r0,a=n.contextType;typeof a=="object"&&a!==null&&(s=ba(a)),s=new n(i,s),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=SR,e.stateNode=s,s._reactInternals=e,s=e.stateNode,s.props=i,s.state=e.memoizedState,s.refs={},PO(e),a=n.contextType,s.context=typeof a=="object"&&a!==null?ba(a):r0,s.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(KM(e,n,a,i),s.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(a=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),a!==s.state&&SR.enqueueReplaceState(s,s.state,null),Yx(e,i,s,r),Xx(),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308),i=!0}else if(t===null){s=e.stateNode;var o=e.memoizedProps,l=qp(n,o);s.props=l;var u=s.context,c=n.contextType;a=r0,typeof c=="object"&&c!==null&&(a=ba(c));var h=n.getDerivedStateFromProps;c=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,c||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o||u!==a)&&oL(e,s,i,a),zh=!1;var d=e.memoizedState;s.state=d,Yx(e,i,s,r),Xx(),u=e.memoizedState,o||d!==u||zh?(typeof h=="function"&&(KM(e,n,h,i),u=e.memoizedState),(l=zh||aL(e,n,l,i,d,u,a))?(c||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=u),s.props=i,s.state=u,s.context=a,i=l):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{s=e.stateNode,gR(t,e),a=e.memoizedProps,c=qp(n,a),s.props=c,h=e.pendingProps,d=s.context,u=n.contextType,l=r0,typeof u=="object"&&u!==null&&(l=ba(u)),o=n.getDerivedStateFromProps,(u=typeof o=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==h||d!==l)&&oL(e,s,i,l),zh=!1,d=e.memoizedState,s.state=d,Yx(e,i,s,r),Xx();var m=e.memoizedState;a!==h||d!==m||zh||t!==null&&t.dependencies!==null&&PE(t.dependencies)?(typeof o=="function"&&(KM(e,n,o,i),m=e.memoizedState),(c=zh||aL(e,n,c,i,d,m,l)||t!==null&&t.dependencies!==null&&PE(t.dependencies))?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(i,m,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(i,m,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=m),s.props=i,s.state=m,s.context=l,i=c):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return s=i,tE(t,e),i=(e.flags&128)!==0,s||i?(s=e.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:s.render(),e.flags|=1,t!==null&&i?(e.child=I0(e,t.child,null,r),e.child=I0(e,null,n,r)):$s(t,e,n,r),e.memoizedState=s.state,t=e.child):t=Sf(t,e,r),t}function pL(t,e,n,i){return A_(),e.flags|=256,$s(t,e,n,i),e.child}var QM={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function JM(t){return{baseLanes:t,cachePool:Ik()}}function $M(t,e,n){return t=t!==null?t.childLanes&~n:0,e&&(t|=ll),t}function CF(t,e,n){var i=e.pendingProps,r=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(Os.current&2)!==0),a&&(r=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,t===null){if(Gi){if(r?Nh(e):Bh(),Gi){var o=Jr,l;if(l=o){e:{for(l=o,o=Wu;l.nodeType!==8;){if(!o){o=null;break e}if(l=ru(l.nextSibling),l===null){o=null;break e}}o=l}o!==null?(e.memoizedState={dehydrated:o,treeContext:Up!==null?{id:of,overflow:lf}:null,retryLane:536870912,hydrationErrors:null},l=Ao(18,null,null,0),l.stateNode=o,l.return=e,e.child=l,Oa=e,Jr=null,l=!0):l=!1}l||Xp(e)}if(o=e.memoizedState,o!==null&&(o=o.dehydrated,o!==null))return BR(o)?e.lanes=32:e.lanes=536870912,null;cf(e)}return o=i.children,i=i.fallback,r?(Bh(),r=e.mode,o=jE({mode:"hidden",children:o},r),i=Op(i,r,n,null),o.return=e,i.return=e,o.sibling=i,e.child=o,r=e.child,r.memoizedState=JM(n),r.childLanes=$M(t,a,n),e.memoizedState=QM,i):(Nh(e),AR(e,o))}if(l=t.memoizedState,l!==null&&(o=l.dehydrated,o!==null)){if(s)e.flags&256?(Nh(e),e.flags&=-257,e=eC(t,e,n)):e.memoizedState!==null?(Bh(),e.child=t.child,e.flags|=128,e=null):(Bh(),r=i.fallback,o=e.mode,i=jE({mode:"visible",children:i.children},o),r=Op(r,o,n,null),r.flags|=2,i.return=e,r.return=e,i.sibling=r,e.child=i,I0(e,t.child,null,n),i=e.child,i.memoizedState=JM(n),i.childLanes=$M(t,a,n),e.memoizedState=QM,e=r);else if(Nh(e),BR(o)){if(a=o.nextSibling&&o.nextSibling.dataset,a)var u=a.dgst;a=u,i=Error(Dt(419)),i.stack="",i.digest=a,S1({value:i,source:null,stack:null}),e=eC(t,e,n)}else if(Ys||T_(t,e,n,!1),a=(n&t.childLanes)!==0,Ys||a){if(a=yr,a!==null&&(i=n&-n,i=i&42?1:_O(i),i=i&(a.suspendedLanes|n)?0:i,i!==0&&i!==l.retryLane))throw l.retryLane=i,ov(t,i),Ro(a,t,i),AF;o.data==="$?"||OR(),e=eC(t,e,n)}else o.data==="$?"?(e.flags|=192,e.child=t.child,e=null):(t=l.treeContext,Jr=ru(o.nextSibling),Oa=e,Gi=!0,zp=null,Wu=!1,t!==null&&(tl[nl++]=of,tl[nl++]=lf,tl[nl++]=Up,of=t.id,lf=t.overflow,Up=e),e=AR(e,i.children),e.flags|=4096);return e}return r?(Bh(),r=i.fallback,o=e.mode,l=t.child,u=l.sibling,i=df(l,{mode:"hidden",children:i.children}),i.subtreeFlags=l.subtreeFlags&65011712,u!==null?r=df(u,r):(r=Op(r,o,n,null),r.flags|=2),r.return=e,i.return=e,i.sibling=r,e.child=i,i=r,r=e.child,o=t.child.memoizedState,o===null?o=JM(n):(l=o.cachePool,l!==null?(u=Rs._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Ik(),o={baseLanes:o.baseLanes|n,cachePool:l}),r.memoizedState=o,r.childLanes=$M(t,a,n),e.memoizedState=QM,i):(Nh(e),n=t.child,t=n.sibling,n=df(n,{mode:"visible",children:i.children}),n.return=e,n.sibling=null,t!==null&&(a=e.deletions,a===null?(e.deletions=[t],e.flags|=16):a.push(t)),e.child=n,e.memoizedState=null,n)}function AR(t,e){return e=jE({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function jE(t,e){return t=Ao(22,t,null,e),t.lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function eC(t,e,n){return I0(e,t.child,null,n),t=AR(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function mL(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),hR(t.return,e,n)}function tC(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function RF(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if($s(t,e,i.children,n),i=Os.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&mL(t,n,e);else if(t.tag===19)mL(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}switch(Cr(Os,i),r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&GE(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),tC(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&GE(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}tC(e,!0,n,null,s);break;case"together":tC(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sf(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),sd|=e.lanes,!(n&e.childLanes))if(t!==null){if(T_(t,e,n,!1),(n&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(Dt(153));if(e.child!==null){for(t=e.child,n=df(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=df(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function KO(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&PE(t)))}function KW(t,e,n){switch(e.tag){case 3:CE(e,e.stateNode.containerInfo),Ph(e,Rs,t.memoizedState.cache),A_();break;case 27:case 5:eR(e);break;case 4:CE(e,e.stateNode.containerInfo);break;case 10:Ph(e,e.type,e.memoizedProps.value);break;case 13:var i=e.memoizedState;if(i!==null)return i.dehydrated!==null?(Nh(e),e.flags|=128,null):n&e.child.childLanes?CF(t,e,n):(Nh(e),t=Sf(t,e,n),t!==null?t.sibling:null);Nh(e);break;case 19:var r=(t.flags&128)!==0;if(i=(n&e.childLanes)!==0,i||(T_(t,e,n,!1),i=(n&e.childLanes)!==0),r){if(i)return RF(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Cr(Os,Os.current),i)break;return null;case 22:case 23:return e.lanes=0,MF(t,e,n);case 24:Ph(e,Rs,t.memoizedState.cache)}return Sf(t,e,n)}function DF(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps)Ys=!0;else{if(!KO(t,n)&&!(e.flags&128))return Ys=!1,KW(t,e,n);Ys=!!(t.flags&131072)}else Ys=!1,Gi&&e.flags&1048576&&Uk(e,LE,e.index);switch(e.lanes=0,e.tag){case 16:e:{t=e.pendingProps;var i=e.elementType,r=i._init;if(i=r(i._payload),e.type=i,typeof i=="function")OO(i)?(t=qp(i,t),e.tag=1,e=dL(null,e,i,t,n)):(e.tag=0,e=wR(null,e,i,t,n));else{if(i!=null){if(r=i.$$typeof,r===vO){e.tag=11,e=uL(null,e,i,t,n);break e}else if(r===yO){e.tag=14,e=cL(null,e,i,t,n);break e}}throw e=J3(i)||i,Error(Dt(306,e,""))}}return e;case 0:return wR(t,e,e.type,e.pendingProps,n);case 1:return i=e.type,r=qp(i,e.pendingProps),dL(t,e,i,r,n);case 3:e:{if(CE(e,e.stateNode.containerInfo),t===null)throw Error(Dt(387));i=e.pendingProps;var s=e.memoizedState;r=s.element,gR(t,e),Yx(e,i,null,n);var a=e.memoizedState;if(i=a.cache,Ph(e,Rs,i),i!==s.cache&&dR(e,[Rs],n,!0),Xx(),i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){e=pL(t,e,i,n);break e}else if(i!==r){r=al(Error(Dt(424)),e),S1(r),e=pL(t,e,i,n);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Jr=ru(t.firstChild),Oa=e,Gi=!0,zp=null,Wu=!0,n=yF(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(A_(),i===r){e=Sf(t,e,n);break e}$s(t,e,i,n)}e=e.child}return e;case 26:return tE(t,e),t===null?(n=UL(e.type,null,e.pendingProps,null))?e.memoizedState=n:Gi||(n=e.type,t=e.pendingProps,i=QE(Zh.current).createElement(n),i[_a]=e,i[ao]=t,na(i,n,t),Xs(i),e.stateNode=i):e.memoizedState=UL(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return eR(e),t===null&&Gi&&(i=e.stateNode=g6(e.type,e.pendingProps,Zh.current),Oa=e,Wu=!0,r=Jr,fd(e.type)?(kR=r,Jr=ru(i.firstChild)):Jr=r),$s(t,e,e.pendingProps.children,n),tE(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&Gi&&((r=i=Jr)&&(i=wX(i,e.type,e.pendingProps,Wu),i!==null?(e.stateNode=i,Oa=e,Jr=ru(i.firstChild),Wu=!1,r=!0):r=!1),r||Xp(e)),eR(e),r=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,PR(r,s)?i=null:a!==null&&PR(r,a)&&(e.flags|=32),e.memoizedState!==null&&(r=kO(t,e,VW,null,null,n),C1._currentValue=r),tE(t,e),$s(t,e,i,n),e.child;case 6:return t===null&&Gi&&((t=n=Jr)&&(n=AX(n,e.pendingProps,Wu),n!==null?(e.stateNode=n,Oa=e,Jr=null,t=!0):t=!1),t||Xp(e)),null;case 13:return CF(t,e,n);case 4:return CE(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=I0(e,null,i,n):$s(t,e,i,n),e.child;case 11:return uL(t,e,e.type,e.pendingProps,n);case 7:return $s(t,e,e.pendingProps,n),e.child;case 8:return $s(t,e,e.pendingProps.children,n),e.child;case 12:return $s(t,e,e.pendingProps.children,n),e.child;case 10:return i=e.pendingProps,Ph(e,e.type,i.value),$s(t,e,i.children,n),e.child;case 9:return r=e.type._context,i=e.pendingProps.children,Yp(e),r=ba(r),i=i(r),e.flags|=1,$s(t,e,i,n),e.child;case 14:return cL(t,e,e.type,e.pendingProps,n);case 15:return TF(t,e,e.type,e.pendingProps,n);case 19:return RF(t,e,n);case 31:return i=e.pendingProps,n=e.mode,i={mode:i.mode,children:i.children},t===null?(n=jE(i,n),n.ref=e.ref,e.child=n,n.return=e,e=n):(n=df(t.child,i),n.ref=e.ref,e.child=n,n.return=e,e=n),e;case 22:return MF(t,e,n);case 24:return Yp(e),i=ba(Rs),t===null?(r=LO(),r===null&&(r=yr,s=IO(),r.pooledCache=s,s.refCount++,s!==null&&(r.pooledCacheLanes|=n),r=s),e.memoizedState={parent:i,cache:r},PO(e),Ph(e,Rs,r)):(t.lanes&n&&(gR(t,e),Yx(e,null,null,n),Xx()),r=t.memoizedState,s=e.memoizedState,r.parent!==i?(r={parent:i,cache:i},e.memoizedState=r,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=r),Ph(e,Rs,i)):(i=s.cache,Ph(e,Rs,i),i!==r.cache&&dR(e,[Rs],n,!0))),$s(t,e,e.pendingProps.children,n),e.child;case 29:throw e.pendingProps}throw Error(Dt(156,e.tag))}function Bc(t){t.flags|=4}function gL(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!x6(e)){if(e=dl.current,e!==null&&((wi&4194048)===wi?Qu!==null:(wi&62914560)!==wi&&!(wi&536870912)||e!==Qu))throw jx=mR,Lk;t.flags|=8192}}function bS(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?nk():536870912,t.lanes|=e,L0|=e)}function By(t,e){if(!Gi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function zr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&65011712,i|=r.flags&65011712,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function QW(t,e,n){var i=e.pendingProps;switch(zO(e),e.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zr(e),null;case 1:return zr(e),null;case 3:return n=e.stateNode,i=null,t!==null&&(i=t.memoizedState.cache),e.memoizedState.cache!==i&&(e.flags|=2048),pf(Rs),C0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Py(e)?Bc(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,XI())),zr(e),null;case 26:return n=e.memoizedState,t===null?(Bc(e),n!==null?(zr(e),gL(e,n)):(zr(e),e.flags&=-16777217)):n?n!==t.memoizedState?(Bc(e),zr(e),gL(e,n)):(zr(e),e.flags&=-16777217):(t.memoizedProps!==i&&Bc(e),zr(e),e.flags&=-16777217),null;case 27:RE(e),n=Zh.current;var r=e.type;if(t!==null&&e.stateNode!=null)t.memoizedProps!==i&&Bc(e);else{if(!i){if(e.stateNode===null)throw Error(Dt(166));return zr(e),null}t=qu.current,Py(e)?jI(e):(t=g6(r,i,n),e.stateNode=t,Bc(e))}return zr(e),null;case 5:if(RE(e),n=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==i&&Bc(e);else{if(!i){if(e.stateNode===null)throw Error(Dt(166));return zr(e),null}if(t=qu.current,Py(e))jI(e);else{switch(r=QE(Zh.current),t){case 1:t=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:t=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":t=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":t=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":t=r.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof i.is=="string"?r.createElement("select",{is:i.is}):r.createElement("select"),i.multiple?t.multiple=!0:i.size&&(t.size=i.size);break;default:t=typeof i.is=="string"?r.createElement(n,{is:i.is}):r.createElement(n)}}t[_a]=e,t[ao]=i;e:for(r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}e.stateNode=t;e:switch(na(t,n,i),n){case"button":case"input":case"select":case"textarea":t=!!i.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&Bc(e)}}return zr(e),e.flags&=-16777217,null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==i&&Bc(e);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Dt(166));if(t=Zh.current,Py(e)){if(t=e.stateNode,n=e.memoizedProps,i=null,r=Oa,r!==null)switch(r.tag){case 27:case 5:i=r.memoizedProps}t[_a]=e,t=!!(t.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||d6(t.nodeValue,n)),t||Xp(e)}else t=QE(t).createTextNode(i),t[_a]=e,e.stateNode=t}return zr(e),null;case 13:if(i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(r=Py(e),i!==null&&i.dehydrated!==null){if(t===null){if(!r)throw Error(Dt(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(Dt(317));r[_a]=e}else A_(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zr(e),r=!1}else r=XI(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=r),r=!0;if(!r)return e.flags&256?(cf(e),e):(cf(e),null)}if(cf(e),e.flags&128)return e.lanes=n,e;if(n=i!==null,t=t!==null&&t.memoizedState!==null,n){i=e.child,r=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(r=i.alternate.memoizedState.cachePool.pool);var s=null;i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==r&&(i.flags|=2048)}return n!==t&&n&&(e.child.flags|=8192),bS(e,e.updateQueue),zr(e),null;case 4:return C0(),t===null&&rU(e.stateNode.containerInfo),zr(e),null;case 10:return pf(e.type),zr(e),null;case 19:if(Zs(Os),r=e.memoizedState,r===null)return zr(e),null;if(i=(e.flags&128)!==0,s=r.rendering,s===null)if(i)By(r,!1);else{if($r!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=GE(t),s!==null){for(e.flags|=128,By(r,!1),t=s.updateQueue,e.updateQueue=t,bS(e,t),e.subtreeFlags=0,t=n,n=e.child;n!==null;)Ok(n,t),n=n.sibling;return Cr(Os,Os.current&1|2),e.child}t=t.sibling}r.tail!==null&&Ku()>XE&&(e.flags|=128,i=!0,By(r,!1),e.lanes=4194304)}else{if(!i)if(t=GE(s),t!==null){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,bS(e,t),By(r,!0),r.tail===null&&r.tailMode==="hidden"&&!s.alternate&&!Gi)return zr(e),null}else 2*Ku()-r.renderingStartTime>XE&&n!==536870912&&(e.flags|=128,i=!0,By(r,!1),e.lanes=4194304);r.isBackwards?(s.sibling=e.child,e.child=s):(t=r.last,t!==null?t.sibling=s:e.child=s,r.last=s)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Ku(),e.sibling=null,t=Os.current,Cr(Os,i?t&1|2:t&1),e):(zr(e),null);case 22:case 23:return cf(e),NO(),i=e.memoizedState!==null,t!==null?t.memoizedState!==null!==i&&(e.flags|=8192):i&&(e.flags|=8192),i?n&536870912&&!(e.flags&128)&&(zr(e),e.subtreeFlags&6&&(e.flags|=8192)):zr(e),n=e.updateQueue,n!==null&&bS(e,n.retryQueue),n=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),i=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),i!==n&&(e.flags|=2048),t!==null&&Zs(Ip),null;case 24:return n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),pf(Rs),zr(e),null;case 25:return null;case 30:return null}throw Error(Dt(156,e.tag))}function JW(t,e){switch(zO(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pf(Rs),C0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return RE(e),null;case 13:if(cf(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Dt(340));A_()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Zs(Os),null;case 4:return C0(),null;case 10:return pf(e.type),null;case 22:case 23:return cf(e),NO(),t!==null&&Zs(Ip),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return pf(Rs),null;case 25:return null;default:return null}}function OF(t,e){switch(zO(e),e.tag){case 3:pf(Rs),C0();break;case 26:case 27:case 5:RE(e);break;case 4:C0();break;case 13:cf(e);break;case 19:Zs(Os);break;case 10:pf(e.type);break;case 22:case 23:cf(e),NO(),t!==null&&Zs(Ip);break;case 24:pf(Rs)}}function O_(t,e){try{var n=e.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var r=i.next;n=r;do{if((n.tag&t)===t){i=void 0;var s=n.create,a=n.inst;i=s(),a.destroy=i}n=n.next}while(n!==r)}}catch(o){hr(e,e.return,o)}}function rd(t,e,n){try{var i=e.updateQueue,r=i!==null?i.lastEffect:null;if(r!==null){var s=r.next;i=s;do{if((i.tag&t)===t){var a=i.inst,o=a.destroy;if(o!==void 0){a.destroy=void 0,r=e;var l=n,u=o;try{u()}catch(c){hr(r,l,c)}}}i=i.next}while(i!==s)}}catch(c){hr(e,e.return,c)}}function UF(t){var e=t.updateQueue;if(e!==null){var n=t.stateNode;try{Bk(e,n)}catch(i){hr(t,t.return,i)}}}function zF(t,e,n){n.props=qp(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(i){hr(t,e,i)}}function qx(t,e){try{var n=t.ref;if(n!==null){switch(t.tag){case 26:case 27:case 5:var i=t.stateNode;break;case 30:i=t.stateNode;break;default:i=t.stateNode}typeof n=="function"?t.refCleanup=n(i):n.current=i}}catch(r){hr(t,e,r)}}function Xu(t,e){var n=t.ref,i=t.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(r){hr(t,e,r)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){hr(t,e,r)}else n.current=null}function IF(t){var e=t.type,n=t.memoizedProps,i=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(r){hr(t,t.return,r)}}function nC(t,e,n){try{var i=t.stateNode;xX(i,t.type,n,e),i[ao]=e}catch(r){hr(t,t.return,r)}}function LF(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&fd(t.type)||t.tag===4}function iC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||LF(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&fd(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function TR(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(t,e):(e=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,e.appendChild(t),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=GA));else if(i!==4&&(i===27&&fd(t.type)&&(n=t.stateNode,e=null),t=t.child,t!==null))for(TR(t,e,n),t=t.sibling;t!==null;)TR(t,e,n),t=t.sibling}function WE(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(i===27&&fd(t.type)&&(n=t.stateNode),t=t.child,t!==null))for(WE(t,e,n),t=t.sibling;t!==null;)WE(t,e,n),t=t.sibling}function PF(t){var e=t.stateNode,n=t.memoizedProps;try{for(var i=t.type,r=e.attributes;r.length;)e.removeAttributeNode(r[0]);na(e,i,n),e[_a]=t,e[ao]=n}catch(s){hr(t,t.return,s)}}var tf=!1,as=!1,rC=!1,vL=typeof WeakSet=="function"?WeakSet:Set,js=null;function $W(t,e){if(t=t.containerInfo,IR=tw,t=Ek(t),CO(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,l=-1,u=0,c=0,h=t,d=null;t:for(;;){for(var m;h!==n||r!==0&&h.nodeType!==3||(o=a+r),h!==s||i!==0&&h.nodeType!==3||(l=a+i),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===t)break t;if(d===n&&++u===r&&(o=a),d===s&&++c===i&&(l=a),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(LR={focusedElem:t,selectionRange:n},tw=!1,js=e;js!==null;)if(e=js,t=e.child,(e.subtreeFlags&1024)!==0&&t!==null)t.return=e,js=t;else for(;js!==null;){switch(e=js,s=e.alternate,t=e.flags,e.tag){case 0:break;case 11:case 15:break;case 1:if(t&1024&&s!==null){t=void 0,n=e,r=s.memoizedProps,s=s.memoizedState,i=n.stateNode;try{var v=qp(n.type,r,n.elementType===n.type);t=i.getSnapshotBeforeUpdate(v,s),i.__reactInternalSnapshotBeforeUpdate=t}catch(_){hr(n,n.return,_)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,n=t.nodeType,n===9)NR(t);else if(n===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":NR(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(Dt(163))}if(t=e.sibling,t!==null){t.return=e.return,js=t;break}js=e.return}}function NF(t,e,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:xh(t,n),i&4&&O_(5,n);break;case 1:if(xh(t,n),i&4)if(t=n.stateNode,e===null)try{t.componentDidMount()}catch(a){hr(n,n.return,a)}else{var r=qp(n.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(r,e,t.__reactInternalSnapshotBeforeUpdate)}catch(a){hr(n,n.return,a)}}i&64&&UF(n),i&512&&qx(n,n.return);break;case 3:if(xh(t,n),i&64&&(t=n.updateQueue,t!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{Bk(t,e)}catch(a){hr(n,n.return,a)}}break;case 27:e===null&&i&4&&PF(n);case 26:case 5:xh(t,n),e===null&&i&4&&IF(n),i&512&&qx(n,n.return);break;case 12:xh(t,n);break;case 13:xh(t,n),i&4&&FF(t,n),i&64&&(t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(n=lX.bind(null,n),TX(t,n))));break;case 22:if(i=n.memoizedState!==null||tf,!i){e=e!==null&&e.memoizedState!==null||as,r=tf;var s=as;tf=i,(as=e)&&!s?Dh(t,n,(n.subtreeFlags&8772)!==0):xh(t,n),tf=r,as=s}break;case 30:break;default:xh(t,n)}}function BF(t){var e=t.alternate;e!==null&&(t.alternate=null,BF(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&SO(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Tr=null,$a=!1;function kc(t,e,n){for(n=n.child;n!==null;)kF(t,e,n),n=n.sibling}function kF(t,e,n){if(To&&typeof To.onCommitFiberUnmount=="function")try{To.onCommitFiberUnmount(__,n)}catch{}switch(n.tag){case 26:as||Xu(n,e),kc(t,e,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:as||Xu(n,e);var i=Tr,r=$a;fd(n.type)&&(Tr=n.stateNode,$a=!1),kc(t,e,n),$x(n.stateNode),Tr=i,$a=r;break;case 5:as||Xu(n,e);case 6:if(i=Tr,r=$a,Tr=null,kc(t,e,n),Tr=i,$a=r,Tr!==null)if($a)try{(Tr.nodeType===9?Tr.body:Tr.nodeName==="HTML"?Tr.ownerDocument.body:Tr).removeChild(n.stateNode)}catch(s){hr(n,e,s)}else try{Tr.removeChild(n.stateNode)}catch(s){hr(n,e,s)}break;case 18:Tr!==null&&($a?(t=Tr,RL(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,n.stateNode),O1(t)):RL(Tr,n.stateNode));break;case 4:i=Tr,r=$a,Tr=n.stateNode.containerInfo,$a=!0,kc(t,e,n),Tr=i,$a=r;break;case 0:case 11:case 14:case 15:as||rd(2,n,e),as||rd(4,n,e),kc(t,e,n);break;case 1:as||(Xu(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"&&zF(n,e,i)),kc(t,e,n);break;case 21:kc(t,e,n);break;case 22:as=(i=as)||n.memoizedState!==null,kc(t,e,n),as=i;break;default:kc(t,e,n)}}function FF(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{O1(t)}catch(n){hr(e,e.return,n)}}function eX(t){switch(t.tag){case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new vL),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new vL),e;default:throw Error(Dt(435,t.tag))}}function sC(t,e){var n=eX(t);e.forEach(function(i){var r=uX.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}function xo(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i],s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 27:if(fd(o.type)){Tr=o.stateNode,$a=!1;break e}break;case 5:Tr=o.stateNode,$a=!1;break e;case 3:case 4:Tr=o.stateNode.containerInfo,$a=!0;break e}o=o.return}if(Tr===null)throw Error(Dt(160));kF(s,a,r),Tr=null,$a=!1,s=r.alternate,s!==null&&(s.return=null),r.return=null}if(e.subtreeFlags&13878)for(e=e.child;e!==null;)GF(e,t),e=e.sibling}var ql=null;function GF(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:xo(e,t),_o(t),i&4&&(rd(3,t,t.return),O_(3,t),rd(5,t,t.return));break;case 1:xo(e,t),_o(t),i&512&&(as||n===null||Xu(n,n.return)),i&64&&tf&&(t=t.updateQueue,t!==null&&(i=t.callbacks,i!==null&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var r=ql;if(xo(e,t),_o(t),i&512&&(as||n===null||Xu(n,n.return)),i&4){var s=n!==null?n.memoizedState:null;if(i=t.memoizedState,n===null)if(i===null)if(t.stateNode===null){e:{i=t.type,n=t.memoizedProps,r=r.ownerDocument||r;t:switch(i){case"title":s=r.getElementsByTagName("title")[0],(!s||s[E_]||s[_a]||s.namespaceURI==="http://www.w3.org/2000/svg"||s.hasAttribute("itemprop"))&&(s=r.createElement(i),r.head.insertBefore(s,r.querySelector("head > title"))),na(s,i,n),s[_a]=t,Xs(s),i=s;break e;case"link":var a=IL("link","href",r).get(i+(n.href||""));if(a){for(var o=0;o<a.length;o++)if(s=a[o],s.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&s.getAttribute("rel")===(n.rel==null?null:n.rel)&&s.getAttribute("title")===(n.title==null?null:n.title)&&s.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){a.splice(o,1);break t}}s=r.createElement(i),na(s,i,n),r.head.appendChild(s);break;case"meta":if(a=IL("meta","content",r).get(i+(n.content||""))){for(o=0;o<a.length;o++)if(s=a[o],s.getAttribute("content")===(n.content==null?null:""+n.content)&&s.getAttribute("name")===(n.name==null?null:n.name)&&s.getAttribute("property")===(n.property==null?null:n.property)&&s.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&s.getAttribute("charset")===(n.charSet==null?null:n.charSet)){a.splice(o,1);break t}}s=r.createElement(i),na(s,i,n),r.head.appendChild(s);break;default:throw Error(Dt(468,i))}s[_a]=t,Xs(s),i=s}t.stateNode=i}else LL(r,t.type,t.stateNode);else t.stateNode=zL(r,i,t.memoizedProps);else s!==i?(s===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):s.count--,i===null?LL(r,t.type,t.stateNode):zL(r,i,t.memoizedProps)):i===null&&t.stateNode!==null&&nC(t,t.memoizedProps,n.memoizedProps)}break;case 27:xo(e,t),_o(t),i&512&&(as||n===null||Xu(n,n.return)),n!==null&&i&4&&nC(t,t.memoizedProps,n.memoizedProps);break;case 5:if(xo(e,t),_o(t),i&512&&(as||n===null||Xu(n,n.return)),t.flags&32){r=t.stateNode;try{D0(r,"")}catch(m){hr(t,t.return,m)}}i&4&&t.stateNode!=null&&(r=t.memoizedProps,nC(t,r,n!==null?n.memoizedProps:r)),i&1024&&(rC=!0);break;case 6:if(xo(e,t),_o(t),i&4){if(t.stateNode===null)throw Error(Dt(162));i=t.memoizedProps,n=t.stateNode;try{n.nodeValue=i}catch(m){hr(t,t.return,m)}}break;case 3:if(rE=null,r=ql,ql=JE(e.containerInfo),xo(e,t),ql=r,_o(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{O1(e.containerInfo)}catch(m){hr(t,t.return,m)}rC&&(rC=!1,VF(t));break;case 4:i=ql,ql=JE(t.stateNode.containerInfo),xo(e,t),_o(t),ql=i;break;case 12:xo(e,t),_o(t);break;case 13:xo(e,t),_o(t),t.child.flags&8192&&t.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(tU=Ku()),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,sC(t,i)));break;case 22:r=t.memoizedState!==null;var l=n!==null&&n.memoizedState!==null,u=tf,c=as;if(tf=u||r,as=c||l,xo(e,t),as=c,tf=u,_o(t),i&8192)e:for(e=t.stateNode,e._visibility=r?e._visibility&-2:e._visibility|1,r&&(n===null||l||tf||as||xp(t)),n=null,e=t;;){if(e.tag===5||e.tag===26){if(n===null){l=n=e;try{if(s=l.stateNode,r)a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{o=l.stateNode;var h=l.memoizedProps.style,d=h!=null&&h.hasOwnProperty("display")?h.display:null;o.style.display=d==null||typeof d=="boolean"?"":(""+d).trim()}}catch(m){hr(l,l.return,m)}}}else if(e.tag===6){if(n===null){l=e;try{l.stateNode.nodeValue=r?"":l.memoizedProps}catch(m){hr(l,l.return,m)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;n===e&&(n=null),e=e.return}n===e&&(n=null),e.sibling.return=e.return,e=e.sibling}i&4&&(i=t.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,sC(t,n))));break;case 19:xo(e,t),_o(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,sC(t,i)));break;case 30:break;case 21:break;default:xo(e,t),_o(t)}}function _o(t){var e=t.flags;if(e&2){try{for(var n,i=t.return;i!==null;){if(LF(i)){n=i;break}i=i.return}if(n==null)throw Error(Dt(160));switch(n.tag){case 27:var r=n.stateNode,s=iC(t);WE(t,s,r);break;case 5:var a=n.stateNode;n.flags&32&&(D0(a,""),n.flags&=-33);var o=iC(t);WE(t,o,a);break;case 3:case 4:var l=n.stateNode.containerInfo,u=iC(t);TR(t,u,l);break;default:throw Error(Dt(161))}}catch(c){hr(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function VF(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;VF(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function xh(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)NF(t,e.alternate,e),e=e.sibling}function xp(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:rd(4,e,e.return),xp(e);break;case 1:Xu(e,e.return);var n=e.stateNode;typeof n.componentWillUnmount=="function"&&zF(e,e.return,n),xp(e);break;case 27:$x(e.stateNode);case 26:case 5:Xu(e,e.return),xp(e);break;case 22:e.memoizedState===null&&xp(e);break;case 30:xp(e);break;default:xp(e)}t=t.sibling}}function Dh(t,e,n){for(n=n&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var i=e.alternate,r=t,s=e,a=s.flags;switch(s.tag){case 0:case 11:case 15:Dh(r,s,n),O_(4,s);break;case 1:if(Dh(r,s,n),i=s,r=i.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(u){hr(i,i.return,u)}if(i=s,r=i.updateQueue,r!==null){var o=i.stateNode;try{var l=r.shared.hiddenCallbacks;if(l!==null)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)Nk(l[r],o)}catch(u){hr(i,i.return,u)}}n&&a&64&&UF(s),qx(s,s.return);break;case 27:PF(s);case 26:case 5:Dh(r,s,n),n&&i===null&&a&4&&IF(s),qx(s,s.return);break;case 12:Dh(r,s,n);break;case 13:Dh(r,s,n),n&&a&4&&FF(r,s);break;case 22:s.memoizedState===null&&Dh(r,s,n),qx(s,s.return);break;case 30:break;default:Dh(r,s,n)}e=e.sibling}}function QO(t,e){var n=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==n&&(t!=null&&t.refCount++,n!=null&&M_(n))}function JO(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&M_(t))}function zu(t,e,n,i){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)HF(t,e,n,i),e=e.sibling}function HF(t,e,n,i){var r=e.flags;switch(e.tag){case 0:case 11:case 15:zu(t,e,n,i),r&2048&&O_(9,e);break;case 1:zu(t,e,n,i);break;case 3:zu(t,e,n,i),r&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&M_(t)));break;case 12:if(r&2048){zu(t,e,n,i),t=e.stateNode;try{var s=e.memoizedProps,a=s.id,o=s.onPostCommit;typeof o=="function"&&o(a,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(l){hr(e,e.return,l)}}else zu(t,e,n,i);break;case 13:zu(t,e,n,i);break;case 23:break;case 22:s=e.stateNode,a=e.alternate,e.memoizedState!==null?s._visibility&2?zu(t,e,n,i):Kx(t,e):s._visibility&2?zu(t,e,n,i):(s._visibility|=2,Zg(t,e,n,i,(e.subtreeFlags&10256)!==0)),r&2048&&QO(a,e);break;case 24:zu(t,e,n,i),r&2048&&JO(e.alternate,e);break;default:zu(t,e,n,i)}}function Zg(t,e,n,i,r){for(r=r&&(e.subtreeFlags&10256)!==0,e=e.child;e!==null;){var s=t,a=e,o=n,l=i,u=a.flags;switch(a.tag){case 0:case 11:case 15:Zg(s,a,o,l,r),O_(8,a);break;case 23:break;case 22:var c=a.stateNode;a.memoizedState!==null?c._visibility&2?Zg(s,a,o,l,r):Kx(s,a):(c._visibility|=2,Zg(s,a,o,l,r)),r&&u&2048&&QO(a.alternate,a);break;case 24:Zg(s,a,o,l,r),r&&u&2048&&JO(a.alternate,a);break;default:Zg(s,a,o,l,r)}e=e.sibling}}function Kx(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var n=t,i=e,r=i.flags;switch(i.tag){case 22:Kx(n,i),r&2048&&QO(i.alternate,i);break;case 24:Kx(n,i),r&2048&&JO(i.alternate,i);break;default:Kx(n,i)}e=e.sibling}}var Rx=8192;function hg(t){if(t.subtreeFlags&Rx)for(t=t.child;t!==null;)jF(t),t=t.sibling}function jF(t){switch(t.tag){case 26:hg(t),t.flags&Rx&&t.memoizedState!==null&&kX(ql,t.memoizedState,t.memoizedProps);break;case 5:hg(t);break;case 3:case 4:var e=ql;ql=JE(t.stateNode.containerInfo),hg(t),ql=e;break;case 22:t.memoizedState===null&&(e=t.alternate,e!==null&&e.memoizedState!==null?(e=Rx,Rx=16777216,hg(t),Rx=e):hg(t));break;default:hg(t)}}function WF(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function ky(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var i=e[n];js=i,YF(i,t)}WF(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)XF(t),t=t.sibling}function XF(t){switch(t.tag){case 0:case 11:case 15:ky(t),t.flags&2048&&rd(9,t,t.return);break;case 3:ky(t);break;case 12:ky(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,nE(t)):ky(t);break;default:ky(t)}}function nE(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var i=e[n];js=i,YF(i,t)}WF(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:rd(8,e,e.return),nE(e);break;case 22:n=e.stateNode,n._visibility&2&&(n._visibility&=-3,nE(e));break;default:nE(e)}t=t.sibling}}function YF(t,e){for(;js!==null;){var n=js;switch(n.tag){case 0:case 11:case 15:rd(8,n,e);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:M_(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,js=i;else e:for(n=t;js!==null;){i=js;var r=i.sibling,s=i.return;if(BF(i),i===n){js=null;break e}if(r!==null){r.return=s,js=r;break e}js=s}}}var tX={getCacheForType:function(t){var e=ba(Rs),n=e.data.get(t);return n===void 0&&(n=t(),e.data.set(t,n)),n}},nX=typeof WeakMap=="function"?WeakMap:Map,Ji=0,yr=null,yi=null,wi=0,Qi=0,Eo=null,Hh=!1,lv=!1,$O=!1,Ef=0,$r=0,sd=0,Lp=0,eU=0,ll=0,L0=0,Qx=null,eo=null,MR=!1,tU=0,XE=1/0,YE=null,Qh=null,ea=0,Jh=null,P0=null,_0=0,CR=0,RR=null,ZF=null,Jx=0,DR=null;function Co(){if(Ji&2&&wi!==0)return wi&-wi;if(Hn.T!==null){var t=O0;return t!==0?t:iU()}return sk()}function qF(){ll===0&&(ll=!(wi&536870912)||Gi?tk():536870912);var t=dl.current;return t!==null&&(t.flags|=32),ll}function Ro(t,e,n){(t===yr&&(Qi===2||Qi===9)||t.cancelPendingCommit!==null)&&(N0(t,0),jh(t,wi,ll,!1)),S_(t,n),(!(Ji&2)||t!==yr)&&(t===yr&&(!(Ji&2)&&(Lp|=n),$r===4&&jh(t,wi,ll,!1)),lc(t))}function KF(t,e,n){if(Ji&6)throw Error(Dt(327));var i=!n&&(e&124)===0&&(e&t.expiredLanes)===0||b_(t,e),r=i?sX(t,e):aC(t,e,!0),s=i;do{if(r===0){lv&&!i&&jh(t,e,0,!1);break}else{if(n=t.current.alternate,s&&!iX(n)){r=aC(t,e,!1),s=!1;continue}if(r===2){if(s=e,t.errorRecoveryDisabledLanes&s)var a=0;else a=t.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var o=t;r=Qx;var l=o.current.memoizedState.isDehydrated;if(l&&(N0(o,a).flags|=256),a=aC(o,a,!1),a!==2){if($O&&!l){o.errorRecoveryDisabledLanes|=s,Lp|=s,r=4;break e}s=eo,eo=r,s!==null&&(eo===null?eo=s:eo.push.apply(eo,s))}r=a}if(s=!1,r!==2)continue}}if(r===1){N0(t,0),jh(t,e,0,!0);break}e:{switch(i=t,s=r,s){case 0:case 1:throw Error(Dt(345));case 4:if((e&4194048)!==e)break;case 6:jh(i,e,ll,!Hh);break e;case 2:eo=null;break;case 3:case 5:break;default:throw Error(Dt(329))}if((e&62914560)===e&&(r=tU+300-Ku(),10<r)){if(jh(i,e,ll,!Hh),CA(i,0,!0)!==0)break e;i.timeoutHandle=m6(yL.bind(null,i,n,eo,YE,MR,e,ll,Lp,L0,Hh,s,2,-0,0),r);break e}yL(i,n,eo,YE,MR,e,ll,Lp,L0,Hh,s,0,-0,0)}}break}while(!0);lc(t)}function yL(t,e,n,i,r,s,a,o,l,u,c,h,d,m){if(t.timeoutHandle=-1,h=e.subtreeFlags,(h&8192||(h&16785408)===16785408)&&(M1={stylesheets:null,count:0,unsuspend:BX},jF(e),h=FX(),h!==null)){t.cancelPendingCommit=h(_L.bind(null,t,e,s,n,i,r,a,o,l,c,1,d,m)),jh(t,s,a,!u);return}_L(t,e,s,n,i,r,a,o,l)}function iX(t){for(var e=t;;){var n=e.tag;if((n===0||n===11||n===15)&&e.flags&16384&&(n=e.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Oo(s(),r))return!1}catch{return!1}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function jh(t,e,n,i){e&=~eU,e&=~Lp,t.suspendedLanes|=e,t.pingedLanes&=~e,i&&(t.warmLanes|=e),i=t.expirationTimes;for(var r=e;0<r;){var s=31-Mo(r),a=1<<s;i[s]=-1,r&=~a}n!==0&&ik(t,n,e)}function BA(){return Ji&6?!0:(U_(0),!1)}function nU(){if(yi!==null){if(Qi===0)var t=yi.return;else t=yi,uf=cm=null,VO(t),x0=null,w1=0,t=yi;for(;t!==null;)OF(t.alternate,t),t=t.return;yi=null}}function N0(t,e){var n=t.timeoutHandle;n!==-1&&(t.timeoutHandle=-1,bX(n)),n=t.cancelPendingCommit,n!==null&&(t.cancelPendingCommit=null,n()),nU(),yr=t,yi=n=df(t.current,null),wi=e,Qi=0,Eo=null,Hh=!1,lv=b_(t,e),$O=!1,L0=ll=eU=Lp=sd=$r=0,eo=Qx=null,MR=!1,e&8&&(e|=e&32);var i=t.entangledLanes;if(i!==0)for(t=t.entanglements,i&=e;0<i;){var r=31-Mo(i),s=1<<r;e|=t[r],i&=~s}return Ef=e,UA(),n}function QF(t,e){mi=null,Hn.H=FE,e===C_||e===IA?(e=KI(),Qi=3):e===Lk?(e=KI(),Qi=4):Qi=e===AF?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,Eo=e,yi===null&&($r=1,HE(t,al(e,t.current)))}function JF(){var t=Hn.H;return Hn.H=FE,t===null?FE:t}function $F(){var t=Hn.A;return Hn.A=tX,t}function OR(){$r=4,Hh||(wi&4194048)!==wi&&dl.current!==null||(lv=!0),!(sd&134217727)&&!(Lp&134217727)||yr===null||jh(yr,wi,ll,!1)}function aC(t,e,n){var i=Ji;Ji|=2;var r=JF(),s=$F();(yr!==t||wi!==e)&&(YE=null,N0(t,e)),e=!1;var a=$r;e:do try{if(Qi!==0&&yi!==null){var o=yi,l=Eo;switch(Qi){case 8:nU(),a=6;break e;case 3:case 2:case 9:case 6:dl.current===null&&(e=!0);var u=Qi;if(Qi=0,Eo=null,o0(t,o,l,u),n&&lv){a=0;break e}break;default:u=Qi,Qi=0,Eo=null,o0(t,o,l,u)}}rX(),a=$r;break}catch(c){QF(t,c)}while(!0);return e&&t.shellSuspendCounter++,uf=cm=null,Ji=i,Hn.H=r,Hn.A=s,yi===null&&(yr=null,wi=0,UA()),a}function rX(){for(;yi!==null;)e6(yi)}function sX(t,e){var n=Ji;Ji|=2;var i=JF(),r=$F();yr!==t||wi!==e?(YE=null,XE=Ku()+500,N0(t,e)):lv=b_(t,e);e:do try{if(Qi!==0&&yi!==null){e=yi;var s=Eo;t:switch(Qi){case 1:Qi=0,Eo=null,o0(t,e,s,1);break;case 2:case 9:if(qI(s)){Qi=0,Eo=null,xL(e);break}e=function(){Qi!==2&&Qi!==9||yr!==t||(Qi=7),lc(t)},s.then(e,e);break e;case 3:Qi=7;break e;case 4:Qi=5;break e;case 7:qI(s)?(Qi=0,Eo=null,xL(e)):(Qi=0,Eo=null,o0(t,e,s,7));break;case 5:var a=null;switch(yi.tag){case 26:a=yi.memoizedState;case 5:case 27:var o=yi;if(!a||x6(a)){Qi=0,Eo=null;var l=o.sibling;if(l!==null)yi=l;else{var u=o.return;u!==null?(yi=u,kA(u)):yi=null}break t}}Qi=0,Eo=null,o0(t,e,s,5);break;case 6:Qi=0,Eo=null,o0(t,e,s,6);break;case 8:nU(),$r=6;break e;default:throw Error(Dt(462))}}aX();break}catch(c){QF(t,c)}while(!0);return uf=cm=null,Hn.H=i,Hn.A=r,Ji=n,yi!==null?0:(yr=null,wi=0,UA(),$r)}function aX(){for(;yi!==null&&!Cj();)e6(yi)}function e6(t){var e=DF(t.alternate,t,Ef);t.memoizedProps=t.pendingProps,e===null?kA(t):yi=e}function xL(t){var e=t,n=e.alternate;switch(e.tag){case 15:case 0:e=hL(n,e,e.pendingProps,e.type,void 0,wi);break;case 11:e=hL(n,e,e.pendingProps,e.type.render,e.ref,wi);break;case 5:VO(e);default:OF(n,e),e=yi=Ok(e,Ef),e=DF(n,e,Ef)}t.memoizedProps=t.pendingProps,e===null?kA(t):yi=e}function o0(t,e,n,i){uf=cm=null,VO(e),x0=null,w1=0;var r=e.return;try{if(qW(t,r,e,n,wi)){$r=1,HE(t,al(n,t.current)),yi=null;return}}catch(s){if(r!==null)throw yi=r,s;$r=1,HE(t,al(n,t.current)),yi=null;return}e.flags&32768?(Gi||i===1?t=!0:lv||wi&536870912?t=!1:(Hh=t=!0,(i===2||i===9||i===3||i===6)&&(i=dl.current,i!==null&&i.tag===13&&(i.flags|=16384))),t6(e,t)):kA(e)}function kA(t){var e=t;do{if(e.flags&32768){t6(e,Hh);return}t=e.return;var n=QW(e.alternate,e,Ef);if(n!==null){yi=n;return}if(e=e.sibling,e!==null){yi=e;return}yi=e=t}while(e!==null);$r===0&&($r=5)}function t6(t,e){do{var n=JW(t.alternate,t);if(n!==null){n.flags&=32767,yi=n;return}if(n=t.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!e&&(t=t.sibling,t!==null)){yi=t;return}yi=t=n}while(t!==null);$r=6,yi=null}function _L(t,e,n,i,r,s,a,o,l){t.cancelPendingCommit=null;do FA();while(ea!==0);if(Ji&6)throw Error(Dt(327));if(e!==null){if(e===t.current)throw Error(Dt(177));if(s=e.lanes|e.childLanes,s|=RO,Bj(t,n,s,a,o,l),t===yr&&(yi=yr=null,wi=0),P0=e,Jh=t,_0=n,CR=s,RR=r,ZF=i,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,cX(DE,function(){return a6(),null})):(t.callbackNode=null,t.callbackPriority=0),i=(e.flags&13878)!==0,e.subtreeFlags&13878||i){i=Hn.T,Hn.T=null,r=Vi.p,Vi.p=2,a=Ji,Ji|=4;try{$W(t,e,n)}finally{Ji=a,Vi.p=r,Hn.T=i}}ea=1,n6(),i6(),r6()}}function n6(){if(ea===1){ea=0;var t=Jh,e=P0,n=(e.flags&13878)!==0;if(e.subtreeFlags&13878||n){n=Hn.T,Hn.T=null;var i=Vi.p;Vi.p=2;var r=Ji;Ji|=4;try{GF(e,t);var s=LR,a=Ek(t.containerInfo),o=s.focusedElem,l=s.selectionRange;if(a!==o&&o&&o.ownerDocument&&Sk(o.ownerDocument.documentElement,o)){if(l!==null&&CO(o)){var u=l.start,c=l.end;if(c===void 0&&(c=u),"selectionStart"in o)o.selectionStart=u,o.selectionEnd=Math.min(c,o.value.length);else{var h=o.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var m=d.getSelection(),v=o.textContent.length,_=Math.min(l.start,v),y=l.end===void 0?_:Math.min(l.end,v);!m.extend&&_>y&&(a=y,y=_,_=a);var g=GI(o,_),x=GI(o,y);if(g&&x&&(m.rangeCount!==1||m.anchorNode!==g.node||m.anchorOffset!==g.offset||m.focusNode!==x.node||m.focusOffset!==x.offset)){var S=h.createRange();S.setStart(g.node,g.offset),m.removeAllRanges(),_>y?(m.addRange(S),m.extend(x.node,x.offset)):(S.setEnd(x.node,x.offset),m.addRange(S))}}}}for(h=[],m=o;m=m.parentNode;)m.nodeType===1&&h.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<h.length;o++){var E=h[o];E.element.scrollLeft=E.left,E.element.scrollTop=E.top}}tw=!!IR,LR=IR=null}finally{Ji=r,Vi.p=i,Hn.T=n}}t.current=e,ea=2}}function i6(){if(ea===2){ea=0;var t=Jh,e=P0,n=(e.flags&8772)!==0;if(e.subtreeFlags&8772||n){n=Hn.T,Hn.T=null;var i=Vi.p;Vi.p=2;var r=Ji;Ji|=4;try{NF(t,e.alternate,e)}finally{Ji=r,Vi.p=i,Hn.T=n}}ea=3}}function r6(){if(ea===4||ea===3){ea=0,Rj();var t=Jh,e=P0,n=_0,i=ZF;e.subtreeFlags&10256||e.flags&10256?ea=5:(ea=0,P0=Jh=null,s6(t,t.pendingLanes));var r=t.pendingLanes;if(r===0&&(Qh=null),bO(n),e=e.stateNode,To&&typeof To.onCommitFiberRoot=="function")try{To.onCommitFiberRoot(__,e,void 0,(e.current.flags&128)===128)}catch{}if(i!==null){e=Hn.T,r=Vi.p,Vi.p=2,Hn.T=null;try{for(var s=t.onRecoverableError,a=0;a<i.length;a++){var o=i[a];s(o.value,{componentStack:o.stack})}}finally{Hn.T=e,Vi.p=r}}_0&3&&FA(),lc(t),r=t.pendingLanes,n&4194090&&r&42?t===DR?Jx++:(Jx=0,DR=t):Jx=0,U_(0)}}function s6(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,M_(e)))}function FA(t){return n6(),i6(),r6(),a6()}function a6(){if(ea!==5)return!1;var t=Jh,e=CR;CR=0;var n=bO(_0),i=Hn.T,r=Vi.p;try{Vi.p=32>n?32:n,Hn.T=null,n=RR,RR=null;var s=Jh,a=_0;if(ea=0,P0=Jh=null,_0=0,Ji&6)throw Error(Dt(331));var o=Ji;if(Ji|=4,XF(s.current),HF(s,s.current,a,n),Ji=o,U_(0,!1),To&&typeof To.onPostCommitFiberRoot=="function")try{To.onPostCommitFiberRoot(__,s)}catch{}return!0}finally{Vi.p=r,Hn.T=i,s6(t,e)}}function bL(t,e,n){e=al(n,e),e=ER(t.stateNode,e,2),t=Kh(t,e,2),t!==null&&(S_(t,2),lc(t))}function hr(t,e,n){if(t.tag===3)bL(t,t,n);else for(;e!==null;){if(e.tag===3){bL(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Qh===null||!Qh.has(i))){t=al(n,t),n=EF(2),i=Kh(e,n,2),i!==null&&(wF(n,i,e,t),S_(i,2),lc(i));break}}e=e.return}}function oC(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new nX;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||($O=!0,r.add(n),t=oX.bind(null,t,e,n),e.then(t,t))}function oX(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,yr===t&&(wi&n)===n&&($r===4||$r===3&&(wi&62914560)===wi&&300>Ku()-tU?!(Ji&2)&&N0(t,0):eU|=n,L0===wi&&(L0=0)),lc(t)}function o6(t,e){e===0&&(e=nk()),t=ov(t,e),t!==null&&(S_(t,e),lc(t))}function lX(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),o6(t,n)}function uX(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;case 22:i=t.stateNode._retryCache;break;default:throw Error(Dt(314))}i!==null&&i.delete(e),o6(t,n)}function cX(t,e){return xO(t,e)}var ZE=null,qg=null,UR=!1,qE=!1,lC=!1,Pp=0;function lc(t){t!==qg&&t.next===null&&(qg===null?ZE=qg=t:qg=qg.next=t),qE=!0,UR||(UR=!0,hX())}function U_(t,e){if(!lC&&qE){lC=!0;do for(var n=!1,i=ZE;i!==null;){if(t!==0){var r=i.pendingLanes;if(r===0)var s=0;else{var a=i.suspendedLanes,o=i.pingedLanes;s=(1<<31-Mo(42|t)+1)-1,s&=r&~(a&~o),s=s&201326741?s&201326741|1:s?s|2:0}s!==0&&(n=!0,SL(i,s))}else s=wi,s=CA(i,i===yr?s:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),!(s&3)||b_(i,s)||(n=!0,SL(i,s));i=i.next}while(n);lC=!1}}function fX(){l6()}function l6(){qE=UR=!1;var t=0;Pp!==0&&(_X()&&(t=Pp),Pp=0);for(var e=Ku(),n=null,i=ZE;i!==null;){var r=i.next,s=u6(i,e);s===0?(i.next=null,n===null?ZE=r:n.next=r,r===null&&(qg=n)):(n=i,(t!==0||s&3)&&(qE=!0)),i=r}U_(t)}function u6(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes&-62914561;0<s;){var a=31-Mo(s),o=1<<a,l=r[a];l===-1?(!(o&n)||o&i)&&(r[a]=Nj(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}if(e=yr,n=wi,n=CA(t,t===e?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i=t.callbackNode,n===0||t===e&&(Qi===2||Qi===9)||t.cancelPendingCommit!==null)return i!==null&&i!==null&&IM(i),t.callbackNode=null,t.callbackPriority=0;if(!(n&3)||b_(t,n)){if(e=n&-n,e===t.callbackPriority)return e;switch(i!==null&&IM(i),bO(n)){case 2:case 8:n=$B;break;case 32:n=DE;break;case 268435456:n=ek;break;default:n=DE}return i=c6.bind(null,t),n=xO(n,i),t.callbackPriority=e,t.callbackNode=n,e}return i!==null&&i!==null&&IM(i),t.callbackPriority=2,t.callbackNode=null,2}function c6(t,e){if(ea!==0&&ea!==5)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if(FA()&&t.callbackNode!==n)return null;var i=wi;return i=CA(t,t===yr?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i===0?null:(KF(t,i,e),u6(t,Ku()),t.callbackNode!=null&&t.callbackNode===n?c6.bind(null,t):null)}function SL(t,e){if(FA())return null;KF(t,e,!0)}function hX(){SX(function(){Ji&6?xO(JB,fX):l6()})}function iU(){return Pp===0&&(Pp=tk()),Pp}function EL(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Z2(""+t)}function wL(t,e){var n=e.ownerDocument.createElement("input");return n.name=e.name,n.value=e.value,t.id&&n.setAttribute("form",t.id),e.parentNode.insertBefore(n,e),t=new FormData(t),n.parentNode.removeChild(n),t}function dX(t,e,n,i,r){if(e==="submit"&&n&&n.stateNode===r){var s=EL((r[ao]||null).action),a=i.submitter;a&&(e=(e=a[ao]||null)?EL(e.formAction):a.getAttribute("formAction"),e!==null&&(s=e,a=null));var o=new RA("action","action",null,i,r);t.push({event:o,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Pp!==0){var l=a?wL(r,a):new FormData(r);bR(n,{pending:!0,data:l,method:r.method,action:s},null,l)}}else typeof s=="function"&&(o.preventDefault(),l=a?wL(r,a):new FormData(r),bR(n,{pending:!0,data:l,method:r.method,action:s},s,l))},currentTarget:r}]})}}for(var uC=0;uC<uR.length;uC++){var cC=uR[uC],pX=cC.toLowerCase(),mX=cC[0].toUpperCase()+cC.slice(1);lu(pX,"on"+mX)}lu(Ak,"onAnimationEnd");lu(Tk,"onAnimationIteration");lu(Mk,"onAnimationStart");lu("dblclick","onDoubleClick");lu("focusin","onFocus");lu("focusout","onBlur");lu(UW,"onTransitionRun");lu(zW,"onTransitionStart");lu(IW,"onTransitionCancel");lu(Ck,"onTransitionEnd");R0("onMouseEnter",["mouseout","mouseover"]);R0("onMouseLeave",["mouseout","mouseover"]);R0("onPointerEnter",["pointerout","pointerover"]);R0("onPointerLeave",["pointerout","pointerover"]);om("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));om("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));om("onBeforeInput",["compositionend","keypress","textInput","paste"]);om("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));om("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));om("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var A1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gX=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(A1));function f6(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=u;try{s(r)}catch(c){VE(c)}r.currentTarget=null,s=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=u;try{s(r)}catch(c){VE(c)}r.currentTarget=null,s=l}}}}function vi(t,e){var n=e[nR];n===void 0&&(n=e[nR]=new Set);var i=t+"__bubble";n.has(i)||(h6(e,t,2,!1),n.add(i))}function fC(t,e,n){var i=0;e&&(i|=4),h6(n,t,i,e)}var SS="_reactListening"+Math.random().toString(36).slice(2);function rU(t){if(!t[SS]){t[SS]=!0,ak.forEach(function(n){n!=="selectionchange"&&(gX.has(n)||fC(n,!1,t),fC(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[SS]||(e[SS]=!0,fC("selectionchange",!1,e))}}function h6(t,e,n,i){switch(w6(e)){case 2:var r=HX;break;case 8:r=jX;break;default:r=lU}n=r.bind(null,e,n,t),r=void 0,!aR||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function hC(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===r)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&a.stateNode.containerInfo===r)return;a=a.return}for(;o!==null;){if(a=Jg(o),a===null)return;if(l=a.tag,l===5||l===6||l===26||l===27){i=s=a;continue e}o=o.parentNode}}i=i.return}pk(function(){var u=s,c=wO(n),h=[];e:{var d=Rk.get(t);if(d!==void 0){var m=RA,v=t;switch(t){case"keypress":if(K2(n)===0)break e;case"keydown":case"keyup":m=cW;break;case"focusin":v="focus",m=VM;break;case"focusout":v="blur",m=VM;break;case"beforeblur":case"afterblur":m=VM;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=OI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Jj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=dW;break;case Ak:case Tk:case Mk:m=tW;break;case Ck:m=mW;break;case"scroll":case"scrollend":m=Kj;break;case"wheel":m=vW;break;case"copy":case"cut":case"paste":m=iW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=zI;break;case"toggle":case"beforetoggle":m=xW}var _=(e&4)!==0,y=!_&&(t==="scroll"||t==="scrollend"),g=_?d!==null?d+"Capture":null:d;_=[];for(var x=u,S;x!==null;){var E=x;if(S=E.stateNode,E=E.tag,E!==5&&E!==26&&E!==27||S===null||g===null||(E=x1(x,g),E!=null&&_.push(T1(x,E,S))),y)break;x=x.return}0<_.length&&(d=new m(d,v,null,n,c),h.push({event:d,listeners:_}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&n!==sR&&(v=n.relatedTarget||n.fromElement)&&(Jg(v)||v[sv]))break e;if((m||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,m?(v=n.relatedTarget||n.toElement,m=u,v=v?Jg(v):null,v!==null&&(y=x_(v),_=v.tag,v!==y||_!==5&&_!==27&&_!==6)&&(v=null)):(m=null,v=u),m!==v)){if(_=OI,E="onMouseLeave",g="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(_=zI,E="onPointerLeave",g="onPointerEnter",x="pointer"),y=m==null?d:Cx(m),S=v==null?d:Cx(v),d=new _(E,x+"leave",m,n,c),d.target=y,d.relatedTarget=S,E=null,Jg(c)===u&&(_=new _(g,x+"enter",v,n,c),_.target=S,_.relatedTarget=y,E=_),y=E,m&&v)t:{for(_=m,g=v,x=0,S=_;S;S=dg(S))x++;for(S=0,E=g;E;E=dg(E))S++;for(;0<x-S;)_=dg(_),x--;for(;0<S-x;)g=dg(g),S--;for(;x--;){if(_===g||g!==null&&_===g.alternate)break t;_=dg(_),g=dg(g)}_=null}else _=null;m!==null&&AL(h,d,m,_,!1),v!==null&&y!==null&&AL(h,y,v,_,!0)}}e:{if(d=u?Cx(u):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var A=NI;else if(PI(d))if(_k)A=RW;else{A=MW;var T=TW}else m=d.nodeName,!m||m.toLowerCase()!=="input"||d.type!=="checkbox"&&d.type!=="radio"?u&&EO(u.elementType)&&(A=NI):A=CW;if(A&&(A=A(t,u))){xk(h,A,n,c);break e}T&&T(t,d,u),t==="focusout"&&u&&d.type==="number"&&u.memoizedProps.value!=null&&rR(d,"number",d.value)}switch(T=u?Cx(u):window,t){case"focusin":(PI(T)||T.contentEditable==="true")&&(t0=T,oR=u,Vx=null);break;case"focusout":Vx=oR=t0=null;break;case"mousedown":lR=!0;break;case"contextmenu":case"mouseup":case"dragend":lR=!1,VI(h,n,c);break;case"selectionchange":if(OW)break;case"keydown":case"keyup":VI(h,n,c)}var C;if(MO)e:{switch(t){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else e0?vk(t,n)&&(O="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(gk&&n.locale!=="ko"&&(e0||O!=="onCompositionStart"?O==="onCompositionEnd"&&e0&&(C=mk()):(Vh=c,AO="value"in Vh?Vh.value:Vh.textContent,e0=!0)),T=KE(u,O),0<T.length&&(O=new UI(O,t,null,n,c),h.push({event:O,listeners:T}),C?O.data=C:(C=yk(n),C!==null&&(O.data=C)))),(C=bW?SW(t,n):EW(t,n))&&(O=KE(u,"onBeforeInput"),0<O.length&&(T=new UI("onBeforeInput","beforeinput",null,n,c),h.push({event:T,listeners:O}),T.data=C)),dX(h,t,u,n,c)}f6(h,e)})}function T1(t,e,n){return{instance:t,listener:e,currentTarget:n}}function KE(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||s===null||(r=x1(t,n),r!=null&&i.unshift(T1(t,r,s)),r=x1(t,e),r!=null&&i.push(T1(t,r,s))),t.tag===3)return i;t=t.return}return[]}function dg(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function AL(t,e,n,i,r){for(var s=e._reactName,a=[];n!==null&&n!==i;){var o=n,l=o.alternate,u=o.stateNode;if(o=o.tag,l!==null&&l===i)break;o!==5&&o!==26&&o!==27||u===null||(l=u,r?(u=x1(n,s),u!=null&&a.unshift(T1(n,u,l))):r||(u=x1(n,s),u!=null&&a.push(T1(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var vX=/\r\n?/g,yX=/\u0000|\uFFFD/g;function TL(t){return(typeof t=="string"?t:""+t).replace(vX,`
`).replace(yX,"")}function d6(t,e){return e=TL(e),TL(t)===e}function GA(){}function rr(t,e,n,i,r,s){switch(n){case"children":typeof i=="string"?e==="body"||e==="textarea"&&i===""||D0(t,i):(typeof i=="number"||typeof i=="bigint")&&e!=="body"&&D0(t,""+i);break;case"className":mS(t,"class",i);break;case"tabIndex":mS(t,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":mS(t,n,i);break;case"style":dk(t,i,s);break;case"data":if(e!=="object"){mS(t,"data",i);break}case"src":case"href":if(i===""&&(e!=="a"||n!=="href")){t.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(n);break}i=Z2(""+i),t.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){t.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof s=="function"&&(n==="formAction"?(e!=="input"&&rr(t,e,"name",r.name,r,null),rr(t,e,"formEncType",r.formEncType,r,null),rr(t,e,"formMethod",r.formMethod,r,null),rr(t,e,"formTarget",r.formTarget,r,null)):(rr(t,e,"encType",r.encType,r,null),rr(t,e,"method",r.method,r,null),rr(t,e,"target",r.target,r,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(n);break}i=Z2(""+i),t.setAttribute(n,i);break;case"onClick":i!=null&&(t.onclick=GA);break;case"onScroll":i!=null&&vi("scroll",t);break;case"onScrollEnd":i!=null&&vi("scrollend",t);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(Dt(61));if(n=i.__html,n!=null){if(r.children!=null)throw Error(Dt(60));t.innerHTML=n}}break;case"multiple":t.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":t.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){t.removeAttribute("xlink:href");break}n=Z2(""+i),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,""+i):t.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,""):t.removeAttribute(n);break;case"capture":case"download":i===!0?t.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,i):t.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?t.setAttribute(n,i):t.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?t.removeAttribute(n):t.setAttribute(n,i);break;case"popover":vi("beforetoggle",t),vi("toggle",t),Y2(t,"popover",i);break;case"xlinkActuate":Nc(t,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":Nc(t,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":Nc(t,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":Nc(t,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":Nc(t,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":Nc(t,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":Nc(t,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":Nc(t,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":Nc(t,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Y2(t,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Zj.get(n)||n,Y2(t,n,i))}}function zR(t,e,n,i,r,s){switch(n){case"style":dk(t,i,s);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(Dt(61));if(n=i.__html,n!=null){if(r.children!=null)throw Error(Dt(60));t.innerHTML=n}}break;case"children":typeof i=="string"?D0(t,i):(typeof i=="number"||typeof i=="bigint")&&D0(t,""+i);break;case"onScroll":i!=null&&vi("scroll",t);break;case"onScrollEnd":i!=null&&vi("scrollend",t);break;case"onClick":i!=null&&(t.onclick=GA);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ok.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),e=n.slice(2,r?n.length-7:void 0),s=t[ao]||null,s=s!=null?s[n]:null,typeof s=="function"&&t.removeEventListener(e,s,r),typeof i=="function")){typeof s!="function"&&s!==null&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(e,i,r);break e}n in t?t[n]=i:i===!0?t.setAttribute(n,""):Y2(t,n,i)}}}function na(t,e,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":vi("error",t),vi("load",t);var i=!1,r=!1,s;for(s in n)if(n.hasOwnProperty(s)){var a=n[s];if(a!=null)switch(s){case"src":i=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Dt(137,e));default:rr(t,e,s,a,n,null)}}r&&rr(t,e,"srcSet",n.srcSet,n,null),i&&rr(t,e,"src",n.src,n,null);return;case"input":vi("invalid",t);var o=s=a=r=null,l=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var c=n[i];if(c!=null)switch(i){case"name":r=c;break;case"type":a=c;break;case"checked":l=c;break;case"defaultChecked":u=c;break;case"value":s=c;break;case"defaultValue":o=c;break;case"children":case"dangerouslySetInnerHTML":if(c!=null)throw Error(Dt(137,e));break;default:rr(t,e,i,c,n,null)}}ck(t,s,o,l,u,a,r,!1),OE(t);return;case"select":vi("invalid",t),i=a=s=null;for(r in n)if(n.hasOwnProperty(r)&&(o=n[r],o!=null))switch(r){case"value":s=o;break;case"defaultValue":a=o;break;case"multiple":i=o;default:rr(t,e,r,o,n,null)}e=s,n=a,t.multiple=!!i,e!=null?p0(t,!!i,e,!1):n!=null&&p0(t,!!i,n,!0);return;case"textarea":vi("invalid",t),s=r=i=null;for(a in n)if(n.hasOwnProperty(a)&&(o=n[a],o!=null))switch(a){case"value":i=o;break;case"defaultValue":r=o;break;case"children":s=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(Dt(91));break;default:rr(t,e,a,o,n,null)}hk(t,i,r,s),OE(t);return;case"option":for(l in n)if(n.hasOwnProperty(l)&&(i=n[l],i!=null))switch(l){case"selected":t.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:rr(t,e,l,i,n,null)}return;case"dialog":vi("beforetoggle",t),vi("toggle",t),vi("cancel",t),vi("close",t);break;case"iframe":case"object":vi("load",t);break;case"video":case"audio":for(i=0;i<A1.length;i++)vi(A1[i],t);break;case"image":vi("error",t),vi("load",t);break;case"details":vi("toggle",t);break;case"embed":case"source":case"link":vi("error",t),vi("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&(i=n[u],i!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(Dt(137,e));default:rr(t,e,u,i,n,null)}return;default:if(EO(e)){for(c in n)n.hasOwnProperty(c)&&(i=n[c],i!==void 0&&zR(t,e,c,i,n,void 0));return}}for(o in n)n.hasOwnProperty(o)&&(i=n[o],i!=null&&rr(t,e,o,i,n,null))}function xX(t,e,n,i){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,s=null,a=null,o=null,l=null,u=null,c=null;for(m in n){var h=n[m];if(n.hasOwnProperty(m)&&h!=null)switch(m){case"checked":break;case"value":break;case"defaultValue":l=h;default:i.hasOwnProperty(m)||rr(t,e,m,null,i,h)}}for(var d in i){var m=i[d];if(h=n[d],i.hasOwnProperty(d)&&(m!=null||h!=null))switch(d){case"type":s=m;break;case"name":r=m;break;case"checked":u=m;break;case"defaultChecked":c=m;break;case"value":a=m;break;case"defaultValue":o=m;break;case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(Dt(137,e));break;default:m!==h&&rr(t,e,d,m,i,h)}}iR(t,a,o,l,u,c,s,r);return;case"select":m=a=o=d=null;for(s in n)if(l=n[s],n.hasOwnProperty(s)&&l!=null)switch(s){case"value":break;case"multiple":m=l;default:i.hasOwnProperty(s)||rr(t,e,s,null,i,l)}for(r in i)if(s=i[r],l=n[r],i.hasOwnProperty(r)&&(s!=null||l!=null))switch(r){case"value":d=s;break;case"defaultValue":o=s;break;case"multiple":a=s;default:s!==l&&rr(t,e,r,s,i,l)}e=o,n=a,i=m,d!=null?p0(t,!!n,d,!1):!!i!=!!n&&(e!=null?p0(t,!!n,e,!0):p0(t,!!n,n?[]:"",!1));return;case"textarea":m=d=null;for(o in n)if(r=n[o],n.hasOwnProperty(o)&&r!=null&&!i.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:rr(t,e,o,null,i,r)}for(a in i)if(r=i[a],s=n[a],i.hasOwnProperty(a)&&(r!=null||s!=null))switch(a){case"value":d=r;break;case"defaultValue":m=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(Dt(91));break;default:r!==s&&rr(t,e,a,r,i,s)}fk(t,d,m);return;case"option":for(var v in n)if(d=n[v],n.hasOwnProperty(v)&&d!=null&&!i.hasOwnProperty(v))switch(v){case"selected":t.selected=!1;break;default:rr(t,e,v,null,i,d)}for(l in i)if(d=i[l],m=n[l],i.hasOwnProperty(l)&&d!==m&&(d!=null||m!=null))switch(l){case"selected":t.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:rr(t,e,l,d,i,m)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var _ in n)d=n[_],n.hasOwnProperty(_)&&d!=null&&!i.hasOwnProperty(_)&&rr(t,e,_,null,i,d);for(u in i)if(d=i[u],m=n[u],i.hasOwnProperty(u)&&d!==m&&(d!=null||m!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(Dt(137,e));break;default:rr(t,e,u,d,i,m)}return;default:if(EO(e)){for(var y in n)d=n[y],n.hasOwnProperty(y)&&d!==void 0&&!i.hasOwnProperty(y)&&zR(t,e,y,void 0,i,d);for(c in i)d=i[c],m=n[c],!i.hasOwnProperty(c)||d===m||d===void 0&&m===void 0||zR(t,e,c,d,i,m);return}}for(var g in n)d=n[g],n.hasOwnProperty(g)&&d!=null&&!i.hasOwnProperty(g)&&rr(t,e,g,null,i,d);for(h in i)d=i[h],m=n[h],!i.hasOwnProperty(h)||d===m||d==null&&m==null||rr(t,e,h,d,i,m)}var IR=null,LR=null;function QE(t){return t.nodeType===9?t:t.ownerDocument}function ML(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function p6(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function PR(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var dC=null;function _X(){var t=window.event;return t&&t.type==="popstate"?t===dC?!1:(dC=t,!0):(dC=null,!1)}var m6=typeof setTimeout=="function"?setTimeout:void 0,bX=typeof clearTimeout=="function"?clearTimeout:void 0,CL=typeof Promise=="function"?Promise:void 0,SX=typeof queueMicrotask=="function"?queueMicrotask:typeof CL<"u"?function(t){return CL.resolve(null).then(t).catch(EX)}:m6;function EX(t){setTimeout(function(){throw t})}function fd(t){return t==="head"}function RL(t,e){var n=e,i=0,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(0<i&&8>i){n=i;var a=t.ownerDocument;if(n&1&&$x(a.documentElement),n&2&&$x(a.body),n&4)for(n=a.head,$x(n),a=n.firstChild;a;){var o=a.nextSibling,l=a.nodeName;a[E_]||l==="SCRIPT"||l==="STYLE"||l==="LINK"&&a.rel.toLowerCase()==="stylesheet"||n.removeChild(a),a=o}}if(r===0){t.removeChild(s),O1(e);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:i=n.charCodeAt(0)-48;else i=0;n=s}while(n);O1(e)}function NR(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var n=e;switch(e=e.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":NR(n),SO(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}t.removeChild(n)}}function wX(t,e,n,i){for(;t.nodeType===1;){var r=n;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!i&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(i){if(!t[E_])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(s=t.getAttribute("rel"),s==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(s!==r.rel||t.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||t.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||t.getAttribute("title")!==(r.title==null?null:r.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(s=t.getAttribute("src"),(s!==(r.src==null?null:r.src)||t.getAttribute("type")!==(r.type==null?null:r.type)||t.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&s&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var s=r.name==null?null:""+r.name;if(r.type==="hidden"&&t.getAttribute("name")===s)return t}else return t;if(t=ru(t.nextSibling),t===null)break}return null}function AX(t,e,n){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=ru(t.nextSibling),t===null))return null;return t}function BR(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState==="complete"}function TX(t,e){var n=t.ownerDocument;if(t.data!=="$?"||n.readyState==="complete")e();else{var i=function(){e(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),t._reactRetry=i}}function ru(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="F!"||e==="F")break;if(e==="/$")return null}}return t}var kR=null;function DL(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}function g6(t,e,n){switch(e=QE(n),t){case"html":if(t=e.documentElement,!t)throw Error(Dt(452));return t;case"head":if(t=e.head,!t)throw Error(Dt(453));return t;case"body":if(t=e.body,!t)throw Error(Dt(454));return t;default:throw Error(Dt(451))}}function $x(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);SO(t)}var pl=new Map,OL=new Set;function JE(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Uf=Vi.d;Vi.d={f:MX,r:CX,D:RX,C:DX,L:OX,m:UX,X:IX,S:zX,M:LX};function MX(){var t=Uf.f(),e=BA();return t||e}function CX(t){var e=av(t);e!==null&&e.tag===5&&e.type==="form"?uF(e):Uf.r(t)}var uv=typeof document>"u"?null:document;function v6(t,e,n){var i=uv;if(i&&typeof e=="string"&&e){var r=sl(e);r='link[rel="'+t+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),OL.has(r)||(OL.add(r),t={rel:t,crossOrigin:n,href:e},i.querySelector(r)===null&&(e=i.createElement("link"),na(e,"link",t),Xs(e),i.head.appendChild(e)))}}function RX(t){Uf.D(t),v6("dns-prefetch",t,null)}function DX(t,e){Uf.C(t,e),v6("preconnect",t,e)}function OX(t,e,n){Uf.L(t,e,n);var i=uv;if(i&&t&&e){var r='link[rel="preload"][as="'+sl(e)+'"]';e==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+sl(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+sl(n.imageSizes)+'"]')):r+='[href="'+sl(t)+'"]';var s=r;switch(e){case"style":s=B0(t);break;case"script":s=cv(t)}pl.has(s)||(t=br({rel:"preload",href:e==="image"&&n&&n.imageSrcSet?void 0:t,as:e},n),pl.set(s,t),i.querySelector(r)!==null||e==="style"&&i.querySelector(z_(s))||e==="script"&&i.querySelector(I_(s))||(e=i.createElement("link"),na(e,"link",t),Xs(e),i.head.appendChild(e)))}}function UX(t,e){Uf.m(t,e);var n=uv;if(n&&t){var i=e&&typeof e.as=="string"?e.as:"script",r='link[rel="modulepreload"][as="'+sl(i)+'"][href="'+sl(t)+'"]',s=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=cv(t)}if(!pl.has(s)&&(t=br({rel:"modulepreload",href:t},e),pl.set(s,t),n.querySelector(r)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(I_(s)))return}i=n.createElement("link"),na(i,"link",t),Xs(i),n.head.appendChild(i)}}}function zX(t,e,n){Uf.S(t,e,n);var i=uv;if(i&&t){var r=d0(i).hoistableStyles,s=B0(t);e=e||"default";var a=r.get(s);if(!a){var o={loading:0,preload:null};if(a=i.querySelector(z_(s)))o.loading=5;else{t=br({rel:"stylesheet",href:t,"data-precedence":e},n),(n=pl.get(s))&&sU(t,n);var l=a=i.createElement("link");Xs(l),na(l,"link",t),l._p=new Promise(function(u,c){l.onload=u,l.onerror=c}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,iE(a,e,i)}a={type:"stylesheet",instance:a,count:1,state:o},r.set(s,a)}}}function IX(t,e){Uf.X(t,e);var n=uv;if(n&&t){var i=d0(n).hoistableScripts,r=cv(t),s=i.get(r);s||(s=n.querySelector(I_(r)),s||(t=br({src:t,async:!0},e),(e=pl.get(r))&&aU(t,e),s=n.createElement("script"),Xs(s),na(s,"link",t),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}function LX(t,e){Uf.M(t,e);var n=uv;if(n&&t){var i=d0(n).hoistableScripts,r=cv(t),s=i.get(r);s||(s=n.querySelector(I_(r)),s||(t=br({src:t,async:!0,type:"module"},e),(e=pl.get(r))&&aU(t,e),s=n.createElement("script"),Xs(s),na(s,"link",t),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}function UL(t,e,n,i){var r=(r=Zh.current)?JE(r):null;if(!r)throw Error(Dt(446));switch(t){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(e=B0(n.href),n=d0(r).hoistableStyles,i=n.get(e),i||(i={type:"style",instance:null,count:0,state:null},n.set(e,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){t=B0(n.href);var s=d0(r).hoistableStyles,a=s.get(t);if(a||(r=r.ownerDocument||r,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},s.set(t,a),(s=r.querySelector(z_(t)))&&!s._p&&(a.instance=s,a.state.loading=5),pl.has(t)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},pl.set(t,n),s||PX(r,t,n,a.state))),e&&i===null)throw Error(Dt(528,""));return a}if(e&&i!==null)throw Error(Dt(529,""));return null;case"script":return e=n.async,n=n.src,typeof n=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=cv(n),n=d0(r).hoistableScripts,i=n.get(e),i||(i={type:"script",instance:null,count:0,state:null},n.set(e,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(Dt(444,t))}}function B0(t){return'href="'+sl(t)+'"'}function z_(t){return'link[rel="stylesheet"]['+t+"]"}function y6(t){return br({},t,{"data-precedence":t.precedence,precedence:null})}function PX(t,e,n,i){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?i.loading=1:(e=t.createElement("link"),i.preload=e,e.addEventListener("load",function(){return i.loading|=1}),e.addEventListener("error",function(){return i.loading|=2}),na(e,"link",n),Xs(e),t.head.appendChild(e))}function cv(t){return'[src="'+sl(t)+'"]'}function I_(t){return"script[async]"+t}function zL(t,e,n){if(e.count++,e.instance===null)switch(e.type){case"style":var i=t.querySelector('style[data-href~="'+sl(n.href)+'"]');if(i)return e.instance=i,Xs(i),i;var r=br({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(t.ownerDocument||t).createElement("style"),Xs(i),na(i,"style",r),iE(i,n.precedence,t),e.instance=i;case"stylesheet":r=B0(n.href);var s=t.querySelector(z_(r));if(s)return e.state.loading|=4,e.instance=s,Xs(s),s;i=y6(n),(r=pl.get(r))&&sU(i,r),s=(t.ownerDocument||t).createElement("link"),Xs(s);var a=s;return a._p=new Promise(function(o,l){a.onload=o,a.onerror=l}),na(s,"link",i),e.state.loading|=4,iE(s,n.precedence,t),e.instance=s;case"script":return s=cv(n.src),(r=t.querySelector(I_(s)))?(e.instance=r,Xs(r),r):(i=n,(r=pl.get(s))&&(i=br({},n),aU(i,r)),t=t.ownerDocument||t,r=t.createElement("script"),Xs(r),na(r,"link",i),t.head.appendChild(r),e.instance=r);case"void":return null;default:throw Error(Dt(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(i=e.instance,e.state.loading|=4,iE(i,n.precedence,t));return e.instance}function iE(t,e,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,s=r,a=0;a<i.length;a++){var o=i[a];if(o.dataset.precedence===e)s=o;else if(s!==r)break}s?s.parentNode.insertBefore(t,s.nextSibling):(e=n.nodeType===9?n.head:n,e.insertBefore(t,e.firstChild))}function sU(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function aU(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var rE=null;function IL(t,e,n){if(rE===null){var i=new Map,r=rE=new Map;r.set(n,i)}else r=rE,i=r.get(n),i||(i=new Map,r.set(n,i));if(i.has(t))return i;for(i.set(t,null),n=n.getElementsByTagName(t),r=0;r<n.length;r++){var s=n[r];if(!(s[E_]||s[_a]||t==="link"&&s.getAttribute("rel")==="stylesheet")&&s.namespaceURI!=="http://www.w3.org/2000/svg"){var a=s.getAttribute(e)||"";a=t+a;var o=i.get(a);o?o.push(s):i.set(a,[s])}}return i}function LL(t,e,n){t=t.ownerDocument||t,t.head.insertBefore(n,e==="title"?t.querySelector("head > title"):null)}function NX(t,e,n){if(n===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function x6(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}var M1=null;function BX(){}function kX(t,e,n){if(M1===null)throw Error(Dt(475));var i=M1;if(e.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(e.state.loading&4)){if(e.instance===null){var r=B0(n.href),s=t.querySelector(z_(r));if(s){t=s._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(i.count++,i=$E.bind(i),t.then(i,i)),e.state.loading|=4,e.instance=s,Xs(s);return}s=t.ownerDocument||t,n=y6(n),(r=pl.get(r))&&sU(n,r),s=s.createElement("link"),Xs(s);var a=s;a._p=new Promise(function(o,l){a.onload=o,a.onerror=l}),na(s,"link",n),e.instance=s}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(e,t),(t=e.state.preload)&&!(e.state.loading&3)&&(i.count++,e=$E.bind(i),t.addEventListener("load",e),t.addEventListener("error",e))}}function FX(){if(M1===null)throw Error(Dt(475));var t=M1;return t.stylesheets&&t.count===0&&FR(t,t.stylesheets),0<t.count?function(e){var n=setTimeout(function(){if(t.stylesheets&&FR(t,t.stylesheets),t.unsuspend){var i=t.unsuspend;t.unsuspend=null,i()}},6e4);return t.unsuspend=e,function(){t.unsuspend=null,clearTimeout(n)}}:null}function $E(){if(this.count--,this.count===0){if(this.stylesheets)FR(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var ew=null;function FR(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,ew=new Map,e.forEach(GX,t),ew=null,$E.call(t))}function GX(t,e){if(!(e.state.loading&4)){var n=ew.get(t);if(n)var i=n.get(null);else{n=new Map,ew.set(t,n);for(var r=t.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<r.length;s++){var a=r[s];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(n.set(a.dataset.precedence,a),i=a)}i&&n.set(null,i)}r=e.instance,a=r.getAttribute("data-precedence"),s=n.get(a)||i,s===i&&n.set(null,r),n.set(a,r),this.count++,i=$E.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),s?s.parentNode.insertBefore(r,s.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(r,t.firstChild)),e.state.loading|=4}}var C1={$$typeof:af,Provider:null,Consumer:null,_currentValue:Dp,_currentValue2:Dp,_threadCount:0};function VX(t,e,n,i,r,s,a,o){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=LM(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=LM(0),this.hiddenUpdates=LM(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=s,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function _6(t,e,n,i,r,s,a,o,l,u,c,h){return t=new VX(t,e,n,a,o,l,u,h),e=1,s===!0&&(e|=24),s=Ao(3,null,null,e),t.current=s,s.stateNode=t,e=IO(),e.refCount++,t.pooledCache=e,e.refCount++,s.memoizedState={element:i,isDehydrated:n,cache:e},PO(s),t}function b6(t){return t?(t=r0,t):r0}function S6(t,e,n,i,r,s){r=b6(r),i.context===null?i.context=r:i.pendingContext=r,i=qh(e),i.payload={element:n},s=s===void 0?null:s,s!==null&&(i.callback=s),n=Kh(t,i,e),n!==null&&(Ro(n,t,e),Wx(n,t,e))}function PL(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function oU(t,e){PL(t,e),(t=t.alternate)&&PL(t,e)}function E6(t){if(t.tag===13){var e=ov(t,67108864);e!==null&&Ro(e,t,67108864),oU(t,67108864)}}var tw=!0;function HX(t,e,n,i){var r=Hn.T;Hn.T=null;var s=Vi.p;try{Vi.p=2,lU(t,e,n,i)}finally{Vi.p=s,Hn.T=r}}function jX(t,e,n,i){var r=Hn.T;Hn.T=null;var s=Vi.p;try{Vi.p=8,lU(t,e,n,i)}finally{Vi.p=s,Hn.T=r}}function lU(t,e,n,i){if(tw){var r=GR(i);if(r===null)hC(t,e,i,nw,n),NL(t,i);else if(XX(r,t,e,n,i))i.stopPropagation();else if(NL(t,i),e&4&&-1<WX.indexOf(t)){for(;r!==null;){var s=av(r);if(s!==null)switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var a=vp(s.pendingLanes);if(a!==0){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var l=1<<31-Mo(a);o.entanglements[1]|=l,a&=~l}lc(s),!(Ji&6)&&(XE=Ku()+500,U_(0))}}break;case 13:o=ov(s,2),o!==null&&Ro(o,s,2),BA(),oU(s,2)}if(s=GR(i),s===null&&hC(t,e,i,nw,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else hC(t,e,i,null,n)}}function GR(t){return t=wO(t),uU(t)}var nw=null;function uU(t){if(nw=null,t=Jg(t),t!==null){var e=x_(t);if(e===null)t=null;else{var n=e.tag;if(n===13){if(t=ZB(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return nw=t,null}function w6(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Dj()){case JB:return 2;case $B:return 8;case DE:case Oj:return 32;case ek:return 268435456;default:return 32}default:return 32}}var VR=!1,$h=null,ed=null,td=null,R1=new Map,D1=new Map,kh=[],WX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function NL(t,e){switch(t){case"focusin":case"focusout":$h=null;break;case"dragenter":case"dragleave":ed=null;break;case"mouseover":case"mouseout":td=null;break;case"pointerover":case"pointerout":R1.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":D1.delete(e.pointerId)}}function Fy(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=av(e),e!==null&&E6(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function XX(t,e,n,i,r){switch(e){case"focusin":return $h=Fy($h,t,e,n,i,r),!0;case"dragenter":return ed=Fy(ed,t,e,n,i,r),!0;case"mouseover":return td=Fy(td,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return R1.set(s,Fy(R1.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,D1.set(s,Fy(D1.get(s)||null,t,e,n,i,r)),!0}return!1}function A6(t){var e=Jg(t.target);if(e!==null){var n=x_(e);if(n!==null){if(e=n.tag,e===13){if(e=ZB(n),e!==null){t.blockedOn=e,kj(t.priority,function(){if(n.tag===13){var i=Co();i=_O(i);var r=ov(n,i);r!==null&&Ro(r,n,i),oU(n,i)}});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function sE(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=GR(t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);sR=i,n.target.dispatchEvent(i),sR=null}else return e=av(n),e!==null&&E6(e),t.blockedOn=n,!1;e.shift()}return!0}function BL(t,e,n){sE(t)&&n.delete(e)}function YX(){VR=!1,$h!==null&&sE($h)&&($h=null),ed!==null&&sE(ed)&&(ed=null),td!==null&&sE(td)&&(td=null),R1.forEach(BL),D1.forEach(BL)}function ES(t,e){t.blockedOn===e&&(t.blockedOn=null,VR||(VR=!0,zs.unstable_scheduleCallback(zs.unstable_NormalPriority,YX)))}var wS=null;function kL(t){wS!==t&&(wS=t,zs.unstable_scheduleCallback(zs.unstable_NormalPriority,function(){wS===t&&(wS=null);for(var e=0;e<t.length;e+=3){var n=t[e],i=t[e+1],r=t[e+2];if(typeof i!="function"){if(uU(i||n)===null)continue;break}var s=av(n);s!==null&&(t.splice(e,3),e-=3,bR(s,{pending:!0,data:r,method:n.method,action:i},i,r))}}))}function O1(t){function e(l){return ES(l,t)}$h!==null&&ES($h,t),ed!==null&&ES(ed,t),td!==null&&ES(td,t),R1.forEach(e),D1.forEach(e);for(var n=0;n<kh.length;n++){var i=kh[n];i.blockedOn===t&&(i.blockedOn=null)}for(;0<kh.length&&(n=kh[0],n.blockedOn===null);)A6(n),n.blockedOn===null&&kh.shift();if(n=(t.ownerDocument||t).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var r=n[i],s=n[i+1],a=r[ao]||null;if(typeof s=="function")a||kL(n);else if(a){var o=null;if(s&&s.hasAttribute("formAction")){if(r=s,a=s[ao]||null)o=a.formAction;else if(uU(r)!==null)continue}else o=a.action;typeof o=="function"?n[i+1]=o:(n.splice(i,3),i-=3),kL(n)}}}function cU(t){this._internalRoot=t}VA.prototype.render=cU.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Dt(409));var n=e.current,i=Co();S6(n,i,t,e,null,null)};VA.prototype.unmount=cU.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;S6(t.current,2,null,t,null,null),BA(),e[sv]=null}};function VA(t){this._internalRoot=t}VA.prototype.unstable_scheduleHydration=function(t){if(t){var e=sk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<kh.length&&e!==0&&e<kh[n].priority;n++);kh.splice(n,0,t),n===0&&A6(t)}};var FL=XB.version;if(FL!=="19.1.0")throw Error(Dt(527,FL,"19.1.0"));Vi.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Dt(188)):(t=Object.keys(t).join(","),Error(Dt(268,t)));return t=Ej(e),t=t!==null?qB(t):null,t=t===null?null:t.stateNode,t};var ZX={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Hn,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var AS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!AS.isDisabled&&AS.supportsFiber)try{__=AS.inject(ZX),To=AS}catch{}}TA.createRoot=function(t,e){if(!YB(t))throw Error(Dt(299));var n=!1,i="",r=_F,s=bF,a=SF,o=null;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onUncaughtError!==void 0&&(r=e.onUncaughtError),e.onCaughtError!==void 0&&(s=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError),e.unstable_transitionCallbacks!==void 0&&(o=e.unstable_transitionCallbacks)),e=_6(t,1,!1,null,null,n,i,r,s,a,o,null),t[sv]=e.current,rU(t),new cU(e)};TA.hydrateRoot=function(t,e,n){if(!YB(t))throw Error(Dt(299));var i=!1,r="",s=_F,a=bF,o=SF,l=null,u=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(s=n.onUncaughtError),n.onCaughtError!==void 0&&(a=n.onCaughtError),n.onRecoverableError!==void 0&&(o=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(l=n.unstable_transitionCallbacks),n.formState!==void 0&&(u=n.formState)),e=_6(t,1,!0,e,n??null,i,r,s,a,o,l,u),e.context=b6(null),n=e.current,i=Co(),i=_O(i),r=qh(i),r.callback=null,Kh(n,r,i),n=i,e.current.lanes=n,S_(e,n),lc(e),t[sv]=e.current,rU(t),new VA(e)};TA.version="19.1.0";function T6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(T6)}catch(t){console.error(t)}}T6(),FB.exports=TA;var M6=FB.exports;const qX=Lo(M6);var fU={};Object.defineProperty(fU,"__esModule",{value:!0});fU.parse=nY;fU.serialize=iY;const KX=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,QX=/^[\u0021-\u003A\u003C-\u007E]*$/,JX=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,$X=/^[\u0020-\u003A\u003D-\u007E]*$/,eY=Object.prototype.toString,tY=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function nY(t,e){const n=new tY,i=t.length;if(i<2)return n;const r=(e==null?void 0:e.decode)||rY;let s=0;do{const a=t.indexOf("=",s);if(a===-1)break;const o=t.indexOf(";",s),l=o===-1?i:o;if(a>l){s=t.lastIndexOf(";",a-1)+1;continue}const u=GL(t,s,a),c=VL(t,a,u),h=t.slice(u,c);if(n[h]===void 0){let d=GL(t,a+1,l),m=VL(t,l,d);const v=r(t.slice(d,m));n[h]=v}s=l+1}while(s<i);return n}function GL(t,e,n){do{const i=t.charCodeAt(e);if(i!==32&&i!==9)return e}while(++e<n);return n}function VL(t,e,n){for(;e>n;){const i=t.charCodeAt(--e);if(i!==32&&i!==9)return e+1}return n}function iY(t,e,n){const i=(n==null?void 0:n.encode)||encodeURIComponent;if(!KX.test(t))throw new TypeError(`argument name is invalid: ${t}`);const r=i(e);if(!QX.test(r))throw new TypeError(`argument val is invalid: ${e}`);let s=t+"="+r;if(!n)return s;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);s+="; Max-Age="+n.maxAge}if(n.domain){if(!JX.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);s+="; Domain="+n.domain}if(n.path){if(!$X.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);s+="; Path="+n.path}if(n.expires){if(!sY(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);s+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(s+="; HttpOnly"),n.secure&&(s+="; Secure"),n.partitioned&&(s+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"none":s+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return s}function rY(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function sY(t){return eY.call(t)==="[object Date]"}var HL="popstate";function aY(t={}){function e(i,r){let{pathname:s,search:a,hash:o}=i.location;return HR("",{pathname:s,search:a,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:U1(r)}return lY(e,n,null,t)}function Fr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function rc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function oY(){return Math.random().toString(36).substring(2,10)}function jL(t,e){return{usr:t.state,key:t.key,idx:e}}function HR(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?fv(e):e,state:n,key:e&&e.key||i||oY()}}function U1({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function fv(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function lY(t,e,n,i={}){let{window:r=document.defaultView,v5Compat:s=!1}=i,a=r.history,o="POP",l=null,u=c();u==null&&(u=0,a.replaceState({...a.state,idx:u},""));function c(){return(a.state||{idx:null}).idx}function h(){o="POP";let y=c(),g=y==null?null:y-u;u=y,l&&l({action:o,location:_.location,delta:g})}function d(y,g){o="PUSH";let x=HR(_.location,y,g);u=c()+1;let S=jL(x,u),E=_.createHref(x);try{a.pushState(S,"",E)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;r.location.assign(E)}s&&l&&l({action:o,location:_.location,delta:1})}function m(y,g){o="REPLACE";let x=HR(_.location,y,g);u=c();let S=jL(x,u),E=_.createHref(x);a.replaceState(S,"",E),s&&l&&l({action:o,location:_.location,delta:0})}function v(y){return uY(y)}let _={get action(){return o},get location(){return t(r,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(HL,h),l=y,()=>{r.removeEventListener(HL,h),l=null}},createHref(y){return e(r,y)},createURL:v,encodeLocation(y){let g=v(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:d,replace:m,go(y){return a.go(y)}};return _}function uY(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Fr(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:U1(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function C6(t,e,n="/"){return cY(t,e,n,!1)}function cY(t,e,n,i){let r=typeof e=="string"?fv(e):e,s=wf(r.pathname||"/",n);if(s==null)return null;let a=R6(t);fY(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=SY(s);o=_Y(a[l],u,i)}return o}function R6(t,e=[],n=[],i=""){let r=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Fr(l.relativePath.startsWith(i),`Absolute route path "${l.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(i.length));let u=mf([i,l.relativePath]),c=n.concat(l);s.children&&s.children.length>0&&(Fr(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),R6(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:yY(u,s.index),routesMeta:c})};return t.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))r(s,a);else for(let l of D6(s.path))r(s,a,l)}),e}function D6(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let a=D6(i.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),r&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function fY(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:xY(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var hY=/^:[\w-]+$/,dY=3,pY=2,mY=1,gY=10,vY=-2,WL=t=>t==="*";function yY(t,e){let n=t.split("/"),i=n.length;return n.some(WL)&&(i+=vY),e&&(i+=pY),n.filter(r=>!WL(r)).reduce((r,s)=>r+(hY.test(s)?dY:s===""?mY:gY),i)}function xY(t,e){return t.length===e.length&&t.slice(0,-1).every((i,r)=>i===e[r])?t[t.length-1]-e[e.length-1]:0}function _Y(t,e,n=!1){let{routesMeta:i}=t,r={},s="/",a=[];for(let o=0;o<i.length;++o){let l=i[o],u=o===i.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=iw({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h&&u&&n&&!i[i.length-1].route.index&&(h=iw({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!h)return null;Object.assign(r,h.params),a.push({params:r,pathname:mf([s,h.pathname]),pathnameBase:TY(mf([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=mf([s,h.pathnameBase]))}return a}function iw(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=bY(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:i.reduce((u,{paramName:c,isOptional:h},d)=>{if(c==="*"){let v=o[d]||"";a=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const m=o[d];return h&&!m?u[c]=void 0:u[c]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:t}}function bY(t,e=!1,n=!0){rc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(i.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(i.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function SY(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return rc(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function wf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}function EY(t,e="/"){let{pathname:n,search:i="",hash:r=""}=typeof t=="string"?fv(t):t;return{pathname:n?n.startsWith("/")?n:wY(n,e):e,search:MY(i),hash:CY(r)}}function wY(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function pC(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function AY(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function O6(t){let e=AY(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function U6(t,e,n,i=!1){let r;typeof t=="string"?r=fv(t):(r={...t},Fr(!r.pathname||!r.pathname.includes("?"),pC("?","pathname","search",r)),Fr(!r.pathname||!r.pathname.includes("#"),pC("#","pathname","hash",r)),Fr(!r.search||!r.search.includes("#"),pC("#","search","hash",r)));let s=t===""||r.pathname==="",a=s?"/":r.pathname,o;if(a==null)o=n;else{let h=e.length-1;if(!i&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;r.pathname=d.join("/")}o=h>=0?e[h]:"/"}let l=EY(r,o),u=a&&a!=="/"&&a.endsWith("/"),c=(s||a===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}var mf=t=>t.join("/").replace(/\/\/+/g,"/"),TY=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),MY=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,CY=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function RY(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var z6=["POST","PUT","PATCH","DELETE"];new Set(z6);var DY=["GET",...z6];new Set(DY);var hv=V.createContext(null);hv.displayName="DataRouter";var HA=V.createContext(null);HA.displayName="DataRouterState";var I6=V.createContext({isTransitioning:!1});I6.displayName="ViewTransition";var OY=V.createContext(new Map);OY.displayName="Fetchers";var UY=V.createContext(null);UY.displayName="Await";var uc=V.createContext(null);uc.displayName="Navigation";var L_=V.createContext(null);L_.displayName="Location";var zf=V.createContext({outlet:null,matches:[],isDataRoute:!1});zf.displayName="Route";var hU=V.createContext(null);hU.displayName="RouteError";function zY(t,{relative:e}={}){Fr(P_(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=V.useContext(uc),{hash:r,pathname:s,search:a}=N_(t,{relative:e}),o=s;return n!=="/"&&(o=s==="/"?n:mf([n,s])),i.createHref({pathname:o,search:a,hash:r})}function P_(){return V.useContext(L_)!=null}function hd(){return Fr(P_(),"useLocation() may be used only in the context of a <Router> component."),V.useContext(L_).location}var L6="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function P6(t){V.useContext(uc).static||V.useLayoutEffect(t)}function If(){let{isDataRoute:t}=V.useContext(zf);return t?XY():IY()}function IY(){Fr(P_(),"useNavigate() may be used only in the context of a <Router> component.");let t=V.useContext(hv),{basename:e,navigator:n}=V.useContext(uc),{matches:i}=V.useContext(zf),{pathname:r}=hd(),s=JSON.stringify(O6(i)),a=V.useRef(!1);return P6(()=>{a.current=!0}),V.useCallback((l,u={})=>{if(rc(a.current,L6),!a.current)return;if(typeof l=="number"){n.go(l);return}let c=U6(l,JSON.parse(s),r,u.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:mf([e,c.pathname])),(u.replace?n.replace:n.push)(c,u.state,u)},[e,n,s,r,t])}V.createContext(null);function N_(t,{relative:e}={}){let{matches:n}=V.useContext(zf),{pathname:i}=hd(),r=JSON.stringify(O6(n));return V.useMemo(()=>U6(t,JSON.parse(r),i,e==="path"),[t,r,i,e])}function LY(t,e){return N6(t,e)}function N6(t,e,n,i){var g;Fr(P_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=V.useContext(uc),{matches:s}=V.useContext(zf),a=s[s.length-1],o=a?a.params:{},l=a?a.pathname:"/",u=a?a.pathnameBase:"/",c=a&&a.route;{let x=c&&c.path||"";B6(l,!c||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let h=hd(),d;if(e){let x=typeof e=="string"?fv(e):e;Fr(u==="/"||((g=x.pathname)==null?void 0:g.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${x.pathname}" was given in the \`location\` prop.`),d=x}else d=h;let m=d.pathname||"/",v=m;if(u!=="/"){let x=u.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(x.length).join("/")}let _=C6(t,{pathname:v});rc(c||_!=null,`No routes matched location "${d.pathname}${d.search}${d.hash}" `),rc(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${d.pathname}${d.search}${d.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let y=FY(_&&_.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:mf([u,r.encodeLocation?r.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?u:mf([u,r.encodeLocation?r.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,n,i);return e&&y?V.createElement(L_.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...d},navigationType:"POP"}},y):y}function PY(){let t=WY(),e=RY(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},a=null;return console.error("Error handled by React Router default ErrorBoundary:",t),a=V.createElement(V.Fragment,null,V.createElement("p",null,"💿 Hey developer 👋"),V.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",V.createElement("code",{style:s},"ErrorBoundary")," or"," ",V.createElement("code",{style:s},"errorElement")," prop on your route.")),V.createElement(V.Fragment,null,V.createElement("h2",null,"Unexpected Application Error!"),V.createElement("h3",{style:{fontStyle:"italic"}},e),n?V.createElement("pre",{style:r},n):null,a)}var NY=V.createElement(PY,null),BY=class extends V.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?V.createElement(zf.Provider,{value:this.props.routeContext},V.createElement(hU.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function kY({routeContext:t,match:e,children:n}){let i=V.useContext(hv);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),V.createElement(zf.Provider,{value:t},n)}function FY(t,e=[],n=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let r=t,s=n==null?void 0:n.errors;if(s!=null){let l=r.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);Fr(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),r=r.slice(0,Math.min(r.length,l+1))}let a=!1,o=-1;if(n)for(let l=0;l<r.length;l++){let u=r[l];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(o=l),u.route.id){let{loaderData:c,errors:h}=n,d=u.route.loader&&!c.hasOwnProperty(u.route.id)&&(!h||h[u.route.id]===void 0);if(u.route.lazy||d){a=!0,o>=0?r=r.slice(0,o+1):r=[r[0]];break}}}return r.reduceRight((l,u,c)=>{let h,d=!1,m=null,v=null;n&&(h=s&&u.route.id?s[u.route.id]:void 0,m=u.route.errorElement||NY,a&&(o<0&&c===0?(B6("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,v=null):o===c&&(d=!0,v=u.route.hydrateFallbackElement||null)));let _=e.concat(r.slice(0,c+1)),y=()=>{let g;return h?g=m:d?g=v:u.route.Component?g=V.createElement(u.route.Component,null):u.route.element?g=u.route.element:g=l,V.createElement(kY,{match:u,routeContext:{outlet:l,matches:_,isDataRoute:n!=null},children:g})};return n&&(u.route.ErrorBoundary||u.route.errorElement||c===0)?V.createElement(BY,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:y(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):y()},null)}function dU(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function GY(t){let e=V.useContext(hv);return Fr(e,dU(t)),e}function VY(t){let e=V.useContext(HA);return Fr(e,dU(t)),e}function HY(t){let e=V.useContext(zf);return Fr(e,dU(t)),e}function pU(t){let e=HY(t),n=e.matches[e.matches.length-1];return Fr(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function jY(){return pU("useRouteId")}function WY(){var i;let t=V.useContext(hU),e=VY("useRouteError"),n=pU("useRouteError");return t!==void 0?t:(i=e.errors)==null?void 0:i[n]}function XY(){let{router:t}=GY("useNavigate"),e=pU("useNavigate"),n=V.useRef(!1);return P6(()=>{n.current=!0}),V.useCallback(async(r,s={})=>{rc(n.current,L6),n.current&&(typeof r=="number"?t.navigate(r):await t.navigate(r,{fromRouteId:e,...s}))},[t,e])}var XL={};function B6(t,e,n){!e&&!XL[t]&&(XL[t]=!0,rc(!1,n))}V.memo(YY);function YY({routes:t,future:e,state:n}){return N6(t,void 0,n,e)}function Xl(t){Fr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ZY({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:r,static:s=!1}){Fr(!P_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=t.replace(/^\/*/,"/"),o=V.useMemo(()=>({basename:a,navigator:r,static:s,future:{}}),[a,r,s]);typeof n=="string"&&(n=fv(n));let{pathname:l="/",search:u="",hash:c="",state:h=null,key:d="default"}=n,m=V.useMemo(()=>{let v=wf(l,a);return v==null?null:{location:{pathname:v,search:u,hash:c,state:h,key:d},navigationType:i}},[a,l,u,c,h,d,i]);return rc(m!=null,`<Router basename="${a}"> is not able to match the URL "${l}${u}${c}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:V.createElement(uc.Provider,{value:o},V.createElement(L_.Provider,{children:e,value:m}))}function qY({children:t,location:e}){return LY(jR(t),e)}function jR(t,e=[]){let n=[];return V.Children.forEach(t,(i,r)=>{if(!V.isValidElement(i))return;let s=[...e,r];if(i.type===V.Fragment){n.push.apply(n,jR(i.props.children,s));return}Fr(i.type===Xl,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Fr(!i.props.index||!i.props.children,"An index route cannot have child routes.");let a={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=jR(i.props.children,s)),n.push(a)}),n}var aE="get",oE="application/x-www-form-urlencoded";function jA(t){return t!=null&&typeof t.tagName=="string"}function KY(t){return jA(t)&&t.tagName.toLowerCase()==="button"}function QY(t){return jA(t)&&t.tagName.toLowerCase()==="form"}function JY(t){return jA(t)&&t.tagName.toLowerCase()==="input"}function $Y(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function eZ(t,e){return t.button===0&&(!e||e==="_self")&&!$Y(t)}var TS=null;function tZ(){if(TS===null)try{new FormData(document.createElement("form"),0),TS=!1}catch{TS=!0}return TS}var nZ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function mC(t){return t!=null&&!nZ.has(t)?(rc(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${oE}"`),null):t}function iZ(t,e){let n,i,r,s,a;if(QY(t)){let o=t.getAttribute("action");i=o?wf(o,e):null,n=t.getAttribute("method")||aE,r=mC(t.getAttribute("enctype"))||oE,s=new FormData(t)}else if(KY(t)||JY(t)&&(t.type==="submit"||t.type==="image")){let o=t.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||o.getAttribute("action");if(i=l?wf(l,e):null,n=t.getAttribute("formmethod")||o.getAttribute("method")||aE,r=mC(t.getAttribute("formenctype"))||mC(o.getAttribute("enctype"))||oE,s=new FormData(o,t),!tZ()){let{name:u,type:c,value:h}=t;if(c==="image"){let d=u?`${u}.`:"";s.append(`${d}x`,"0"),s.append(`${d}y`,"0")}else u&&s.append(u,h)}}else{if(jA(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=aE,i=null,r=oE,a=t}return s&&r==="text/plain"&&(a=s,s=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:s,body:a}}function mU(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function rZ(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function sZ(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function aZ(t,e,n){let i=await Promise.all(t.map(async r=>{let s=e.routes[r.route.id];if(s){let a=await rZ(s,n);return a.links?a.links():[]}return[]}));return cZ(i.flat(1).filter(sZ).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function YL(t,e,n,i,r,s){let a=(l,u)=>n[u]?l.route.id!==n[u].route.id:!0,o=(l,u)=>{var c;return n[u].pathname!==l.pathname||((c=n[u].route.path)==null?void 0:c.endsWith("*"))&&n[u].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,u)=>a(l,u)||o(l,u)):s==="data"?e.filter((l,u)=>{var h;let c=i.routes[l.route.id];if(!c||!c.hasLoader)return!1;if(a(l,u)||o(l,u))return!0;if(l.route.shouldRevalidate){let d=l.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((h=n[0])==null?void 0:h.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function oZ(t,e,{includeHydrateFallback:n}={}){return lZ(t.map(i=>{let r=e.routes[i.route.id];if(!r)return[];let s=[r.module];return r.clientActionModule&&(s=s.concat(r.clientActionModule)),r.clientLoaderModule&&(s=s.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(s=s.concat(r.hydrateFallbackModule)),r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function lZ(t){return[...new Set(t)]}function uZ(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function cZ(t,e){let n=new Set;return new Set(e),t.reduce((i,r)=>{let s=JSON.stringify(uZ(r));return n.has(s)||(n.add(s),i.push({key:s,link:r})),i},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var fZ=new Set([100,101,204,205]);function hZ(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&wf(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function k6(){let t=V.useContext(hv);return mU(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function dZ(){let t=V.useContext(HA);return mU(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var gU=V.createContext(void 0);gU.displayName="FrameworkContext";function F6(){let t=V.useContext(gU);return mU(t,"You must render this element inside a <HydratedRouter> element"),t}function pZ(t,e){let n=V.useContext(gU),[i,r]=V.useState(!1),[s,a]=V.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:u,onMouseLeave:c,onTouchStart:h}=e,d=V.useRef(null);V.useEffect(()=>{if(t==="render"&&a(!0),t==="viewport"){let _=g=>{g.forEach(x=>{a(x.isIntersecting)})},y=new IntersectionObserver(_,{threshold:.5});return d.current&&y.observe(d.current),()=>{y.disconnect()}}},[t]),V.useEffect(()=>{if(i){let _=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(_)}}},[i]);let m=()=>{r(!0)},v=()=>{r(!1),a(!1)};return n?t!=="intent"?[s,d,{}]:[s,d,{onFocus:Gy(o,m),onBlur:Gy(l,v),onMouseEnter:Gy(u,m),onMouseLeave:Gy(c,v),onTouchStart:Gy(h,m)}]:[!1,d,{}]}function Gy(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function mZ({page:t,...e}){let{router:n}=k6(),i=V.useMemo(()=>C6(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?V.createElement(vZ,{page:t,matches:i,...e}):null}function gZ(t){let{manifest:e,routeModules:n}=F6(),[i,r]=V.useState([]);return V.useEffect(()=>{let s=!1;return aZ(t,e,n).then(a=>{s||r(a)}),()=>{s=!0}},[t,e,n]),i}function vZ({page:t,matches:e,...n}){let i=hd(),{manifest:r,routeModules:s}=F6(),{basename:a}=k6(),{loaderData:o,matches:l}=dZ(),u=V.useMemo(()=>YL(t,e,l,r,i,"data"),[t,e,l,r,i]),c=V.useMemo(()=>YL(t,e,l,r,i,"assets"),[t,e,l,r,i]),h=V.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let v=new Set,_=!1;if(e.forEach(g=>{var S;let x=r.routes[g.route.id];!x||!x.hasLoader||(!u.some(E=>E.route.id===g.route.id)&&g.route.id in o&&((S=s[g.route.id])!=null&&S.shouldRevalidate)||x.hasClientLoader?_=!0:v.add(g.route.id))}),v.size===0)return[];let y=hZ(t,a);return _&&v.size>0&&y.searchParams.set("_routes",e.filter(g=>v.has(g.route.id)).map(g=>g.route.id).join(",")),[y.pathname+y.search]},[a,o,i,r,u,e,t,s]),d=V.useMemo(()=>oZ(c,r),[c,r]),m=gZ(c);return V.createElement(V.Fragment,null,h.map(v=>V.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...n})),d.map(v=>V.createElement("link",{key:v,rel:"modulepreload",href:v,...n})),m.map(({key:v,link:_})=>V.createElement("link",{key:v,..._})))}function yZ(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var G6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{G6&&(window.__reactRouterVersion="7.6.2")}catch{}function xZ({basename:t,children:e,window:n}){let i=V.useRef();i.current==null&&(i.current=aY({window:n,v5Compat:!0}));let r=i.current,[s,a]=V.useState({action:r.action,location:r.location}),o=V.useCallback(l=>{V.startTransition(()=>a(l))},[a]);return V.useLayoutEffect(()=>r.listen(o),[r,o]),V.createElement(ZY,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:r})}var V6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Sp=V.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:r,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:c,viewTransition:h,...d},m){let{basename:v}=V.useContext(uc),_=typeof u=="string"&&V6.test(u),y,g=!1;if(typeof u=="string"&&_&&(y=u,G6))try{let M=new URL(window.location.href),D=u.startsWith("//")?new URL(M.protocol+u):new URL(u),P=wf(D.pathname,v);D.origin===M.origin&&P!=null?u=P+D.search+D.hash:g=!0}catch{rc(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let x=zY(u,{relative:r}),[S,E,A]=pZ(i,d),T=EZ(u,{replace:a,state:o,target:l,preventScrollReset:c,relative:r,viewTransition:h});function C(M){e&&e(M),M.defaultPrevented||T(M)}let O=V.createElement("a",{...d,...A,href:y||x,onClick:g||s?e:C,ref:yZ(m,E),target:l,"data-discover":!_&&n==="render"?"true":void 0});return S&&!_?V.createElement(V.Fragment,null,O,V.createElement(mZ,{page:x})):O});Sp.displayName="Link";var _Z=V.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:r=!1,style:s,to:a,viewTransition:o,children:l,...u},c){let h=N_(a,{relative:u.relative}),d=hd(),m=V.useContext(HA),{navigator:v,basename:_}=V.useContext(uc),y=m!=null&&CZ(h)&&o===!0,g=v.encodeLocation?v.encodeLocation(h).pathname:h.pathname,x=d.pathname,S=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;n||(x=x.toLowerCase(),S=S?S.toLowerCase():null,g=g.toLowerCase()),S&&_&&(S=wf(S,_)||S);const E=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let A=x===g||!r&&x.startsWith(g)&&x.charAt(E)==="/",T=S!=null&&(S===g||!r&&S.startsWith(g)&&S.charAt(g.length)==="/"),C={isActive:A,isPending:T,isTransitioning:y},O=A?e:void 0,M;typeof i=="function"?M=i(C):M=[i,A?"active":null,T?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let D=typeof s=="function"?s(C):s;return V.createElement(Sp,{...u,"aria-current":O,className:M,ref:c,style:D,to:a,viewTransition:o},typeof l=="function"?l(C):l)});_Z.displayName="NavLink";var bZ=V.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:r,state:s,method:a=aE,action:o,onSubmit:l,relative:u,preventScrollReset:c,viewTransition:h,...d},m)=>{let v=TZ(),_=MZ(o,{relative:u}),y=a.toLowerCase()==="get"?"get":"post",g=typeof o=="string"&&V6.test(o),x=S=>{if(l&&l(S),S.defaultPrevented)return;S.preventDefault();let E=S.nativeEvent.submitter,A=(E==null?void 0:E.getAttribute("formmethod"))||a;v(E||S.currentTarget,{fetcherKey:e,method:A,navigate:n,replace:r,state:s,relative:u,preventScrollReset:c,viewTransition:h})};return V.createElement("form",{ref:m,method:y,action:_,onSubmit:i?l:x,...d,"data-discover":!g&&t==="render"?"true":void 0})});bZ.displayName="Form";function SZ(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function H6(t){let e=V.useContext(hv);return Fr(e,SZ(t)),e}function EZ(t,{target:e,replace:n,state:i,preventScrollReset:r,relative:s,viewTransition:a}={}){let o=If(),l=hd(),u=N_(t,{relative:s});return V.useCallback(c=>{if(eZ(c,e)){c.preventDefault();let h=n!==void 0?n:U1(l)===U1(u);o(t,{replace:h,state:i,preventScrollReset:r,relative:s,viewTransition:a})}},[l,o,u,n,i,e,t,r,s,a])}var wZ=0,AZ=()=>`__${String(++wZ)}__`;function TZ(){let{router:t}=H6("useSubmit"),{basename:e}=V.useContext(uc),n=jY();return V.useCallback(async(i,r={})=>{let{action:s,method:a,encType:o,formData:l,body:u}=iZ(i,e);if(r.navigate===!1){let c=r.fetcherKey||AZ();await t.fetch(c,n,r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:u,formMethod:r.method||a,formEncType:r.encType||o,flushSync:r.flushSync})}else await t.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:u,formMethod:r.method||a,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[t,e,n])}function MZ(t,{relative:e}={}){let{basename:n}=V.useContext(uc),i=V.useContext(zf);Fr(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),s={...N_(t||".",{relative:e})},a=hd();if(t==null){s.search=a.search;let o=new URLSearchParams(s.search),l=o.getAll("index");if(l.some(c=>c==="")){o.delete("index"),l.filter(h=>h).forEach(h=>o.append("index",h));let c=o.toString();s.search=c?`?${c}`:""}}return(!t||t===".")&&r.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:mf([n,s.pathname])),U1(s)}function CZ(t,e={}){let n=V.useContext(I6);Fr(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=H6("useViewTransitionState"),r=N_(t,{relative:e.relative});if(!n.isTransitioning)return!1;let s=wf(n.currentLocation.pathname,i)||n.currentLocation.pathname,a=wf(n.nextLocation.pathname,i)||n.nextLocation.pathname;return iw(r.pathname,a)!=null||iw(r.pathname,s)!=null}[...fZ];/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const WA="176",j6={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},RZ={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},W6=0,WR=1,X6=2,DZ=3,Y6=0,XA=1,e1=2,Zl=3,Af=0,La=1,es=2,gf=0,Np=1,XR=2,YR=3,ZR=4,Z6=5,Fh=100,q6=101,K6=102,Q6=103,J6=104,$6=200,eG=201,tG=202,nG=203,rw=204,sw=205,iG=206,rG=207,sG=208,aG=209,oG=210,lG=211,uG=212,cG=213,fG=214,aw=0,ow=1,lw=2,Kp=3,uw=4,cw=5,fw=6,hw=7,B_=0,hG=1,dG=2,Ju=0,pG=1,mG=2,gG=3,vU=4,vG=5,yG=6,xG=7,qR="attached",_G="detached",YA=300,Tf=301,ad=302,z1=303,I1=304,dv=306,L1=1e3,ul=1001,P1=1002,ia=1003,yU=1004,OZ=1004,l0=1005,UZ=1005,ts=1006,t1=1007,zZ=1007,Yu=1008,IZ=1008,ml=1009,xU=1010,_U=1011,k0=1012,ZA=1013,Mf=1014,io=1015,pv=1016,qA=1017,KA=1018,F0=1020,bU=35902,SU=1021,EU=1022,Sa=1023,G0=1026,V0=1027,QA=1028,k_=1029,wU=1030,JA=1031,LZ=1032,$A=1033,n1=33776,i1=33777,r1=33778,s1=33779,dw=35840,pw=35841,mw=35842,gw=35843,vw=36196,yw=37492,xw=37496,_w=37808,bw=37809,Sw=37810,Ew=37811,ww=37812,Aw=37813,Tw=37814,Mw=37815,Cw=37816,Rw=37817,Dw=37818,Ow=37819,Uw=37820,zw=37821,a1=36492,Iw=36494,Lw=36495,AU=36283,Pw=36284,Nw=36285,Bw=36286,bG=2200,SG=2201,EG=2202,N1=2300,kw=2301,lE=2302,Ap=2400,Tp=2401,B1=2402,eT=2500,TU=2501,PZ=0,NZ=1,BZ=2,wG=3200,MU=3201,kZ=3202,FZ=3203,dd=0,AG=1,nf="",xa="srgb",od="srgb-linear",k1="linear",Ki="srgb",GZ=0,_p=7680,VZ=7681,HZ=7682,jZ=7683,WZ=34055,XZ=34056,YZ=5386,ZZ=512,qZ=513,KZ=514,QZ=515,JZ=516,$Z=517,eq=518,KR=519,TG=512,MG=513,CG=514,CU=515,RG=516,DG=517,OG=518,UG=519,F1=35044,tq=35048,nq=35040,iq=35045,rq=35049,sq=35041,aq=35046,oq=35050,lq=35042,uq="100",QR="300 es",cl=2e3,G1=2001,cq={COMPUTE:"compute",RENDER:"render"},fq={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},hq={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};let cc=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){const i=this._listeners;if(i===void 0)return;const r=i[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const i=n[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}};const ma=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ZL=1234567;const Bp=Math.PI/180,H0=180/Math.PI;function Do(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(ma[t&255]+ma[t>>8&255]+ma[t>>16&255]+ma[t>>24&255]+"-"+ma[e&255]+ma[e>>8&255]+"-"+ma[e>>16&15|64]+ma[e>>24&255]+"-"+ma[n&63|128]+ma[n>>8&255]+"-"+ma[n>>16&255]+ma[n>>24&255]+ma[i&255]+ma[i>>8&255]+ma[i>>16&255]+ma[i>>24&255]).toLowerCase()}function Jn(t,e,n){return Math.max(e,Math.min(n,t))}function RU(t,e){return(t%e+e)%e}function dq(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function pq(t,e,n){return t!==e?(n-t)/(e-t):0}function o1(t,e,n){return(1-n)*t+n*e}function mq(t,e,n,i){return o1(t,e,1-Math.exp(-n*i))}function gq(t,e=1){return e-Math.abs(RU(t,e*2)-e)}function vq(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function yq(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function xq(t,e){return t+Math.floor(Math.random()*(e-t+1))}function _q(t,e){return t+Math.random()*(e-t)}function bq(t){return t*(.5-Math.random())}function Sq(t){t!==void 0&&(ZL=t);let e=ZL+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Eq(t){return t*Bp}function wq(t){return t*H0}function Aq(t){return(t&t-1)===0&&t!==0}function Tq(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Mq(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Cq(t,e,n,i,r){const s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),u=s((e+i)/2),c=a((e+i)/2),h=s((e-i)/2),d=a((e-i)/2),m=s((i-e)/2),v=a((i-e)/2);switch(r){case"XYX":t.set(o*c,l*h,l*d,o*u);break;case"YZY":t.set(l*d,o*c,l*h,o*u);break;case"ZXZ":t.set(l*h,l*d,o*c,o*u);break;case"XZX":t.set(o*c,l*v,l*m,o*u);break;case"YXY":t.set(l*m,o*c,l*v,o*u);break;case"ZYZ":t.set(l*v,l*m,o*c,o*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Ua(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function si(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const Ih={DEG2RAD:Bp,RAD2DEG:H0,generateUUID:Do,clamp:Jn,euclideanModulo:RU,mapLinear:dq,inverseLerp:pq,lerp:o1,damp:mq,pingpong:gq,smoothstep:vq,smootherstep:yq,randInt:xq,randFloat:_q,randFloatSpread:bq,seededRandom:Sq,degToRad:Eq,radToDeg:wq,isPowerOfTwo:Aq,ceilPowerOfTwo:Tq,floorPowerOfTwo:Mq,setQuaternionFromProperEuler:Cq,normalize:si,denormalize:Ua};class Tt{constructor(e=0,n=0){Tt.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Jn(this.x,e.x,n.x),this.y=Jn(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Jn(this.x,e,n),this.y=Jn(this.y,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Jn(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Jn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,a=this.y-e.y;return this.x=s*i-a*r+e.x,this.y=s*r+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Qn{constructor(e,n,i,r,s,a,o,l,u){Qn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,a,o,l,u)}set(e,n,i,r,s,a,o,l,u){const c=this.elements;return c[0]=e,c[1]=r,c[2]=o,c[3]=n,c[4]=s,c[5]=l,c[6]=i,c[7]=a,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,a=i[0],o=i[3],l=i[6],u=i[1],c=i[4],h=i[7],d=i[2],m=i[5],v=i[8],_=r[0],y=r[3],g=r[6],x=r[1],S=r[4],E=r[7],A=r[2],T=r[5],C=r[8];return s[0]=a*_+o*x+l*A,s[3]=a*y+o*S+l*T,s[6]=a*g+o*E+l*C,s[1]=u*_+c*x+h*A,s[4]=u*y+c*S+h*T,s[7]=u*g+c*E+h*C,s[2]=d*_+m*x+v*A,s[5]=d*y+m*S+v*T,s[8]=d*g+m*E+v*C,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8];return n*a*c-n*o*u-i*s*c+i*o*l+r*s*u-r*a*l}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=c*a-o*u,d=o*l-c*s,m=u*s-a*l,v=n*h+i*d+r*m;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/v;return e[0]=h*_,e[1]=(r*u-c*i)*_,e[2]=(o*i-r*a)*_,e[3]=d*_,e[4]=(c*n-r*l)*_,e[5]=(r*s-o*n)*_,e[6]=m*_,e[7]=(i*l-u*n)*_,e[8]=(a*n-i*s)*_,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,a,o){const l=Math.cos(s),u=Math.sin(s);return this.set(i*l,i*u,-i*(l*a+u*o)+a+e,-r*u,r*l,-r*(-u*a+l*o)+o+n,0,0,1),this}scale(e,n){return this.premultiply(gC.makeScale(e,n)),this}rotate(e){return this.premultiply(gC.makeRotation(-e)),this}translate(e,n){return this.premultiply(gC.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const gC=new Qn;function zG(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const Rq={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function u0(t,e){return new Rq[t](e)}function V1(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function IG(){const t=V1("canvas");return t.style.display="block",t}const qL={};function uE(t){t in qL||(qL[t]=!0,console.warn(t))}function Dq(t,e,n){return new Promise(function(i,r){function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:r();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}}setTimeout(s,n)})}function Oq(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function Uq(t){const e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const KL=new Qn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),QL=new Qn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function zq(){const t={enabled:!0,workingColorSpace:od,spaces:{},convert:function(r,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===Ki&&(r.r=vf(r.r),r.g=vf(r.g),r.b=vf(r.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Ki&&(r.r=b0(r.r),r.g=b0(r.g),r.b=b0(r.b))),r},fromWorkingColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},toWorkingColorSpace:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===nf?k1:this.spaces[r].transfer},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,a){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[od]:{primaries:e,whitePoint:i,transfer:k1,toXYZ:KL,fromXYZ:QL,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:xa},outputColorSpaceConfig:{drawingBufferColorSpace:xa}},[xa]:{primaries:e,whitePoint:i,transfer:Ki,toXYZ:KL,fromXYZ:QL,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:xa}}}),t}const Ei=zq();function vf(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function b0(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let pg;class LG{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{pg===void 0&&(pg=V1("canvas")),pg.width=e.width,pg.height=e.height;const r=pg.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=pg}return i.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=V1("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=vf(s[a]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(vf(n[i]/255)*255):n[i]=vf(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Iq=0;class Wh{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Iq++}),this.uuid=Do(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?s.push(vC(r[a].image)):s.push(vC(r[a]))}else s=vC(r);i.url=s}return n||(e.images[this.uuid]=i),i}}function vC(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?LG.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Lq=0;class Gr extends cc{constructor(e=Gr.DEFAULT_IMAGE,n=Gr.DEFAULT_MAPPING,i=ul,r=ul,s=ts,a=Yu,o=Sa,l=ml,u=Gr.DEFAULT_ANISOTROPY,c=nf){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Lq++}),this.uuid=Do(),this.name="",this.source=new Wh(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=u,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Tt(0,0),this.repeat=new Tt(1,1),this.center=new Tt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Qn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==YA)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case L1:e.x=e.x-Math.floor(e.x);break;case ul:e.x=e.x<0?0:1;break;case P1:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case L1:e.y=e.y-Math.floor(e.y);break;case ul:e.y=e.y<0?0:1;break;case P1:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Gr.DEFAULT_IMAGE=null;Gr.DEFAULT_MAPPING=YA;Gr.DEFAULT_ANISOTROPY=1;class bi{constructor(e=0,n=0,i=0,r=1){bi.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*r+a[12]*s,this.y=a[1]*n+a[5]*i+a[9]*r+a[13]*s,this.z=a[2]*n+a[6]*i+a[10]*r+a[14]*s,this.w=a[3]*n+a[7]*i+a[11]*r+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const l=e.elements,u=l[0],c=l[4],h=l[8],d=l[1],m=l[5],v=l[9],_=l[2],y=l[6],g=l[10];if(Math.abs(c-d)<.01&&Math.abs(h-_)<.01&&Math.abs(v-y)<.01){if(Math.abs(c+d)<.1&&Math.abs(h+_)<.1&&Math.abs(v+y)<.1&&Math.abs(u+m+g-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const S=(u+1)/2,E=(m+1)/2,A=(g+1)/2,T=(c+d)/4,C=(h+_)/4,O=(v+y)/4;return S>E&&S>A?S<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(S),r=T/i,s=C/i):E>A?E<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(E),i=T/r,s=O/r):A<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(A),i=C/s,r=O/s),this.set(i,r,s,n),this}let x=Math.sqrt((y-v)*(y-v)+(h-_)*(h-_)+(d-c)*(d-c));return Math.abs(x)<.001&&(x=1),this.x=(y-v)/x,this.y=(h-_)/x,this.z=(d-c)/x,this.w=Math.acos((u+m+g-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Jn(this.x,e.x,n.x),this.y=Jn(this.y,e.y,n.y),this.z=Jn(this.z,e.z,n.z),this.w=Jn(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Jn(this.x,e,n),this.y=Jn(this.y,e,n),this.z=Jn(this.z,e,n),this.w=Jn(this.w,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Jn(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class tT extends cc{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=i.depth?i.depth:1,this.scissor=new bi(0,0,e,n),this.scissorTest=!1,this.viewport=new bi(0,0,e,n);const r={width:e,height:n,depth:this.depth};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ts,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},i);const s=new Gr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const a=i.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=n,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const r=Object.assign({},e.textures[n].image);this.textures[n].source=new Wh(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class sc extends tT{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class F_ extends Gr{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=ia,this.minFilter=ia,this.wrapR=ul,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Pq extends sc{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new F_(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class nT extends Gr{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=ia,this.minFilter=ia,this.wrapR=ul,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Nq extends sc{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new nT(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class ra{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,a,o){let l=i[r+0],u=i[r+1],c=i[r+2],h=i[r+3];const d=s[a+0],m=s[a+1],v=s[a+2],_=s[a+3];if(o===0){e[n+0]=l,e[n+1]=u,e[n+2]=c,e[n+3]=h;return}if(o===1){e[n+0]=d,e[n+1]=m,e[n+2]=v,e[n+3]=_;return}if(h!==_||l!==d||u!==m||c!==v){let y=1-o;const g=l*d+u*m+c*v+h*_,x=g>=0?1:-1,S=1-g*g;if(S>Number.EPSILON){const A=Math.sqrt(S),T=Math.atan2(A,g*x);y=Math.sin(y*T)/A,o=Math.sin(o*T)/A}const E=o*x;if(l=l*y+d*E,u=u*y+m*E,c=c*y+v*E,h=h*y+_*E,y===1-o){const A=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=A,u*=A,c*=A,h*=A}}e[n]=l,e[n+1]=u,e[n+2]=c,e[n+3]=h}static multiplyQuaternionsFlat(e,n,i,r,s,a){const o=i[r],l=i[r+1],u=i[r+2],c=i[r+3],h=s[a],d=s[a+1],m=s[a+2],v=s[a+3];return e[n]=o*v+c*h+l*m-u*d,e[n+1]=l*v+c*d+u*h-o*m,e[n+2]=u*v+c*m+o*d-l*h,e[n+3]=c*v-o*h-l*d-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,r=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,u=o(i/2),c=o(r/2),h=o(s/2),d=l(i/2),m=l(r/2),v=l(s/2);switch(a){case"XYZ":this._x=d*c*h+u*m*v,this._y=u*m*h-d*c*v,this._z=u*c*v+d*m*h,this._w=u*c*h-d*m*v;break;case"YXZ":this._x=d*c*h+u*m*v,this._y=u*m*h-d*c*v,this._z=u*c*v-d*m*h,this._w=u*c*h+d*m*v;break;case"ZXY":this._x=d*c*h-u*m*v,this._y=u*m*h+d*c*v,this._z=u*c*v+d*m*h,this._w=u*c*h-d*m*v;break;case"ZYX":this._x=d*c*h-u*m*v,this._y=u*m*h+d*c*v,this._z=u*c*v-d*m*h,this._w=u*c*h+d*m*v;break;case"YZX":this._x=d*c*h+u*m*v,this._y=u*m*h+d*c*v,this._z=u*c*v-d*m*h,this._w=u*c*h-d*m*v;break;case"XZY":this._x=d*c*h-u*m*v,this._y=u*m*h-d*c*v,this._z=u*c*v+d*m*h,this._w=u*c*h+d*m*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],a=n[1],o=n[5],l=n[9],u=n[2],c=n[6],h=n[10],d=i+o+h;if(d>0){const m=.5/Math.sqrt(d+1);this._w=.25/m,this._x=(c-l)*m,this._y=(s-u)*m,this._z=(a-r)*m}else if(i>o&&i>h){const m=2*Math.sqrt(1+i-o-h);this._w=(c-l)/m,this._x=.25*m,this._y=(r+a)/m,this._z=(s+u)/m}else if(o>h){const m=2*Math.sqrt(1+o-i-h);this._w=(s-u)/m,this._x=(r+a)/m,this._y=.25*m,this._z=(l+c)/m}else{const m=2*Math.sqrt(1+h-i-o);this._w=(a-r)/m,this._x=(s+u)/m,this._y=(l+c)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Jn(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,a=e._w,o=n._x,l=n._y,u=n._z,c=n._w;return this._x=i*c+a*o+r*u-s*l,this._y=r*c+a*l+s*o-i*u,this._z=s*c+a*u+i*l-r*o,this._w=a*c-i*o-r*l-s*u,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,a=this._w;let o=a*e._w+i*e._x+r*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=i,this._y=r,this._z=s,this;const l=1-o*o;if(l<=Number.EPSILON){const m=1-n;return this._w=m*a+n*this._w,this._x=m*i+n*this._x,this._y=m*r+n*this._y,this._z=m*s+n*this._z,this.normalize(),this}const u=Math.sqrt(l),c=Math.atan2(u,o),h=Math.sin((1-n)*c)/u,d=Math.sin(n*c)/u;return this._w=a*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(n),s*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class re{constructor(e=0,n=0,i=0){re.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(JL.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(JL.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,a=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*a,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*a,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*a,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,a=e.y,o=e.z,l=e.w,u=2*(a*r-o*i),c=2*(o*n-s*r),h=2*(s*i-a*n);return this.x=n+l*u+a*h-o*c,this.y=i+l*c+o*u-s*h,this.z=r+l*h+s*c-a*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Jn(this.x,e.x,n.x),this.y=Jn(this.y,e.y,n.y),this.z=Jn(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Jn(this.x,e,n),this.y=Jn(this.y,e,n),this.z=Jn(this.z,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Jn(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,a=n.x,o=n.y,l=n.z;return this.x=r*l-s*o,this.y=s*a-i*l,this.z=i*o-r*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return yC.copy(this).projectOnVector(e),this.sub(yC)}reflect(e){return this.sub(yC.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Jn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const yC=new re,JL=new ra;class bs{constructor(e=new re(1/0,1/0,1/0),n=new re(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(Fl.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(Fl.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=Fl.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Fl):Fl.fromBufferAttribute(s,a),Fl.applyMatrix4(e.matrixWorld),this.expandByPoint(Fl);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),MS.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),MS.copy(i.boundingBox)),MS.applyMatrix4(e.matrixWorld),this.union(MS)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Fl),Fl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Vy),CS.subVectors(this.max,Vy),mg.subVectors(e.a,Vy),gg.subVectors(e.b,Vy),vg.subVectors(e.c,Vy),_h.subVectors(gg,mg),bh.subVectors(vg,gg),ep.subVectors(mg,vg);let n=[0,-_h.z,_h.y,0,-bh.z,bh.y,0,-ep.z,ep.y,_h.z,0,-_h.x,bh.z,0,-bh.x,ep.z,0,-ep.x,-_h.y,_h.x,0,-bh.y,bh.x,0,-ep.y,ep.x,0];return!xC(n,mg,gg,vg,CS)||(n=[1,0,0,0,1,0,0,0,1],!xC(n,mg,gg,vg,CS))?!1:(RS.crossVectors(_h,bh),n=[RS.x,RS.y,RS.z],xC(n,mg,gg,vg,CS))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Fl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Fl).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Fc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Fc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Fc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Fc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Fc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Fc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Fc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Fc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Fc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Fc=[new re,new re,new re,new re,new re,new re,new re,new re],Fl=new re,MS=new bs,mg=new re,gg=new re,vg=new re,_h=new re,bh=new re,ep=new re,Vy=new re,CS=new re,RS=new re,tp=new re;function xC(t,e,n,i,r){for(let s=0,a=t.length-3;s<=a;s+=3){tp.fromArray(t,s);const o=r.x*Math.abs(tp.x)+r.y*Math.abs(tp.y)+r.z*Math.abs(tp.z),l=e.dot(tp),u=n.dot(tp),c=i.dot(tp);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>o)return!1}return!0}const Bq=new bs,Hy=new re,_C=new re;let Us=class{constructor(e=new re,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):Bq.setFromPoints(e).getCenter(i);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Hy.subVectors(e,this.center);const n=Hy.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(Hy,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(_C.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Hy.copy(e.center).add(_C)),this.expandByPoint(Hy.copy(e.center).sub(_C))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};const Gc=new re,bC=new re,DS=new re,Sh=new re,SC=new re,OS=new re,EC=new re;class mv{constructor(e=new re,n=new re(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Gc)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Gc.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Gc.copy(this.origin).addScaledVector(this.direction,n),Gc.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){bC.copy(e).add(n).multiplyScalar(.5),DS.copy(n).sub(e).normalize(),Sh.copy(this.origin).sub(bC);const s=e.distanceTo(n)*.5,a=-this.direction.dot(DS),o=Sh.dot(this.direction),l=-Sh.dot(DS),u=Sh.lengthSq(),c=Math.abs(1-a*a);let h,d,m,v;if(c>0)if(h=a*l-o,d=a*o-l,v=s*c,h>=0)if(d>=-v)if(d<=v){const _=1/c;h*=_,d*=_,m=h*(h+a*d+2*o)+d*(a*h+d+2*l)+u}else d=s,h=Math.max(0,-(a*d+o)),m=-h*h+d*(d+2*l)+u;else d=-s,h=Math.max(0,-(a*d+o)),m=-h*h+d*(d+2*l)+u;else d<=-v?(h=Math.max(0,-(-a*s+o)),d=h>0?-s:Math.min(Math.max(-s,-l),s),m=-h*h+d*(d+2*l)+u):d<=v?(h=0,d=Math.min(Math.max(-s,-l),s),m=d*(d+2*l)+u):(h=Math.max(0,-(a*s+o)),d=h>0?s:Math.min(Math.max(-s,-l),s),m=-h*h+d*(d+2*l)+u);else d=a>0?-s:s,h=Math.max(0,-(a*d+o)),m=-h*h+d*(d+2*l)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(bC).addScaledVector(DS,d),m}intersectSphere(e,n){Gc.subVectors(e.center,this.origin);const i=Gc.dot(this.direction),r=Gc.dot(Gc)-i*i,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=i-a,l=i+a;return l<0?null:o<0?this.at(l,n):this.at(o,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,a,o,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,d=this.origin;return u>=0?(i=(e.min.x-d.x)*u,r=(e.max.x-d.x)*u):(i=(e.max.x-d.x)*u,r=(e.min.x-d.x)*u),c>=0?(s=(e.min.y-d.y)*c,a=(e.max.y-d.y)*c):(s=(e.max.y-d.y)*c,a=(e.min.y-d.y)*c),i>a||s>r||((s>i||isNaN(i))&&(i=s),(a<r||isNaN(r))&&(r=a),h>=0?(o=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(o=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),i>l||o>r)||((o>i||i!==i)&&(i=o),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,Gc)!==null}intersectTriangle(e,n,i,r,s){SC.subVectors(n,e),OS.subVectors(i,e),EC.crossVectors(SC,OS);let a=this.direction.dot(EC),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Sh.subVectors(this.origin,e);const l=o*this.direction.dot(OS.crossVectors(Sh,OS));if(l<0)return null;const u=o*this.direction.dot(SC.cross(Sh));if(u<0||l+u>a)return null;const c=-o*Sh.dot(EC);return c<0?null:this.at(c/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class kn{constructor(e,n,i,r,s,a,o,l,u,c,h,d,m,v,_,y){kn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,a,o,l,u,c,h,d,m,v,_,y)}set(e,n,i,r,s,a,o,l,u,c,h,d,m,v,_,y){const g=this.elements;return g[0]=e,g[4]=n,g[8]=i,g[12]=r,g[1]=s,g[5]=a,g[9]=o,g[13]=l,g[2]=u,g[6]=c,g[10]=h,g[14]=d,g[3]=m,g[7]=v,g[11]=_,g[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new kn().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/yg.setFromMatrixColumn(e,0).length(),s=1/yg.setFromMatrixColumn(e,1).length(),a=1/yg.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,s=e.z,a=Math.cos(i),o=Math.sin(i),l=Math.cos(r),u=Math.sin(r),c=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=a*c,m=a*h,v=o*c,_=o*h;n[0]=l*c,n[4]=-l*h,n[8]=u,n[1]=m+v*u,n[5]=d-_*u,n[9]=-o*l,n[2]=_-d*u,n[6]=v+m*u,n[10]=a*l}else if(e.order==="YXZ"){const d=l*c,m=l*h,v=u*c,_=u*h;n[0]=d+_*o,n[4]=v*o-m,n[8]=a*u,n[1]=a*h,n[5]=a*c,n[9]=-o,n[2]=m*o-v,n[6]=_+d*o,n[10]=a*l}else if(e.order==="ZXY"){const d=l*c,m=l*h,v=u*c,_=u*h;n[0]=d-_*o,n[4]=-a*h,n[8]=v+m*o,n[1]=m+v*o,n[5]=a*c,n[9]=_-d*o,n[2]=-a*u,n[6]=o,n[10]=a*l}else if(e.order==="ZYX"){const d=a*c,m=a*h,v=o*c,_=o*h;n[0]=l*c,n[4]=v*u-m,n[8]=d*u+_,n[1]=l*h,n[5]=_*u+d,n[9]=m*u-v,n[2]=-u,n[6]=o*l,n[10]=a*l}else if(e.order==="YZX"){const d=a*l,m=a*u,v=o*l,_=o*u;n[0]=l*c,n[4]=_-d*h,n[8]=v*h+m,n[1]=h,n[5]=a*c,n[9]=-o*c,n[2]=-u*c,n[6]=m*h+v,n[10]=d-_*h}else if(e.order==="XZY"){const d=a*l,m=a*u,v=o*l,_=o*u;n[0]=l*c,n[4]=-h,n[8]=u*c,n[1]=d*h+_,n[5]=a*c,n[9]=m*h-v,n[2]=v*h-m,n[6]=o*c,n[10]=_*h+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(kq,e,Fq)}lookAt(e,n,i){const r=this.elements;return bo.subVectors(e,n),bo.lengthSq()===0&&(bo.z=1),bo.normalize(),Eh.crossVectors(i,bo),Eh.lengthSq()===0&&(Math.abs(i.z)===1?bo.x+=1e-4:bo.z+=1e-4,bo.normalize(),Eh.crossVectors(i,bo)),Eh.normalize(),US.crossVectors(bo,Eh),r[0]=Eh.x,r[4]=US.x,r[8]=bo.x,r[1]=Eh.y,r[5]=US.y,r[9]=bo.y,r[2]=Eh.z,r[6]=US.z,r[10]=bo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,a=i[0],o=i[4],l=i[8],u=i[12],c=i[1],h=i[5],d=i[9],m=i[13],v=i[2],_=i[6],y=i[10],g=i[14],x=i[3],S=i[7],E=i[11],A=i[15],T=r[0],C=r[4],O=r[8],M=r[12],D=r[1],P=r[5],F=r[9],G=r[13],z=r[2],Y=r[6],N=r[10],k=r[14],j=r[3],X=r[7],Q=r[11],H=r[15];return s[0]=a*T+o*D+l*z+u*j,s[4]=a*C+o*P+l*Y+u*X,s[8]=a*O+o*F+l*N+u*Q,s[12]=a*M+o*G+l*k+u*H,s[1]=c*T+h*D+d*z+m*j,s[5]=c*C+h*P+d*Y+m*X,s[9]=c*O+h*F+d*N+m*Q,s[13]=c*M+h*G+d*k+m*H,s[2]=v*T+_*D+y*z+g*j,s[6]=v*C+_*P+y*Y+g*X,s[10]=v*O+_*F+y*N+g*Q,s[14]=v*M+_*G+y*k+g*H,s[3]=x*T+S*D+E*z+A*j,s[7]=x*C+S*P+E*Y+A*X,s[11]=x*O+S*F+E*N+A*Q,s[15]=x*M+S*G+E*k+A*H,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],a=e[1],o=e[5],l=e[9],u=e[13],c=e[2],h=e[6],d=e[10],m=e[14],v=e[3],_=e[7],y=e[11],g=e[15];return v*(+s*l*h-r*u*h-s*o*d+i*u*d+r*o*m-i*l*m)+_*(+n*l*m-n*u*d+s*a*d-r*a*m+r*u*c-s*l*c)+y*(+n*u*h-n*o*m-s*a*h+i*a*m+s*o*c-i*u*c)+g*(-r*o*c-n*l*h+n*o*d+r*a*h-i*a*d+i*l*c)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],m=e[11],v=e[12],_=e[13],y=e[14],g=e[15],x=h*y*u-_*d*u+_*l*m-o*y*m-h*l*g+o*d*g,S=v*d*u-c*y*u-v*l*m+a*y*m+c*l*g-a*d*g,E=c*_*u-v*h*u+v*o*m-a*_*m-c*o*g+a*h*g,A=v*h*l-c*_*l-v*o*d+a*_*d+c*o*y-a*h*y,T=n*x+i*S+r*E+s*A;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/T;return e[0]=x*C,e[1]=(_*d*s-h*y*s-_*r*m+i*y*m+h*r*g-i*d*g)*C,e[2]=(o*y*s-_*l*s+_*r*u-i*y*u-o*r*g+i*l*g)*C,e[3]=(h*l*s-o*d*s-h*r*u+i*d*u+o*r*m-i*l*m)*C,e[4]=S*C,e[5]=(c*y*s-v*d*s+v*r*m-n*y*m-c*r*g+n*d*g)*C,e[6]=(v*l*s-a*y*s-v*r*u+n*y*u+a*r*g-n*l*g)*C,e[7]=(a*d*s-c*l*s+c*r*u-n*d*u-a*r*m+n*l*m)*C,e[8]=E*C,e[9]=(v*h*s-c*_*s-v*i*m+n*_*m+c*i*g-n*h*g)*C,e[10]=(a*_*s-v*o*s+v*i*u-n*_*u-a*i*g+n*o*g)*C,e[11]=(c*o*s-a*h*s-c*i*u+n*h*u+a*i*m-n*o*m)*C,e[12]=A*C,e[13]=(c*_*r-v*h*r+v*i*d-n*_*d-c*i*y+n*h*y)*C,e[14]=(v*o*r-a*_*r-v*i*l+n*_*l+a*i*y-n*o*y)*C,e[15]=(a*h*r-c*o*r+c*i*l-n*h*l-a*i*d+n*o*d)*C,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,a=e.x,o=e.y,l=e.z,u=s*a,c=s*o;return this.set(u*a+i,u*o-r*l,u*l+r*o,0,u*o+r*l,c*o+i,c*l-r*a,0,u*l-r*o,c*l+r*a,s*l*l+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,a){return this.set(1,i,s,0,e,1,a,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,a=n._y,o=n._z,l=n._w,u=s+s,c=a+a,h=o+o,d=s*u,m=s*c,v=s*h,_=a*c,y=a*h,g=o*h,x=l*u,S=l*c,E=l*h,A=i.x,T=i.y,C=i.z;return r[0]=(1-(_+g))*A,r[1]=(m+E)*A,r[2]=(v-S)*A,r[3]=0,r[4]=(m-E)*T,r[5]=(1-(d+g))*T,r[6]=(y+x)*T,r[7]=0,r[8]=(v+S)*C,r[9]=(y-x)*C,r[10]=(1-(d+_))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=yg.set(r[0],r[1],r[2]).length();const a=yg.set(r[4],r[5],r[6]).length(),o=yg.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Gl.copy(this);const u=1/s,c=1/a,h=1/o;return Gl.elements[0]*=u,Gl.elements[1]*=u,Gl.elements[2]*=u,Gl.elements[4]*=c,Gl.elements[5]*=c,Gl.elements[6]*=c,Gl.elements[8]*=h,Gl.elements[9]*=h,Gl.elements[10]*=h,n.setFromRotationMatrix(Gl),i.x=s,i.y=a,i.z=o,this}makePerspective(e,n,i,r,s,a,o=cl){const l=this.elements,u=2*s/(n-e),c=2*s/(i-r),h=(n+e)/(n-e),d=(i+r)/(i-r);let m,v;if(o===cl)m=-(a+s)/(a-s),v=-2*a*s/(a-s);else if(o===G1)m=-a/(a-s),v=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=u,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=c,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=v,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,n,i,r,s,a,o=cl){const l=this.elements,u=1/(n-e),c=1/(i-r),h=1/(a-s),d=(n+e)*u,m=(i+r)*c;let v,_;if(o===cl)v=(a+s)*h,_=-2*h;else if(o===G1)v=s*h,_=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=_,l[14]=-v,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const yg=new re,Gl=new kn,kq=new re(0,0,0),Fq=new re(1,1,1),Eh=new re,US=new re,bo=new re,$L=new kn,e4=new ra;class Ea{constructor(e=0,n=0,i=0,r=Ea.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,s=r[0],a=r[4],o=r[8],l=r[1],u=r[5],c=r[9],h=r[2],d=r[6],m=r[10];switch(n){case"XYZ":this._y=Math.asin(Jn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,m),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Jn(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Jn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Jn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Jn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(o,m));break;case"XZY":this._z=Math.asin(-Jn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-c,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return $L.makeRotationFromQuaternion(e),this.setFromRotationMatrix($L,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return e4.setFromEuler(this),this.setFromQuaternion(e4,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ea.DEFAULT_ORDER="XYZ";class j0{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Gq=0;const t4=new re,xg=new ra,Vc=new kn,zS=new re,jy=new re,Vq=new re,Hq=new ra,n4=new re(1,0,0),i4=new re(0,1,0),r4=new re(0,0,1),s4={type:"added"},jq={type:"removed"},_g={type:"childadded",child:null},wC={type:"childremoved",child:null};class Ci extends cc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Gq++}),this.uuid=Do(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ci.DEFAULT_UP.clone();const e=new re,n=new Ea,i=new ra,r=new re(1,1,1);function s(){i.setFromEuler(n,!1)}function a(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new kn},normalMatrix:{value:new Qn}}),this.matrix=new kn,this.matrixWorld=new kn,this.matrixAutoUpdate=Ci.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ci.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new j0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return xg.setFromAxisAngle(e,n),this.quaternion.multiply(xg),this}rotateOnWorldAxis(e,n){return xg.setFromAxisAngle(e,n),this.quaternion.premultiply(xg),this}rotateX(e){return this.rotateOnAxis(n4,e)}rotateY(e){return this.rotateOnAxis(i4,e)}rotateZ(e){return this.rotateOnAxis(r4,e)}translateOnAxis(e,n){return t4.copy(e).applyQuaternion(this.quaternion),this.position.add(t4.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(n4,e)}translateY(e){return this.translateOnAxis(i4,e)}translateZ(e){return this.translateOnAxis(r4,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Vc.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?zS.copy(e):zS.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),jy.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Vc.lookAt(jy,zS,this.up):Vc.lookAt(zS,jy,this.up),this.quaternion.setFromRotationMatrix(Vc),r&&(Vc.extractRotation(r.matrixWorld),xg.setFromRotationMatrix(Vc),this.quaternion.premultiply(xg.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(s4),_g.child=e,this.dispatchEvent(_g),_g.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(jq),wC.child=e,this.dispatchEvent(wC),wC.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Vc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Vc.multiply(e.parent.matrixWorld)),e.applyMatrix4(Vc),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(s4),_g.child=e,this.dispatchEvent(_g),_g.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const a=this.children[i].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jy,e,Vq),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jy,Hq,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?{min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}:void 0,boundingSphere:o.boundingSphere?{radius:o.boundingSphere.radius,center:o.boundingSphere.center.toArray()}:void 0})),r.instanceInfo=this._instanceInfo.map(o=>({...o})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,u=this.material.length;l<u;l++)o.push(s(e.materials,this.material[l]));r.material=o}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];r.animations.push(s(e.animations,l))}}if(n){const o=a(e.geometries),l=a(e.materials),u=a(e.textures),c=a(e.images),h=a(e.shapes),d=a(e.skeletons),m=a(e.animations),v=a(e.nodes);o.length>0&&(i.geometries=o),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),c.length>0&&(i.images=c),h.length>0&&(i.shapes=h),d.length>0&&(i.skeletons=d),m.length>0&&(i.animations=m),v.length>0&&(i.nodes=v)}return i.object=r,i;function a(o){const l=[];for(const u in o){const c=o[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Ci.DEFAULT_UP=new re(0,1,0);Ci.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ci.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Vl=new re,Hc=new re,AC=new re,jc=new re,bg=new re,Sg=new re,a4=new re,TC=new re,MC=new re,CC=new re,RC=new bi,DC=new bi,OC=new bi;class no{constructor(e=new re,n=new re,i=new re){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),Vl.subVectors(e,n),r.cross(Vl);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){Vl.subVectors(r,n),Hc.subVectors(i,n),AC.subVectors(e,n);const a=Vl.dot(Vl),o=Vl.dot(Hc),l=Vl.dot(AC),u=Hc.dot(Hc),c=Hc.dot(AC),h=a*u-o*o;if(h===0)return s.set(0,0,0),null;const d=1/h,m=(u*l-o*c)*d,v=(a*c-o*l)*d;return s.set(1-m-v,v,m)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,jc)===null?!1:jc.x>=0&&jc.y>=0&&jc.x+jc.y<=1}static getInterpolation(e,n,i,r,s,a,o,l){return this.getBarycoord(e,n,i,r,jc)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,jc.x),l.addScaledVector(a,jc.y),l.addScaledVector(o,jc.z),l)}static getInterpolatedAttribute(e,n,i,r,s,a){return RC.setScalar(0),DC.setScalar(0),OC.setScalar(0),RC.fromBufferAttribute(e,n),DC.fromBufferAttribute(e,i),OC.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(RC,s.x),a.addScaledVector(DC,s.y),a.addScaledVector(OC,s.z),a}static isFrontFacing(e,n,i,r){return Vl.subVectors(i,n),Hc.subVectors(e,n),Vl.cross(Hc).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Vl.subVectors(this.c,this.b),Hc.subVectors(this.a,this.b),Vl.cross(Hc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return no.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return no.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,r,s){return no.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return no.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return no.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,s=this.c;let a,o;bg.subVectors(r,i),Sg.subVectors(s,i),TC.subVectors(e,i);const l=bg.dot(TC),u=Sg.dot(TC);if(l<=0&&u<=0)return n.copy(i);MC.subVectors(e,r);const c=bg.dot(MC),h=Sg.dot(MC);if(c>=0&&h<=c)return n.copy(r);const d=l*h-c*u;if(d<=0&&l>=0&&c<=0)return a=l/(l-c),n.copy(i).addScaledVector(bg,a);CC.subVectors(e,s);const m=bg.dot(CC),v=Sg.dot(CC);if(v>=0&&m<=v)return n.copy(s);const _=m*u-l*v;if(_<=0&&u>=0&&v<=0)return o=u/(u-v),n.copy(i).addScaledVector(Sg,o);const y=c*v-m*h;if(y<=0&&h-c>=0&&m-v>=0)return a4.subVectors(s,r),o=(h-c)/(h-c+(m-v)),n.copy(r).addScaledVector(a4,o);const g=1/(y+_+d);return a=_*g,o=d*g,n.copy(i).addScaledVector(bg,a).addScaledVector(Sg,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const PG={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},wh={h:0,s:0,l:0},IS={h:0,s:0,l:0};function UC(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}let nn=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=xa){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ei.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=Ei.workingColorSpace){return this.r=e,this.g=n,this.b=i,Ei.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=Ei.workingColorSpace){if(e=RU(e,1),n=Jn(n,0,1),i=Jn(i,0,1),n===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+n):i+n-i*n,a=2*i-s;this.r=UC(a,s,e+1/3),this.g=UC(a,s,e),this.b=UC(a,s,e-1/3)}return Ei.toWorkingColorSpace(this,r),this}setStyle(e,n=xa){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=xa){const i=PG[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=vf(e.r),this.g=vf(e.g),this.b=vf(e.b),this}copyLinearToSRGB(e){return this.r=b0(e.r),this.g=b0(e.g),this.b=b0(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=xa){return Ei.fromWorkingColorSpace(ga.copy(this),e),Math.round(Jn(ga.r*255,0,255))*65536+Math.round(Jn(ga.g*255,0,255))*256+Math.round(Jn(ga.b*255,0,255))}getHexString(e=xa){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Ei.workingColorSpace){Ei.fromWorkingColorSpace(ga.copy(this),n);const i=ga.r,r=ga.g,s=ga.b,a=Math.max(i,r,s),o=Math.min(i,r,s);let l,u;const c=(o+a)/2;if(o===a)l=0,u=0;else{const h=a-o;switch(u=c<=.5?h/(a+o):h/(2-a-o),a){case i:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-i)/h+2;break;case s:l=(i-r)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,n=Ei.workingColorSpace){return Ei.fromWorkingColorSpace(ga.copy(this),n),e.r=ga.r,e.g=ga.g,e.b=ga.b,e}getStyle(e=xa){Ei.fromWorkingColorSpace(ga.copy(this),e);const n=ga.r,i=ga.g,r=ga.b;return e!==xa?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(wh),this.setHSL(wh.h+e,wh.s+n,wh.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(wh),e.getHSL(IS);const i=o1(wh.h,IS.h,n),r=o1(wh.s,IS.s,n),s=o1(wh.l,IS.l,n);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*n+s[3]*i+s[6]*r,this.g=s[1]*n+s[4]*i+s[7]*r,this.b=s[2]*n+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const ga=new nn;nn.NAMES=PG;let Wq=0;class wa extends cc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Wq++}),this.uuid=Do(),this.name="",this.type="Material",this.blending=Np,this.side=Af,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=rw,this.blendDst=sw,this.blendEquation=Fh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new nn(0,0,0),this.blendAlpha=0,this.depthFunc=Kp,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=KR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=_p,this.stencilZFail=_p,this.stencilZPass=_p,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Np&&(i.blending=this.blending),this.side!==Af&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==rw&&(i.blendSrc=this.blendSrc),this.blendDst!==sw&&(i.blendDst=this.blendDst),this.blendEquation!==Fh&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Kp&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==KR&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==_p&&(i.stencilFail=this.stencilFail),this.stencilZFail!==_p&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==_p&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(n){const s=r(e.textures),a=r(e.images);s.length>0&&(i.textures=s),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Lf extends wa{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new nn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ea,this.combine=B_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const rf=Xq();function Xq(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):u<-14?(i[l]=1024>>-u-14,i[l|256]=1024>>-u-14|32768,r[l]=-u-1,r[l|256]=-u-1):u<=15?(i[l]=u+15<<10,i[l|256]=u+15<<10|32768,r[l]=13,r[l|256]=13):u<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,c=0;for(;!(u&8388608);)u<<=1,c-=8388608;u&=-8388609,c+=947912704,s[l]=u|c}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}function Qa(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Jn(t,-65504,65504),rf.floatView[0]=t;const e=rf.uint32View[0],n=e>>23&511;return rf.baseTable[n]+((e&8388607)>>rf.shiftTable[n])}function Dx(t){const e=t>>10;return rf.uint32View[0]=rf.mantissaTable[rf.offsetTable[e]+(t&1023)]+rf.exponentTable[e],rf.floatView[0]}class Yq{static toHalfFloat(e){return Qa(e)}static fromHalfFloat(e){return Dx(e)}}const ds=new re,LS=new Tt;let Zq=0;class Yi{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Zq++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=F1,this.updateRanges=[],this.gpuType=io,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)LS.fromBufferAttribute(this,n),LS.applyMatrix3(e),this.setXY(n,LS.x,LS.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.applyMatrix3(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.applyMatrix4(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.applyNormalMatrix(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.transformDirection(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Ua(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=si(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Ua(n,this.array)),n}setX(e,n){return this.normalized&&(n=si(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Ua(n,this.array)),n}setY(e,n){return this.normalized&&(n=si(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Ua(n,this.array)),n}setZ(e,n){return this.normalized&&(n=si(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Ua(n,this.array)),n}setW(e,n){return this.normalized&&(n=si(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=si(n,this.array),i=si(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=si(n,this.array),i=si(i,this.array),r=si(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=si(n,this.array),i=si(i,this.array),r=si(r,this.array),s=si(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==F1&&(e.usage=this.usage),e}}class qq extends Yi{constructor(e,n,i){super(new Int8Array(e),n,i)}}class Kq extends Yi{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class Qq extends Yi{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class Jq extends Yi{constructor(e,n,i){super(new Int16Array(e),n,i)}}class DU extends Yi{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class $q extends Yi{constructor(e,n,i){super(new Int32Array(e),n,i)}}class OU extends Yi{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class eK extends Yi{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=Dx(this.array[e*this.itemSize]);return this.normalized&&(n=Ua(n,this.array)),n}setX(e,n){return this.normalized&&(n=si(n,this.array)),this.array[e*this.itemSize]=Qa(n),this}getY(e){let n=Dx(this.array[e*this.itemSize+1]);return this.normalized&&(n=Ua(n,this.array)),n}setY(e,n){return this.normalized&&(n=si(n,this.array)),this.array[e*this.itemSize+1]=Qa(n),this}getZ(e){let n=Dx(this.array[e*this.itemSize+2]);return this.normalized&&(n=Ua(n,this.array)),n}setZ(e,n){return this.normalized&&(n=si(n,this.array)),this.array[e*this.itemSize+2]=Qa(n),this}getW(e){let n=Dx(this.array[e*this.itemSize+3]);return this.normalized&&(n=Ua(n,this.array)),n}setW(e,n){return this.normalized&&(n=si(n,this.array)),this.array[e*this.itemSize+3]=Qa(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=si(n,this.array),i=si(i,this.array)),this.array[e+0]=Qa(n),this.array[e+1]=Qa(i),this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=si(n,this.array),i=si(i,this.array),r=si(r,this.array)),this.array[e+0]=Qa(n),this.array[e+1]=Qa(i),this.array[e+2]=Qa(r),this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=si(n,this.array),i=si(i,this.array),r=si(r,this.array),s=si(s,this.array)),this.array[e+0]=Qa(n),this.array[e+1]=Qa(i),this.array[e+2]=Qa(r),this.array[e+3]=Qa(s),this}}class _n extends Yi{constructor(e,n,i){super(new Float32Array(e),n,i)}}let tK=0;const Zo=new kn,zC=new Ci,Eg=new re,So=new bs,Wy=new bs,Gs=new re;class ni extends cc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:tK++}),this.uuid=Do(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(zG(e)?OU:DU)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Qn().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Zo.makeRotationFromQuaternion(e),this.applyMatrix4(Zo),this}rotateX(e){return Zo.makeRotationX(e),this.applyMatrix4(Zo),this}rotateY(e){return Zo.makeRotationY(e),this.applyMatrix4(Zo),this}rotateZ(e){return Zo.makeRotationZ(e),this.applyMatrix4(Zo),this}translate(e,n,i){return Zo.makeTranslation(e,n,i),this.applyMatrix4(Zo),this}scale(e,n,i){return Zo.makeScale(e,n,i),this.applyMatrix4(Zo),this}lookAt(e){return zC.lookAt(e),zC.updateMatrix(),this.applyMatrix4(zC.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Eg).negate(),this.translate(Eg.x,Eg.y,Eg.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];i.push(a.x,a.y,a.z||0)}this.setAttribute("position",new _n(i,3))}else{const i=Math.min(e.length,n.count);for(let r=0;r<i;r++){const s=e[r];n.setXYZ(r,s.x,s.y,s.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new bs);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new re(-1/0,-1/0,-1/0),new re(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const s=n[i];So.setFromBufferAttribute(s),this.morphTargetsRelative?(Gs.addVectors(this.boundingBox.min,So.min),this.boundingBox.expandByPoint(Gs),Gs.addVectors(this.boundingBox.max,So.max),this.boundingBox.expandByPoint(Gs)):(this.boundingBox.expandByPoint(So.min),this.boundingBox.expandByPoint(So.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Us);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new re,1/0);return}if(e){const i=this.boundingSphere.center;if(So.setFromBufferAttribute(e),n)for(let s=0,a=n.length;s<a;s++){const o=n[s];Wy.setFromBufferAttribute(o),this.morphTargetsRelative?(Gs.addVectors(So.min,Wy.min),So.expandByPoint(Gs),Gs.addVectors(So.max,Wy.max),So.expandByPoint(Gs)):(So.expandByPoint(Wy.min),So.expandByPoint(Wy.max))}So.getCenter(i);let r=0;for(let s=0,a=e.count;s<a;s++)Gs.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Gs));if(n)for(let s=0,a=n.length;s<a;s++){const o=n[s],l=this.morphTargetsRelative;for(let u=0,c=o.count;u<c;u++)Gs.fromBufferAttribute(o,u),l&&(Eg.fromBufferAttribute(e,u),Gs.add(Eg)),r=Math.max(r,i.distanceToSquared(Gs))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,r=n.normal,s=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Yi(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let O=0;O<i.count;O++)o[O]=new re,l[O]=new re;const u=new re,c=new re,h=new re,d=new Tt,m=new Tt,v=new Tt,_=new re,y=new re;function g(O,M,D){u.fromBufferAttribute(i,O),c.fromBufferAttribute(i,M),h.fromBufferAttribute(i,D),d.fromBufferAttribute(s,O),m.fromBufferAttribute(s,M),v.fromBufferAttribute(s,D),c.sub(u),h.sub(u),m.sub(d),v.sub(d);const P=1/(m.x*v.y-v.x*m.y);isFinite(P)&&(_.copy(c).multiplyScalar(v.y).addScaledVector(h,-m.y).multiplyScalar(P),y.copy(h).multiplyScalar(m.x).addScaledVector(c,-v.x).multiplyScalar(P),o[O].add(_),o[M].add(_),o[D].add(_),l[O].add(y),l[M].add(y),l[D].add(y))}let x=this.groups;x.length===0&&(x=[{start:0,count:e.count}]);for(let O=0,M=x.length;O<M;++O){const D=x[O],P=D.start,F=D.count;for(let G=P,z=P+F;G<z;G+=3)g(e.getX(G+0),e.getX(G+1),e.getX(G+2))}const S=new re,E=new re,A=new re,T=new re;function C(O){A.fromBufferAttribute(r,O),T.copy(A);const M=o[O];S.copy(M),S.sub(A.multiplyScalar(A.dot(M))).normalize(),E.crossVectors(T,M);const P=E.dot(l[O])<0?-1:1;a.setXYZW(O,S.x,S.y,S.z,P)}for(let O=0,M=x.length;O<M;++O){const D=x[O],P=D.start,F=D.count;for(let G=P,z=P+F;G<z;G+=3)C(e.getX(G+0)),C(e.getX(G+1)),C(e.getX(G+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Yi(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,m=i.count;d<m;d++)i.setXYZ(d,0,0,0);const r=new re,s=new re,a=new re,o=new re,l=new re,u=new re,c=new re,h=new re;if(e)for(let d=0,m=e.count;d<m;d+=3){const v=e.getX(d+0),_=e.getX(d+1),y=e.getX(d+2);r.fromBufferAttribute(n,v),s.fromBufferAttribute(n,_),a.fromBufferAttribute(n,y),c.subVectors(a,s),h.subVectors(r,s),c.cross(h),o.fromBufferAttribute(i,v),l.fromBufferAttribute(i,_),u.fromBufferAttribute(i,y),o.add(c),l.add(c),u.add(c),i.setXYZ(v,o.x,o.y,o.z),i.setXYZ(_,l.x,l.y,l.z),i.setXYZ(y,u.x,u.y,u.z)}else for(let d=0,m=n.count;d<m;d+=3)r.fromBufferAttribute(n,d+0),s.fromBufferAttribute(n,d+1),a.fromBufferAttribute(n,d+2),c.subVectors(a,s),h.subVectors(r,s),c.cross(h),i.setXYZ(d+0,c.x,c.y,c.z),i.setXYZ(d+1,c.x,c.y,c.z),i.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)Gs.fromBufferAttribute(e,n),Gs.normalize(),e.setXYZ(n,Gs.x,Gs.y,Gs.z)}toNonIndexed(){function e(o,l){const u=o.array,c=o.itemSize,h=o.normalized,d=new u.constructor(l.length*c);let m=0,v=0;for(let _=0,y=l.length;_<y;_++){o.isInterleavedBufferAttribute?m=l[_]*o.data.stride+o.offset:m=l[_]*c;for(let g=0;g<c;g++)d[v++]=u[m++]}return new Yi(d,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new ni,i=this.index.array,r=this.attributes;for(const o in r){const l=r[o],u=e(l,i);n.setAttribute(o,u)}const s=this.morphAttributes;for(const o in s){const l=[],u=s[o];for(let c=0,h=u.length;c<h;c++){const d=u[c],m=e(d,i);l.push(m)}n.morphAttributes[o]=l}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const u=a[o];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,d=u.length;h<d;h++){const m=u[h];c.push(m.toJSON(e.data))}c.length>0&&(r[l]=c,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const r=e.attributes;for(const u in r){const c=r[u];this.setAttribute(u,c.clone(n))}const s=e.morphAttributes;for(const u in s){const c=[],h=s[u];for(let d=0,m=h.length;d<m;d++)c.push(h[d].clone(n));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let u=0,c=a.length;u<c;u++){const h=a[u];this.addGroup(h.start,h.count,h.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const o4=new kn,np=new mv,PS=new Us,l4=new re,NS=new re,BS=new re,kS=new re,IC=new re,FS=new re,u4=new re,GS=new re;class vr extends Ci{constructor(e=new ni,n=new Lf){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,a=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(s&&o){FS.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const c=o[l],h=s[l];c!==0&&(IC.fromBufferAttribute(h,e),a?FS.addScaledVector(IC,c):FS.addScaledVector(IC.sub(n),c))}n.add(FS)}return n}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),PS.copy(i.boundingSphere),PS.applyMatrix4(s),np.copy(e.ray).recast(e.near),!(PS.containsPoint(np.origin)===!1&&(np.intersectSphere(PS,l4)===null||np.origin.distanceToSquared(l4)>(e.far-e.near)**2))&&(o4.copy(s).invert(),np.copy(e.ray).applyMatrix4(o4),!(i.boundingBox!==null&&np.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,np)))}_computeIntersections(e,n,i){let r;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,u=s.attributes.uv,c=s.attributes.uv1,h=s.attributes.normal,d=s.groups,m=s.drawRange;if(o!==null)if(Array.isArray(a))for(let v=0,_=d.length;v<_;v++){const y=d[v],g=a[y.materialIndex],x=Math.max(y.start,m.start),S=Math.min(o.count,Math.min(y.start+y.count,m.start+m.count));for(let E=x,A=S;E<A;E+=3){const T=o.getX(E),C=o.getX(E+1),O=o.getX(E+2);r=VS(this,g,e,i,u,c,h,T,C,O),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=y.materialIndex,n.push(r))}}else{const v=Math.max(0,m.start),_=Math.min(o.count,m.start+m.count);for(let y=v,g=_;y<g;y+=3){const x=o.getX(y),S=o.getX(y+1),E=o.getX(y+2);r=VS(this,a,e,i,u,c,h,x,S,E),r&&(r.faceIndex=Math.floor(y/3),n.push(r))}}else if(l!==void 0)if(Array.isArray(a))for(let v=0,_=d.length;v<_;v++){const y=d[v],g=a[y.materialIndex],x=Math.max(y.start,m.start),S=Math.min(l.count,Math.min(y.start+y.count,m.start+m.count));for(let E=x,A=S;E<A;E+=3){const T=E,C=E+1,O=E+2;r=VS(this,g,e,i,u,c,h,T,C,O),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=y.materialIndex,n.push(r))}}else{const v=Math.max(0,m.start),_=Math.min(l.count,m.start+m.count);for(let y=v,g=_;y<g;y+=3){const x=y,S=y+1,E=y+2;r=VS(this,a,e,i,u,c,h,x,S,E),r&&(r.faceIndex=Math.floor(y/3),n.push(r))}}}}function nK(t,e,n,i,r,s,a,o){let l;if(e.side===La?l=i.intersectTriangle(a,s,r,!0,o):l=i.intersectTriangle(r,s,a,e.side===Af,o),l===null)return null;GS.copy(o),GS.applyMatrix4(t.matrixWorld);const u=n.ray.origin.distanceTo(GS);return u<n.near||u>n.far?null:{distance:u,point:GS.clone(),object:t}}function VS(t,e,n,i,r,s,a,o,l,u){t.getVertexPosition(o,NS),t.getVertexPosition(l,BS),t.getVertexPosition(u,kS);const c=nK(t,e,n,i,NS,BS,kS,u4);if(c){const h=new re;no.getBarycoord(u4,NS,BS,kS,h),r&&(c.uv=no.getInterpolatedAttribute(r,o,l,u,h,new Tt)),s&&(c.uv1=no.getInterpolatedAttribute(s,o,l,u,h,new Tt)),a&&(c.normal=no.getInterpolatedAttribute(a,o,l,u,h,new re),c.normal.dot(i.direction)>0&&c.normal.multiplyScalar(-1));const d={a:o,b:l,c:u,normal:new re,materialIndex:0};no.getNormal(NS,BS,kS,d.normal),c.face=d,c.barycoord=h}return c}class Pf extends ni{constructor(e=1,n=1,i=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const l=[],u=[],c=[],h=[];let d=0,m=0;v("z","y","x",-1,-1,i,n,e,a,s,0),v("z","y","x",1,-1,i,n,-e,a,s,1),v("x","z","y",1,1,e,i,n,r,a,2),v("x","z","y",1,-1,e,i,-n,r,a,3),v("x","y","z",1,-1,e,n,i,r,s,4),v("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new _n(u,3)),this.setAttribute("normal",new _n(c,3)),this.setAttribute("uv",new _n(h,2));function v(_,y,g,x,S,E,A,T,C,O,M){const D=E/C,P=A/O,F=E/2,G=A/2,z=T/2,Y=C+1,N=O+1;let k=0,j=0;const X=new re;for(let Q=0;Q<N;Q++){const H=Q*P-G;for(let $=0;$<Y;$++){const ne=$*D-F;X[_]=ne*x,X[y]=H*S,X[g]=z,u.push(X.x,X.y,X.z),X[_]=0,X[y]=0,X[g]=T>0?1:-1,c.push(X.x,X.y,X.z),h.push($/C),h.push(1-Q/O),k+=1}}for(let Q=0;Q<O;Q++)for(let H=0;H<C;H++){const $=d+H+Y*Q,ne=d+H+Y*(Q+1),q=d+(H+1)+Y*(Q+1),se=d+(H+1)+Y*Q;l.push($,ne,se),l.push(ne,q,se),j+=6}o.addGroup(m,j,M),m+=j,d+=k}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Pf(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function W0(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function Da(t){const e={};for(let n=0;n<t.length;n++){const i=W0(t[n]);for(const r in i)e[r]=i[r]}return e}function iK(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function NG(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Ei.workingColorSpace}const UU={clone:W0,merge:Da};var rK=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,sK=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class su extends wa{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=rK,this.fragmentShader=sK,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=W0(e.uniforms),this.uniformsGroups=iK(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?n.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?n.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?n.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?n.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?n.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?n.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?n.uniforms[r]={type:"m4",value:a.toArray()}:n.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class iT extends Ci{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new kn,this.projectionMatrix=new kn,this.projectionMatrixInverse=new kn,this.coordinateSystem=cl}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Ah=new re,c4=new Tt,f4=new Tt;class ys extends iT{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=H0*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Bp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return H0*2*Math.atan(Math.tan(Bp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){Ah.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Ah.x,Ah.y).multiplyScalar(-e/Ah.z),Ah.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Ah.x,Ah.y).multiplyScalar(-e/Ah.z)}getViewSize(e,n){return this.getViewBounds(e,c4,f4),n.subVectors(f4,c4)}setViewOffset(e,n,i,r,s,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(Bp*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,u=a.fullHeight;s+=a.offsetX*r/l,n-=a.offsetY*i/u,r*=a.width/l,i*=a.height/u}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const wg=-90,Ag=1;class BG extends Ci{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new ys(wg,Ag,e,n);r.layers=this.layers,this.add(r);const s=new ys(wg,Ag,e,n);s.layers=this.layers,this.add(s);const a=new ys(wg,Ag,e,n);a.layers=this.layers,this.add(a);const o=new ys(wg,Ag,e,n);o.layers=this.layers,this.add(o);const l=new ys(wg,Ag,e,n);l.layers=this.layers,this.add(l);const u=new ys(wg,Ag,e,n);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,r,s,a,o,l]=n;for(const u of n)this.remove(u);if(e===cl)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===G1)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of n)this.add(u),u.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,u,c]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),v=e.xr.enabled;e.xr.enabled=!1;const _=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(n,s),e.setRenderTarget(i,1,r),e.render(n,a),e.setRenderTarget(i,2,r),e.render(n,o),e.setRenderTarget(i,3,r),e.render(n,l),e.setRenderTarget(i,4,r),e.render(n,u),i.texture.generateMipmaps=_,e.setRenderTarget(i,5,r),e.render(n,c),e.setRenderTarget(h,d,m),e.xr.enabled=v,i.texture.needsPMREMUpdate=!0}}class G_ extends Gr{constructor(e=[],n=Tf,i,r,s,a,o,l,u,c){super(e,n,i,r,s,a,o,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class kG extends sc{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new G_(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:ts}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Pf(5,5,5),s=new su({name:"CubemapFromEquirect",uniforms:W0(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:La,blending:gf});s.uniforms.tEquirect.value=n;const a=new vr(r,s),o=n.minFilter;return n.minFilter===Yu&&(n.minFilter=ts),new BG(1,10,this).update(e,a),n.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,n=!0,i=!0,r=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(n,i,r);e.setRenderTarget(s)}}class c0 extends Ci{constructor(){super(),this.isGroup=!0,this.type="Group"}}const aK={type:"move"};class cE{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new c0,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new c0,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new re,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new re),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new c0,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new re,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new re),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,a=null;const o=this._targetRay,l=this._grip,u=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(u&&e.hand){a=!0;for(const _ of e.hand.values()){const y=n.getJointPose(_,i),g=this._getHandJoint(u,_);y!==null&&(g.matrix.fromArray(y.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=y.radius),g.visible=y!==null}const c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],d=c.position.distanceTo(h.position),m=.02,v=.005;u.inputState.pinching&&d>m+v?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=m-v&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(aK)))}return o!==null&&(o.visible=r!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=a!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new c0;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class rT{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new nn(e),this.density=n}clone(){return new rT(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class sT{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new nn(e),this.near=n,this.far=i}clone(){return new sT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class aT extends Ci{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Ea,this.environmentIntensity=1,this.environmentRotation=new Ea,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class oT{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=F1,this.updateRanges=[],this.version=0,this.uuid=Do()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Do()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Do()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ca=new re;class Qp{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)Ca.fromBufferAttribute(this,n),Ca.applyMatrix4(e),this.setXYZ(n,Ca.x,Ca.y,Ca.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Ca.fromBufferAttribute(this,n),Ca.applyNormalMatrix(e),this.setXYZ(n,Ca.x,Ca.y,Ca.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Ca.fromBufferAttribute(this,n),Ca.transformDirection(e),this.setXYZ(n,Ca.x,Ca.y,Ca.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=Ua(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=si(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=si(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=si(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=si(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=si(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=Ua(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=Ua(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=Ua(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=Ua(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=si(n,this.array),i=si(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=si(n,this.array),i=si(i,this.array),r=si(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=si(n,this.array),i=si(i,this.array),r=si(r,this.array),s=si(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new Yi(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Qp(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class zU extends wa{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new nn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Tg;const Xy=new re,Mg=new re,Cg=new re,Rg=new Tt,Yy=new Tt,FG=new kn,HS=new re,Zy=new re,jS=new re,h4=new Tt,LC=new Tt,d4=new Tt;class GG extends Ci{constructor(e=new zU){if(super(),this.isSprite=!0,this.type="Sprite",Tg===void 0){Tg=new ni;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new oT(n,5);Tg.setIndex([0,1,2,0,2,3]),Tg.setAttribute("position",new Qp(i,3,0,!1)),Tg.setAttribute("uv",new Qp(i,2,3,!1))}this.geometry=Tg,this.material=e,this.center=new Tt(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Mg.setFromMatrixScale(this.matrixWorld),FG.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Cg.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Mg.multiplyScalar(-Cg.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const a=this.center;WS(HS.set(-.5,-.5,0),Cg,a,Mg,r,s),WS(Zy.set(.5,-.5,0),Cg,a,Mg,r,s),WS(jS.set(.5,.5,0),Cg,a,Mg,r,s),h4.set(0,0),LC.set(1,0),d4.set(1,1);let o=e.ray.intersectTriangle(HS,Zy,jS,!1,Xy);if(o===null&&(WS(Zy.set(-.5,.5,0),Cg,a,Mg,r,s),LC.set(0,1),o=e.ray.intersectTriangle(HS,jS,Zy,!1,Xy),o===null))return;const l=e.ray.origin.distanceTo(Xy);l<e.near||l>e.far||n.push({distance:l,point:Xy.clone(),uv:no.getInterpolation(Xy,HS,Zy,jS,h4,LC,d4,new Tt),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function WS(t,e,n,i,r,s){Rg.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(Yy.x=s*Rg.x-r*Rg.y,Yy.y=r*Rg.x+s*Rg.y):Yy.copy(Rg),t.copy(e),t.x+=Yy.x,t.y+=Yy.y,t.applyMatrix4(FG)}const XS=new re,p4=new re;class VG extends Ci{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const r=this.levels;let s;for(s=0;s<r.length&&!(n<r[s].distance);s++);return r.splice(s,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}removeLevel(e){const n=this.levels;for(let i=0;i<n.length;i++)if(n[i].distance===e){const r=n.splice(i,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let s=n[i].distance;if(n[i].object.visible&&(s-=s*n[i].hysteresis),e<s)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){XS.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(XS);this.getObjectForDistance(r).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){XS.setFromMatrixPosition(e.matrixWorld),p4.setFromMatrixPosition(this.matrixWorld);const i=XS.distanceTo(p4)/e.zoom;n[0].object.visible=!0;let r,s;for(r=1,s=n.length;r<s;r++){let a=n[r].distance;if(n[r].object.visible&&(a-=a*n[r].hysteresis),i>=a)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)n[r].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const a=i[r];n.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return n}}const m4=new re,g4=new bi,v4=new bi,oK=new re,y4=new kn,YS=new re,PC=new Us,x4=new kn,NC=new mv;class HG extends vr{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=qR,this.bindMatrix=new kn,this.bindMatrixInverse=new kn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new bs),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,YS),this.boundingBox.expandByPoint(YS)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Us),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,YS),this.boundingSphere.expandByPoint(YS)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),PC.copy(this.boundingSphere),PC.applyMatrix4(r),e.ray.intersectsSphere(PC)!==!1&&(x4.copy(r).invert(),NC.copy(e.ray).applyMatrix4(x4),!(this.boundingBox!==null&&NC.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,NC)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new bi,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===qR?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===_G?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,r=this.geometry;g4.fromBufferAttribute(r.attributes.skinIndex,e),v4.fromBufferAttribute(r.attributes.skinWeight,e),m4.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const a=v4.getComponent(s);if(a!==0){const o=g4.getComponent(s);y4.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),n.addScaledVector(oK.copy(m4).applyMatrix4(y4),a)}}return n.applyMatrix4(this.bindMatrixInverse)}}class IU extends Ci{constructor(){super(),this.isBone=!0,this.type="Bone"}}class $u extends Gr{constructor(e=null,n=1,i=1,r,s,a,o,l,u=ia,c=ia,h,d){super(null,a,o,l,u,c,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _4=new kn,lK=new kn;class lT{constructor(e=[],n=[]){this.uuid=Do(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new kn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new kn;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:lK;_4.multiplyMatrices(o,n[s]),_4.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new lT(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new $u(n,e,e,Sa,io);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let a=n[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new IU),this.bones.push(a),this.boneInverses.push(new kn().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let r=0,s=n.length;r<s;r++){const a=n[r];e.bones.push(a.uuid);const o=i[r];e.boneInverses.push(o.toArray())}return e}}class Jp extends Yi{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Dg=new kn,b4=new kn,ZS=[],S4=new bs,uK=new kn,qy=new vr,Ky=new Us;class jG extends vr{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new Jp(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,uK)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new bs),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Dg),S4.copy(e.boundingBox).applyMatrix4(Dg),this.boundingBox.union(S4)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new Us),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Dg),Ky.copy(e.boundingSphere).applyMatrix4(Dg),this.boundingSphere.union(Ky)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,n){const i=n.morphTargetInfluences,r=this.morphTexture.source.data.data,s=i.length+1,a=e*s+1;for(let o=0;o<i.length;o++)i[o]=r[a+o]}raycast(e,n){const i=this.matrixWorld,r=this.count;if(qy.geometry=this.geometry,qy.material=this.material,qy.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Ky.copy(this.boundingSphere),Ky.applyMatrix4(i),e.ray.intersectsSphere(Ky)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Dg),b4.multiplyMatrices(i,Dg),qy.matrixWorld=b4,qy.raycast(e,ZS);for(let a=0,o=ZS.length;a<o;a++){const l=ZS[a];l.instanceId=s,l.object=this,n.push(l)}ZS.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new Jp(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,n){const i=n.morphTargetInfluences,r=i.length+1;this.morphTexture===null&&(this.morphTexture=new $u(new Float32Array(r*this.count),r,this.count,QA,io));const s=this.morphTexture.source.data.data;let a=0;for(let u=0;u<i.length;u++)a+=i[u];const o=this.geometry.morphTargetsRelative?1:1-a,l=r*e;s[l]=o,s.set(i,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const BC=new re,cK=new re,fK=new Qn;class ef{constructor(e=new re(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=BC.subVectors(i,n).cross(cK.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(BC),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||fK.getNormalMatrix(e),r=this.coplanarPoint(BC).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const ip=new Us,qS=new re;class fm{constructor(e=new ef,n=new ef,i=new ef,r=new ef,s=new ef,a=new ef){this.planes=[e,n,i,r,s,a]}set(e,n,i,r,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(n),o[2].copy(i),o[3].copy(r),o[4].copy(s),o[5].copy(a),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=cl){const i=this.planes,r=e.elements,s=r[0],a=r[1],o=r[2],l=r[3],u=r[4],c=r[5],h=r[6],d=r[7],m=r[8],v=r[9],_=r[10],y=r[11],g=r[12],x=r[13],S=r[14],E=r[15];if(i[0].setComponents(l-s,d-u,y-m,E-g).normalize(),i[1].setComponents(l+s,d+u,y+m,E+g).normalize(),i[2].setComponents(l+a,d+c,y+v,E+x).normalize(),i[3].setComponents(l-a,d-c,y-v,E-x).normalize(),i[4].setComponents(l-o,d-h,y-_,E-S).normalize(),n===cl)i[5].setComponents(l+o,d+h,y+_,E+S).normalize();else if(n===G1)i[5].setComponents(o,h,_,S).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),ip.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),ip.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(ip)}intersectsSprite(e){return ip.center.set(0,0,0),ip.radius=.7071067811865476,ip.applyMatrix4(e.matrixWorld),this.intersectsSphere(ip)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(qS.x=r.normal.x>0?e.max.x:e.min.x,qS.y=r.normal.y>0?e.max.y:e.min.y,qS.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(qS)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Iu=new kn,Lu=new fm;class uT{constructor(){this.coordinateSystem=cl}intersectsObject(e,n){if(!n.isArrayCamera||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(Iu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Lu.setFromProjectionMatrix(Iu,this.coordinateSystem),Lu.intersectsObject(e))return!0}return!1}intersectsSprite(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(Iu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Lu.setFromProjectionMatrix(Iu,this.coordinateSystem),Lu.intersectsSprite(e))return!0}return!1}intersectsSphere(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(Iu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Lu.setFromProjectionMatrix(Iu,this.coordinateSystem),Lu.intersectsSphere(e))return!0}return!1}intersectsBox(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(Iu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Lu.setFromProjectionMatrix(Iu,this.coordinateSystem),Lu.intersectsBox(e))return!0}return!1}containsPoint(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(Iu.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Lu.setFromProjectionMatrix(Iu,this.coordinateSystem),Lu.containsPoint(e))return!0}return!1}clone(){return new uT}}function kC(t,e){return t-e}function hK(t,e){return t.z-e.z}function dK(t,e){return e.z-t.z}class pK{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n,i,r){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o),this.index++,o.start=e,o.count=n,o.z=i,o.index=r}reset(){this.list.length=0,this.index=0}}const Za=new kn,mK=new nn(1,1,1),E4=new fm,gK=new uT,KS=new bs,rp=new Us,Qy=new re,w4=new re,vK=new re,FC=new pK,va=new vr,QS=[];function yK(t,e,n=0){const i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const r=t.count;for(let s=0;s<r;s++)for(let a=0;a<i;a++)e.setComponent(s+n,a,t.getComponent(s,a))}else e.array.set(t.array,n*i);e.needsUpdate=!0}function sp(t,e){if(t.constructor!==e.constructor){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)e[i]=t[i]}else{const n=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,n))}}class WG extends vr{constructor(e,n,i=n*2,r){super(new ni,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=n,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4),i=new $u(n,e,e,Sa,io);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Uint32Array(e*e),i=new $u(n,e,e,k_,Mf);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Float32Array(e*e*4).fill(1),i=new $u(n,e,e,Sa,io);i.colorSpace=Ei.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const n=this.geometry,i=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:o,itemSize:l,normalized:u}=a,c=new o.constructor(i*l),h=new Yi(c,l,u);n.setAttribute(s,h)}if(e.getIndex()!==null){const s=i>65535?new Uint32Array(r):new Uint16Array(r);n.setIndex(new Yi(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const i in n.attributes){if(!e.hasAttribute(i))throw new Error(`THREE.BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=n.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const n=this._instanceInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const n=this._geometryInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new bs);const e=this.boundingBox,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,Za),this.getBoundingBoxAt(s,KS).applyMatrix4(Za),e.union(KS)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Us);const e=this.boundingSphere,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,Za),this.getBoundingSphereAt(s,rp).applyMatrix4(Za),e.union(rp)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const i={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(kC),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=i):(r=this._instanceInfo.length,this._instanceInfo.push(i));const s=this._matricesTexture;Za.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(mK.toArray(a.image.data,r*4),a.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,n=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=n===-1?e.getAttribute("position").count:n;const a=e.getIndex();if(a!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=i===-1?a.count:i),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(kC),l=this._availableGeometryIds.shift(),s[l]=r):(l=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(l,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,l}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);const i=this.geometry,r=i.getIndex()!==null,s=i.getIndex(),a=n.getIndex(),o=this._geometryInfo[e];if(r&&a.count>o.reservedIndexCount||n.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=o.vertexStart,u=o.reservedVertexCount;o.vertexCount=n.getAttribute("position").count;for(const c in i.attributes){const h=n.getAttribute(c),d=i.getAttribute(c);yK(h,d,l);const m=h.itemSize;for(let v=h.count,_=u;v<_;v++){const y=l+v;for(let g=0;g<m;g++)d.setComponent(y,g,0)}d.needsUpdate=!0,d.addUpdateRange(l*m,u*m)}if(r){const c=o.indexStart,h=o.reservedIndexCount;o.indexCount=n.getIndex().count;for(let d=0;d<a.count;d++)s.setX(c+d,l+a.getX(d));for(let d=a.count,m=h;d<m;d++)s.setX(c+d,l);s.needsUpdate=!0,s.addUpdateRange(c,o.reservedIndexCount)}return o.start=r?o.indexStart:o.vertexStart,o.count=r?o.indexCount:o.vertexCount,o.boundingBox=null,n.boundingBox!==null&&(o.boundingBox=n.boundingBox.clone()),o.boundingSphere=null,n.boundingSphere!==null&&(o.boundingSphere=n.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const n=this._geometryInfo;if(e>=n.length||n[e].active===!1)return this;const i=this._instanceInfo;for(let r=0,s=i.length;r<s;r++)i[r].active&&i[r].geometryIndex===e&&this.deleteInstance(r);return n[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,n=0;const i=this._geometryInfo,r=i.map((a,o)=>o).sort((a,o)=>i[a].vertexStart-i[o].vertexStart),s=this.geometry;for(let a=0,o=i.length;a<o;a++){const l=r[a],u=i[l];if(u.active!==!1){if(s.index!==null){if(u.indexStart!==n){const{indexStart:c,vertexStart:h,reservedIndexCount:d}=u,m=s.index,v=m.array,_=e-h;for(let y=c;y<c+d;y++)v[y]=v[y]+_;m.array.copyWithin(n,c,c+d),m.addUpdateRange(n,d),u.indexStart=n}n+=u.reservedIndexCount}if(u.vertexStart!==e){const{vertexStart:c,reservedVertexCount:h}=u,d=s.attributes;for(const m in d){const v=d[m],{array:_,itemSize:y}=v;_.copyWithin(e*y,c*y,(c+h)*y),v.addUpdateRange(e*y,h*y)}u.vertexStart=e}e+=u.reservedVertexCount,u.start=s.index?u.indexStart:u.vertexStart,this._nextIndexStart=s.index?u.indexStart+u.reservedIndexCount:0,this._nextVertexStart=u.vertexStart+u.reservedVertexCount}}return this}getBoundingBoxAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new bs,a=i.index,o=i.attributes.position;for(let l=r.start,u=r.start+r.count;l<u;l++){let c=l;a&&(c=a.getX(c)),s.expandByPoint(Qy.fromBufferAttribute(o,c))}r.boundingBox=s}return n.copy(r.boundingBox),n}getBoundingSphereAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new Us;this.getBoundingBoxAt(e,KS),KS.getCenter(s.center);const a=i.index,o=i.attributes.position;let l=0;for(let u=r.start,c=r.start+r.count;u<c;u++){let h=u;a&&(h=a.getX(h)),Qy.fromBufferAttribute(o,h),l=Math.max(l,s.center.distanceToSquared(Qy))}s.radius=Math.sqrt(l),r.boundingSphere=s}return n.copy(r.boundingSphere),n}setMatrixAt(e,n){this.validateInstanceId(e);const i=this._matricesTexture,r=this._matricesTexture.image.data;return n.toArray(r,e*16),i.needsUpdate=!0,this}getMatrixAt(e,n){return this.validateInstanceId(e),n.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,n){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),n.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,n){return this.validateInstanceId(e),n.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,n){return this.validateInstanceId(e),this._instanceInfo[e].visible===n?this:(this._instanceInfo[e].visible=n,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,n){return this.validateInstanceId(e),this.validateGeometryId(n),this._instanceInfo[e].geometryIndex=n,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,n={}){this.validateGeometryId(e);const i=this._geometryInfo[e];return n.vertexStart=i.vertexStart,n.vertexCount=i.vertexCount,n.reservedVertexCount=i.reservedVertexCount,n.indexStart=i.indexStart,n.indexCount=i.indexCount,n.reservedIndexCount=i.reservedIndexCount,n.start=i.start,n.count=i.count,n}setInstanceCount(e){const n=this._availableInstanceIds,i=this._instanceInfo;for(n.sort(kC);n[n.length-1]===i.length;)i.pop(),n.pop();if(e<i.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);sp(this._multiDrawCounts,r),sp(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,l=this._colorsTexture;a.dispose(),this._initIndirectTexture(),sp(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),sp(o.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),sp(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,n){const i=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...i.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${n}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...i.map(l=>l.indexStart+l.reservedIndexCount))>n)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${n}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=n,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new ni,this._initializeGeometry(s));const a=this.geometry;s.index&&sp(s.index.array,a.index.array);for(const o in s.attributes)sp(s.attributes[o].array,a.attributes[o].array)}raycast(e,n){const i=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,a=this.geometry;va.material=this.material,va.geometry.index=a.index,va.geometry.attributes=a.attributes,va.geometry.boundingBox===null&&(va.geometry.boundingBox=new bs),va.geometry.boundingSphere===null&&(va.geometry.boundingSphere=new Us);for(let o=0,l=i.length;o<l;o++){if(!i[o].visible||!i[o].active)continue;const u=i[o].geometryIndex,c=r[u];va.geometry.setDrawRange(c.start,c.count),this.getMatrixAt(o,va.matrixWorld).premultiply(s),this.getBoundingBoxAt(u,va.geometry.boundingBox),this.getBoundingSphereAt(u,va.geometry.boundingSphere),va.raycast(e,QS);for(let h=0,d=QS.length;h<d;h++){const m=QS[h];m.object=this,m.batchId=o,n.push(m)}QS.length=0}va.material=null,va.geometry.index=null,va.geometry.attributes={},va.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(n=>({...n,boundingBox:n.boundingBox!==null?n.boundingBox.clone():null,boundingSphere:n.boundingSphere!==null?n.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(n=>({...n})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,n,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,l=this._instanceInfo,u=this._multiDrawStarts,c=this._multiDrawCounts,h=this._geometryInfo,d=this.perObjectFrustumCulled,m=this._indirectTexture,v=m.image.data,_=i.isArrayCamera?gK:E4;d&&!i.isArrayCamera&&(Za.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),E4.setFromProjectionMatrix(Za,e.coordinateSystem));let y=0;if(this.sortObjects){Za.copy(this.matrixWorld).invert(),Qy.setFromMatrixPosition(i.matrixWorld).applyMatrix4(Za),w4.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(Za);for(let S=0,E=l.length;S<E;S++)if(l[S].visible&&l[S].active){const A=l[S].geometryIndex;this.getMatrixAt(S,Za),this.getBoundingSphereAt(A,rp).applyMatrix4(Za);let T=!1;if(d&&(T=!_.intersectsSphere(rp,i)),!T){const C=h[A],O=vK.subVectors(rp.center,Qy).dot(w4);FC.push(C.start,C.count,O,S)}}const g=FC.list,x=this.customSort;x===null?g.sort(s.transparent?dK:hK):x.call(this,g,i);for(let S=0,E=g.length;S<E;S++){const A=g[S];u[y]=A.start*o,c[y]=A.count,v[y]=A.index,y++}FC.reset()}else for(let g=0,x=l.length;g<x;g++)if(l[g].visible&&l[g].active){const S=l[g].geometryIndex;let E=!1;if(d&&(this.getMatrixAt(g,Za),this.getBoundingSphereAt(S,rp).applyMatrix4(Za),E=!_.intersectsSphere(rp,i)),!E){const A=h[S];u[y]=A.start*o,c[y]=A.count,v[y]=g,y++}}m.needsUpdate=!0,this._multiDrawCount=y,this._visibilityChanged=!1}onBeforeShadow(e,n,i,r,s,a){this.onBeforeRender(e,null,r,s,a)}}class Na extends wa{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new nn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Fw=new re,Gw=new re,A4=new kn,Jy=new mv,JS=new Us,GC=new re,T4=new re;let ld=class extends Ci{constructor(e=new ni,n=new Na){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)Fw.fromBufferAttribute(n,r-1),Gw.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=Fw.distanceTo(Gw);e.setAttribute("lineDistance",new _n(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),JS.copy(i.boundingSphere),JS.applyMatrix4(r),JS.radius+=s,e.ray.intersectsSphere(JS)===!1)return;A4.copy(r).invert(),Jy.copy(e.ray).applyMatrix4(A4);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,u=this.isLineSegments?2:1,c=i.index,d=i.attributes.position;if(c!==null){const m=Math.max(0,a.start),v=Math.min(c.count,a.start+a.count);for(let _=m,y=v-1;_<y;_+=u){const g=c.getX(_),x=c.getX(_+1),S=$S(this,e,Jy,l,g,x,_);S&&n.push(S)}if(this.isLineLoop){const _=c.getX(v-1),y=c.getX(m),g=$S(this,e,Jy,l,_,y,v-1);g&&n.push(g)}}else{const m=Math.max(0,a.start),v=Math.min(d.count,a.start+a.count);for(let _=m,y=v-1;_<y;_+=u){const g=$S(this,e,Jy,l,_,_+1,_);g&&n.push(g)}if(this.isLineLoop){const _=$S(this,e,Jy,l,v-1,m,v-1);_&&n.push(_)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}};function $S(t,e,n,i,r,s,a){const o=t.geometry.attributes.position;if(Fw.fromBufferAttribute(o,r),Gw.fromBufferAttribute(o,s),n.distanceSqToSegment(Fw,Gw,GC,T4)>i)return;GC.applyMatrix4(t.matrixWorld);const u=e.ray.origin.distanceTo(GC);if(!(u<e.near||u>e.far))return{distance:u,point:T4.clone().applyMatrix4(t.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:t}}const M4=new re,C4=new re;class fc extends ld{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)M4.fromBufferAttribute(n,r),C4.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+M4.distanceTo(C4);e.setAttribute("lineDistance",new _n(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class XG extends ld{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class LU extends wa{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new nn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const R4=new kn,JR=new mv,e2=new Us,t2=new re;class YG extends Ci{constructor(e=new ni,n=new LU){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),e2.copy(i.boundingSphere),e2.applyMatrix4(r),e2.radius+=s,e.ray.intersectsSphere(e2)===!1)return;R4.copy(r).invert(),JR.copy(e.ray).applyMatrix4(R4);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,u=i.index,h=i.attributes.position;if(u!==null){const d=Math.max(0,a.start),m=Math.min(u.count,a.start+a.count);for(let v=d,_=m;v<_;v++){const y=u.getX(v);t2.fromBufferAttribute(h,y),D4(t2,y,l,r,e,n,this)}}else{const d=Math.max(0,a.start),m=Math.min(h.count,a.start+a.count);for(let v=d,_=m;v<_;v++)t2.fromBufferAttribute(h,v),D4(t2,v,l,r,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function D4(t,e,n,i,r,s,a){const o=JR.distanceSqToPoint(t);if(o<n){const l=new re;JR.closestPointToPoint(t,l),l.applyMatrix4(i);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class ZG extends Gr{constructor(e,n,i,r,s=ts,a=ts,o,l,u){super(e,n,i,r,s,a,o,l,u),this.isVideoTexture=!0,this.generateMipmaps=!1;const c=this;function h(){c.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class xK extends ZG{constructor(e,n,i,r,s,a,o,l){super({},e,n,i,r,s,a,o,l),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class _K extends Gr{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=ia,this.minFilter=ia,this.generateMipmaps=!1,this.needsUpdate=!0}}class cT extends Gr{constructor(e,n,i,r,s,a,o,l,u,c,h,d){super(null,a,o,l,u,c,r,s,h,d),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class bK extends cT{constructor(e,n,i,r,s,a){super(e,n,i,s,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=ul,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class SK extends cT{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,Tf),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class EK extends Gr{constructor(e,n,i,r,s,a,o,l,u){super(e,n,i,r,s,a,o,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class fT extends Gr{constructor(e,n,i=Mf,r,s,a,o=ia,l=ia,u,c=G0){if(c!==G0&&c!==V0)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,r,s,a,o,l,c,i,u),this.isDepthTexture=!0,this.image={width:e,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Wh(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class wK extends fT{constructor(e=1,n=1,i=1){super(e,n),this.isDepthArrayTexture=!0,this.image={width:e,height:n,depth:i},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class hT extends ni{constructor(e=1,n=1,i=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:r,heightSegments:s},n=Math.max(0,n),i=Math.max(1,Math.floor(i)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const a=[],o=[],l=[],u=[],c=n/2,h=Math.PI/2*e,d=n,m=2*h+d,v=i*2+s,_=r+1,y=new re,g=new re;for(let x=0;x<=v;x++){let S=0,E=0,A=0,T=0;if(x<=i){const M=x/i,D=M*Math.PI/2;E=-c-e*Math.cos(D),A=e*Math.sin(D),T=-e*Math.cos(D),S=M*h}else if(x<=i+s){const M=(x-i)/s;E=-c+M*n,A=e,T=0,S=h+M*d}else{const M=(x-i-s)/i,D=M*Math.PI/2;E=c+e*Math.sin(D),A=e*Math.cos(D),T=e*Math.sin(D),S=h+d+M*h}const C=Math.max(0,Math.min(1,S/m));let O=0;x===0?O=.5/r:x===v&&(O=-.5/r);for(let M=0;M<=r;M++){const D=M/r,P=D*Math.PI*2,F=Math.sin(P),G=Math.cos(P);g.x=-A*G,g.y=E,g.z=A*F,o.push(g.x,g.y,g.z),y.set(-A*G,T,A*F),y.normalize(),l.push(y.x,y.y,y.z),u.push(D+O,C)}if(x>0){const M=(x-1)*_;for(let D=0;D<r;D++){const P=M+D,F=M+D+1,G=x*_+D,z=x*_+D+1;a.push(P,F,G),a.push(F,z,G)}}}this.setIndex(a),this.setAttribute("position",new _n(o,3)),this.setAttribute("normal",new _n(l,3)),this.setAttribute("uv",new _n(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hT(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class dT extends ni{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);const s=[],a=[],o=[],l=[],u=new re,c=new Tt;a.push(0,0,0),o.push(0,0,1),l.push(.5,.5);for(let h=0,d=3;h<=n;h++,d+=3){const m=i+h/n*r;u.x=e*Math.cos(m),u.y=e*Math.sin(m),a.push(u.x,u.y,u.z),o.push(0,0,1),c.x=(a[d]/e+1)/2,c.y=(a[d+1]/e+1)/2,l.push(c.x,c.y)}for(let h=1;h<=n;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new _n(a,3)),this.setAttribute("normal",new _n(o,3)),this.setAttribute("uv",new _n(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dT(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class gv extends ni{constructor(e=1,n=1,i=1,r=32,s=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const u=this;r=Math.floor(r),s=Math.floor(s);const c=[],h=[],d=[],m=[];let v=0;const _=[],y=i/2;let g=0;x(),a===!1&&(e>0&&S(!0),n>0&&S(!1)),this.setIndex(c),this.setAttribute("position",new _n(h,3)),this.setAttribute("normal",new _n(d,3)),this.setAttribute("uv",new _n(m,2));function x(){const E=new re,A=new re;let T=0;const C=(n-e)/i;for(let O=0;O<=s;O++){const M=[],D=O/s,P=D*(n-e)+e;for(let F=0;F<=r;F++){const G=F/r,z=G*l+o,Y=Math.sin(z),N=Math.cos(z);A.x=P*Y,A.y=-D*i+y,A.z=P*N,h.push(A.x,A.y,A.z),E.set(Y,C,N).normalize(),d.push(E.x,E.y,E.z),m.push(G,1-D),M.push(v++)}_.push(M)}for(let O=0;O<r;O++)for(let M=0;M<s;M++){const D=_[M][O],P=_[M+1][O],F=_[M+1][O+1],G=_[M][O+1];(e>0||M!==0)&&(c.push(D,P,G),T+=3),(n>0||M!==s-1)&&(c.push(P,F,G),T+=3)}u.addGroup(g,T,0),g+=T}function S(E){const A=v,T=new Tt,C=new re;let O=0;const M=E===!0?e:n,D=E===!0?1:-1;for(let F=1;F<=r;F++)h.push(0,y*D,0),d.push(0,D,0),m.push(.5,.5),v++;const P=v;for(let F=0;F<=r;F++){const z=F/r*l+o,Y=Math.cos(z),N=Math.sin(z);C.x=M*N,C.y=y*D,C.z=M*Y,h.push(C.x,C.y,C.z),d.push(0,D,0),T.x=Y*.5+.5,T.y=N*.5*D+.5,m.push(T.x,T.y),v++}for(let F=0;F<r;F++){const G=A+F,z=P+F;E===!0?c.push(z,z+1,G):c.push(z+1,z,G),O+=3}u.addGroup(g,O,E===!0?1:2),g+=O}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gv(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class V_ extends gv{constructor(e=1,n=1,i=32,r=1,s=!1,a=0,o=Math.PI*2){super(0,e,n,i,r,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new V_(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class pd extends ni{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};const s=[],a=[];o(r),u(i),c(),this.setAttribute("position",new _n(s,3)),this.setAttribute("normal",new _n(s.slice(),3)),this.setAttribute("uv",new _n(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function o(x){const S=new re,E=new re,A=new re;for(let T=0;T<n.length;T+=3)m(n[T+0],S),m(n[T+1],E),m(n[T+2],A),l(S,E,A,x)}function l(x,S,E,A){const T=A+1,C=[];for(let O=0;O<=T;O++){C[O]=[];const M=x.clone().lerp(E,O/T),D=S.clone().lerp(E,O/T),P=T-O;for(let F=0;F<=P;F++)F===0&&O===T?C[O][F]=M:C[O][F]=M.clone().lerp(D,F/P)}for(let O=0;O<T;O++)for(let M=0;M<2*(T-O)-1;M++){const D=Math.floor(M/2);M%2===0?(d(C[O][D+1]),d(C[O+1][D]),d(C[O][D])):(d(C[O][D+1]),d(C[O+1][D+1]),d(C[O+1][D]))}}function u(x){const S=new re;for(let E=0;E<s.length;E+=3)S.x=s[E+0],S.y=s[E+1],S.z=s[E+2],S.normalize().multiplyScalar(x),s[E+0]=S.x,s[E+1]=S.y,s[E+2]=S.z}function c(){const x=new re;for(let S=0;S<s.length;S+=3){x.x=s[S+0],x.y=s[S+1],x.z=s[S+2];const E=y(x)/2/Math.PI+.5,A=g(x)/Math.PI+.5;a.push(E,1-A)}v(),h()}function h(){for(let x=0;x<a.length;x+=6){const S=a[x+0],E=a[x+2],A=a[x+4],T=Math.max(S,E,A),C=Math.min(S,E,A);T>.9&&C<.1&&(S<.2&&(a[x+0]+=1),E<.2&&(a[x+2]+=1),A<.2&&(a[x+4]+=1))}}function d(x){s.push(x.x,x.y,x.z)}function m(x,S){const E=x*3;S.x=e[E+0],S.y=e[E+1],S.z=e[E+2]}function v(){const x=new re,S=new re,E=new re,A=new re,T=new Tt,C=new Tt,O=new Tt;for(let M=0,D=0;M<s.length;M+=9,D+=6){x.set(s[M+0],s[M+1],s[M+2]),S.set(s[M+3],s[M+4],s[M+5]),E.set(s[M+6],s[M+7],s[M+8]),T.set(a[D+0],a[D+1]),C.set(a[D+2],a[D+3]),O.set(a[D+4],a[D+5]),A.copy(x).add(S).add(E).divideScalar(3);const P=y(A);_(T,D+0,x,P),_(C,D+2,S,P),_(O,D+4,E,P)}}function _(x,S,E,A){A<0&&x.x===1&&(a[S]=x.x-1),E.x===0&&E.z===0&&(a[S]=A/2/Math.PI+.5)}function y(x){return Math.atan2(x.z,-x.x)}function g(x){return Math.atan2(-x.y,Math.sqrt(x.x*x.x+x.z*x.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pd(e.vertices,e.indices,e.radius,e.details)}}class pT extends pd{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new pT(e.radius,e.detail)}}const n2=new re,i2=new re,VC=new re,r2=new no;class qG extends ni{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const r=Math.pow(10,4),s=Math.cos(Bp*n),a=e.getIndex(),o=e.getAttribute("position"),l=a?a.count:o.count,u=[0,0,0],c=["a","b","c"],h=new Array(3),d={},m=[];for(let v=0;v<l;v+=3){a?(u[0]=a.getX(v),u[1]=a.getX(v+1),u[2]=a.getX(v+2)):(u[0]=v,u[1]=v+1,u[2]=v+2);const{a:_,b:y,c:g}=r2;if(_.fromBufferAttribute(o,u[0]),y.fromBufferAttribute(o,u[1]),g.fromBufferAttribute(o,u[2]),r2.getNormal(VC),h[0]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,h[1]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,h[2]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let x=0;x<3;x++){const S=(x+1)%3,E=h[x],A=h[S],T=r2[c[x]],C=r2[c[S]],O=`${E}_${A}`,M=`${A}_${E}`;M in d&&d[M]?(VC.dot(d[M].normal)<=s&&(m.push(T.x,T.y,T.z),m.push(C.x,C.y,C.z)),d[M]=null):O in d||(d[O]={index0:u[x],index1:u[S],normal:VC.clone()})}}for(const v in d)if(d[v]){const{index0:_,index1:y}=d[v];n2.fromBufferAttribute(o,_),i2.fromBufferAttribute(o,y),m.push(n2.x,n2.y,n2.z),m.push(i2.x,i2.y,i2.z)}this.setAttribute("position",new _n(m,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class uu{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),s=0;n.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n=null){const i=this.getLengths();let r=0;const s=i.length;let a;n?a=n:a=e*i[s-1];let o=0,l=s-1,u;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),u=i[r]-a,u<0)o=r+1;else if(u>0)l=r-1;else{l=r;break}if(r=l,i[r]===a)return r/(s-1);const c=i[r],d=i[r+1]-c,m=(a-c)/d;return(r+m)/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),o=this.getPoint(s),l=n||(a.isVector2?new Tt:new re);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n=!1){const i=new re,r=[],s=[],a=[],o=new re,l=new kn;for(let m=0;m<=e;m++){const v=m/e;r[m]=this.getTangentAt(v,new re)}s[0]=new re,a[0]=new re;let u=Number.MAX_VALUE;const c=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);c<=u&&(u=c,i.set(1,0,0)),h<=u&&(u=h,i.set(0,1,0)),d<=u&&i.set(0,0,1),o.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],o),a[0].crossVectors(r[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),a[m]=a[m-1].clone(),o.crossVectors(r[m-1],r[m]),o.length()>Number.EPSILON){o.normalize();const v=Math.acos(Jn(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(o,v))}a[m].crossVectors(r[m],s[m])}if(n===!0){let m=Math.acos(Jn(s[0].dot(s[e]),-1,1));m/=e,r[0].dot(o.crossVectors(s[0],s[e]))>0&&(m=-m);for(let v=1;v<=e;v++)s[v].applyMatrix4(l.makeRotationAxis(r[v],m*v)),a[v].crossVectors(r[v],s[v])}return{tangents:r,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class mT extends uu{constructor(e=0,n=0,i=1,r=1,s=0,a=Math.PI*2,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=l}getPoint(e,n=new Tt){const i=n,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(a?s=0:s=r),this.aClockwise===!0&&!a&&(s===r?s=-r:s=s-r);const o=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=l-this.aX,m=u-this.aY;l=d*c-m*h+this.aX,u=d*h+m*c+this.aY}return i.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class KG extends mT{constructor(e,n,i,r,s,a){super(e,n,i,i,r,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function PU(){let t=0,e=0,n=0,i=0;function r(s,a,o,l){t=s,e=o,n=-3*s+3*a-2*o-l,i=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,u){r(a,o,u*(o-s),u*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,u,c,h){let d=(a-s)/u-(o-s)/(u+c)+(o-a)/c,m=(o-a)/c-(l-a)/(c+h)+(l-o)/h;d*=c,m*=c,r(a,o,d,m)},calc:function(s){const a=s*s,o=a*s;return t+e*s+n*a+i*o}}}const s2=new re,HC=new PU,jC=new PU,WC=new PU;class QG extends uu{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new re){const i=n,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:l===0&&o===s-1&&(o=s-2,l=1);let u,c;this.closed||o>0?u=r[(o-1)%s]:(s2.subVectors(r[0],r[1]).add(r[0]),u=s2);const h=r[o%s],d=r[(o+1)%s];if(this.closed||o+2<s?c=r[(o+2)%s]:(s2.subVectors(r[s-1],r[s-2]).add(r[s-1]),c=s2),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let v=Math.pow(u.distanceToSquared(h),m),_=Math.pow(h.distanceToSquared(d),m),y=Math.pow(d.distanceToSquared(c),m);_<1e-4&&(_=1),v<1e-4&&(v=_),y<1e-4&&(y=_),HC.initNonuniformCatmullRom(u.x,h.x,d.x,c.x,v,_,y),jC.initNonuniformCatmullRom(u.y,h.y,d.y,c.y,v,_,y),WC.initNonuniformCatmullRom(u.z,h.z,d.z,c.z,v,_,y)}else this.curveType==="catmullrom"&&(HC.initCatmullRom(u.x,h.x,d.x,c.x,this.tension),jC.initCatmullRom(u.y,h.y,d.y,c.y,this.tension),WC.initCatmullRom(u.z,h.z,d.z,c.z,this.tension));return i.set(HC.calc(l),jC.calc(l),WC.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new re().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function O4(t,e,n,i,r){const s=(i-e)*.5,a=(r-n)*.5,o=t*t,l=t*o;return(2*n-2*i+s+a)*l+(-3*n+3*i-2*s-a)*o+s*t+n}function AK(t,e){const n=1-t;return n*n*e}function TK(t,e){return 2*(1-t)*t*e}function MK(t,e){return t*t*e}function l1(t,e,n,i){return AK(t,e)+TK(t,n)+MK(t,i)}function CK(t,e){const n=1-t;return n*n*n*e}function RK(t,e){const n=1-t;return 3*n*n*t*e}function DK(t,e){return 3*(1-t)*t*t*e}function OK(t,e){return t*t*t*e}function u1(t,e,n,i,r){return CK(t,e)+RK(t,n)+DK(t,i)+OK(t,r)}class NU extends uu{constructor(e=new Tt,n=new Tt,i=new Tt,r=new Tt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new Tt){const i=n,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(u1(e,r.x,s.x,a.x,o.x),u1(e,r.y,s.y,a.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class JG extends uu{constructor(e=new re,n=new re,i=new re,r=new re){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new re){const i=n,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(u1(e,r.x,s.x,a.x,o.x),u1(e,r.y,s.y,a.y,o.y),u1(e,r.z,s.z,a.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class BU extends uu{constructor(e=new Tt,n=new Tt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Tt){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Tt){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class kU extends uu{constructor(e=new re,n=new re){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new re){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new re){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class FU extends uu{constructor(e=new Tt,n=new Tt,i=new Tt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Tt){const i=n,r=this.v0,s=this.v1,a=this.v2;return i.set(l1(e,r.x,s.x,a.x),l1(e,r.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gT extends uu{constructor(e=new re,n=new re,i=new re){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new re){const i=n,r=this.v0,s=this.v1,a=this.v2;return i.set(l1(e,r.x,s.x,a.x),l1(e,r.y,s.y,a.y),l1(e,r.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class GU extends uu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Tt){const i=n,r=this.points,s=(r.length-1)*e,a=Math.floor(s),o=s-a,l=r[a===0?a:a-1],u=r[a],c=r[a>r.length-2?r.length-1:a+1],h=r[a>r.length-3?r.length-1:a+2];return i.set(O4(o,l.x,u.x,c.x,h.x),O4(o,l.y,u.y,c.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new Tt().fromArray(r))}return this}}var Vw=Object.freeze({__proto__:null,ArcCurve:KG,CatmullRomCurve3:QG,CubicBezierCurve:NU,CubicBezierCurve3:JG,EllipseCurve:mT,LineCurve:BU,LineCurve3:kU,QuadraticBezierCurve:FU,QuadraticBezierCurve3:gT,SplineCurve:GU});class $G extends uu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Vw[i](n,e))}return this}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const a=r[s]-i,o=this.curves[s],l=o.getLength(),u=l===0?0:1-a/l;return o.getPointAt(u,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,l=a.getPoints(o);for(let u=0;u<l.length;u++){const c=l[u];i&&i.equals(c)||(n.push(c),i=c)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(new Vw[r.type]().fromJSON(r))}return this}}class Hw extends $G{constructor(e){super(),this.type="Path",this.currentPoint=new Tt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new BU(this.currentPoint.clone(),new Tt(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const s=new FU(this.currentPoint.clone(),new Tt(e,n),new Tt(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,a){const o=new NU(this.currentPoint.clone(),new Tt(e,n),new Tt(i,r),new Tt(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new GU(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,a){const o=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+o,n+l,i,r,s,a),this}absarc(e,n,i,r,s,a){return this.absellipse(e,n,i,i,r,s,a),this}ellipse(e,n,i,r,s,a,o,l){const u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,n+c,i,r,s,a,o,l),this}absellipse(e,n,i,r,s,a,o,l){const u=new mT(e,n,i,r,s,a,o,l);if(this.curves.length>0){const h=u.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(u);const c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class kp extends Hw{constructor(e){super(e),this.uuid=Do(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(new Hw().fromJSON(r))}return this}}function UK(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=e8(t,0,r,n,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,u;if(i&&(s=NK(t,e,s,n)),t.length>80*n){o=1/0,l=1/0;let c=-1/0,h=-1/0;for(let d=n;d<r;d+=n){const m=t[d],v=t[d+1];m<o&&(o=m),v<l&&(l=v),m>c&&(c=m),v>h&&(h=v)}u=Math.max(c-o,h-l),u=u!==0?32767/u:0}return H1(s,a,n,o,l,u,0),a}function e8(t,e,n,i,r){let s;if(r===ZK(t,e,n,i)>0)for(let a=e;a<n;a+=i)s=U4(a/i|0,t[a],t[a+1],s);else for(let a=n-i;a>=e;a-=i)s=U4(a/i|0,t[a],t[a+1],s);return s&&X0(s,s.next)&&(W1(s),s=s.next),s}function $p(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(X0(n,n.next)||Nr(n.prev,n,n.next)===0)){if(W1(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function H1(t,e,n,i,r,s,a){if(!t)return;!a&&s&&VK(t,i,r,s);let o=t;for(;t.prev!==t.next;){const l=t.prev,u=t.next;if(s?IK(t,i,r,s):zK(t)){e.push(l.i,t.i,u.i),W1(t),t=u.next,o=u.next;continue}if(t=u,t===o){a?a===1?(t=LK($p(t),e),H1(t,e,n,i,r,s,2)):a===2&&PK(t,e,n,i,r,s):H1($p(t),e,n,i,r,s,1);break}}}function zK(t){const e=t.prev,n=t,i=t.next;if(Nr(e,n,i)>=0)return!1;const r=e.x,s=n.x,a=i.x,o=e.y,l=n.y,u=i.y,c=Math.min(r,s,a),h=Math.min(o,l,u),d=Math.max(r,s,a),m=Math.max(o,l,u);let v=i.next;for(;v!==e;){if(v.x>=c&&v.x<=d&&v.y>=h&&v.y<=m&&Ox(r,o,s,l,a,u,v.x,v.y)&&Nr(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function IK(t,e,n,i){const r=t.prev,s=t,a=t.next;if(Nr(r,s,a)>=0)return!1;const o=r.x,l=s.x,u=a.x,c=r.y,h=s.y,d=a.y,m=Math.min(o,l,u),v=Math.min(c,h,d),_=Math.max(o,l,u),y=Math.max(c,h,d),g=$R(m,v,e,n,i),x=$R(_,y,e,n,i);let S=t.prevZ,E=t.nextZ;for(;S&&S.z>=g&&E&&E.z<=x;){if(S.x>=m&&S.x<=_&&S.y>=v&&S.y<=y&&S!==r&&S!==a&&Ox(o,c,l,h,u,d,S.x,S.y)&&Nr(S.prev,S,S.next)>=0||(S=S.prevZ,E.x>=m&&E.x<=_&&E.y>=v&&E.y<=y&&E!==r&&E!==a&&Ox(o,c,l,h,u,d,E.x,E.y)&&Nr(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;S&&S.z>=g;){if(S.x>=m&&S.x<=_&&S.y>=v&&S.y<=y&&S!==r&&S!==a&&Ox(o,c,l,h,u,d,S.x,S.y)&&Nr(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;E&&E.z<=x;){if(E.x>=m&&E.x<=_&&E.y>=v&&E.y<=y&&E!==r&&E!==a&&Ox(o,c,l,h,u,d,E.x,E.y)&&Nr(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function LK(t,e){let n=t;do{const i=n.prev,r=n.next.next;!X0(i,r)&&n8(i,n,n.next,r)&&j1(i,r)&&j1(r,i)&&(e.push(i.i,n.i,r.i),W1(n),W1(n.next),n=t=r),n=n.next}while(n!==t);return $p(n)}function PK(t,e,n,i,r,s){let a=t;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&WK(a,o)){let l=i8(a,o);a=$p(a,a.next),l=$p(l,l.next),H1(a,e,n,i,r,s,0),H1(l,e,n,i,r,s,0);return}o=o.next}a=a.next}while(a!==t)}function NK(t,e,n,i){const r=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*i,l=s<a-1?e[s+1]*i:t.length,u=e8(t,o,l,i,!1);u===u.next&&(u.steiner=!0),r.push(jK(u))}r.sort(BK);for(let s=0;s<r.length;s++)n=kK(r[s],n);return n}function BK(t,e){let n=t.x-e.x;if(n===0&&(n=t.y-e.y,n===0)){const i=(t.next.y-t.y)/(t.next.x-t.x),r=(e.next.y-e.y)/(e.next.x-e.x);n=i-r}return n}function kK(t,e){const n=FK(t,e);if(!n)return e;const i=i8(n,t);return $p(i,i.next),$p(n,n.next)}function FK(t,e){let n=e;const i=t.x,r=t.y;let s=-1/0,a;if(X0(t,n))return n;do{if(X0(t,n.next))return n.next;if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const h=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(h<=i&&h>s&&(s=h,a=n.x<n.next.x?n:n.next,h===i))return a}n=n.next}while(n!==e);if(!a)return null;const o=a,l=a.x,u=a.y;let c=1/0;n=a;do{if(i>=n.x&&n.x>=l&&i!==n.x&&t8(r<u?i:s,r,l,u,r<u?s:i,r,n.x,n.y)){const h=Math.abs(r-n.y)/(i-n.x);j1(n,t)&&(h<c||h===c&&(n.x>a.x||n.x===a.x&&GK(a,n)))&&(a=n,c=h)}n=n.next}while(n!==o);return a}function GK(t,e){return Nr(t.prev,t,e.prev)<0&&Nr(e.next,t,t.next)<0}function VK(t,e,n,i){let r=t;do r.z===0&&(r.z=$R(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,HK(r)}function HK(t){let e,n=1;do{let i=t,r;t=null;let s=null;for(e=0;i;){e++;let a=i,o=0;for(let u=0;u<n&&(o++,a=a.nextZ,!!a);u++);let l=n;for(;o>0||l>0&&a;)o!==0&&(l===0||!a||i.z<=a.z)?(r=i,i=i.nextZ,o--):(r=a,a=a.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=a}s.nextZ=null,n*=2}while(e>1);return t}function $R(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function jK(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function t8(t,e,n,i,r,s,a,o){return(r-a)*(e-o)>=(t-a)*(s-o)&&(t-a)*(i-o)>=(n-a)*(e-o)&&(n-a)*(s-o)>=(r-a)*(i-o)}function Ox(t,e,n,i,r,s,a,o){return!(t===a&&e===o)&&t8(t,e,n,i,r,s,a,o)}function WK(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!XK(t,e)&&(j1(t,e)&&j1(e,t)&&YK(t,e)&&(Nr(t.prev,t,e.prev)||Nr(t,e.prev,e))||X0(t,e)&&Nr(t.prev,t,t.next)>0&&Nr(e.prev,e,e.next)>0)}function Nr(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function X0(t,e){return t.x===e.x&&t.y===e.y}function n8(t,e,n,i){const r=o2(Nr(t,e,n)),s=o2(Nr(t,e,i)),a=o2(Nr(n,i,t)),o=o2(Nr(n,i,e));return!!(r!==s&&a!==o||r===0&&a2(t,n,e)||s===0&&a2(t,i,e)||a===0&&a2(n,t,i)||o===0&&a2(n,e,i))}function a2(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function o2(t){return t>0?1:t<0?-1:0}function XK(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&n8(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function j1(t,e){return Nr(t.prev,t,t.next)<0?Nr(t,e,t.next)>=0&&Nr(t,t.prev,e)>=0:Nr(t,e,t.prev)<0||Nr(t,t.next,e)<0}function YK(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function i8(t,e){const n=eD(t.i,t.x,t.y),i=eD(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function U4(t,e,n,i){const r=eD(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function W1(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function eD(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function ZK(t,e,n,i){let r=0;for(let s=e,a=n-i;s<n;s+=i)r+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return r}class qK{static triangulate(e,n,i=2){return UK(e,n,i)}}class tu{static area(e){const n=e.length;let i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return tu.area(e)<0}static triangulateShape(e,n){const i=[],r=[],s=[];z4(e),I4(i,e);let a=e.length;n.forEach(z4);for(let l=0;l<n.length;l++)r.push(a),a+=n[l].length,I4(i,n[l]);const o=qK.triangulate(i,r);for(let l=0;l<o.length;l+=3)s.push(o.slice(l,l+3));return s}}function z4(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function I4(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class vT extends ni{constructor(e=new kp([new Tt(.5,.5),new Tt(-.5,.5),new Tt(-.5,-.5),new Tt(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let o=0,l=e.length;o<l;o++){const u=e[o];a(u)}this.setAttribute("position",new _n(r,3)),this.setAttribute("uv",new _n(s,2)),this.computeVertexNormals();function a(o){const l=[],u=n.curveSegments!==void 0?n.curveSegments:12,c=n.steps!==void 0?n.steps:1,h=n.depth!==void 0?n.depth:1;let d=n.bevelEnabled!==void 0?n.bevelEnabled:!0,m=n.bevelThickness!==void 0?n.bevelThickness:.2,v=n.bevelSize!==void 0?n.bevelSize:m-.1,_=n.bevelOffset!==void 0?n.bevelOffset:0,y=n.bevelSegments!==void 0?n.bevelSegments:3;const g=n.extrudePath,x=n.UVGenerator!==void 0?n.UVGenerator:KK;let S,E=!1,A,T,C,O;g&&(S=g.getSpacedPoints(c),E=!0,d=!1,A=g.computeFrenetFrames(c,!1),T=new re,C=new re,O=new re),d||(y=0,m=0,v=0,_=0);const M=o.extractPoints(u);let D=M.shape;const P=M.holes;if(!tu.isClockWise(D)){D=D.reverse();for(let K=0,Pe=P.length;K<Pe;K++){const Ne=P[K];tu.isClockWise(Ne)&&(P[K]=Ne.reverse())}}function G(K){const Ne=10000000000000001e-36;let Ve=K[0];for(let _e=1;_e<=K.length;_e++){const ft=_e%K.length,ke=K[ft],Z=ke.x-Ve.x,W=ke.y-Ve.y,I=Z*Z+W*W,De=Math.max(Math.abs(ke.x),Math.abs(ke.y),Math.abs(Ve.x),Math.abs(Ve.y)),ge=Ne*De*De;if(I<=ge){K.splice(ft,1),_e--;continue}Ve=ke}}G(D),P.forEach(G);const z=P.length,Y=D;for(let K=0;K<z;K++){const Pe=P[K];D=D.concat(Pe)}function N(K,Pe,Ne){return Pe||console.error("THREE.ExtrudeGeometry: vec does not exist"),K.clone().addScaledVector(Pe,Ne)}const k=D.length;function j(K,Pe,Ne){let Ve,_e,ft;const ke=K.x-Pe.x,Z=K.y-Pe.y,W=Ne.x-K.x,I=Ne.y-K.y,De=ke*ke+Z*Z,ge=ke*I-Z*W;if(Math.abs(ge)>Number.EPSILON){const ze=Math.sqrt(De),ct=Math.sqrt(W*W+I*I),at=Pe.x-Z/ze,Rt=Pe.y+ke/ze,Nt=Ne.x-I/ct,vt=Ne.y+W/ct,Vt=((Nt-at)*I-(vt-Rt)*W)/(ke*I-Z*W);Ve=at+ke*Vt-K.x,_e=Rt+Z*Vt-K.y;const Bt=Ve*Ve+_e*_e;if(Bt<=2)return new Tt(Ve,_e);ft=Math.sqrt(Bt/2)}else{let ze=!1;ke>Number.EPSILON?W>Number.EPSILON&&(ze=!0):ke<-Number.EPSILON?W<-Number.EPSILON&&(ze=!0):Math.sign(Z)===Math.sign(I)&&(ze=!0),ze?(Ve=-Z,_e=ke,ft=Math.sqrt(De)):(Ve=ke,_e=Z,ft=Math.sqrt(De/2))}return new Tt(Ve/ft,_e/ft)}const X=[];for(let K=0,Pe=Y.length,Ne=Pe-1,Ve=K+1;K<Pe;K++,Ne++,Ve++)Ne===Pe&&(Ne=0),Ve===Pe&&(Ve=0),X[K]=j(Y[K],Y[Ne],Y[Ve]);const Q=[];let H,$=X.concat();for(let K=0,Pe=z;K<Pe;K++){const Ne=P[K];H=[];for(let Ve=0,_e=Ne.length,ft=_e-1,ke=Ve+1;Ve<_e;Ve++,ft++,ke++)ft===_e&&(ft=0),ke===_e&&(ke=0),H[Ve]=j(Ne[Ve],Ne[ft],Ne[ke]);Q.push(H),$=$.concat(H)}let ne;if(y===0)ne=tu.triangulateShape(Y,P);else{const K=[],Pe=[];for(let Ne=0;Ne<y;Ne++){const Ve=Ne/y,_e=m*Math.cos(Ve*Math.PI/2),ft=v*Math.sin(Ve*Math.PI/2)+_;for(let ke=0,Z=Y.length;ke<Z;ke++){const W=N(Y[ke],X[ke],ft);ot(W.x,W.y,-_e),Ve===0&&K.push(W)}for(let ke=0,Z=z;ke<Z;ke++){const W=P[ke];H=Q[ke];const I=[];for(let De=0,ge=W.length;De<ge;De++){const ze=N(W[De],H[De],ft);ot(ze.x,ze.y,-_e),Ve===0&&I.push(ze)}Ve===0&&Pe.push(I)}}ne=tu.triangulateShape(K,Pe)}const q=ne.length,se=v+_;for(let K=0;K<k;K++){const Pe=d?N(D[K],$[K],se):D[K];E?(C.copy(A.normals[0]).multiplyScalar(Pe.x),T.copy(A.binormals[0]).multiplyScalar(Pe.y),O.copy(S[0]).add(C).add(T),ot(O.x,O.y,O.z)):ot(Pe.x,Pe.y,0)}for(let K=1;K<=c;K++)for(let Pe=0;Pe<k;Pe++){const Ne=d?N(D[Pe],$[Pe],se):D[Pe];E?(C.copy(A.normals[K]).multiplyScalar(Ne.x),T.copy(A.binormals[K]).multiplyScalar(Ne.y),O.copy(S[K]).add(C).add(T),ot(O.x,O.y,O.z)):ot(Ne.x,Ne.y,h/c*K)}for(let K=y-1;K>=0;K--){const Pe=K/y,Ne=m*Math.cos(Pe*Math.PI/2),Ve=v*Math.sin(Pe*Math.PI/2)+_;for(let _e=0,ft=Y.length;_e<ft;_e++){const ke=N(Y[_e],X[_e],Ve);ot(ke.x,ke.y,h+Ne)}for(let _e=0,ft=P.length;_e<ft;_e++){const ke=P[_e];H=Q[_e];for(let Z=0,W=ke.length;Z<W;Z++){const I=N(ke[Z],H[Z],Ve);E?ot(I.x,I.y+S[c-1].y,S[c-1].x+Ne):ot(I.x,I.y,h+Ne)}}}ve(),pe();function ve(){const K=r.length/3;if(d){let Pe=0,Ne=k*Pe;for(let Ve=0;Ve<q;Ve++){const _e=ne[Ve];st(_e[2]+Ne,_e[1]+Ne,_e[0]+Ne)}Pe=c+y*2,Ne=k*Pe;for(let Ve=0;Ve<q;Ve++){const _e=ne[Ve];st(_e[0]+Ne,_e[1]+Ne,_e[2]+Ne)}}else{for(let Pe=0;Pe<q;Pe++){const Ne=ne[Pe];st(Ne[2],Ne[1],Ne[0])}for(let Pe=0;Pe<q;Pe++){const Ne=ne[Pe];st(Ne[0]+k*c,Ne[1]+k*c,Ne[2]+k*c)}}i.addGroup(K,r.length/3-K,0)}function pe(){const K=r.length/3;let Pe=0;xe(Y,Pe),Pe+=Y.length;for(let Ne=0,Ve=P.length;Ne<Ve;Ne++){const _e=P[Ne];xe(_e,Pe),Pe+=_e.length}i.addGroup(K,r.length/3-K,1)}function xe(K,Pe){let Ne=K.length;for(;--Ne>=0;){const Ve=Ne;let _e=Ne-1;_e<0&&(_e=K.length-1);for(let ft=0,ke=c+y*2;ft<ke;ft++){const Z=k*ft,W=k*(ft+1),I=Pe+Ve+Z,De=Pe+_e+Z,ge=Pe+_e+W,ze=Pe+Ve+W;et(I,De,ge,ze)}}}function ot(K,Pe,Ne){l.push(K),l.push(Pe),l.push(Ne)}function st(K,Pe,Ne){Te(K),Te(Pe),Te(Ne);const Ve=r.length/3,_e=x.generateTopUV(i,r,Ve-3,Ve-2,Ve-1);Xe(_e[0]),Xe(_e[1]),Xe(_e[2])}function et(K,Pe,Ne,Ve){Te(K),Te(Pe),Te(Ve),Te(Pe),Te(Ne),Te(Ve);const _e=r.length/3,ft=x.generateSideWallUV(i,r,_e-6,_e-3,_e-2,_e-1);Xe(ft[0]),Xe(ft[1]),Xe(ft[3]),Xe(ft[1]),Xe(ft[2]),Xe(ft[3])}function Te(K){r.push(l[K*3+0]),r.push(l[K*3+1]),r.push(l[K*3+2])}function Xe(K){s.push(K.x),s.push(K.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return QK(n,i,e)}static fromJSON(e,n){const i=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=n[e.shapes[s]];i.push(o)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new Vw[r.type]().fromJSON(r)),new vT(i,e.options)}}const KK={generateTopUV:function(t,e,n,i,r){const s=e[n*3],a=e[n*3+1],o=e[i*3],l=e[i*3+1],u=e[r*3],c=e[r*3+1];return[new Tt(s,a),new Tt(o,l),new Tt(u,c)]},generateSideWallUV:function(t,e,n,i,r,s){const a=e[n*3],o=e[n*3+1],l=e[n*3+2],u=e[i*3],c=e[i*3+1],h=e[i*3+2],d=e[r*3],m=e[r*3+1],v=e[r*3+2],_=e[s*3],y=e[s*3+1],g=e[s*3+2];return Math.abs(o-c)<Math.abs(a-u)?[new Tt(a,1-l),new Tt(u,1-h),new Tt(d,1-v),new Tt(_,1-g)]:[new Tt(o,1-l),new Tt(c,1-h),new Tt(m,1-v),new Tt(y,1-g)]}};function QK(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class yT extends pd{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new yT(e.radius,e.detail)}}class xT extends ni{constructor(e=[new Tt(0,-.5),new Tt(.5,0),new Tt(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=Jn(r,0,Math.PI*2);const s=[],a=[],o=[],l=[],u=[],c=1/n,h=new re,d=new Tt,m=new re,v=new re,_=new re;let y=0,g=0;for(let x=0;x<=e.length-1;x++)switch(x){case 0:y=e[x+1].x-e[x].x,g=e[x+1].y-e[x].y,m.x=g*1,m.y=-y,m.z=g*0,_.copy(m),m.normalize(),l.push(m.x,m.y,m.z);break;case e.length-1:l.push(_.x,_.y,_.z);break;default:y=e[x+1].x-e[x].x,g=e[x+1].y-e[x].y,m.x=g*1,m.y=-y,m.z=g*0,v.copy(m),m.x+=_.x,m.y+=_.y,m.z+=_.z,m.normalize(),l.push(m.x,m.y,m.z),_.copy(v)}for(let x=0;x<=n;x++){const S=i+x*c*r,E=Math.sin(S),A=Math.cos(S);for(let T=0;T<=e.length-1;T++){h.x=e[T].x*E,h.y=e[T].y,h.z=e[T].x*A,a.push(h.x,h.y,h.z),d.x=x/n,d.y=T/(e.length-1),o.push(d.x,d.y);const C=l[3*T+0]*E,O=l[3*T+1],M=l[3*T+0]*A;u.push(C,O,M)}}for(let x=0;x<n;x++)for(let S=0;S<e.length-1;S++){const E=S+x*e.length,A=E,T=E+e.length,C=E+e.length+1,O=E+1;s.push(A,T,O),s.push(C,O,T)}this.setIndex(s),this.setAttribute("position",new _n(a,3)),this.setAttribute("uv",new _n(o,2)),this.setAttribute("normal",new _n(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xT(e.points,e.segments,e.phiStart,e.phiLength)}}class H_ extends pd{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new H_(e.radius,e.detail)}}class Nf extends ni{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const s=e/2,a=n/2,o=Math.floor(i),l=Math.floor(r),u=o+1,c=l+1,h=e/o,d=n/l,m=[],v=[],_=[],y=[];for(let g=0;g<c;g++){const x=g*d-a;for(let S=0;S<u;S++){const E=S*h-s;v.push(E,-x,0),_.push(0,0,1),y.push(S/o),y.push(1-g/l)}}for(let g=0;g<l;g++)for(let x=0;x<o;x++){const S=x+u*g,E=x+u*(g+1),A=x+1+u*(g+1),T=x+1+u*g;m.push(S,E,T),m.push(E,A,T)}this.setIndex(m),this.setAttribute("position",new _n(v,3)),this.setAttribute("normal",new _n(_,3)),this.setAttribute("uv",new _n(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Nf(e.width,e.height,e.widthSegments,e.heightSegments)}}class _T extends ni{constructor(e=.5,n=1,i=32,r=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:a},i=Math.max(3,i),r=Math.max(1,r);const o=[],l=[],u=[],c=[];let h=e;const d=(n-e)/r,m=new re,v=new Tt;for(let _=0;_<=r;_++){for(let y=0;y<=i;y++){const g=s+y/i*a;m.x=h*Math.cos(g),m.y=h*Math.sin(g),l.push(m.x,m.y,m.z),u.push(0,0,1),v.x=(m.x/n+1)/2,v.y=(m.y/n+1)/2,c.push(v.x,v.y)}h+=d}for(let _=0;_<r;_++){const y=_*(i+1);for(let g=0;g<i;g++){const x=g+y,S=x,E=x+i+1,A=x+i+2,T=x+1;o.push(S,E,T),o.push(E,A,T)}}this.setIndex(o),this.setAttribute("position",new _n(l,3)),this.setAttribute("normal",new _n(u,3)),this.setAttribute("uv",new _n(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _T(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class bT extends ni{constructor(e=new kp([new Tt(0,.5),new Tt(-.5,-.5),new Tt(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],s=[],a=[];let o=0,l=0;if(Array.isArray(e)===!1)u(e);else for(let c=0;c<e.length;c++)u(e[c]),this.addGroup(o,l,c),o+=l,l=0;this.setIndex(i),this.setAttribute("position",new _n(r,3)),this.setAttribute("normal",new _n(s,3)),this.setAttribute("uv",new _n(a,2));function u(c){const h=r.length/3,d=c.extractPoints(n);let m=d.shape;const v=d.holes;tu.isClockWise(m)===!1&&(m=m.reverse());for(let y=0,g=v.length;y<g;y++){const x=v[y];tu.isClockWise(x)===!0&&(v[y]=x.reverse())}const _=tu.triangulateShape(m,v);for(let y=0,g=v.length;y<g;y++){const x=v[y];m=m.concat(x)}for(let y=0,g=m.length;y<g;y++){const x=m[y];r.push(x.x,x.y,0),s.push(0,0,1),a.push(x.x,x.y)}for(let y=0,g=_.length;y<g;y++){const x=_[y],S=x[0]+h,E=x[1]+h,A=x[2]+h;i.push(S,E,A),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return JK(n,e)}static fromJSON(e,n){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const a=n[e.shapes[r]];i.push(a)}return new bT(i,e.curveSegments)}}function JK(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class j_ extends ni{constructor(e=1,n=32,i=16,r=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:a,thetaLength:o},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const l=Math.min(a+o,Math.PI);let u=0;const c=[],h=new re,d=new re,m=[],v=[],_=[],y=[];for(let g=0;g<=i;g++){const x=[],S=g/i;let E=0;g===0&&a===0?E=.5/n:g===i&&l===Math.PI&&(E=-.5/n);for(let A=0;A<=n;A++){const T=A/n;h.x=-e*Math.cos(r+T*s)*Math.sin(a+S*o),h.y=e*Math.cos(a+S*o),h.z=e*Math.sin(r+T*s)*Math.sin(a+S*o),v.push(h.x,h.y,h.z),d.copy(h).normalize(),_.push(d.x,d.y,d.z),y.push(T+E,1-S),x.push(u++)}c.push(x)}for(let g=0;g<i;g++)for(let x=0;x<n;x++){const S=c[g][x+1],E=c[g][x],A=c[g+1][x],T=c[g+1][x+1];(g!==0||a>0)&&m.push(S,E,T),(g!==i-1||l<Math.PI)&&m.push(E,A,T)}this.setIndex(m),this.setAttribute("position",new _n(v,3)),this.setAttribute("normal",new _n(_,3)),this.setAttribute("uv",new _n(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new j_(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class ST extends pd{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new ST(e.radius,e.detail)}}class ET extends ni{constructor(e=1,n=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const a=[],o=[],l=[],u=[],c=new re,h=new re,d=new re;for(let m=0;m<=i;m++)for(let v=0;v<=r;v++){const _=v/r*s,y=m/i*Math.PI*2;h.x=(e+n*Math.cos(y))*Math.cos(_),h.y=(e+n*Math.cos(y))*Math.sin(_),h.z=n*Math.sin(y),o.push(h.x,h.y,h.z),c.x=e*Math.cos(_),c.y=e*Math.sin(_),d.subVectors(h,c).normalize(),l.push(d.x,d.y,d.z),u.push(v/r),u.push(m/i)}for(let m=1;m<=i;m++)for(let v=1;v<=r;v++){const _=(r+1)*m+v-1,y=(r+1)*(m-1)+v-1,g=(r+1)*(m-1)+v,x=(r+1)*m+v;a.push(_,y,x),a.push(y,g,x)}this.setIndex(a),this.setAttribute("position",new _n(o,3)),this.setAttribute("normal",new _n(l,3)),this.setAttribute("uv",new _n(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ET(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class wT extends ni{constructor(e=1,n=.4,i=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:a},i=Math.floor(i),r=Math.floor(r);const o=[],l=[],u=[],c=[],h=new re,d=new re,m=new re,v=new re,_=new re,y=new re,g=new re;for(let S=0;S<=i;++S){const E=S/i*s*Math.PI*2;x(E,s,a,e,m),x(E+.01,s,a,e,v),y.subVectors(v,m),g.addVectors(v,m),_.crossVectors(y,g),g.crossVectors(_,y),_.normalize(),g.normalize();for(let A=0;A<=r;++A){const T=A/r*Math.PI*2,C=-n*Math.cos(T),O=n*Math.sin(T);h.x=m.x+(C*g.x+O*_.x),h.y=m.y+(C*g.y+O*_.y),h.z=m.z+(C*g.z+O*_.z),l.push(h.x,h.y,h.z),d.subVectors(h,m).normalize(),u.push(d.x,d.y,d.z),c.push(S/i),c.push(A/r)}}for(let S=1;S<=i;S++)for(let E=1;E<=r;E++){const A=(r+1)*(S-1)+(E-1),T=(r+1)*S+(E-1),C=(r+1)*S+E,O=(r+1)*(S-1)+E;o.push(A,T,O),o.push(T,C,O)}this.setIndex(o),this.setAttribute("position",new _n(l,3)),this.setAttribute("normal",new _n(u,3)),this.setAttribute("uv",new _n(c,2));function x(S,E,A,T,C){const O=Math.cos(S),M=Math.sin(S),D=A/E*S,P=Math.cos(D);C.x=T*(2+P)*.5*O,C.y=T*(2+P)*M*.5,C.z=T*Math.sin(D)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wT(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class em extends ni{constructor(e=new gT(new re(-1,-1,0),new re(-1,1,0),new re(1,1,0)),n=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s};const a=e.computeFrenetFrames(n,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new re,l=new re,u=new Tt;let c=new re;const h=[],d=[],m=[],v=[];_(),this.setIndex(v),this.setAttribute("position",new _n(h,3)),this.setAttribute("normal",new _n(d,3)),this.setAttribute("uv",new _n(m,2));function _(){for(let S=0;S<n;S++)y(S);y(s===!1?n:0),x(),g()}function y(S){c=e.getPointAt(S/n,c);const E=a.normals[S],A=a.binormals[S];for(let T=0;T<=r;T++){const C=T/r*Math.PI*2,O=Math.sin(C),M=-Math.cos(C);l.x=M*E.x+O*A.x,l.y=M*E.y+O*A.y,l.z=M*E.z+O*A.z,l.normalize(),d.push(l.x,l.y,l.z),o.x=c.x+i*l.x,o.y=c.y+i*l.y,o.z=c.z+i*l.z,h.push(o.x,o.y,o.z)}}function g(){for(let S=1;S<=n;S++)for(let E=1;E<=r;E++){const A=(r+1)*(S-1)+(E-1),T=(r+1)*S+(E-1),C=(r+1)*S+E,O=(r+1)*(S-1)+E;v.push(A,T,O),v.push(T,C,O)}}function x(){for(let S=0;S<=n;S++)for(let E=0;E<=r;E++)u.x=S/n,u.y=E/r,m.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new em(new Vw[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class r8 extends ni{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new re,s=new re;if(e.index!==null){const a=e.attributes.position,o=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:o.count,materialIndex:0}]);for(let u=0,c=l.length;u<c;++u){const h=l[u],d=h.start,m=h.count;for(let v=d,_=d+m;v<_;v+=3)for(let y=0;y<3;y++){const g=o.getX(v+y),x=o.getX(v+(y+1)%3);r.fromBufferAttribute(a,g),s.fromBufferAttribute(a,x),L4(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,l=a.count/3;o<l;o++)for(let u=0;u<3;u++){const c=3*o+u,h=3*o+(u+1)%3;r.fromBufferAttribute(a,c),s.fromBufferAttribute(a,h),L4(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new _n(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function L4(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}var P4=Object.freeze({__proto__:null,BoxGeometry:Pf,CapsuleGeometry:hT,CircleGeometry:dT,ConeGeometry:V_,CylinderGeometry:gv,DodecahedronGeometry:pT,EdgesGeometry:qG,ExtrudeGeometry:vT,IcosahedronGeometry:yT,LatheGeometry:xT,OctahedronGeometry:H_,PlaneGeometry:Nf,PolyhedronGeometry:pd,RingGeometry:_T,ShapeGeometry:bT,SphereGeometry:j_,TetrahedronGeometry:ST,TorusGeometry:ET,TorusKnotGeometry:wT,TubeGeometry:em,WireframeGeometry:r8});class s8 extends wa{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new nn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class a8 extends su{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class VU extends wa{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new nn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dd,this.normalScale=new Tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ea,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class o8 extends VU{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Tt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Jn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new nn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new nn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new nn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class l8 extends wa{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new nn(16777215),this.specular=new nn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dd,this.normalScale=new Tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ea,this.combine=B_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class u8 extends wa{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new nn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dd,this.normalScale=new Tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class c8 extends wa{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dd,this.normalScale=new Tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class f8 extends wa{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new nn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dd,this.normalScale=new Tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ea,this.combine=B_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class AT extends wa{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=wG,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class TT extends wa{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class h8 extends wa{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new nn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dd,this.normalScale=new Tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class d8 extends Na{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Mp(t,e){return!t||t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function p8(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function m8(t){function e(r,s){return t[r]-t[s]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function tD(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,a=0;a!==i;++s){const o=n[s]*e;for(let l=0;l!==e;++l)r[a++]=t[o+l]}return r}function HU(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(e.push(s.time),n.push(...a)),s=t[r++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(e.push(s.time),a.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do a=s[i],a!==void 0&&(e.push(s.time),n.push(a)),s=t[r++];while(s!==void 0)}function $K(t,e,n,i,r=30){const s=t.clone();s.name=e;const a=[];for(let l=0;l<s.tracks.length;++l){const u=s.tracks[l],c=u.getValueSize(),h=[],d=[];for(let m=0;m<u.times.length;++m){const v=u.times[m]*r;if(!(v<n||v>=i)){h.push(u.times[m]);for(let _=0;_<c;++_)d.push(u.values[m*c+_])}}h.length!==0&&(u.times=Mp(h,u.times.constructor),u.values=Mp(d,u.values.constructor),a.push(u))}s.tracks=a;let o=1/0;for(let l=0;l<s.tracks.length;++l)o>s.tracks[l].times[0]&&(o=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*o);return s.resetDuration(),s}function eQ(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let a=0;a<r;++a){const o=n.tracks[a],l=o.ValueTypeName;if(l==="bool"||l==="string")continue;const u=t.tracks.find(function(g){return g.name===o.name&&g.ValueTypeName===l});if(u===void 0)continue;let c=0;const h=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=h/3);let d=0;const m=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=m/3);const v=o.times.length-1;let _;if(s<=o.times[0]){const g=c,x=h-c;_=o.values.slice(g,x)}else if(s>=o.times[v]){const g=v*h+c,x=g+h-c;_=o.values.slice(g,x)}else{const g=o.createInterpolant(),x=c,S=h-c;g.evaluate(s),_=g.resultBuffer.slice(x,S)}l==="quaternion"&&new ra().fromArray(_).normalize().conjugate().toArray(_);const y=u.times.length;for(let g=0;g<y;++g){const x=g*m+d;if(l==="quaternion")ra.multiplyQuaternionsFlat(u.values,x,_,0,u.values,x);else{const S=m-d*2;for(let E=0;E<S;++E)u.values[x+E]-=_[E]}}}return t.blendMode=TU,t}class tQ{static convertArray(e,n){return Mp(e,n)}static isTypedArray(e){return p8(e)}static getKeyframeOrder(e){return m8(e)}static sortedArray(e,n,i){return tD(e,n,i)}static flattenJSON(e,n,i,r){HU(e,n,i,r)}static subclip(e,n,i,r,s=30){return $K(e,n,i,r,s)}static makeClipAdditive(e,n=0,i=e,r=30){return eQ(e,n,i,r)}}class W_{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let a;n:{i:if(!(e<r)){for(let o=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(s=r,r=n[++i],e<r)break t}a=n.length;break n}if(!(e>=s)){const o=n[1];e<o&&(i=2,s=o);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=n[--i-1],e>=s)break t}a=i,i=0;break n}break e}for(;i<a;){const o=i+a>>>1;e<n[o]?a=o:i=o+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)n[a]=i[s+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class g8 extends W_{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ap,endingEnd:Ap}}intervalChanged_(e,n,i){const r=this.parameterPositions;let s=e-2,a=e+1,o=r[s],l=r[a];if(o===void 0)switch(this.getSettings_().endingStart){case Tp:s=e,o=2*n-i;break;case B1:s=r.length-2,o=n+r[s]-r[s+1];break;default:s=e,o=i}if(l===void 0)switch(this.getSettings_().endingEnd){case Tp:a=e,l=2*i-n;break;case B1:a=1,l=i+r[1]-r[0];break;default:a=e-1,l=n}const u=(i-n)*.5,c=this.valueSize;this._weightPrev=u/(n-o),this._weightNext=u/(l-i),this._offsetPrev=s*c,this._offsetNext=a*c}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,u=l-o,c=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,m=this._weightNext,v=(i-n)/(r-n),_=v*v,y=_*v,g=-d*y+2*d*_-d*v,x=(1+d)*y+(-1.5-2*d)*_+(-.5+d)*v+1,S=(-1-m)*y+(1.5+m)*_+.5*v,E=m*y-m*_;for(let A=0;A!==o;++A)s[A]=g*a[c+A]+x*a[u+A]+S*a[l+A]+E*a[h+A];return s}}class jU extends W_{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,u=l-o,c=(i-n)/(r-n),h=1-c;for(let d=0;d!==o;++d)s[d]=a[u+d]*h+a[l+d]*c;return s}}class v8 extends W_{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class yl{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Mp(n,this.TimeBufferType),this.values=Mp(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:Mp(e.times,Array),values:Mp(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new v8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new jU(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new g8(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case N1:n=this.InterpolantFactoryMethodDiscrete;break;case kw:n=this.InterpolantFactoryMethodLinear;break;case lE:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return N1;case this.InterpolantFactoryMethodLinear:return kw;case this.InterpolantFactoryMethodSmooth:return lE}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let s=0,a=r-1;for(;s!==r&&i[s]<e;)++s;for(;a!==-1&&i[a]>n;)--a;if(++a,s!==0||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=i.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const l=i[o];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,l),e=!1;break}if(a!==null&&a>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,l,a),e=!1;break}a=l}if(r!==void 0&&p8(r))for(let o=0,l=r.length;o!==l;++o){const u=r[o];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===lE,s=e.length-1;let a=1;for(let o=1;o<s;++o){let l=!1;const u=e[o],c=e[o+1];if(u!==c&&(o!==1||u!==e[0]))if(r)l=!0;else{const h=o*i,d=h-i,m=h+i;for(let v=0;v!==i;++v){const _=n[h+v];if(_!==n[d+v]||_!==n[m+v]){l=!0;break}}}if(l){if(o!==a){e[a]=e[o];const h=o*i,d=a*i;for(let m=0;m!==i;++m)n[d+m]=n[h+m]}++a}}if(s>0){e[a]=e[s];for(let o=s*i,l=a*i,u=0;u!==i;++u)n[l+u]=n[o+u];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=n.slice(0,a*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}yl.prototype.ValueTypeName="";yl.prototype.TimeBufferType=Float32Array;yl.prototype.ValueBufferType=Float32Array;yl.prototype.DefaultInterpolation=kw;class hm extends yl{constructor(e,n,i){super(e,n,i)}}hm.prototype.ValueTypeName="bool";hm.prototype.ValueBufferType=Array;hm.prototype.DefaultInterpolation=N1;hm.prototype.InterpolantFactoryMethodLinear=void 0;hm.prototype.InterpolantFactoryMethodSmooth=void 0;class WU extends yl{constructor(e,n,i,r){super(e,n,i,r)}}WU.prototype.ValueTypeName="color";class X1 extends yl{constructor(e,n,i,r){super(e,n,i,r)}}X1.prototype.ValueTypeName="number";class y8 extends W_{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=(i-n)/(r-n);let u=e*o;for(let c=u+o;u!==c;u+=4)ra.slerpFlat(s,0,a,u-o,a,u,l);return s}}class X_ extends yl{constructor(e,n,i,r){super(e,n,i,r)}InterpolantFactoryMethodLinear(e){return new y8(this.times,this.values,this.getValueSize(),e)}}X_.prototype.ValueTypeName="quaternion";X_.prototype.InterpolantFactoryMethodSmooth=void 0;class dm extends yl{constructor(e,n,i){super(e,n,i)}}dm.prototype.ValueTypeName="string";dm.prototype.ValueBufferType=Array;dm.prototype.DefaultInterpolation=N1;dm.prototype.InterpolantFactoryMethodLinear=void 0;dm.prototype.InterpolantFactoryMethodSmooth=void 0;class Y1 extends yl{constructor(e,n,i,r){super(e,n,i,r)}}Y1.prototype.ValueTypeName="vector";class Z1{constructor(e="",n=-1,i=[],r=eT){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=Do(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let a=0,o=i.length;a!==o;++a)n.push(iQ(i[a]).scale(r));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=i.length;s!==a;++s)n.push(yl.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const s=n.length,a=[];for(let o=0;o<s;o++){let l=[],u=[];l.push((o+s-1)%s,o,(o+1)%s),u.push(0,1,0);const c=m8(l);l=tD(l,1,c),u=tD(u,1,c),!r&&l[0]===0&&(l.push(s),u.push(u[0])),a.push(new X1(".morphTargetInfluences["+n[o].name+"]",l,u).scale(1/i))}return new this(e,-1,a)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,l=e.length;o<l;o++){const u=e[o],c=u.name.match(s);if(c&&c.length>1){const h=c[1];let d=r[h];d||(r[h]=d=[]),d.push(u)}}const a=[];for(const o in r)a.push(this.CreateFromMorphTargetSequence(o,r[o],n,i));return a}static parseAnimation(e,n){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,d,m,v,_){if(m.length!==0){const y=[],g=[];HU(m,y,g,v),y.length!==0&&_.push(new h(d,y,g))}},r=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let h=0;h<u.length;h++){const d=u[h].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const m={};let v;for(v=0;v<d.length;v++)if(d[v].morphTargets)for(let _=0;_<d[v].morphTargets.length;_++)m[d[v].morphTargets[_]]=-1;for(const _ in m){const y=[],g=[];for(let x=0;x!==d[v].morphTargets.length;++x){const S=d[v];y.push(S.time),g.push(S.morphTarget===_?1:0)}r.push(new X1(".morphTargetInfluence["+_+"]",y,g))}l=m.length*a}else{const m=".bones["+n[h].name+"]";i(Y1,m+".position",d,"pos",r),i(X_,m+".quaternion",d,"rot",r),i(Y1,m+".scale",d,"scl",r)}}return r.length===0?null:new this(s,l,r,o)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function nQ(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return X1;case"vector":case"vector2":case"vector3":case"vector4":return Y1;case"color":return WU;case"quaternion":return X_;case"bool":case"boolean":return hm;case"string":return dm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function iQ(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=nQ(t.type);if(t.times===void 0){const n=[],i=[];HU(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const ff={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class XU{constructor(e,n,i){const r=this;let s=!1,a=0,o=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(c){o++,s===!1&&r.onStart!==void 0&&r.onStart(c,a,o),s=!0},this.itemEnd=function(c){a++,r.onProgress!==void 0&&r.onProgress(c,a,o),a===o&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(c){r.onError!==void 0&&r.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,h){return u.push(c,h),this},this.removeHandler=function(c){const h=u.indexOf(c);return h!==-1&&u.splice(h,2),this},this.getHandler=function(c){for(let h=0,d=u.length;h<d;h+=2){const m=u[h],v=u[h+1];if(m.global&&(m.lastIndex=0),m.test(c))return v}return null}}}const x8=new XU;class lo{constructor(e){this.manager=e!==void 0?e:x8,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}lo.DEFAULT_MATERIAL_NAME="__DEFAULT";const Wc={};class rQ extends Error{constructor(e,n){super(e),this.response=n}}class Cf extends lo{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=ff.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(Wc[e]!==void 0){Wc[e].push({onLoad:n,onProgress:i,onError:r});return}Wc[e]=[],Wc[e].push({onLoad:n,onProgress:i,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,l=this.responseType;fetch(a).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const c=Wc[e],h=u.body.getReader(),d=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),m=d?parseInt(d):0,v=m!==0;let _=0;const y=new ReadableStream({start(g){x();function x(){h.read().then(({done:S,value:E})=>{if(S)g.close();else{_+=E.byteLength;const A=new ProgressEvent("progress",{lengthComputable:v,loaded:_,total:m});for(let T=0,C=c.length;T<C;T++){const O=c[T];O.onProgress&&O.onProgress(A)}g.enqueue(E),x()}},S=>{g.error(S)})}}});return new Response(y)}else throw new rQ(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,o));case"json":return u.json();default:if(o==="")return u.text();{const h=/charset="?([^;"\s]*)"?/i.exec(o),d=h&&h[1]?h[1].toLowerCase():void 0,m=new TextDecoder(d);return u.arrayBuffer().then(v=>m.decode(v))}}}).then(u=>{ff.add(e,u);const c=Wc[e];delete Wc[e];for(let h=0,d=c.length;h<d;h++){const m=c[h];m.onLoad&&m.onLoad(u)}}).catch(u=>{const c=Wc[e];if(c===void 0)throw this.manager.itemError(e),u;delete Wc[e];for(let h=0,d=c.length;h<d;h++){const m=c[h];m.onError&&m.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class sQ extends lo{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new Cf(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n=[];for(let i=0;i<e.length;i++){const r=Z1.parse(e[i]);n.push(r)}return n}}class aQ extends lo{constructor(e){super(e)}load(e,n,i,r){const s=this,a=[],o=new cT,l=new Cf(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let u=0;function c(h){l.load(e[h],function(d){const m=s.parse(d,!0);a[h]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},u+=1,u===6&&(m.mipmapCount===1&&(o.minFilter=ts),o.image=a,o.format=m.format,o.needsUpdate=!0,n&&n(o))},i,r)}if(Array.isArray(e))for(let h=0,d=e.length;h<d;++h)c(h);else l.load(e,function(h){const d=s.parse(h,!0);if(d.isCubemap){const m=d.mipmaps.length/d.mipmapCount;for(let v=0;v<m;v++){a[v]={mipmaps:[]};for(let _=0;_<d.mipmapCount;_++)a[v].mipmaps.push(d.mipmaps[v*d.mipmapCount+_]),a[v].format=d.format,a[v].width=d.width,a[v].height=d.height}o.image=a}else o.image.width=d.width,o.image.height=d.height,o.mipmaps=d.mipmaps;d.mipmapCount===1&&(o.minFilter=ts),o.format=d.format,o.needsUpdate=!0,n&&n(o)},i,r);return o}}class q1 extends lo{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=ff.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a;const o=V1("img");function l(){c(),ff.add(e,this),n&&n(this),s.manager.itemEnd(e)}function u(h){c(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function c(){o.removeEventListener("load",l,!1),o.removeEventListener("error",u,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class oQ extends lo{constructor(e){super(e)}load(e,n,i,r){const s=new G_;s.colorSpace=xa;const a=new q1(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function l(u){a.load(e[u],function(c){s.images[u]=c,o++,o===6&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let u=0;u<e.length;++u)l(u);return s}}class lQ extends lo{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new $u,o=new Cf(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(l){let u;try{u=s.parse(l)}catch(c){if(r!==void 0)r(c);else{console.error(c);return}}u.image!==void 0?a.image=u.image:u.data!==void 0&&(a.image.width=u.width,a.image.height=u.height,a.image.data=u.data),a.wrapS=u.wrapS!==void 0?u.wrapS:ul,a.wrapT=u.wrapT!==void 0?u.wrapT:ul,a.magFilter=u.magFilter!==void 0?u.magFilter:ts,a.minFilter=u.minFilter!==void 0?u.minFilter:ts,a.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0&&(a.colorSpace=u.colorSpace),u.flipY!==void 0&&(a.flipY=u.flipY),u.format!==void 0&&(a.format=u.format),u.type!==void 0&&(a.type=u.type),u.mipmaps!==void 0&&(a.mipmaps=u.mipmaps,a.minFilter=Yu),u.mipmapCount===1&&(a.minFilter=ts),u.generateMipmaps!==void 0&&(a.generateMipmaps=u.generateMipmaps),a.needsUpdate=!0,n&&n(a,u)},i,r),a}}class _8 extends lo{constructor(e){super(e)}load(e,n,i,r){const s=new Gr,a=new q1(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,n!==void 0&&n(s)},i,r),s}}class md extends Ci{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new nn(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(n.object.target=this.target.uuid),n}}class b8 extends md{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ci.DEFAULT_UP),this.updateMatrix(),this.groundColor=new nn(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const XC=new kn,N4=new re,B4=new re;class YU{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Tt(512,512),this.mapType=ml,this.map=null,this.mapPass=null,this.matrix=new kn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new fm,this._frameExtents=new Tt(1,1),this._viewportCount=1,this._viewports=[new bi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;N4.setFromMatrixPosition(e.matrixWorld),n.position.copy(N4),B4.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(B4),n.updateMatrixWorld(),XC.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(XC),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(XC)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class uQ extends YU{constructor(){super(new ys(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=H0*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class S8 extends md{constructor(e,n,i=0,r=Math.PI/3,s=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ci.DEFAULT_UP),this.updateMatrix(),this.target=new Ci,this.distance=i,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new uQ}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const k4=new kn,$y=new re,YC=new re;class cQ extends YU{constructor(){super(new ys(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Tt(4,2),this._viewportCount=6,this._viewports=[new bi(2,1,1,1),new bi(0,1,1,1),new bi(3,1,1,1),new bi(1,1,1,1),new bi(3,0,1,1),new bi(1,0,1,1)],this._cubeDirections=[new re(1,0,0),new re(-1,0,0),new re(0,0,1),new re(0,0,-1),new re(0,1,0),new re(0,-1,0)],this._cubeUps=[new re(0,1,0),new re(0,1,0),new re(0,1,0),new re(0,1,0),new re(0,0,1),new re(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),$y.setFromMatrixPosition(e.matrixWorld),i.position.copy($y),YC.copy(i.position),YC.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(YC),i.updateMatrixWorld(),r.makeTranslation(-$y.x,-$y.y,-$y.z),k4.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(k4)}}class E8 extends md{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new cQ}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class pm extends iT{constructor(e=-1,n=1,i=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,a=i+e,o=r+n,l=r-n;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,a=s+u*this.view.width,o-=c*this.view.offsetY,l=o-c*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class fQ extends YU{constructor(){super(new pm(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class w8 extends md{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ci.DEFAULT_UP),this.updateMatrix(),this.target=new Ci,this.shadow=new fQ}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class A8 extends md{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class T8 extends md{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class M8{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new re)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*r),n.addScaledVector(a[2],.488603*s),n.addScaledVector(a[3],.488603*i),n.addScaledVector(a[4],1.092548*(i*r)),n.addScaledVector(a[5],1.092548*(r*s)),n.addScaledVector(a[6],.315392*(3*s*s-1)),n.addScaledVector(a[7],1.092548*(i*s)),n.addScaledVector(a[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],2*.511664*r),n.addScaledVector(a[2],2*.511664*s),n.addScaledVector(a[3],2*.511664*i),n.addScaledVector(a[4],2*.429043*i*r),n.addScaledVector(a[5],2*.429043*r*s),n.addScaledVector(a[6],.743125*s*s-.247708),n.addScaledVector(a[7],2*.429043*i*s),n.addScaledVector(a[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}class C8 extends md{constructor(e=new M8,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class MT extends lo{constructor(e){super(e),this.textures={}}load(e,n,i,r){const s=this,a=new Cf(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n=this.textures;function i(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new nn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(r.uniforms[s]={},a.type){case"t":r.uniforms[s].value=i(a.value);break;case"c":r.uniforms[s].value=new nn().setHex(a.value);break;case"v2":r.uniforms[s].value=new Tt().fromArray(a.value);break;case"v3":r.uniforms[s].value=new re().fromArray(a.value);break;case"v4":r.uniforms[s].value=new bi().fromArray(a.value);break;case"m3":r.uniforms[s].value=new Qn().fromArray(a.value);break;case"m4":r.uniforms[s].value=new kn().fromArray(a.value);break;default:r.uniforms[s].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Tt().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Tt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return MT.createMaterialFromType(e)}static createMaterialFromType(e){const n={ShadowMaterial:s8,SpriteMaterial:zU,RawShaderMaterial:a8,ShaderMaterial:su,PointsMaterial:LU,MeshPhysicalMaterial:o8,MeshStandardMaterial:VU,MeshPhongMaterial:l8,MeshToonMaterial:u8,MeshNormalMaterial:c8,MeshLambertMaterial:f8,MeshDepthMaterial:AT,MeshDistanceMaterial:TT,MeshBasicMaterial:Lf,MeshMatcapMaterial:h8,LineDashedMaterial:d8,LineBasicMaterial:Na,Material:wa};return new n[e]}}class nD{static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class ZU extends ni{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class R8 extends lo{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new Cf(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n={},i={};function r(m,v){if(n[v]!==void 0)return n[v];const y=m.interleavedBuffers[v],g=s(m,y.buffer),x=u0(y.type,g),S=new oT(x,y.stride);return S.uuid=y.uuid,n[v]=S,S}function s(m,v){if(i[v]!==void 0)return i[v];const y=m.arrayBuffers[v],g=new Uint32Array(y).buffer;return i[v]=g,g}const a=e.isInstancedBufferGeometry?new ZU:new ni,o=e.data.index;if(o!==void 0){const m=u0(o.type,o.array);a.setIndex(new Yi(m,1))}const l=e.data.attributes;for(const m in l){const v=l[m];let _;if(v.isInterleavedBufferAttribute){const y=r(e.data,v.data);_=new Qp(y,v.itemSize,v.offset,v.normalized)}else{const y=u0(v.type,v.array),g=v.isInstancedBufferAttribute?Jp:Yi;_=new g(y,v.itemSize,v.normalized)}v.name!==void 0&&(_.name=v.name),v.usage!==void 0&&_.setUsage(v.usage),a.setAttribute(m,_)}const u=e.data.morphAttributes;if(u)for(const m in u){const v=u[m],_=[];for(let y=0,g=v.length;y<g;y++){const x=v[y];let S;if(x.isInterleavedBufferAttribute){const E=r(e.data,x.data);S=new Qp(E,x.itemSize,x.offset,x.normalized)}else{const E=u0(x.type,x.array);S=new Yi(E,x.itemSize,x.normalized)}x.name!==void 0&&(S.name=x.name),_.push(S)}a.morphAttributes[m]=_}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let m=0,v=h.length;m!==v;++m){const _=h[m];a.addGroup(_.start,_.count,_.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const m=new re;d.center!==void 0&&m.fromArray(d.center),a.boundingSphere=new Us(m,d.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class hQ extends lo{constructor(e){super(e)}load(e,n,i,r){const s=this,a=this.path===""?nD.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new Cf(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){let u=null;try{u=JSON.parse(l)}catch(h){r!==void 0&&r(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const c=u.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(u,n)},i,r)}async loadAsync(e,n){const i=this,r=this.path===""?nD.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new Cf(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,n),o=JSON.parse(a),l=o.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(o)}parse(e,n){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){n!==void 0&&n(u)}),o=this.parseTextures(e.textures,a),l=this.parseMaterials(e.materials,o),u=this.parseObject(e.object,s,l,o,i),c=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,c),this.bindLightTargets(u),n!==void 0){let h=!1;for(const d in a)if(a[d].data instanceof HTMLImageElement){h=!0;break}h===!1&&n(u)}return u}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,r,o,a,n),u=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,u),this.bindLightTargets(l),l}parseShapes(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new kp().fromJSON(e[i]);n[s.uuid]=s}return n}parseSkeletons(e,n){const i={},r={};if(n.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new lT().fromJSON(e[s],r);i[o.uuid]=o}return i}parseGeometries(e,n){const i={};if(e!==void 0){const r=new R8;for(let s=0,a=e.length;s<a;s++){let o;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(l);break;default:l.type in P4?o=P4[l.type].fromJSON(l,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}o.uuid=l.uuid,l.name!==void 0&&(o.name=l.name),l.userData!==void 0&&(o.userData=l.userData),i[l.uuid]=o}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const s=new MT;s.setTextures(n);for(let a=0,o=e.length;a<o;a++){const l=e[a];i[l.uuid]===void 0&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=Z1.parse(r);n[s.uuid]=s}return n}parseImages(e,n){const i=this,r={};let s;function a(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function o(l){if(typeof l=="string"){const u=l,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u;return a(c)}else return l.data?{data:u0(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new XU(n);s=new q1(l),s.setCrossOrigin(this.crossOrigin);for(let u=0,c=e.length;u<c;u++){const h=e[u],d=h.url;if(Array.isArray(d)){const m=[];for(let v=0,_=d.length;v<_;v++){const y=d[v],g=o(y);g!==null&&(g instanceof HTMLImageElement?m.push(g):m.push(new $u(g.data,g.width,g.height)))}r[h.uuid]=new Wh(m)}else{const m=o(h.url);r[h.uuid]=new Wh(m)}}}return r}async parseImagesAsync(e){const n=this,i={};let r;async function s(a){if(typeof a=="string"){const o=a,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:n.resourcePath+o;return await r.loadAsync(l)}else return a.data?{data:u0(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){r=new q1(this.manager),r.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const l=e[a],u=l.url;if(Array.isArray(u)){const c=[];for(let h=0,d=u.length;h<d;h++){const m=u[h],v=await s(m);v!==null&&(v instanceof HTMLImageElement?c.push(v):c.push(new $u(v.data,v.width,v.height)))}i[l.uuid]=new Wh(c)}else{const c=await s(l.url);i[l.uuid]=new Wh(c)}}}return i}parseTextures(e,n){function i(s,a){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const r={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),n[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const l=n[o.image],u=l.data;let c;Array.isArray(u)?(c=new G_,u.length===6&&(c.needsUpdate=!0)):(u&&u.data?c=new $u:c=new Gr,u&&(c.needsUpdate=!0)),c.source=l,c.uuid=o.uuid,o.name!==void 0&&(c.name=o.name),o.mapping!==void 0&&(c.mapping=i(o.mapping,dQ)),o.channel!==void 0&&(c.channel=o.channel),o.offset!==void 0&&c.offset.fromArray(o.offset),o.repeat!==void 0&&c.repeat.fromArray(o.repeat),o.center!==void 0&&c.center.fromArray(o.center),o.rotation!==void 0&&(c.rotation=o.rotation),o.wrap!==void 0&&(c.wrapS=i(o.wrap[0],F4),c.wrapT=i(o.wrap[1],F4)),o.format!==void 0&&(c.format=o.format),o.internalFormat!==void 0&&(c.internalFormat=o.internalFormat),o.type!==void 0&&(c.type=o.type),o.colorSpace!==void 0&&(c.colorSpace=o.colorSpace),o.minFilter!==void 0&&(c.minFilter=i(o.minFilter,G4)),o.magFilter!==void 0&&(c.magFilter=i(o.magFilter,G4)),o.anisotropy!==void 0&&(c.anisotropy=o.anisotropy),o.flipY!==void 0&&(c.flipY=o.flipY),o.generateMipmaps!==void 0&&(c.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(c.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(c.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(c.compareFunction=o.compareFunction),o.userData!==void 0&&(c.userData=o.userData),r[o.uuid]=c}return r}parseObject(e,n,i,r,s){let a;function o(d){return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),n[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const m=[];for(let v=0,_=d.length;v<_;v++){const y=d[v];i[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),m.push(i[y])}return m}return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),i[d]}}function u(d){return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}let c,h;switch(e.type){case"Scene":a=new aT,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new nn(e.background):a.background=u(e.background)),e.environment!==void 0&&(a.environment=u(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new sT(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new rT(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new ys(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new pm(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new A8(e.color,e.intensity);break;case"DirectionalLight":a=new w8(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new E8(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new T8(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new S8(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new b8(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new C8().fromJSON(e);break;case"SkinnedMesh":c=o(e.geometry),h=l(e.material),a=new HG(c,h),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":c=o(e.geometry),h=l(e.material),a=new vr(c,h);break;case"InstancedMesh":c=o(e.geometry),h=l(e.material);const d=e.count,m=e.instanceMatrix,v=e.instanceColor;a=new jG(c,h,d),a.instanceMatrix=new Jp(new Float32Array(m.array),16),v!==void 0&&(a.instanceColor=new Jp(new Float32Array(v.array),v.itemSize));break;case"BatchedMesh":c=o(e.geometry),h=l(e.material),a=new WG(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,h),a.geometry=c,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(_=>{let y=null,g=null;return _.boundingBox!==void 0&&(y=new bs,y.min.fromArray(_.boundingBox.min),y.max.fromArray(_.boundingBox.max)),_.boundingSphere!==void 0&&(g=new Us,g.radius=_.boundingSphere.radius,g.center.fromArray(_.boundingSphere.center)),{..._,boundingBox:y,boundingSphere:g}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=u(e.matricesTexture.uuid),a._indirectTexture=u(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=u(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new Us,a.boundingSphere.center.fromArray(e.boundingSphere.center),a.boundingSphere.radius=e.boundingSphere.radius),e.boundingBox!==void 0&&(a.boundingBox=new bs,a.boundingBox.min.fromArray(e.boundingBox.min),a.boundingBox.max.fromArray(e.boundingBox.max));break;case"LOD":a=new VG;break;case"Line":a=new ld(o(e.geometry),l(e.material));break;case"LineLoop":a=new XG(o(e.geometry),l(e.material));break;case"LineSegments":a=new fc(o(e.geometry),l(e.material));break;case"PointCloud":case"Points":a=new YG(o(e.geometry),l(e.material));break;case"Sprite":a=new GG(l(e.material));break;case"Group":a=new c0;break;case"Bone":a=new IU;break;default:a=new Ci}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let m=0;m<d.length;m++)a.add(this.parseObject(d[m],n,i,r,s))}if(e.animations!==void 0){const d=e.animations;for(let m=0;m<d.length;m++){const v=d[m];a.animations.push(s[v])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const d=e.levels;for(let m=0;m<d.length;m++){const v=d[m],_=a.getObjectByProperty("uuid",v.object);_!==void 0&&a.addLevel(_,v.distance,v.hysteresis)}}return a}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=n[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(n){if(n.isDirectionalLight||n.isSpotLight){const i=n.target,r=e.getObjectByProperty("uuid",i);r!==void 0?n.target=r:n.target=new Ci}})}}const dQ={UVMapping:YA,CubeReflectionMapping:Tf,CubeRefractionMapping:ad,EquirectangularReflectionMapping:z1,EquirectangularRefractionMapping:I1,CubeUVReflectionMapping:dv},F4={RepeatWrapping:L1,ClampToEdgeWrapping:ul,MirroredRepeatWrapping:P1},G4={NearestFilter:ia,NearestMipmapNearestFilter:yU,NearestMipmapLinearFilter:l0,LinearFilter:ts,LinearMipmapNearestFilter:t1,LinearMipmapLinearFilter:Yu};class pQ extends lo{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=ff.get(e);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(u=>{n&&n(u),s.manager.itemEnd(e)}).catch(u=>{r&&r(u)});return}return setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader;const l=fetch(e,o).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){return ff.add(e,u),n&&n(u),s.manager.itemEnd(e),u}).catch(function(u){r&&r(u),ff.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});ff.add(e,l),s.manager.itemStart(e)}}let l2;class qU{static getContext(){return l2===void 0&&(l2=new(window.AudioContext||window.webkitAudioContext)),l2}static setContext(e){l2=e}}class mQ extends lo{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new Cf(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{const u=l.slice(0);qU.getContext().decodeAudioData(u,function(h){n(h)}).catch(o)}catch(u){o(u)}},i,r);function o(l){r?r(l):console.error(l),s.manager.itemError(e)}}}const V4=new kn,H4=new kn,ap=new kn;class gQ{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ys,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ys,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,ap.copy(e.projectionMatrix);const r=n.eyeSep/2,s=r*n.near/n.focus,a=n.near*Math.tan(Bp*n.fov*.5)/n.zoom;let o,l;H4.elements[12]=-r,V4.elements[12]=r,o=-a*n.aspect+s,l=a*n.aspect+s,ap.elements[0]=2*n.near/(l-o),ap.elements[8]=(l+o)/(l-o),this.cameraL.projectionMatrix.copy(ap),o=-a*n.aspect-s,l=a*n.aspect-s,ap.elements[0]=2*n.near/(l-o),ap.elements[8]=(l+o)/(l-o),this.cameraR.projectionMatrix.copy(ap)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(H4),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(V4)}}class D8 extends ys{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class KU{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=j4(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=j4();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function j4(){return performance.now()}const op=new re,W4=new ra,vQ=new re,lp=new re;class yQ extends Ci{constructor(){super(),this.type="AudioListener",this.context=qU.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new KU}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(op,W4,vQ),lp.set(0,0,-1).applyQuaternion(W4),n.positionX){const r=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(op.x,r),n.positionY.linearRampToValueAtTime(op.y,r),n.positionZ.linearRampToValueAtTime(op.z,r),n.forwardX.linearRampToValueAtTime(lp.x,r),n.forwardY.linearRampToValueAtTime(lp.y,r),n.forwardZ.linearRampToValueAtTime(lp.z,r),n.upX.linearRampToValueAtTime(i.x,r),n.upY.linearRampToValueAtTime(i.y,r),n.upZ.linearRampToValueAtTime(i.z,r)}else n.setPosition(op.x,op.y,op.z),n.setOrientation(lp.x,lp.y,lp.z,i.x,i.y,i.z)}}class O8 extends Ci{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,n){return super.copy(e,n),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const up=new re,X4=new ra,xQ=new re,cp=new re;class _Q extends O8{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(up,X4,xQ),cp.set(0,0,1).applyQuaternion(X4);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(up.x,i),n.positionY.linearRampToValueAtTime(up.y,i),n.positionZ.linearRampToValueAtTime(up.z,i),n.orientationX.linearRampToValueAtTime(cp.x,i),n.orientationY.linearRampToValueAtTime(cp.y,i),n.orientationZ.linearRampToValueAtTime(cp.z,i)}else n.setPosition(up.x,up.y,up.z),n.setOrientation(cp.x,cp.y,cp.z)}}class bQ{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class U8{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,s,a;switch(n){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,s=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==r;++o)i[s+o]=i[o];a=n}else{a+=n;const o=n/a;this._mixBufferRegion(i,s,0,o,r)}this.cumulativeWeight=a}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=n*this._origIndex;this._mixBufferRegion(i,r,l,1-s,n)}a>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let l=n,u=n+n;l!==u;++l)if(i[l]!==i[l+n]){o.setValue(i,r);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let s=i,a=r;s!==a;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let a=0;a!==s;++a)e[n+a]=e[i+a]}_slerp(e,n,i,r){ra.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){const a=this._workIndex*s;ra.multiplyQuaternionsFlat(e,a,e,n,e,i),ra.slerpFlat(e,n,e,n,e,a,r)}_lerp(e,n,i,r,s){const a=1-r;for(let o=0;o!==s;++o){const l=n+o;e[l]=e[l]*a+e[i+o]*r}}_lerpAdditive(e,n,i,r,s){for(let a=0;a!==s;++a){const o=n+a;e[o]=e[o]+e[i+a]*r}}}const QU="\\[\\]\\.:\\/",SQ=new RegExp("["+QU+"]","g"),JU="[^"+QU+"]",EQ="[^"+QU.replace("\\.","")+"]",wQ=/((?:WC+[\/:])*)/.source.replace("WC",JU),AQ=/(WCOD+)?/.source.replace("WCOD",EQ),TQ=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",JU),MQ=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",JU),CQ=new RegExp("^"+wQ+AQ+TQ+MQ+"$"),RQ=["material","materials","bones","map"];class DQ{constructor(e,n,i){const r=i||Mi.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class Mi{constructor(e,n,i){this.path=n,this.parsedPath=i||Mi.parseTrackName(n),this.node=Mi.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new Mi.Composite(e,n,i):new Mi(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(SQ,"")}static parseTrackName(e){const n=CQ.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);RQ.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===n||o.uuid===n)return o;const l=i(o.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,r=n.propertyName;let s=n.propertyIndex;if(e||(e=Mi.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let u=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const a=e[r];if(a===void 0){const u=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Mi.Composite=DQ;Mi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Mi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Mi.prototype.GetterByBindingType=[Mi.prototype._getValue_direct,Mi.prototype._getValue_array,Mi.prototype._getValue_arrayElement,Mi.prototype._getValue_toArray];Mi.prototype.SetterByBindingTypeAndVersioning=[[Mi.prototype._setValue_direct,Mi.prototype._setValue_direct_setNeedsUpdate,Mi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Mi.prototype._setValue_array,Mi.prototype._setValue_array_setNeedsUpdate,Mi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Mi.prototype._setValue_arrayElement,Mi.prototype._setValue_arrayElement_setNeedsUpdate,Mi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Mi.prototype._setValue_fromArray,Mi.prototype._setValue_fromArray_setNeedsUpdate,Mi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class OQ{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Do(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length;let o,l=e.length,u=this.nCachedObjects_;for(let c=0,h=arguments.length;c!==h;++c){const d=arguments[c],m=d.uuid;let v=n[m];if(v===void 0){v=l++,n[m]=v,e.push(d);for(let _=0,y=a;_!==y;++_)s[_].push(new Mi(d,i[_],r[_]))}else if(v<u){o=e[v];const _=--u,y=e[_];n[y.uuid]=v,e[v]=y,n[m]=_,e[_]=d;for(let g=0,x=a;g!==x;++g){const S=s[g],E=S[_];let A=S[v];S[v]=E,A===void 0&&(A=new Mi(d,i[g],r[g])),S[_]=A}}else e[v]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const l=arguments[a],u=l.uuid,c=n[u];if(c!==void 0&&c>=s){const h=s++,d=e[h];n[d.uuid]=c,e[c]=d,n[u]=h,e[h]=l;for(let m=0,v=r;m!==v;++m){const _=i[m],y=_[h],g=_[c];_[c]=y,_[h]=g}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,l=arguments.length;o!==l;++o){const u=arguments[o],c=u.uuid,h=n[c];if(h!==void 0)if(delete n[c],h<s){const d=--s,m=e[d],v=--a,_=e[v];n[m.uuid]=h,e[h]=m,n[_.uuid]=d,e[d]=_,e.pop();for(let y=0,g=r;y!==g;++y){const x=i[y],S=x[d],E=x[v];x[h]=S,x[d]=E,x.pop()}}else{const d=--a,m=e[d];d>0&&(n[m.uuid]=h),e[h]=m,e.pop();for(let v=0,_=r;v!==_;++v){const y=i[v];y[h]=y[d],y.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const a=this._paths,o=this._parsedPaths,l=this._objects,u=l.length,c=this.nCachedObjects_,h=new Array(u);r=s.length,i[e]=r,a.push(e),o.push(n),s.push(h);for(let d=c,m=l.length;d!==m;++d){const v=l[d];h[d]=new Mi(v,e,n)}return h}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,l=a[o],u=e[o];n[u]=i,a[i]=l,a.pop(),s[i]=s[o],s.pop(),r[i]=r[o],r.pop()}}}class z8{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const s=n.tracks,a=s.length,o=new Array(a),l={endingStart:Ap,endingEnd:Ap};for(let u=0;u!==a;++u){const c=s[u].createInterpolant(null);o[u]=c,c.settings=l}this._interpolantSettings=l,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=SG,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i=!1){if(e.fadeOut(n),this.fadeIn(n),i===!0){const r=this._clip.duration,s=e._clip.duration,a=s/r,o=r/s;e.warp(1,a,n),this.warp(o,1,n)}return this}crossFadeTo(e,n,i=!1){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const l=o.parameterPositions,u=o.sampleValues;return l[0]=s,l[1]=s+i,u[0]=e/a,u[1]=n/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?n=0:(this._startTime=null,n=i*l)}n*=this._updateTimeScale(e);const a=this._updateTime(n),o=this._updateWeight(e);if(o>0){const l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case TU:for(let c=0,h=l.length;c!==h;++c)l[c].evaluate(a),u[c].accumulateAdditive(o);break;case eT:default:for(let c=0,h=l.length;c!==h;++c)l[c].evaluate(a),u[c].accumulate(r,o)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const a=i===EG;if(e===0)return s===-1?r:a&&(s&1)===1?n-r:r;if(i===bG){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=n||r<0){const o=Math.floor(r/n);r-=n*o,s+=Math.abs(o);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const u=e<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=Tp,r.endingEnd=Tp):(e?r.endingStart=this.zeroSlopeAtStart?Tp:Ap:r.endingStart=B1,n?r.endingEnd=this.zeroSlopeAtEnd?Tp:Ap:r.endingEnd=B1)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,l=a.sampleValues;return o[0]=s,l[0]=n,o[1]=s+e,l[1]=i,this}}const UQ=new Float32Array(1);class zQ extends cc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,o=e._interpolants,l=i.uuid,u=this._bindingsByRootAndName;let c=u[l];c===void 0&&(c={},u[l]=c);for(let h=0;h!==s;++h){const d=r[h],m=d.name;let v=c[m];if(v!==void 0)++v.referenceCount,a[h]=v;else{if(v=a[h],v!==void 0){v._cacheIndex===null&&(++v.referenceCount,this._addInactiveBinding(v,l,m));continue}const _=n&&n._propertyBindings[h].binding.parsedPath;v=new U8(Mi.create(i,m,_),d.ValueTypeName,d.getValueSize()),++v.referenceCount,this._addInactiveBinding(v,l,m),a[h]=v}o[h].resultBuffer=v.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,s=this._actionsByClip;let a=s[n];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],l=o.knownActions,u=l[l.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,l[c]=u,l.pop(),e._byClipCacheIndex=null;const h=o.actionByRoot,d=(e._localRoot||this._root).uuid;delete h[d],l.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[n];a===void 0&&(a={},r[n]=a),a[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,a=this._bindingsByRootAndName,o=a[r],l=n[n.length-1],u=e._cacheIndex;l._cacheIndex=u,n[u]=l,n.pop(),delete o[s],Object.keys(o).length===0&&delete a[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new jU(new Float32Array(2),new Float32Array(2),1,UQ),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){const r=n||this._root,s=r.uuid;let a=typeof e=="string"?Z1.findByName(r,e):e;const o=a!==null?a.uuid:e,l=this._actionsByClip[o];let u=null;if(i===void 0&&(a!==null?i=a.blendMode:i=eT),l!==void 0){const h=l.actionByRoot[s];if(h!==void 0&&h.blendMode===i)return h;u=l.knownActions[0],a===null&&(a=u._clip)}if(a===null)return null;const c=new z8(this,a,n,i);return this._bindAction(c,u),this._addInactiveAction(c,o,s),c}existingAction(e,n){const i=n||this._root,r=i.uuid,s=typeof e=="string"?Z1.findByName(i,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[r]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let u=0;u!==i;++u)n[u]._update(r,e,s,a);const o=this._bindings,l=this._nActiveBindings;for(let u=0;u!==l;++u)o[u].apply(a);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const a=s.knownActions;for(let o=0,l=a.length;o!==l;++o){const u=a[o];this._deactivateAction(u);const c=u._cacheIndex,h=n[n.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,h._cacheIndex=c,n[c]=h,n.pop(),this._removeInactiveBindingsForAction(u)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const a in i){const o=i[a].actionByRoot,l=o[n];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[n];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class IQ extends tT{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isRenderTarget3D=!0,this.depth=i,this.texture=new nT(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class LQ extends tT{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isRenderTargetArray=!0,this.depth=i,this.texture=new F_(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class $U{constructor(e){this.value=e}clone(){return new $U(this.value.clone===void 0?this.value:this.value.clone())}}let PQ=0;class NQ extends cc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:PQ++}),this.name="",this.usage=F1,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++){const s=Array.isArray(n[i])?n[i]:[n[i]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class BQ extends oT{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class kQ{constructor(e,n,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const Y4=new kn;class ez{constructor(e,n,i=0,r=1/0){this.ray=new mv(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new j0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return Y4.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Y4),this}intersectObject(e,n=!0,i=[]){return iD(e,this,i,n),i.sort(Z4),i}intersectObjects(e,n=!0,i=[]){for(let r=0,s=e.length;r<s;r++)iD(e[r],this,i,n);return i.sort(Z4),i}}function Z4(t,e){return t.distance-e.distance}function iD(t,e,n,i){let r=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(r=!1),r===!0&&i===!0){const s=t.children;for(let a=0,o=s.length;a<o;a++)iD(s[a],e,n,!0)}}class I8{constructor(e=1,n=0,i=0){this.radius=e,this.phi=n,this.theta=i}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Jn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Jn(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class FQ{constructor(e=1,n=0,i=0){this.radius=e,this.theta=n,this.y=i}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}class tz{constructor(e,n,i,r){tz.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let i=0;i<4;i++)this.elements[i]=e[i+n];return this}set(e,n,i,r){const s=this.elements;return s[0]=e,s[2]=n,s[1]=i,s[3]=r,this}}const q4=new Tt;class GQ{constructor(e=new Tt(1/0,1/0),n=new Tt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=q4.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,q4).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const K4=new re,u2=new re;class VQ{constructor(e=new re,n=new re){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){K4.subVectors(e,this.start),u2.subVectors(this.end,this.start);const i=u2.dot(u2);let s=u2.dot(K4)/i;return n&&(s=Jn(s,0,1)),s}closestPointToPoint(e,n,i){const r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const Q4=new re;class HQ extends Ci{constructor(e,n){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new ni,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,l=32;a<l;a++,o++){const u=a/l*Math.PI*2,c=o/l*Math.PI*2;r.push(Math.cos(u),Math.sin(u),1,Math.cos(c),Math.sin(c),1)}i.setAttribute("position",new _n(r,3));const s=new Na({fog:!1,toneMapped:!1});this.cone=new fc(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),Q4.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Q4),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Th=new re,c2=new kn,ZC=new kn;class jQ extends fc{constructor(e){const n=L8(e),i=new ni,r=[],s=[],a=new nn(0,0,1),o=new nn(0,1,0);for(let u=0;u<n.length;u++){const c=n[u];c.parent&&c.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(a.r,a.g,a.b),s.push(o.r,o.g,o.b))}i.setAttribute("position",new _n(r,3)),i.setAttribute("color",new _n(s,3));const l=new Na({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");ZC.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<n.length;s++){const o=n[s];o.parent&&o.parent.isBone&&(c2.multiplyMatrices(ZC,o.matrixWorld),Th.setFromMatrixPosition(c2),r.setXYZ(a,Th.x,Th.y,Th.z),c2.multiplyMatrices(ZC,o.parent.matrixWorld),Th.setFromMatrixPosition(c2),r.setXYZ(a+1,Th.x,Th.y,Th.z),a+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function L8(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push(...L8(t.children[n]));return e}class WQ extends vr{constructor(e,n,i){const r=new j_(n,4,2),s=new Lf({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const XQ=new re,J4=new nn,$4=new nn;class YQ extends Ci{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new H_(n);r.rotateY(Math.PI*.5),this.material=new Lf({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),a=new Float32Array(s.count*3);r.setAttribute("color",new Yi(a,3)),this.add(new vr(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");J4.copy(this.light.color),$4.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){const s=i<r/2?J4:$4;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(XQ.setFromMatrixPosition(this.light.matrixWorld).negate())}}class ZQ extends fc{constructor(e=10,n=10,i=4473924,r=8947848){i=new nn(i),r=new nn(r);const s=n/2,a=e/n,o=e/2,l=[],u=[];for(let d=0,m=0,v=-o;d<=n;d++,v+=a){l.push(-o,0,v,o,0,v),l.push(v,0,-o,v,0,o);const _=d===s?i:r;_.toArray(u,m),m+=3,_.toArray(u,m),m+=3,_.toArray(u,m),m+=3,_.toArray(u,m),m+=3}const c=new ni;c.setAttribute("position",new _n(l,3)),c.setAttribute("color",new _n(u,3));const h=new Na({vertexColors:!0,toneMapped:!1});super(c,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class qQ extends fc{constructor(e=10,n=16,i=8,r=64,s=4473924,a=8947848){s=new nn(s),a=new nn(a);const o=[],l=[];if(n>1)for(let h=0;h<n;h++){const d=h/n*(Math.PI*2),m=Math.sin(d)*e,v=Math.cos(d)*e;o.push(0,0,0),o.push(m,0,v);const _=h&1?s:a;l.push(_.r,_.g,_.b),l.push(_.r,_.g,_.b)}for(let h=0;h<i;h++){const d=h&1?s:a,m=e-e/i*h;for(let v=0;v<r;v++){let _=v/r*(Math.PI*2),y=Math.sin(_)*m,g=Math.cos(_)*m;o.push(y,0,g),l.push(d.r,d.g,d.b),_=(v+1)/r*(Math.PI*2),y=Math.sin(_)*m,g=Math.cos(_)*m,o.push(y,0,g),l.push(d.r,d.g,d.b)}}const u=new ni;u.setAttribute("position",new _n(o,3)),u.setAttribute("color",new _n(l,3));const c=new Na({vertexColors:!0,toneMapped:!1});super(u,c),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const eP=new re,f2=new re,tP=new re;class KQ extends Ci{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new ni;r.setAttribute("position",new _n([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new Na({fog:!1,toneMapped:!1});this.lightPlane=new ld(r,s),this.add(this.lightPlane),r=new ni,r.setAttribute("position",new _n([0,0,0,0,0,1],3)),this.targetLine=new ld(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),eP.setFromMatrixPosition(this.light.matrixWorld),f2.setFromMatrixPosition(this.light.target.matrixWorld),tP.subVectors(f2,eP),this.lightPlane.lookAt(f2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(f2),this.targetLine.scale.z=tP.length()}}const h2=new re,Kr=new iT;class QQ extends fc{constructor(e){const n=new ni,i=new Na({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(v,_){l(v),l(_)}function l(v){r.push(0,0,0),s.push(0,0,0),a[v]===void 0&&(a[v]=[]),a[v].push(r.length/3-1)}n.setAttribute("position",new _n(r,3)),n.setAttribute("color",new _n(s,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const u=new nn(16755200),c=new nn(16711680),h=new nn(43775),d=new nn(16777215),m=new nn(3355443);this.setColors(u,c,h,d,m)}setColors(e,n,i,r,s){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,n.r,n.g,n.b),o.setXYZ(25,n.r,n.g,n.b),o.setXYZ(26,n.r,n.g,n.b),o.setXYZ(27,n.r,n.g,n.b),o.setXYZ(28,n.r,n.g,n.b),o.setXYZ(29,n.r,n.g,n.b),o.setXYZ(30,n.r,n.g,n.b),o.setXYZ(31,n.r,n.g,n.b),o.setXYZ(32,i.r,i.g,i.b),o.setXYZ(33,i.r,i.g,i.b),o.setXYZ(34,i.r,i.g,i.b),o.setXYZ(35,i.r,i.g,i.b),o.setXYZ(36,i.r,i.g,i.b),o.setXYZ(37,i.r,i.g,i.b),o.setXYZ(38,r.r,r.g,r.b),o.setXYZ(39,r.r,r.g,r.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,i=1,r=1;Kr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const s=this.camera.coordinateSystem===cl?-1:0;ss("c",n,e,Kr,0,0,s),ss("t",n,e,Kr,0,0,1),ss("n1",n,e,Kr,-1,-1,s),ss("n2",n,e,Kr,i,-1,s),ss("n3",n,e,Kr,-1,r,s),ss("n4",n,e,Kr,i,r,s),ss("f1",n,e,Kr,-1,-1,1),ss("f2",n,e,Kr,i,-1,1),ss("f3",n,e,Kr,-1,r,1),ss("f4",n,e,Kr,i,r,1),ss("u1",n,e,Kr,i*.7,r*1.1,s),ss("u2",n,e,Kr,-1*.7,r*1.1,s),ss("u3",n,e,Kr,0,r*2,s),ss("cf1",n,e,Kr,-1,0,1),ss("cf2",n,e,Kr,i,0,1),ss("cf3",n,e,Kr,0,-1,1),ss("cf4",n,e,Kr,0,r,1),ss("cn1",n,e,Kr,-1,0,s),ss("cn2",n,e,Kr,i,0,s),ss("cn3",n,e,Kr,0,-1,s),ss("cn4",n,e,Kr,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ss(t,e,n,i,r,s,a){h2.set(r,s,a).unproject(i);const o=e[t];if(o!==void 0){const l=n.getAttribute("position");for(let u=0,c=o.length;u<c;u++)l.setXYZ(o[u],h2.x,h2.y,h2.z)}}const d2=new bs;class JQ extends fc{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new ni;s.setIndex(new Yi(i,1)),s.setAttribute("position",new Yi(r,3)),super(s,new Na({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&d2.setFromObject(this.object),d2.isEmpty())return;const e=d2.min,n=d2.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class $Q extends fc{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new ni;s.setIndex(new Yi(i,1)),s.setAttribute("position",new _n(r,3)),super(s,new Na({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class eJ extends ld{constructor(e,n=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new ni;a.setAttribute("position",new _n(s,3)),a.computeBoundingSphere(),super(a,new Na({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new ni;l.setAttribute("position",new _n(o,3)),l.computeBoundingSphere(),this.add(new vr(l,new Lf({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const nP=new re;let p2,qC;class tJ extends Ci{constructor(e=new re(0,0,1),n=new re(0,0,0),i=1,r=16776960,s=i*.2,a=s*.2){super(),this.type="ArrowHelper",p2===void 0&&(p2=new ni,p2.setAttribute("position",new _n([0,0,0,0,1,0],3)),qC=new V_(.5,1,5,1),qC.translate(0,-.5,0)),this.position.copy(n),this.line=new ld(p2,new Na({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new vr(qC,new Lf({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{nP.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(nP,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class nJ extends fc{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new ni;r.setAttribute("position",new _n(n,3)),r.setAttribute("color",new _n(i,3));const s=new Na({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,n,i){const r=new nn,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(n),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class iJ{constructor(){this.type="ShapePath",this.color=new nn,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new Hw,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,s,a){return this.currentPath.bezierCurveTo(e,n,i,r,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(g){const x=[];for(let S=0,E=g.length;S<E;S++){const A=g[S],T=new kp;T.curves=A.curves,x.push(T)}return x}function i(g,x){const S=x.length;let E=!1;for(let A=S-1,T=0;T<S;A=T++){let C=x[A],O=x[T],M=O.x-C.x,D=O.y-C.y;if(Math.abs(D)>Number.EPSILON){if(D<0&&(C=x[T],M=-M,O=x[A],D=-D),g.y<C.y||g.y>O.y)continue;if(g.y===C.y){if(g.x===C.x)return!0}else{const P=D*(g.x-C.x)-M*(g.y-C.y);if(P===0)return!0;if(P<0)continue;E=!E}}else{if(g.y!==C.y)continue;if(O.x<=g.x&&g.x<=C.x||C.x<=g.x&&g.x<=O.x)return!0}}return E}const r=tu.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,l;const u=[];if(s.length===1)return o=s[0],l=new kp,l.curves=o.curves,u.push(l),u;let c=!r(s[0].getPoints());c=e?!c:c;const h=[],d=[];let m=[],v=0,_;d[v]=void 0,m[v]=[];for(let g=0,x=s.length;g<x;g++)o=s[g],_=o.getPoints(),a=r(_),a=e?!a:a,a?(!c&&d[v]&&v++,d[v]={s:new kp,p:_},d[v].s.curves=o.curves,c&&v++,m[v]=[]):m[v].push({h:o,p:_[0]});if(!d[0])return n(s);if(d.length>1){let g=!1,x=0;for(let S=0,E=d.length;S<E;S++)h[S]=[];for(let S=0,E=d.length;S<E;S++){const A=m[S];for(let T=0;T<A.length;T++){const C=A[T];let O=!0;for(let M=0;M<d.length;M++)i(C.p,d[M].p)&&(S!==M&&x++,O?(O=!1,h[M].push(C)):g=!0);O&&h[S].push(C)}}x>0&&g===!1&&(m=h)}let y;for(let g=0,x=d.length;g<x;g++){l=d[g].s,u.push(l),y=m[g];for(let S=0,E=y.length;S<E;S++)l.holes.push(y[S].h)}return u}}class rJ extends cc{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function sJ(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2):(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0),t}function aJ(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0):(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2),t}function oJ(t){return t.repeat.x=1,t.repeat.y=1,t.offset.x=0,t.offset.y=0,t}function rD(t,e,n,i){const r=lJ(i);switch(n){case SU:return t*e;case QA:return t*e/r.components*r.byteLength;case k_:return t*e/r.components*r.byteLength;case wU:return t*e*2/r.components*r.byteLength;case JA:return t*e*2/r.components*r.byteLength;case EU:return t*e*3/r.components*r.byteLength;case Sa:return t*e*4/r.components*r.byteLength;case $A:return t*e*4/r.components*r.byteLength;case n1:case i1:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case r1:case s1:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case pw:case gw:return Math.max(t,16)*Math.max(e,8)/4;case dw:case mw:return Math.max(t,8)*Math.max(e,8)/2;case vw:case yw:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case xw:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case _w:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case bw:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case Sw:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case Ew:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case ww:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case Aw:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case Tw:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case Mw:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case Cw:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case Rw:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case Dw:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case Ow:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case Uw:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case zw:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case a1:case Iw:case Lw:return Math.ceil(t/4)*Math.ceil(e/4)*16;case AU:case Pw:return Math.ceil(t/4)*Math.ceil(e/4)*8;case Nw:case Bw:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function lJ(t){switch(t){case ml:case xU:return{byteLength:1,components:1};case k0:case _U:case pv:return{byteLength:2,components:1};case qA:case KA:return{byteLength:2,components:4};case Mf:case ZA:case io:return{byteLength:4,components:1};case bU:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}class uJ{static contain(e,n){return sJ(e,n)}static cover(e,n){return aJ(e,n)}static fill(e){return oJ(e)}static getByteLength(e,n,i,r){return rD(e,n,i,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:WA}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=WA);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function P8(){let t=null,e=!1,n=null,i=null;function r(s,a){n(s,a),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function cJ(t){const e=new WeakMap;function n(o,l){const u=o.array,c=o.usage,h=u.byteLength,d=t.createBuffer();t.bindBuffer(l,d),t.bufferData(l,u,c),o.onUploadCallback();let m;if(u instanceof Float32Array)m=t.FLOAT;else if(u instanceof Uint16Array)o.isFloat16BufferAttribute?m=t.HALF_FLOAT:m=t.UNSIGNED_SHORT;else if(u instanceof Int16Array)m=t.SHORT;else if(u instanceof Uint32Array)m=t.UNSIGNED_INT;else if(u instanceof Int32Array)m=t.INT;else if(u instanceof Int8Array)m=t.BYTE;else if(u instanceof Uint8Array)m=t.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)m=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:d,type:m,bytesPerElement:u.BYTES_PER_ELEMENT,version:o.version,size:h}}function i(o,l,u){const c=l.array,h=l.updateRanges;if(t.bindBuffer(u,o),h.length===0)t.bufferSubData(u,0,c);else{h.sort((m,v)=>m.start-v.start);let d=0;for(let m=1;m<h.length;m++){const v=h[d],_=h[m];_.start<=v.start+v.count+1?v.count=Math.max(v.count,_.start+_.count-v.start):(++d,h[d]=_)}h.length=d+1;for(let m=0,v=h.length;m<v;m++){const _=h[m];t.bufferSubData(u,_.start*c.BYTES_PER_ELEMENT,c,_.start,_.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const l=e.get(o);l&&(t.deleteBuffer(l.buffer),e.delete(o))}function a(o,l){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const c=e.get(o);(!c||c.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const u=e.get(o);if(u===void 0)e.set(o,n(o,l));else if(u.version<o.version){if(u.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(u.buffer,o,l),u.version=o.version}}return{get:r,remove:s,update:a}}var fJ=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,hJ=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,dJ=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,pJ=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,mJ=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,gJ=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,vJ=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,yJ=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,xJ=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,_J=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,bJ=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,SJ=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,EJ=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,wJ=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,AJ=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,TJ=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,MJ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,CJ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,RJ=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,DJ=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,OJ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,UJ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,zJ=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,IJ=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,LJ=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,PJ=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,NJ=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,BJ=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,kJ=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,FJ=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,GJ="gl_FragColor = linearToOutputTexel( gl_FragColor );",VJ=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,HJ=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,jJ=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,WJ=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,XJ=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,YJ=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,ZJ=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,qJ=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,KJ=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,QJ=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,JJ=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,$J=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,e$=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,t$=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,n$=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,i$=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,r$=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,s$=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,a$=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,o$=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,l$=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,u$=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,c$=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,f$=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,h$=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,d$=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,p$=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,m$=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,g$=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,v$=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,y$=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,x$=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,_$=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,b$=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,S$=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,E$=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,w$=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,A$=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,T$=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,M$=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,C$=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,R$=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,D$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,O$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,U$=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,z$=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,I$=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,L$=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,P$=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,N$=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,B$=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,k$=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,F$=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,G$=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,V$=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,H$=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,j$=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,W$=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,X$=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Y$=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Z$=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,q$=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,K$=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Q$=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,J$=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,$$=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,eee=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,tee=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,nee=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,iee=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,ree=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,see=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,aee=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,oee=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,lee=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,uee=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const cee=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fee=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,hee=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,dee=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,pee=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,mee=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,gee=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,vee=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,yee=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,xee=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,_ee=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,bee=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,See=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Eee=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,wee=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Aee=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Tee=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Mee=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Cee=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Ree=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Dee=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Oee=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Uee=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zee=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Iee=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Lee=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Pee=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Nee=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Bee=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,kee=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Fee=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Gee=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Vee=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Hee=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ri={alphahash_fragment:fJ,alphahash_pars_fragment:hJ,alphamap_fragment:dJ,alphamap_pars_fragment:pJ,alphatest_fragment:mJ,alphatest_pars_fragment:gJ,aomap_fragment:vJ,aomap_pars_fragment:yJ,batching_pars_vertex:xJ,batching_vertex:_J,begin_vertex:bJ,beginnormal_vertex:SJ,bsdfs:EJ,iridescence_fragment:wJ,bumpmap_pars_fragment:AJ,clipping_planes_fragment:TJ,clipping_planes_pars_fragment:MJ,clipping_planes_pars_vertex:CJ,clipping_planes_vertex:RJ,color_fragment:DJ,color_pars_fragment:OJ,color_pars_vertex:UJ,color_vertex:zJ,common:IJ,cube_uv_reflection_fragment:LJ,defaultnormal_vertex:PJ,displacementmap_pars_vertex:NJ,displacementmap_vertex:BJ,emissivemap_fragment:kJ,emissivemap_pars_fragment:FJ,colorspace_fragment:GJ,colorspace_pars_fragment:VJ,envmap_fragment:HJ,envmap_common_pars_fragment:jJ,envmap_pars_fragment:WJ,envmap_pars_vertex:XJ,envmap_physical_pars_fragment:i$,envmap_vertex:YJ,fog_vertex:ZJ,fog_pars_vertex:qJ,fog_fragment:KJ,fog_pars_fragment:QJ,gradientmap_pars_fragment:JJ,lightmap_pars_fragment:$J,lights_lambert_fragment:e$,lights_lambert_pars_fragment:t$,lights_pars_begin:n$,lights_toon_fragment:r$,lights_toon_pars_fragment:s$,lights_phong_fragment:a$,lights_phong_pars_fragment:o$,lights_physical_fragment:l$,lights_physical_pars_fragment:u$,lights_fragment_begin:c$,lights_fragment_maps:f$,lights_fragment_end:h$,logdepthbuf_fragment:d$,logdepthbuf_pars_fragment:p$,logdepthbuf_pars_vertex:m$,logdepthbuf_vertex:g$,map_fragment:v$,map_pars_fragment:y$,map_particle_fragment:x$,map_particle_pars_fragment:_$,metalnessmap_fragment:b$,metalnessmap_pars_fragment:S$,morphinstance_vertex:E$,morphcolor_vertex:w$,morphnormal_vertex:A$,morphtarget_pars_vertex:T$,morphtarget_vertex:M$,normal_fragment_begin:C$,normal_fragment_maps:R$,normal_pars_fragment:D$,normal_pars_vertex:O$,normal_vertex:U$,normalmap_pars_fragment:z$,clearcoat_normal_fragment_begin:I$,clearcoat_normal_fragment_maps:L$,clearcoat_pars_fragment:P$,iridescence_pars_fragment:N$,opaque_fragment:B$,packing:k$,premultiplied_alpha_fragment:F$,project_vertex:G$,dithering_fragment:V$,dithering_pars_fragment:H$,roughnessmap_fragment:j$,roughnessmap_pars_fragment:W$,shadowmap_pars_fragment:X$,shadowmap_pars_vertex:Y$,shadowmap_vertex:Z$,shadowmask_pars_fragment:q$,skinbase_vertex:K$,skinning_pars_vertex:Q$,skinning_vertex:J$,skinnormal_vertex:$$,specularmap_fragment:eee,specularmap_pars_fragment:tee,tonemapping_fragment:nee,tonemapping_pars_fragment:iee,transmission_fragment:ree,transmission_pars_fragment:see,uv_pars_fragment:aee,uv_pars_vertex:oee,uv_vertex:lee,worldpos_vertex:uee,background_vert:cee,background_frag:fee,backgroundCube_vert:hee,backgroundCube_frag:dee,cube_vert:pee,cube_frag:mee,depth_vert:gee,depth_frag:vee,distanceRGBA_vert:yee,distanceRGBA_frag:xee,equirect_vert:_ee,equirect_frag:bee,linedashed_vert:See,linedashed_frag:Eee,meshbasic_vert:wee,meshbasic_frag:Aee,meshlambert_vert:Tee,meshlambert_frag:Mee,meshmatcap_vert:Cee,meshmatcap_frag:Ree,meshnormal_vert:Dee,meshnormal_frag:Oee,meshphong_vert:Uee,meshphong_frag:zee,meshphysical_vert:Iee,meshphysical_frag:Lee,meshtoon_vert:Pee,meshtoon_frag:Nee,points_vert:Bee,points_frag:kee,shadow_vert:Fee,shadow_frag:Gee,sprite_vert:Vee,sprite_frag:Hee},ln={common:{diffuse:{value:new nn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Qn},alphaMap:{value:null},alphaMapTransform:{value:new Qn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Qn}},envmap:{envMap:{value:null},envMapRotation:{value:new Qn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Qn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Qn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Qn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Qn},normalScale:{value:new Tt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Qn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Qn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Qn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Qn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new nn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new nn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Qn},alphaTest:{value:0},uvTransform:{value:new Qn}},sprite:{diffuse:{value:new nn(16777215)},opacity:{value:1},center:{value:new Tt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Qn},alphaMap:{value:null},alphaMapTransform:{value:new Qn},alphaTest:{value:0}}},Kl={basic:{uniforms:Da([ln.common,ln.specularmap,ln.envmap,ln.aomap,ln.lightmap,ln.fog]),vertexShader:ri.meshbasic_vert,fragmentShader:ri.meshbasic_frag},lambert:{uniforms:Da([ln.common,ln.specularmap,ln.envmap,ln.aomap,ln.lightmap,ln.emissivemap,ln.bumpmap,ln.normalmap,ln.displacementmap,ln.fog,ln.lights,{emissive:{value:new nn(0)}}]),vertexShader:ri.meshlambert_vert,fragmentShader:ri.meshlambert_frag},phong:{uniforms:Da([ln.common,ln.specularmap,ln.envmap,ln.aomap,ln.lightmap,ln.emissivemap,ln.bumpmap,ln.normalmap,ln.displacementmap,ln.fog,ln.lights,{emissive:{value:new nn(0)},specular:{value:new nn(1118481)},shininess:{value:30}}]),vertexShader:ri.meshphong_vert,fragmentShader:ri.meshphong_frag},standard:{uniforms:Da([ln.common,ln.envmap,ln.aomap,ln.lightmap,ln.emissivemap,ln.bumpmap,ln.normalmap,ln.displacementmap,ln.roughnessmap,ln.metalnessmap,ln.fog,ln.lights,{emissive:{value:new nn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ri.meshphysical_vert,fragmentShader:ri.meshphysical_frag},toon:{uniforms:Da([ln.common,ln.aomap,ln.lightmap,ln.emissivemap,ln.bumpmap,ln.normalmap,ln.displacementmap,ln.gradientmap,ln.fog,ln.lights,{emissive:{value:new nn(0)}}]),vertexShader:ri.meshtoon_vert,fragmentShader:ri.meshtoon_frag},matcap:{uniforms:Da([ln.common,ln.bumpmap,ln.normalmap,ln.displacementmap,ln.fog,{matcap:{value:null}}]),vertexShader:ri.meshmatcap_vert,fragmentShader:ri.meshmatcap_frag},points:{uniforms:Da([ln.points,ln.fog]),vertexShader:ri.points_vert,fragmentShader:ri.points_frag},dashed:{uniforms:Da([ln.common,ln.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ri.linedashed_vert,fragmentShader:ri.linedashed_frag},depth:{uniforms:Da([ln.common,ln.displacementmap]),vertexShader:ri.depth_vert,fragmentShader:ri.depth_frag},normal:{uniforms:Da([ln.common,ln.bumpmap,ln.normalmap,ln.displacementmap,{opacity:{value:1}}]),vertexShader:ri.meshnormal_vert,fragmentShader:ri.meshnormal_frag},sprite:{uniforms:Da([ln.sprite,ln.fog]),vertexShader:ri.sprite_vert,fragmentShader:ri.sprite_frag},background:{uniforms:{uvTransform:{value:new Qn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ri.background_vert,fragmentShader:ri.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Qn}},vertexShader:ri.backgroundCube_vert,fragmentShader:ri.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ri.cube_vert,fragmentShader:ri.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ri.equirect_vert,fragmentShader:ri.equirect_frag},distanceRGBA:{uniforms:Da([ln.common,ln.displacementmap,{referencePosition:{value:new re},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ri.distanceRGBA_vert,fragmentShader:ri.distanceRGBA_frag},shadow:{uniforms:Da([ln.lights,ln.fog,{color:{value:new nn(0)},opacity:{value:1}}]),vertexShader:ri.shadow_vert,fragmentShader:ri.shadow_frag}};Kl.physical={uniforms:Da([Kl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Qn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Qn},clearcoatNormalScale:{value:new Tt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Qn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Qn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Qn},sheen:{value:0},sheenColor:{value:new nn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Qn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Qn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Qn},transmissionSamplerSize:{value:new Tt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Qn},attenuationDistance:{value:0},attenuationColor:{value:new nn(0)},specularColor:{value:new nn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Qn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Qn},anisotropyVector:{value:new Tt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Qn}}]),vertexShader:ri.meshphysical_vert,fragmentShader:ri.meshphysical_frag};const m2={r:0,b:0,g:0},fp=new Ea,jee=new kn;function Wee(t,e,n,i,r,s,a){const o=new nn(0);let l=s===!0?0:1,u,c,h=null,d=0,m=null;function v(S){let E=S.isScene===!0?S.background:null;return E&&E.isTexture&&(E=(S.backgroundBlurriness>0?n:e).get(E)),E}function _(S){let E=!1;const A=v(S);A===null?g(o,l):A&&A.isColor&&(g(A,1),E=!0);const T=t.xr.getEnvironmentBlendMode();T==="additive"?i.buffers.color.setClear(0,0,0,1,a):T==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,a),(t.autoClear||E)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function y(S,E){const A=v(E);A&&(A.isCubeTexture||A.mapping===dv)?(c===void 0&&(c=new vr(new Pf(1,1,1),new su({name:"BackgroundCubeMaterial",uniforms:W0(Kl.backgroundCube.uniforms),vertexShader:Kl.backgroundCube.vertexShader,fragmentShader:Kl.backgroundCube.fragmentShader,side:La,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(T,C,O){this.matrixWorld.copyPosition(O.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),fp.copy(E.backgroundRotation),fp.x*=-1,fp.y*=-1,fp.z*=-1,A.isCubeTexture&&A.isRenderTargetTexture===!1&&(fp.y*=-1,fp.z*=-1),c.material.uniforms.envMap.value=A,c.material.uniforms.flipEnvMap.value=A.isCubeTexture&&A.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=E.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=E.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(jee.makeRotationFromEuler(fp)),c.material.toneMapped=Ei.getTransfer(A.colorSpace)!==Ki,(h!==A||d!==A.version||m!==t.toneMapping)&&(c.material.needsUpdate=!0,h=A,d=A.version,m=t.toneMapping),c.layers.enableAll(),S.unshift(c,c.geometry,c.material,0,0,null)):A&&A.isTexture&&(u===void 0&&(u=new vr(new Nf(2,2),new su({name:"BackgroundMaterial",uniforms:W0(Kl.background.uniforms),vertexShader:Kl.background.vertexShader,fragmentShader:Kl.background.fragmentShader,side:Af,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=A,u.material.uniforms.backgroundIntensity.value=E.backgroundIntensity,u.material.toneMapped=Ei.getTransfer(A.colorSpace)!==Ki,A.matrixAutoUpdate===!0&&A.updateMatrix(),u.material.uniforms.uvTransform.value.copy(A.matrix),(h!==A||d!==A.version||m!==t.toneMapping)&&(u.material.needsUpdate=!0,h=A,d=A.version,m=t.toneMapping),u.layers.enableAll(),S.unshift(u,u.geometry,u.material,0,0,null))}function g(S,E){S.getRGB(m2,NG(t)),i.buffers.color.setClear(m2.r,m2.g,m2.b,E,a)}function x(){c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return o},setClearColor:function(S,E=1){o.set(S),l=E,g(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(S){l=S,g(o,l)},render:_,addToRenderList:y,dispose:x}}function Xee(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},r=d(null);let s=r,a=!1;function o(D,P,F,G,z){let Y=!1;const N=h(G,F,P);s!==N&&(s=N,u(s.object)),Y=m(D,G,F,z),Y&&v(D,G,F,z),z!==null&&e.update(z,t.ELEMENT_ARRAY_BUFFER),(Y||a)&&(a=!1,E(D,P,F,G),z!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(z).buffer))}function l(){return t.createVertexArray()}function u(D){return t.bindVertexArray(D)}function c(D){return t.deleteVertexArray(D)}function h(D,P,F){const G=F.wireframe===!0;let z=i[D.id];z===void 0&&(z={},i[D.id]=z);let Y=z[P.id];Y===void 0&&(Y={},z[P.id]=Y);let N=Y[G];return N===void 0&&(N=d(l()),Y[G]=N),N}function d(D){const P=[],F=[],G=[];for(let z=0;z<n;z++)P[z]=0,F[z]=0,G[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:P,enabledAttributes:F,attributeDivisors:G,object:D,attributes:{},index:null}}function m(D,P,F,G){const z=s.attributes,Y=P.attributes;let N=0;const k=F.getAttributes();for(const j in k)if(k[j].location>=0){const Q=z[j];let H=Y[j];if(H===void 0&&(j==="instanceMatrix"&&D.instanceMatrix&&(H=D.instanceMatrix),j==="instanceColor"&&D.instanceColor&&(H=D.instanceColor)),Q===void 0||Q.attribute!==H||H&&Q.data!==H.data)return!0;N++}return s.attributesNum!==N||s.index!==G}function v(D,P,F,G){const z={},Y=P.attributes;let N=0;const k=F.getAttributes();for(const j in k)if(k[j].location>=0){let Q=Y[j];Q===void 0&&(j==="instanceMatrix"&&D.instanceMatrix&&(Q=D.instanceMatrix),j==="instanceColor"&&D.instanceColor&&(Q=D.instanceColor));const H={};H.attribute=Q,Q&&Q.data&&(H.data=Q.data),z[j]=H,N++}s.attributes=z,s.attributesNum=N,s.index=G}function _(){const D=s.newAttributes;for(let P=0,F=D.length;P<F;P++)D[P]=0}function y(D){g(D,0)}function g(D,P){const F=s.newAttributes,G=s.enabledAttributes,z=s.attributeDivisors;F[D]=1,G[D]===0&&(t.enableVertexAttribArray(D),G[D]=1),z[D]!==P&&(t.vertexAttribDivisor(D,P),z[D]=P)}function x(){const D=s.newAttributes,P=s.enabledAttributes;for(let F=0,G=P.length;F<G;F++)P[F]!==D[F]&&(t.disableVertexAttribArray(F),P[F]=0)}function S(D,P,F,G,z,Y,N){N===!0?t.vertexAttribIPointer(D,P,F,z,Y):t.vertexAttribPointer(D,P,F,G,z,Y)}function E(D,P,F,G){_();const z=G.attributes,Y=F.getAttributes(),N=P.defaultAttributeValues;for(const k in Y){const j=Y[k];if(j.location>=0){let X=z[k];if(X===void 0&&(k==="instanceMatrix"&&D.instanceMatrix&&(X=D.instanceMatrix),k==="instanceColor"&&D.instanceColor&&(X=D.instanceColor)),X!==void 0){const Q=X.normalized,H=X.itemSize,$=e.get(X);if($===void 0)continue;const ne=$.buffer,q=$.type,se=$.bytesPerElement,ve=q===t.INT||q===t.UNSIGNED_INT||X.gpuType===ZA;if(X.isInterleavedBufferAttribute){const pe=X.data,xe=pe.stride,ot=X.offset;if(pe.isInstancedInterleavedBuffer){for(let st=0;st<j.locationSize;st++)g(j.location+st,pe.meshPerAttribute);D.isInstancedMesh!==!0&&G._maxInstanceCount===void 0&&(G._maxInstanceCount=pe.meshPerAttribute*pe.count)}else for(let st=0;st<j.locationSize;st++)y(j.location+st);t.bindBuffer(t.ARRAY_BUFFER,ne);for(let st=0;st<j.locationSize;st++)S(j.location+st,H/j.locationSize,q,Q,xe*se,(ot+H/j.locationSize*st)*se,ve)}else{if(X.isInstancedBufferAttribute){for(let pe=0;pe<j.locationSize;pe++)g(j.location+pe,X.meshPerAttribute);D.isInstancedMesh!==!0&&G._maxInstanceCount===void 0&&(G._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let pe=0;pe<j.locationSize;pe++)y(j.location+pe);t.bindBuffer(t.ARRAY_BUFFER,ne);for(let pe=0;pe<j.locationSize;pe++)S(j.location+pe,H/j.locationSize,q,Q,H*se,H/j.locationSize*pe*se,ve)}}else if(N!==void 0){const Q=N[k];if(Q!==void 0)switch(Q.length){case 2:t.vertexAttrib2fv(j.location,Q);break;case 3:t.vertexAttrib3fv(j.location,Q);break;case 4:t.vertexAttrib4fv(j.location,Q);break;default:t.vertexAttrib1fv(j.location,Q)}}}}x()}function A(){O();for(const D in i){const P=i[D];for(const F in P){const G=P[F];for(const z in G)c(G[z].object),delete G[z];delete P[F]}delete i[D]}}function T(D){if(i[D.id]===void 0)return;const P=i[D.id];for(const F in P){const G=P[F];for(const z in G)c(G[z].object),delete G[z];delete P[F]}delete i[D.id]}function C(D){for(const P in i){const F=i[P];if(F[D.id]===void 0)continue;const G=F[D.id];for(const z in G)c(G[z].object),delete G[z];delete F[D.id]}}function O(){M(),a=!0,s!==r&&(s=r,u(s.object))}function M(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:o,reset:O,resetDefaultState:M,dispose:A,releaseStatesOfGeometry:T,releaseStatesOfProgram:C,initAttributes:_,enableAttribute:y,disableUnusedAttributes:x}}function Yee(t,e,n){let i;function r(u){i=u}function s(u,c){t.drawArrays(i,u,c),n.update(c,i,1)}function a(u,c,h){h!==0&&(t.drawArraysInstanced(i,u,c,h),n.update(c,i,h))}function o(u,c,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,u,0,c,0,h);let m=0;for(let v=0;v<h;v++)m+=c[v];n.update(m,i,1)}function l(u,c,h,d){if(h===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let v=0;v<u.length;v++)a(u[v],c[v],d[v]);else{m.multiDrawArraysInstancedWEBGL(i,u,0,c,0,d,0,h);let v=0;for(let _=0;_<h;_++)v+=c[_]*d[_];n.update(v,i,1)}}this.setMode=r,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=l}function Zee(t,e,n,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const C=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(C){return!(C!==Sa&&i.convert(C)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(C){const O=C===pv&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(C!==ml&&i.convert(C)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&C!==io&&!O)}function l(C){if(C==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return C==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=n.precision!==void 0?n.precision:"highp";const c=l(u);c!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",c,"instead."),u=c);const h=n.logarithmicDepthBuffer===!0,d=n.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),m=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),v=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=t.getParameter(t.MAX_TEXTURE_SIZE),y=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),g=t.getParameter(t.MAX_VERTEX_ATTRIBS),x=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),S=t.getParameter(t.MAX_VARYING_VECTORS),E=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),A=v>0,T=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:a,textureTypeReadable:o,precision:u,logarithmicDepthBuffer:h,reverseDepthBuffer:d,maxTextures:m,maxVertexTextures:v,maxTextureSize:_,maxCubemapSize:y,maxAttributes:g,maxVertexUniforms:x,maxVaryings:S,maxFragmentUniforms:E,vertexTextures:A,maxSamples:T}}function qee(t){const e=this;let n=null,i=0,r=!1,s=!1;const a=new ef,o=new Qn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const m=h.length!==0||d||i!==0||r;return r=d,i=h.length,m},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){n=c(h,d,0)},this.setState=function(h,d,m){const v=h.clippingPlanes,_=h.clipIntersection,y=h.clipShadows,g=t.get(h);if(!r||v===null||v.length===0||s&&!y)s?c(null):u();else{const x=s?0:i,S=x*4;let E=g.clippingState||null;l.value=E,E=c(v,d,S,m);for(let A=0;A!==S;++A)E[A]=n[A];g.clippingState=E,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=x}};function u(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function c(h,d,m,v){const _=h!==null?h.length:0;let y=null;if(_!==0){if(y=l.value,v!==!0||y===null){const g=m+_*4,x=d.matrixWorldInverse;o.getNormalMatrix(x),(y===null||y.length<g)&&(y=new Float32Array(g));for(let S=0,E=m;S!==_;++S,E+=4)a.copy(h[S]).applyMatrix4(x,o),a.normal.toArray(y,E),y[E+3]=a.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,y}}function Kee(t){let e=new WeakMap;function n(a,o){return o===z1?a.mapping=Tf:o===I1&&(a.mapping=ad),a}function i(a){if(a&&a.isTexture){const o=a.mapping;if(o===z1||o===I1)if(e.has(a)){const l=e.get(a).texture;return n(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const u=new kG(l.height);return u.fromEquirectangularTexture(t,a),e.set(a,u),a.addEventListener("dispose",r),n(u.texture,a.mapping)}else return null}}return a}function r(a){const o=a.target;o.removeEventListener("dispose",r);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}const f0=4,iP=[.125,.215,.35,.446,.526,.582],Ep=20,KC=new pm,rP=new nn;let QC=null,JC=0,$C=0,e3=!1;const bp=(1+Math.sqrt(5))/2,Og=1/bp,sP=[new re(-bp,Og,0),new re(bp,Og,0),new re(-Og,0,bp),new re(Og,0,bp),new re(0,bp,-Og),new re(0,bp,Og),new re(-1,1,-1),new re(1,1,-1),new re(-1,1,1),new re(1,1,1)],Qee=new re;class sD{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100,s={}){const{size:a=256,position:o=Qee}=s;QC=this._renderer.getRenderTarget(),JC=this._renderer.getActiveCubeFace(),$C=this._renderer.getActiveMipmapLevel(),e3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,i,r,l,o),n>0&&this._blur(l,0,0,n),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=lP(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=oP(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(QC,JC,$C),this._renderer.xr.enabled=e3,e.scissorTest=!1,g2(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===Tf||e.mapping===ad?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),QC=this._renderer.getRenderTarget(),JC=this._renderer.getActiveCubeFace(),$C=this._renderer.getActiveMipmapLevel(),e3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:ts,minFilter:ts,generateMipmaps:!1,type:pv,format:Sa,colorSpace:od,depthBuffer:!1},r=aP(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=aP(e,n,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Jee(s)),this._blurMaterial=$ee(s,e,n)}return r}_compileMaterial(e){const n=new vr(this._lodPlanes[0],e);this._renderer.compile(n,KC)}_sceneToCubeUV(e,n,i,r,s){const l=new ys(90,1,n,i),u=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,d=h.autoClear,m=h.toneMapping;h.getClearColor(rP),h.toneMapping=Ju,h.autoClear=!1;const v=new Lf({name:"PMREM.Background",side:La,depthWrite:!1,depthTest:!1}),_=new vr(new Pf,v);let y=!1;const g=e.background;g?g.isColor&&(v.color.copy(g),e.background=null,y=!0):(v.color.copy(rP),y=!0);for(let x=0;x<6;x++){const S=x%3;S===0?(l.up.set(0,u[x],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+c[x],s.y,s.z)):S===1?(l.up.set(0,0,u[x]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+c[x],s.z)):(l.up.set(0,u[x],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+c[x]));const E=this._cubeSize;g2(r,S*E,x>2?E:0,E,E),h.setRenderTarget(r),y&&h.render(_,l),h.render(e,l)}_.geometry.dispose(),_.material.dispose(),h.toneMapping=m,h.autoClear=d,e.background=g}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===Tf||e.mapping===ad;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=lP()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=oP());const s=r?this._cubemapMaterial:this._equirectMaterial,a=new vr(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;g2(n,0,0,3*l,2*l),i.setRenderTarget(n),i.render(a,KC)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),o=sP[(r-s-1)%sP.length];this._blur(e,s-1,s,a,o)}n.autoClear=i}_blur(e,n,i,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,i,r,"latitudinal",s),this._halfBlur(a,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,a,o){const l=this._renderer,u=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,h=new vr(this._lodPlanes[r],u),d=u.uniforms,m=this._sizeLods[i]-1,v=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*Ep-1),_=s/v,y=isFinite(s)?1+Math.floor(c*_):Ep;y>Ep&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${Ep}`);const g=[];let x=0;for(let C=0;C<Ep;++C){const O=C/_,M=Math.exp(-O*O/2);g.push(M),C===0?x+=M:C<y&&(x+=2*M)}for(let C=0;C<g.length;C++)g[C]=g[C]/x;d.envMap.value=e.texture,d.samples.value=y,d.weights.value=g,d.latitudinal.value=a==="latitudinal",o&&(d.poleAxis.value=o);const{_lodMax:S}=this;d.dTheta.value=v,d.mipInt.value=S-i;const E=this._sizeLods[r],A=3*E*(r>S-f0?r-S+f0:0),T=4*(this._cubeSize-E);g2(n,A,T,3*E,2*E),l.setRenderTarget(n),l.render(h,KC)}}function Jee(t){const e=[],n=[],i=[];let r=t;const s=t-f0+1+iP.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);n.push(o);let l=1/o;a>t-f0?l=iP[a-t+f0-1]:a===0&&(l=0),i.push(l);const u=1/(o-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],m=6,v=6,_=3,y=2,g=1,x=new Float32Array(_*v*m),S=new Float32Array(y*v*m),E=new Float32Array(g*v*m);for(let T=0;T<m;T++){const C=T%3*2/3-1,O=T>2?0:-1,M=[C,O,0,C+2/3,O,0,C+2/3,O+1,0,C,O,0,C+2/3,O+1,0,C,O+1,0];x.set(M,_*v*T),S.set(d,y*v*T);const D=[T,T,T,T,T,T];E.set(D,g*v*T)}const A=new ni;A.setAttribute("position",new Yi(x,_)),A.setAttribute("uv",new Yi(S,y)),A.setAttribute("faceIndex",new Yi(E,g)),e.push(A),r>f0&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function aP(t,e,n){const i=new sc(t,e,n);return i.texture.mapping=dv,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function g2(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function $ee(t,e,n){const i=new Float32Array(Ep),r=new re(0,1,0);return new su({name:"SphericalGaussianBlur",defines:{n:Ep,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:nz(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:gf,depthTest:!1,depthWrite:!1})}function oP(){return new su({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:nz(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:gf,depthTest:!1,depthWrite:!1})}function lP(){return new su({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:nz(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:gf,depthTest:!1,depthWrite:!1})}function nz(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function ete(t){let e=new WeakMap,n=null;function i(o){if(o&&o.isTexture){const l=o.mapping,u=l===z1||l===I1,c=l===Tf||l===ad;if(u||c){let h=e.get(o);const d=h!==void 0?h.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==d)return n===null&&(n=new sD(t)),h=u?n.fromEquirectangular(o,h):n.fromCubemap(o,h),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),h.texture;if(h!==void 0)return h.texture;{const m=o.image;return u&&m&&m.height>0||c&&m&&r(m)?(n===null&&(n=new sD(t)),h=u?n.fromEquirectangular(o):n.fromCubemap(o),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),o.addEventListener("dispose",s),h.texture):null}}}return o}function r(o){let l=0;const u=6;for(let c=0;c<u;c++)o[c]!==void 0&&l++;return l===u}function s(o){const l=o.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function a(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:a}}function tte(t){const e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){const r=n(i);return r===null&&uE("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function nte(t,e,n,i){const r={},s=new WeakMap;function a(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const v in d.attributes)e.remove(d.attributes[v]);d.removeEventListener("dispose",a),delete r[d.id];const m=s.get(d);m&&(e.remove(m),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,n.memory.geometries--}function o(h,d){return r[d.id]===!0||(d.addEventListener("dispose",a),r[d.id]=!0,n.memory.geometries++),d}function l(h){const d=h.attributes;for(const m in d)e.update(d[m],t.ARRAY_BUFFER)}function u(h){const d=[],m=h.index,v=h.attributes.position;let _=0;if(m!==null){const x=m.array;_=m.version;for(let S=0,E=x.length;S<E;S+=3){const A=x[S+0],T=x[S+1],C=x[S+2];d.push(A,T,T,C,C,A)}}else if(v!==void 0){const x=v.array;_=v.version;for(let S=0,E=x.length/3-1;S<E;S+=3){const A=S+0,T=S+1,C=S+2;d.push(A,T,T,C,C,A)}}else return;const y=new(zG(d)?OU:DU)(d,1);y.version=_;const g=s.get(h);g&&e.remove(g),s.set(h,y)}function c(h){const d=s.get(h);if(d){const m=h.index;m!==null&&d.version<m.version&&u(h)}else u(h);return s.get(h)}return{get:o,update:l,getWireframeAttribute:c}}function ite(t,e,n){let i;function r(d){i=d}let s,a;function o(d){s=d.type,a=d.bytesPerElement}function l(d,m){t.drawElements(i,m,s,d*a),n.update(m,i,1)}function u(d,m,v){v!==0&&(t.drawElementsInstanced(i,m,s,d*a,v),n.update(m,i,v))}function c(d,m,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,m,0,s,d,0,v);let y=0;for(let g=0;g<v;g++)y+=m[g];n.update(y,i,1)}function h(d,m,v,_){if(v===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let g=0;g<d.length;g++)u(d[g]/a,m[g],_[g]);else{y.multiDrawElementsInstancedWEBGL(i,m,0,s,d,0,_,0,v);let g=0;for(let x=0;x<v;x++)g+=m[x]*_[x];n.update(g,i,1)}}this.setMode=r,this.setIndex=o,this.render=l,this.renderInstances=u,this.renderMultiDraw=c,this.renderMultiDrawInstances=h}function rte(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(n.calls++,a){case t.TRIANGLES:n.triangles+=o*(s/3);break;case t.LINES:n.lines+=o*(s/2);break;case t.LINE_STRIP:n.lines+=o*(s-1);break;case t.LINE_LOOP:n.lines+=o*s;break;case t.POINTS:n.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function ste(t,e,n){const i=new WeakMap,r=new bi;function s(a,o,l){const u=a.morphTargetInfluences,c=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,h=c!==void 0?c.length:0;let d=i.get(o);if(d===void 0||d.count!==h){let M=function(){C.dispose(),i.delete(o),o.removeEventListener("dispose",M)};d!==void 0&&d.texture.dispose();const m=o.morphAttributes.position!==void 0,v=o.morphAttributes.normal!==void 0,_=o.morphAttributes.color!==void 0,y=o.morphAttributes.position||[],g=o.morphAttributes.normal||[],x=o.morphAttributes.color||[];let S=0;m===!0&&(S=1),v===!0&&(S=2),_===!0&&(S=3);let E=o.attributes.position.count*S,A=1;E>e.maxTextureSize&&(A=Math.ceil(E/e.maxTextureSize),E=e.maxTextureSize);const T=new Float32Array(E*A*4*h),C=new F_(T,E,A,h);C.type=io,C.needsUpdate=!0;const O=S*4;for(let D=0;D<h;D++){const P=y[D],F=g[D],G=x[D],z=E*A*4*D;for(let Y=0;Y<P.count;Y++){const N=Y*O;m===!0&&(r.fromBufferAttribute(P,Y),T[z+N+0]=r.x,T[z+N+1]=r.y,T[z+N+2]=r.z,T[z+N+3]=0),v===!0&&(r.fromBufferAttribute(F,Y),T[z+N+4]=r.x,T[z+N+5]=r.y,T[z+N+6]=r.z,T[z+N+7]=0),_===!0&&(r.fromBufferAttribute(G,Y),T[z+N+8]=r.x,T[z+N+9]=r.y,T[z+N+10]=r.z,T[z+N+11]=G.itemSize===4?r.w:1)}}d={count:h,texture:C,size:new Tt(E,A)},i.set(o,d),o.addEventListener("dispose",M)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)l.getUniforms().setValue(t,"morphTexture",a.morphTexture,n);else{let m=0;for(let _=0;_<u.length;_++)m+=u[_];const v=o.morphTargetsRelative?1:1-m;l.getUniforms().setValue(t,"morphTargetBaseInfluence",v),l.getUniforms().setValue(t,"morphTargetInfluences",u)}l.getUniforms().setValue(t,"morphTargetsTexture",d.texture,n),l.getUniforms().setValue(t,"morphTargetsTextureSize",d.size)}return{update:s}}function ate(t,e,n,i){let r=new WeakMap;function s(l){const u=i.render.frame,c=l.geometry,h=e.get(l,c);if(r.get(h)!==u&&(e.update(h),r.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.get(l)!==u&&(n.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&n.update(l.instanceColor,t.ARRAY_BUFFER),r.set(l,u))),l.isSkinnedMesh){const d=l.skeleton;r.get(d)!==u&&(d.update(),r.set(d,u))}return h}function a(){r=new WeakMap}function o(l){const u=l.target;u.removeEventListener("dispose",o),n.remove(u.instanceMatrix),u.instanceColor!==null&&n.remove(u.instanceColor)}return{update:s,dispose:a}}const N8=new Gr,uP=new fT(1,1),B8=new F_,k8=new nT,F8=new G_,cP=[],fP=[],hP=new Float32Array(16),dP=new Float32Array(9),pP=new Float32Array(4);function vv(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=cP[r];if(s===void 0&&(s=new Float32Array(r),cP[r]=s),e!==0){i.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=n,t[a].toArray(s,o)}return s}function Is(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Ls(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function CT(t,e){let n=fP[e];n===void 0&&(n=new Int32Array(e),fP[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function ote(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function lte(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Is(n,e))return;t.uniform2fv(this.addr,e),Ls(n,e)}}function ute(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Is(n,e))return;t.uniform3fv(this.addr,e),Ls(n,e)}}function cte(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Is(n,e))return;t.uniform4fv(this.addr,e),Ls(n,e)}}function fte(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Is(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Ls(n,e)}else{if(Is(n,i))return;pP.set(i),t.uniformMatrix2fv(this.addr,!1,pP),Ls(n,i)}}function hte(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Is(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Ls(n,e)}else{if(Is(n,i))return;dP.set(i),t.uniformMatrix3fv(this.addr,!1,dP),Ls(n,i)}}function dte(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Is(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Ls(n,e)}else{if(Is(n,i))return;hP.set(i),t.uniformMatrix4fv(this.addr,!1,hP),Ls(n,i)}}function pte(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function mte(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Is(n,e))return;t.uniform2iv(this.addr,e),Ls(n,e)}}function gte(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Is(n,e))return;t.uniform3iv(this.addr,e),Ls(n,e)}}function vte(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Is(n,e))return;t.uniform4iv(this.addr,e),Ls(n,e)}}function yte(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function xte(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Is(n,e))return;t.uniform2uiv(this.addr,e),Ls(n,e)}}function _te(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Is(n,e))return;t.uniform3uiv(this.addr,e),Ls(n,e)}}function bte(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Is(n,e))return;t.uniform4uiv(this.addr,e),Ls(n,e)}}function Ste(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r);let s;this.type===t.SAMPLER_2D_SHADOW?(uP.compareFunction=CU,s=uP):s=N8,n.setTexture2D(e||s,r)}function Ete(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||k8,r)}function wte(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||F8,r)}function Ate(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||B8,r)}function Tte(t){switch(t){case 5126:return ote;case 35664:return lte;case 35665:return ute;case 35666:return cte;case 35674:return fte;case 35675:return hte;case 35676:return dte;case 5124:case 35670:return pte;case 35667:case 35671:return mte;case 35668:case 35672:return gte;case 35669:case 35673:return vte;case 5125:return yte;case 36294:return xte;case 36295:return _te;case 36296:return bte;case 35678:case 36198:case 36298:case 36306:case 35682:return Ste;case 35679:case 36299:case 36307:return Ete;case 35680:case 36300:case 36308:case 36293:return wte;case 36289:case 36303:case 36311:case 36292:return Ate}}function Mte(t,e){t.uniform1fv(this.addr,e)}function Cte(t,e){const n=vv(e,this.size,2);t.uniform2fv(this.addr,n)}function Rte(t,e){const n=vv(e,this.size,3);t.uniform3fv(this.addr,n)}function Dte(t,e){const n=vv(e,this.size,4);t.uniform4fv(this.addr,n)}function Ote(t,e){const n=vv(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Ute(t,e){const n=vv(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function zte(t,e){const n=vv(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Ite(t,e){t.uniform1iv(this.addr,e)}function Lte(t,e){t.uniform2iv(this.addr,e)}function Pte(t,e){t.uniform3iv(this.addr,e)}function Nte(t,e){t.uniform4iv(this.addr,e)}function Bte(t,e){t.uniform1uiv(this.addr,e)}function kte(t,e){t.uniform2uiv(this.addr,e)}function Fte(t,e){t.uniform3uiv(this.addr,e)}function Gte(t,e){t.uniform4uiv(this.addr,e)}function Vte(t,e,n){const i=this.cache,r=e.length,s=CT(n,r);Is(i,s)||(t.uniform1iv(this.addr,s),Ls(i,s));for(let a=0;a!==r;++a)n.setTexture2D(e[a]||N8,s[a])}function Hte(t,e,n){const i=this.cache,r=e.length,s=CT(n,r);Is(i,s)||(t.uniform1iv(this.addr,s),Ls(i,s));for(let a=0;a!==r;++a)n.setTexture3D(e[a]||k8,s[a])}function jte(t,e,n){const i=this.cache,r=e.length,s=CT(n,r);Is(i,s)||(t.uniform1iv(this.addr,s),Ls(i,s));for(let a=0;a!==r;++a)n.setTextureCube(e[a]||F8,s[a])}function Wte(t,e,n){const i=this.cache,r=e.length,s=CT(n,r);Is(i,s)||(t.uniform1iv(this.addr,s),Ls(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(e[a]||B8,s[a])}function Xte(t){switch(t){case 5126:return Mte;case 35664:return Cte;case 35665:return Rte;case 35666:return Dte;case 35674:return Ote;case 35675:return Ute;case 35676:return zte;case 5124:case 35670:return Ite;case 35667:case 35671:return Lte;case 35668:case 35672:return Pte;case 35669:case 35673:return Nte;case 5125:return Bte;case 36294:return kte;case 36295:return Fte;case 36296:return Gte;case 35678:case 36198:case 36298:case 36306:case 35682:return Vte;case 35679:case 36299:case 36307:return Hte;case 35680:case 36300:case 36308:case 36293:return jte;case 36289:case 36303:case 36311:case 36292:return Wte}}class Yte{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=Tte(n.type)}}class Zte{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=Xte(n.type)}}class qte{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const o=r[s];o.setValue(e,n[o.id],i)}}}const t3=/(\w+)(\])?(\[|\.)?/g;function mP(t,e){t.seq.push(e),t.map[e.id]=e}function Kte(t,e,n){const i=t.name,r=i.length;for(t3.lastIndex=0;;){const s=t3.exec(i),a=t3.lastIndex;let o=s[1];const l=s[2]==="]",u=s[3];if(l&&(o=o|0),u===void 0||u==="["&&a+2===r){mP(n,u===void 0?new Yte(o,t,e):new Zte(o,t,e));break}else{let h=n.map[o];h===void 0&&(h=new qte(o),mP(n,h)),n=h}}}class fE{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(n,r),a=e.getUniformLocation(n,s.name);Kte(s,a,this)}}setValue(e,n,i,r){const s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,a=n.length;s!==a;++s){const o=n[s],l=i[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in n&&i.push(a)}return i}}function gP(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}const Qte=37297;let Jte=0;function $te(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let a=r;a<s;a++){const o=a+1;i.push(`${o===e?">":" "} ${o}: ${n[a]}`)}return i.join(`
`)}const vP=new Qn;function ene(t){Ei._getMatrix(vP,Ei.workingColorSpace,t);const e=`mat3( ${vP.elements.map(n=>n.toFixed(4))} )`;switch(Ei.getTransfer(t)){case k1:return[e,"LinearTransferOETF"];case Ki:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function yP(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const a=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+$te(t.getShaderSource(e),a)}else return r}function tne(t,e){const n=ene(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function nne(t,e){let n;switch(e){case pG:n="Linear";break;case mG:n="Reinhard";break;case gG:n="Cineon";break;case vU:n="ACESFilmic";break;case yG:n="AgX";break;case xG:n="Neutral";break;case vG:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const v2=new re;function ine(){Ei.getLuminanceCoefficients(v2);const t=v2.x.toFixed(4),e=v2.y.toFixed(4),n=v2.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function rne(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Ux).join(`
`)}function sne(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function ane(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=t.getActiveAttrib(e,r),a=s.name;let o=1;s.type===t.FLOAT_MAT2&&(o=2),s.type===t.FLOAT_MAT3&&(o=3),s.type===t.FLOAT_MAT4&&(o=4),n[a]={type:s.type,location:t.getAttribLocation(e,a),locationSize:o}}return n}function Ux(t){return t!==""}function xP(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function _P(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const one=/^[ \t]*#include +<([\w\d./]+)>/gm;function aD(t){return t.replace(one,une)}const lne=new Map;function une(t,e){let n=ri[e];if(n===void 0){const i=lne.get(e);if(i!==void 0)n=ri[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return aD(n)}const cne=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function bP(t){return t.replace(cne,fne)}function fne(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function SP(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function hne(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===XA?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===e1?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Zl&&(e="SHADOWMAP_TYPE_VSM"),e}function dne(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Tf:case ad:e="ENVMAP_TYPE_CUBE";break;case dv:e="ENVMAP_TYPE_CUBE_UV";break}return e}function pne(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case ad:e="ENVMAP_MODE_REFRACTION";break}return e}function mne(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case B_:e="ENVMAP_BLENDING_MULTIPLY";break;case hG:e="ENVMAP_BLENDING_MIX";break;case dG:e="ENVMAP_BLENDING_ADD";break}return e}function gne(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function vne(t,e,n,i){const r=t.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const l=hne(n),u=dne(n),c=pne(n),h=mne(n),d=gne(n),m=rne(n),v=sne(s),_=r.createProgram();let y,g,x=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v].filter(Ux).join(`
`),y.length>0&&(y+=`
`),g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v].filter(Ux).join(`
`),g.length>0&&(g+=`
`)):(y=[SP(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ux).join(`
`),g=[SP(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+c:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ju?"#define TONE_MAPPING":"",n.toneMapping!==Ju?ri.tonemapping_pars_fragment:"",n.toneMapping!==Ju?nne("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",ri.colorspace_pars_fragment,tne("linearToOutputTexel",n.outputColorSpace),ine(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Ux).join(`
`)),a=aD(a),a=xP(a,n),a=_P(a,n),o=aD(o),o=xP(o,n),o=_P(o,n),a=bP(a),o=bP(o),n.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,y=[m,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,g=["#define varying in",n.glslVersion===QR?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===QR?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);const S=x+y+a,E=x+g+o,A=gP(r,r.VERTEX_SHADER,S),T=gP(r,r.FRAGMENT_SHADER,E);r.attachShader(_,A),r.attachShader(_,T),n.index0AttributeName!==void 0?r.bindAttribLocation(_,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_);function C(P){if(t.debug.checkShaderErrors){const F=r.getProgramInfoLog(_).trim(),G=r.getShaderInfoLog(A).trim(),z=r.getShaderInfoLog(T).trim();let Y=!0,N=!0;if(r.getProgramParameter(_,r.LINK_STATUS)===!1)if(Y=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,_,A,T);else{const k=yP(r,A,"vertex"),j=yP(r,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,r.VALIDATE_STATUS)+`

Material Name: `+P.name+`
Material Type: `+P.type+`

Program Info Log: `+F+`
`+k+`
`+j)}else F!==""?console.warn("THREE.WebGLProgram: Program Info Log:",F):(G===""||z==="")&&(N=!1);N&&(P.diagnostics={runnable:Y,programLog:F,vertexShader:{log:G,prefix:y},fragmentShader:{log:z,prefix:g}})}r.deleteShader(A),r.deleteShader(T),O=new fE(r,_),M=ane(r,_)}let O;this.getUniforms=function(){return O===void 0&&C(this),O};let M;this.getAttributes=function(){return M===void 0&&C(this),M};let D=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return D===!1&&(D=r.getProgramParameter(_,Qte)),D},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Jte++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=A,this.fragmentShader=T,this}let yne=0;class xne{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new _ne(e),n.set(e,i)),i}}class _ne{constructor(e){this.id=yne++,this.code=e,this.usedTimes=0}}function bne(t,e,n,i,r,s,a){const o=new j0,l=new xne,u=new Set,c=[],h=r.logarithmicDepthBuffer,d=r.vertexTextures;let m=r.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(M){return u.add(M),M===0?"uv":`uv${M}`}function y(M,D,P,F,G){const z=F.fog,Y=G.geometry,N=M.isMeshStandardMaterial?F.environment:null,k=(M.isMeshStandardMaterial?n:e).get(M.envMap||N),j=k&&k.mapping===dv?k.image.height:null,X=v[M.type];M.precision!==null&&(m=r.getMaxPrecision(M.precision),m!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",m,"instead."));const Q=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,H=Q!==void 0?Q.length:0;let $=0;Y.morphAttributes.position!==void 0&&($=1),Y.morphAttributes.normal!==void 0&&($=2),Y.morphAttributes.color!==void 0&&($=3);let ne,q,se,ve;if(X){const An=Kl[X];ne=An.vertexShader,q=An.fragmentShader}else ne=M.vertexShader,q=M.fragmentShader,l.update(M),se=l.getVertexShaderID(M),ve=l.getFragmentShaderID(M);const pe=t.getRenderTarget(),xe=t.state.buffers.depth.getReversed(),ot=G.isInstancedMesh===!0,st=G.isBatchedMesh===!0,et=!!M.map,Te=!!M.matcap,Xe=!!k,K=!!M.aoMap,Pe=!!M.lightMap,Ne=!!M.bumpMap,Ve=!!M.normalMap,_e=!!M.displacementMap,ft=!!M.emissiveMap,ke=!!M.metalnessMap,Z=!!M.roughnessMap,W=M.anisotropy>0,I=M.clearcoat>0,De=M.dispersion>0,ge=M.iridescence>0,ze=M.sheen>0,ct=M.transmission>0,at=W&&!!M.anisotropyMap,Rt=I&&!!M.clearcoatMap,Nt=I&&!!M.clearcoatNormalMap,vt=I&&!!M.clearcoatRoughnessMap,Vt=ge&&!!M.iridescenceMap,Bt=ge&&!!M.iridescenceThicknessMap,Ht=ze&&!!M.sheenColorMap,ut=ze&&!!M.sheenRoughnessMap,xn=!!M.specularMap,un=!!M.specularColorMap,Vn=!!M.specularIntensityMap,be=ct&&!!M.transmissionMap,_t=ct&&!!M.thicknessMap,Ye=!!M.gradientMap,Et=!!M.alphaMap,Ot=M.alphaTest>0,Mt=!!M.alphaHash,vn=!!M.extensions;let Un=Ju;M.toneMapped&&(pe===null||pe.isXRRenderTarget===!0)&&(Un=t.toneMapping);const an={shaderID:X,shaderType:M.type,shaderName:M.name,vertexShader:ne,fragmentShader:q,defines:M.defines,customVertexShaderID:se,customFragmentShaderID:ve,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:m,batching:st,batchingColor:st&&G._colorsTexture!==null,instancing:ot,instancingColor:ot&&G.instanceColor!==null,instancingMorph:ot&&G.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:pe===null?t.outputColorSpace:pe.isXRRenderTarget===!0?pe.texture.colorSpace:od,alphaToCoverage:!!M.alphaToCoverage,map:et,matcap:Te,envMap:Xe,envMapMode:Xe&&k.mapping,envMapCubeUVHeight:j,aoMap:K,lightMap:Pe,bumpMap:Ne,normalMap:Ve,displacementMap:d&&_e,emissiveMap:ft,normalMapObjectSpace:Ve&&M.normalMapType===AG,normalMapTangentSpace:Ve&&M.normalMapType===dd,metalnessMap:ke,roughnessMap:Z,anisotropy:W,anisotropyMap:at,clearcoat:I,clearcoatMap:Rt,clearcoatNormalMap:Nt,clearcoatRoughnessMap:vt,dispersion:De,iridescence:ge,iridescenceMap:Vt,iridescenceThicknessMap:Bt,sheen:ze,sheenColorMap:Ht,sheenRoughnessMap:ut,specularMap:xn,specularColorMap:un,specularIntensityMap:Vn,transmission:ct,transmissionMap:be,thicknessMap:_t,gradientMap:Ye,opaque:M.transparent===!1&&M.blending===Np&&M.alphaToCoverage===!1,alphaMap:Et,alphaTest:Ot,alphaHash:Mt,combine:M.combine,mapUv:et&&_(M.map.channel),aoMapUv:K&&_(M.aoMap.channel),lightMapUv:Pe&&_(M.lightMap.channel),bumpMapUv:Ne&&_(M.bumpMap.channel),normalMapUv:Ve&&_(M.normalMap.channel),displacementMapUv:_e&&_(M.displacementMap.channel),emissiveMapUv:ft&&_(M.emissiveMap.channel),metalnessMapUv:ke&&_(M.metalnessMap.channel),roughnessMapUv:Z&&_(M.roughnessMap.channel),anisotropyMapUv:at&&_(M.anisotropyMap.channel),clearcoatMapUv:Rt&&_(M.clearcoatMap.channel),clearcoatNormalMapUv:Nt&&_(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:vt&&_(M.clearcoatRoughnessMap.channel),iridescenceMapUv:Vt&&_(M.iridescenceMap.channel),iridescenceThicknessMapUv:Bt&&_(M.iridescenceThicknessMap.channel),sheenColorMapUv:Ht&&_(M.sheenColorMap.channel),sheenRoughnessMapUv:ut&&_(M.sheenRoughnessMap.channel),specularMapUv:xn&&_(M.specularMap.channel),specularColorMapUv:un&&_(M.specularColorMap.channel),specularIntensityMapUv:Vn&&_(M.specularIntensityMap.channel),transmissionMapUv:be&&_(M.transmissionMap.channel),thicknessMapUv:_t&&_(M.thicknessMap.channel),alphaMapUv:Et&&_(M.alphaMap.channel),vertexTangents:!!Y.attributes.tangent&&(Ve||W),vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!Y.attributes.color&&Y.attributes.color.itemSize===4,pointsUvs:G.isPoints===!0&&!!Y.attributes.uv&&(et||Et),fog:!!z,useFog:M.fog===!0,fogExp2:!!z&&z.isFogExp2,flatShading:M.flatShading===!0,sizeAttenuation:M.sizeAttenuation===!0,logarithmicDepthBuffer:h,reverseDepthBuffer:xe,skinning:G.isSkinnedMesh===!0,morphTargets:Y.morphAttributes.position!==void 0,morphNormals:Y.morphAttributes.normal!==void 0,morphColors:Y.morphAttributes.color!==void 0,morphTargetsCount:H,morphTextureStride:$,numDirLights:D.directional.length,numPointLights:D.point.length,numSpotLights:D.spot.length,numSpotLightMaps:D.spotLightMap.length,numRectAreaLights:D.rectArea.length,numHemiLights:D.hemi.length,numDirLightShadows:D.directionalShadowMap.length,numPointLightShadows:D.pointShadowMap.length,numSpotLightShadows:D.spotShadowMap.length,numSpotLightShadowsWithMaps:D.numSpotLightShadowsWithMaps,numLightProbes:D.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:M.dithering,shadowMapEnabled:t.shadowMap.enabled&&P.length>0,shadowMapType:t.shadowMap.type,toneMapping:Un,decodeVideoTexture:et&&M.map.isVideoTexture===!0&&Ei.getTransfer(M.map.colorSpace)===Ki,decodeVideoTextureEmissive:ft&&M.emissiveMap.isVideoTexture===!0&&Ei.getTransfer(M.emissiveMap.colorSpace)===Ki,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===es,flipSided:M.side===La,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionClipCullDistance:vn&&M.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(vn&&M.extensions.multiDraw===!0||st)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:M.customProgramCacheKey()};return an.vertexUv1s=u.has(1),an.vertexUv2s=u.has(2),an.vertexUv3s=u.has(3),u.clear(),an}function g(M){const D=[];if(M.shaderID?D.push(M.shaderID):(D.push(M.customVertexShaderID),D.push(M.customFragmentShaderID)),M.defines!==void 0)for(const P in M.defines)D.push(P),D.push(M.defines[P]);return M.isRawShaderMaterial===!1&&(x(D,M),S(D,M),D.push(t.outputColorSpace)),D.push(M.customProgramCacheKey),D.join()}function x(M,D){M.push(D.precision),M.push(D.outputColorSpace),M.push(D.envMapMode),M.push(D.envMapCubeUVHeight),M.push(D.mapUv),M.push(D.alphaMapUv),M.push(D.lightMapUv),M.push(D.aoMapUv),M.push(D.bumpMapUv),M.push(D.normalMapUv),M.push(D.displacementMapUv),M.push(D.emissiveMapUv),M.push(D.metalnessMapUv),M.push(D.roughnessMapUv),M.push(D.anisotropyMapUv),M.push(D.clearcoatMapUv),M.push(D.clearcoatNormalMapUv),M.push(D.clearcoatRoughnessMapUv),M.push(D.iridescenceMapUv),M.push(D.iridescenceThicknessMapUv),M.push(D.sheenColorMapUv),M.push(D.sheenRoughnessMapUv),M.push(D.specularMapUv),M.push(D.specularColorMapUv),M.push(D.specularIntensityMapUv),M.push(D.transmissionMapUv),M.push(D.thicknessMapUv),M.push(D.combine),M.push(D.fogExp2),M.push(D.sizeAttenuation),M.push(D.morphTargetsCount),M.push(D.morphAttributeCount),M.push(D.numDirLights),M.push(D.numPointLights),M.push(D.numSpotLights),M.push(D.numSpotLightMaps),M.push(D.numHemiLights),M.push(D.numRectAreaLights),M.push(D.numDirLightShadows),M.push(D.numPointLightShadows),M.push(D.numSpotLightShadows),M.push(D.numSpotLightShadowsWithMaps),M.push(D.numLightProbes),M.push(D.shadowMapType),M.push(D.toneMapping),M.push(D.numClippingPlanes),M.push(D.numClipIntersection),M.push(D.depthPacking)}function S(M,D){o.disableAll(),D.supportsVertexTextures&&o.enable(0),D.instancing&&o.enable(1),D.instancingColor&&o.enable(2),D.instancingMorph&&o.enable(3),D.matcap&&o.enable(4),D.envMap&&o.enable(5),D.normalMapObjectSpace&&o.enable(6),D.normalMapTangentSpace&&o.enable(7),D.clearcoat&&o.enable(8),D.iridescence&&o.enable(9),D.alphaTest&&o.enable(10),D.vertexColors&&o.enable(11),D.vertexAlphas&&o.enable(12),D.vertexUv1s&&o.enable(13),D.vertexUv2s&&o.enable(14),D.vertexUv3s&&o.enable(15),D.vertexTangents&&o.enable(16),D.anisotropy&&o.enable(17),D.alphaHash&&o.enable(18),D.batching&&o.enable(19),D.dispersion&&o.enable(20),D.batchingColor&&o.enable(21),M.push(o.mask),o.disableAll(),D.fog&&o.enable(0),D.useFog&&o.enable(1),D.flatShading&&o.enable(2),D.logarithmicDepthBuffer&&o.enable(3),D.reverseDepthBuffer&&o.enable(4),D.skinning&&o.enable(5),D.morphTargets&&o.enable(6),D.morphNormals&&o.enable(7),D.morphColors&&o.enable(8),D.premultipliedAlpha&&o.enable(9),D.shadowMapEnabled&&o.enable(10),D.doubleSided&&o.enable(11),D.flipSided&&o.enable(12),D.useDepthPacking&&o.enable(13),D.dithering&&o.enable(14),D.transmission&&o.enable(15),D.sheen&&o.enable(16),D.opaque&&o.enable(17),D.pointsUvs&&o.enable(18),D.decodeVideoTexture&&o.enable(19),D.decodeVideoTextureEmissive&&o.enable(20),D.alphaToCoverage&&o.enable(21),M.push(o.mask)}function E(M){const D=v[M.type];let P;if(D){const F=Kl[D];P=UU.clone(F.uniforms)}else P=M.uniforms;return P}function A(M,D){let P;for(let F=0,G=c.length;F<G;F++){const z=c[F];if(z.cacheKey===D){P=z,++P.usedTimes;break}}return P===void 0&&(P=new vne(t,D,M,s),c.push(P)),P}function T(M){if(--M.usedTimes===0){const D=c.indexOf(M);c[D]=c[c.length-1],c.pop(),M.destroy()}}function C(M){l.remove(M)}function O(){l.dispose()}return{getParameters:y,getProgramCacheKey:g,getUniforms:E,acquireProgram:A,releaseProgram:T,releaseShaderCache:C,programs:c,dispose:O}}function Sne(){let t=new WeakMap;function e(a){return t.has(a)}function n(a){let o=t.get(a);return o===void 0&&(o={},t.set(a,o)),o}function i(a){t.delete(a)}function r(a,o,l){t.get(a)[o]=l}function s(){t=new WeakMap}return{has:e,get:n,remove:i,update:r,dispose:s}}function Ene(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function EP(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function wP(){const t=[];let e=0;const n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function a(h,d,m,v,_,y){let g=t[e];return g===void 0?(g={id:h.id,object:h,geometry:d,material:m,groupOrder:v,renderOrder:h.renderOrder,z:_,group:y},t[e]=g):(g.id=h.id,g.object=h,g.geometry=d,g.material=m,g.groupOrder=v,g.renderOrder=h.renderOrder,g.z=_,g.group=y),e++,g}function o(h,d,m,v,_,y){const g=a(h,d,m,v,_,y);m.transmission>0?i.push(g):m.transparent===!0?r.push(g):n.push(g)}function l(h,d,m,v,_,y){const g=a(h,d,m,v,_,y);m.transmission>0?i.unshift(g):m.transparent===!0?r.unshift(g):n.unshift(g)}function u(h,d){n.length>1&&n.sort(h||Ene),i.length>1&&i.sort(d||EP),r.length>1&&r.sort(d||EP)}function c(){for(let h=e,d=t.length;h<d;h++){const m=t[h];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:o,unshift:l,finish:c,sort:u}}function wne(){let t=new WeakMap;function e(i,r){const s=t.get(i);let a;return s===void 0?(a=new wP,t.set(i,[a])):r>=s.length?(a=new wP,s.push(a)):a=s[r],a}function n(){t=new WeakMap}return{get:e,dispose:n}}function Ane(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new re,color:new nn};break;case"SpotLight":n={position:new re,direction:new re,color:new nn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new re,color:new nn,distance:0,decay:0};break;case"HemisphereLight":n={direction:new re,skyColor:new nn,groundColor:new nn};break;case"RectAreaLight":n={color:new nn,position:new re,halfWidth:new re,halfHeight:new re};break}return t[e.id]=n,n}}}function Tne(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Tt};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Tt};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Tt,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let Mne=0;function Cne(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Rne(t){const e=new Ane,n=Tne(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new re);const r=new re,s=new kn,a=new kn;function o(u){let c=0,h=0,d=0;for(let M=0;M<9;M++)i.probe[M].set(0,0,0);let m=0,v=0,_=0,y=0,g=0,x=0,S=0,E=0,A=0,T=0,C=0;u.sort(Cne);for(let M=0,D=u.length;M<D;M++){const P=u[M],F=P.color,G=P.intensity,z=P.distance,Y=P.shadow&&P.shadow.map?P.shadow.map.texture:null;if(P.isAmbientLight)c+=F.r*G,h+=F.g*G,d+=F.b*G;else if(P.isLightProbe){for(let N=0;N<9;N++)i.probe[N].addScaledVector(P.sh.coefficients[N],G);C++}else if(P.isDirectionalLight){const N=e.get(P);if(N.color.copy(P.color).multiplyScalar(P.intensity),P.castShadow){const k=P.shadow,j=n.get(P);j.shadowIntensity=k.intensity,j.shadowBias=k.bias,j.shadowNormalBias=k.normalBias,j.shadowRadius=k.radius,j.shadowMapSize=k.mapSize,i.directionalShadow[m]=j,i.directionalShadowMap[m]=Y,i.directionalShadowMatrix[m]=P.shadow.matrix,x++}i.directional[m]=N,m++}else if(P.isSpotLight){const N=e.get(P);N.position.setFromMatrixPosition(P.matrixWorld),N.color.copy(F).multiplyScalar(G),N.distance=z,N.coneCos=Math.cos(P.angle),N.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),N.decay=P.decay,i.spot[_]=N;const k=P.shadow;if(P.map&&(i.spotLightMap[A]=P.map,A++,k.updateMatrices(P),P.castShadow&&T++),i.spotLightMatrix[_]=k.matrix,P.castShadow){const j=n.get(P);j.shadowIntensity=k.intensity,j.shadowBias=k.bias,j.shadowNormalBias=k.normalBias,j.shadowRadius=k.radius,j.shadowMapSize=k.mapSize,i.spotShadow[_]=j,i.spotShadowMap[_]=Y,E++}_++}else if(P.isRectAreaLight){const N=e.get(P);N.color.copy(F).multiplyScalar(G),N.halfWidth.set(P.width*.5,0,0),N.halfHeight.set(0,P.height*.5,0),i.rectArea[y]=N,y++}else if(P.isPointLight){const N=e.get(P);if(N.color.copy(P.color).multiplyScalar(P.intensity),N.distance=P.distance,N.decay=P.decay,P.castShadow){const k=P.shadow,j=n.get(P);j.shadowIntensity=k.intensity,j.shadowBias=k.bias,j.shadowNormalBias=k.normalBias,j.shadowRadius=k.radius,j.shadowMapSize=k.mapSize,j.shadowCameraNear=k.camera.near,j.shadowCameraFar=k.camera.far,i.pointShadow[v]=j,i.pointShadowMap[v]=Y,i.pointShadowMatrix[v]=P.shadow.matrix,S++}i.point[v]=N,v++}else if(P.isHemisphereLight){const N=e.get(P);N.skyColor.copy(P.color).multiplyScalar(G),N.groundColor.copy(P.groundColor).multiplyScalar(G),i.hemi[g]=N,g++}}y>0&&(t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=ln.LTC_FLOAT_1,i.rectAreaLTC2=ln.LTC_FLOAT_2):(i.rectAreaLTC1=ln.LTC_HALF_1,i.rectAreaLTC2=ln.LTC_HALF_2)),i.ambient[0]=c,i.ambient[1]=h,i.ambient[2]=d;const O=i.hash;(O.directionalLength!==m||O.pointLength!==v||O.spotLength!==_||O.rectAreaLength!==y||O.hemiLength!==g||O.numDirectionalShadows!==x||O.numPointShadows!==S||O.numSpotShadows!==E||O.numSpotMaps!==A||O.numLightProbes!==C)&&(i.directional.length=m,i.spot.length=_,i.rectArea.length=y,i.point.length=v,i.hemi.length=g,i.directionalShadow.length=x,i.directionalShadowMap.length=x,i.pointShadow.length=S,i.pointShadowMap.length=S,i.spotShadow.length=E,i.spotShadowMap.length=E,i.directionalShadowMatrix.length=x,i.pointShadowMatrix.length=S,i.spotLightMatrix.length=E+A-T,i.spotLightMap.length=A,i.numSpotLightShadowsWithMaps=T,i.numLightProbes=C,O.directionalLength=m,O.pointLength=v,O.spotLength=_,O.rectAreaLength=y,O.hemiLength=g,O.numDirectionalShadows=x,O.numPointShadows=S,O.numSpotShadows=E,O.numSpotMaps=A,O.numLightProbes=C,i.version=Mne++)}function l(u,c){let h=0,d=0,m=0,v=0,_=0;const y=c.matrixWorldInverse;for(let g=0,x=u.length;g<x;g++){const S=u[g];if(S.isDirectionalLight){const E=i.directional[h];E.direction.setFromMatrixPosition(S.matrixWorld),r.setFromMatrixPosition(S.target.matrixWorld),E.direction.sub(r),E.direction.transformDirection(y),h++}else if(S.isSpotLight){const E=i.spot[m];E.position.setFromMatrixPosition(S.matrixWorld),E.position.applyMatrix4(y),E.direction.setFromMatrixPosition(S.matrixWorld),r.setFromMatrixPosition(S.target.matrixWorld),E.direction.sub(r),E.direction.transformDirection(y),m++}else if(S.isRectAreaLight){const E=i.rectArea[v];E.position.setFromMatrixPosition(S.matrixWorld),E.position.applyMatrix4(y),a.identity(),s.copy(S.matrixWorld),s.premultiply(y),a.extractRotation(s),E.halfWidth.set(S.width*.5,0,0),E.halfHeight.set(0,S.height*.5,0),E.halfWidth.applyMatrix4(a),E.halfHeight.applyMatrix4(a),v++}else if(S.isPointLight){const E=i.point[d];E.position.setFromMatrixPosition(S.matrixWorld),E.position.applyMatrix4(y),d++}else if(S.isHemisphereLight){const E=i.hemi[_];E.direction.setFromMatrixPosition(S.matrixWorld),E.direction.transformDirection(y),_++}}}return{setup:o,setupView:l,state:i}}function AP(t){const e=new Rne(t),n=[],i=[];function r(c){u.camera=c,n.length=0,i.length=0}function s(c){n.push(c)}function a(c){i.push(c)}function o(){e.setup(n)}function l(c){e.setupView(n,c)}const u={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:u,setupLights:o,setupLightsView:l,pushLight:s,pushShadow:a}}function Dne(t){let e=new WeakMap;function n(r,s=0){const a=e.get(r);let o;return a===void 0?(o=new AP(t),e.set(r,[o])):s>=a.length?(o=new AP(t),a.push(o)):o=a[s],o}function i(){e=new WeakMap}return{get:n,dispose:i}}const One=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Une=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function zne(t,e,n){let i=new fm;const r=new Tt,s=new Tt,a=new bi,o=new AT({depthPacking:MU}),l=new TT,u={},c=n.maxTextureSize,h={[Af]:La,[La]:Af,[es]:es},d=new su({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Tt},radius:{value:4}},vertexShader:One,fragmentShader:Une}),m=d.clone();m.defines.HORIZONTAL_PASS=1;const v=new ni;v.setAttribute("position",new Yi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new vr(v,d),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=XA;let g=this.type;this.render=function(T,C,O){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||T.length===0)return;const M=t.getRenderTarget(),D=t.getActiveCubeFace(),P=t.getActiveMipmapLevel(),F=t.state;F.setBlending(gf),F.buffers.color.setClear(1,1,1,1),F.buffers.depth.setTest(!0),F.setScissorTest(!1);const G=g!==Zl&&this.type===Zl,z=g===Zl&&this.type!==Zl;for(let Y=0,N=T.length;Y<N;Y++){const k=T[Y],j=k.shadow;if(j===void 0){console.warn("THREE.WebGLShadowMap:",k,"has no shadow.");continue}if(j.autoUpdate===!1&&j.needsUpdate===!1)continue;r.copy(j.mapSize);const X=j.getFrameExtents();if(r.multiply(X),s.copy(j.mapSize),(r.x>c||r.y>c)&&(r.x>c&&(s.x=Math.floor(c/X.x),r.x=s.x*X.x,j.mapSize.x=s.x),r.y>c&&(s.y=Math.floor(c/X.y),r.y=s.y*X.y,j.mapSize.y=s.y)),j.map===null||G===!0||z===!0){const H=this.type!==Zl?{minFilter:ia,magFilter:ia}:{};j.map!==null&&j.map.dispose(),j.map=new sc(r.x,r.y,H),j.map.texture.name=k.name+".shadowMap",j.camera.updateProjectionMatrix()}t.setRenderTarget(j.map),t.clear();const Q=j.getViewportCount();for(let H=0;H<Q;H++){const $=j.getViewport(H);a.set(s.x*$.x,s.y*$.y,s.x*$.z,s.y*$.w),F.viewport(a),j.updateMatrices(k,H),i=j.getFrustum(),E(C,O,j.camera,k,this.type)}j.isPointLightShadow!==!0&&this.type===Zl&&x(j,O),j.needsUpdate=!1}g=this.type,y.needsUpdate=!1,t.setRenderTarget(M,D,P)};function x(T,C){const O=e.update(_);d.defines.VSM_SAMPLES!==T.blurSamples&&(d.defines.VSM_SAMPLES=T.blurSamples,m.defines.VSM_SAMPLES=T.blurSamples,d.needsUpdate=!0,m.needsUpdate=!0),T.mapPass===null&&(T.mapPass=new sc(r.x,r.y)),d.uniforms.shadow_pass.value=T.map.texture,d.uniforms.resolution.value=T.mapSize,d.uniforms.radius.value=T.radius,t.setRenderTarget(T.mapPass),t.clear(),t.renderBufferDirect(C,null,O,d,_,null),m.uniforms.shadow_pass.value=T.mapPass.texture,m.uniforms.resolution.value=T.mapSize,m.uniforms.radius.value=T.radius,t.setRenderTarget(T.map),t.clear(),t.renderBufferDirect(C,null,O,m,_,null)}function S(T,C,O,M){let D=null;const P=O.isPointLight===!0?T.customDistanceMaterial:T.customDepthMaterial;if(P!==void 0)D=P;else if(D=O.isPointLight===!0?l:o,t.localClippingEnabled&&C.clipShadows===!0&&Array.isArray(C.clippingPlanes)&&C.clippingPlanes.length!==0||C.displacementMap&&C.displacementScale!==0||C.alphaMap&&C.alphaTest>0||C.map&&C.alphaTest>0||C.alphaToCoverage===!0){const F=D.uuid,G=C.uuid;let z=u[F];z===void 0&&(z={},u[F]=z);let Y=z[G];Y===void 0&&(Y=D.clone(),z[G]=Y,C.addEventListener("dispose",A)),D=Y}if(D.visible=C.visible,D.wireframe=C.wireframe,M===Zl?D.side=C.shadowSide!==null?C.shadowSide:C.side:D.side=C.shadowSide!==null?C.shadowSide:h[C.side],D.alphaMap=C.alphaMap,D.alphaTest=C.alphaToCoverage===!0?.5:C.alphaTest,D.map=C.map,D.clipShadows=C.clipShadows,D.clippingPlanes=C.clippingPlanes,D.clipIntersection=C.clipIntersection,D.displacementMap=C.displacementMap,D.displacementScale=C.displacementScale,D.displacementBias=C.displacementBias,D.wireframeLinewidth=C.wireframeLinewidth,D.linewidth=C.linewidth,O.isPointLight===!0&&D.isMeshDistanceMaterial===!0){const F=t.properties.get(D);F.light=O}return D}function E(T,C,O,M,D){if(T.visible===!1)return;if(T.layers.test(C.layers)&&(T.isMesh||T.isLine||T.isPoints)&&(T.castShadow||T.receiveShadow&&D===Zl)&&(!T.frustumCulled||i.intersectsObject(T))){T.modelViewMatrix.multiplyMatrices(O.matrixWorldInverse,T.matrixWorld);const G=e.update(T),z=T.material;if(Array.isArray(z)){const Y=G.groups;for(let N=0,k=Y.length;N<k;N++){const j=Y[N],X=z[j.materialIndex];if(X&&X.visible){const Q=S(T,X,M,D);T.onBeforeShadow(t,T,C,O,G,Q,j),t.renderBufferDirect(O,null,G,Q,T,j),T.onAfterShadow(t,T,C,O,G,Q,j)}}}else if(z.visible){const Y=S(T,z,M,D);T.onBeforeShadow(t,T,C,O,G,Y,null),t.renderBufferDirect(O,null,G,Y,T,null),T.onAfterShadow(t,T,C,O,G,Y,null)}}const F=T.children;for(let G=0,z=F.length;G<z;G++)E(F[G],C,O,M,D)}function A(T){T.target.removeEventListener("dispose",A);for(const O in u){const M=u[O],D=T.target.uuid;D in M&&(M[D].dispose(),delete M[D])}}}const Ine={[aw]:ow,[lw]:fw,[uw]:hw,[Kp]:cw,[ow]:aw,[fw]:lw,[hw]:uw,[cw]:Kp};function Lne(t,e){function n(){let be=!1;const _t=new bi;let Ye=null;const Et=new bi(0,0,0,0);return{setMask:function(Ot){Ye!==Ot&&!be&&(t.colorMask(Ot,Ot,Ot,Ot),Ye=Ot)},setLocked:function(Ot){be=Ot},setClear:function(Ot,Mt,vn,Un,an){an===!0&&(Ot*=Un,Mt*=Un,vn*=Un),_t.set(Ot,Mt,vn,Un),Et.equals(_t)===!1&&(t.clearColor(Ot,Mt,vn,Un),Et.copy(_t))},reset:function(){be=!1,Ye=null,Et.set(-1,0,0,0)}}}function i(){let be=!1,_t=!1,Ye=null,Et=null,Ot=null;return{setReversed:function(Mt){if(_t!==Mt){const vn=e.get("EXT_clip_control");Mt?vn.clipControlEXT(vn.LOWER_LEFT_EXT,vn.ZERO_TO_ONE_EXT):vn.clipControlEXT(vn.LOWER_LEFT_EXT,vn.NEGATIVE_ONE_TO_ONE_EXT),_t=Mt;const Un=Ot;Ot=null,this.setClear(Un)}},getReversed:function(){return _t},setTest:function(Mt){Mt?pe(t.DEPTH_TEST):xe(t.DEPTH_TEST)},setMask:function(Mt){Ye!==Mt&&!be&&(t.depthMask(Mt),Ye=Mt)},setFunc:function(Mt){if(_t&&(Mt=Ine[Mt]),Et!==Mt){switch(Mt){case aw:t.depthFunc(t.NEVER);break;case ow:t.depthFunc(t.ALWAYS);break;case lw:t.depthFunc(t.LESS);break;case Kp:t.depthFunc(t.LEQUAL);break;case uw:t.depthFunc(t.EQUAL);break;case cw:t.depthFunc(t.GEQUAL);break;case fw:t.depthFunc(t.GREATER);break;case hw:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}Et=Mt}},setLocked:function(Mt){be=Mt},setClear:function(Mt){Ot!==Mt&&(_t&&(Mt=1-Mt),t.clearDepth(Mt),Ot=Mt)},reset:function(){be=!1,Ye=null,Et=null,Ot=null,_t=!1}}}function r(){let be=!1,_t=null,Ye=null,Et=null,Ot=null,Mt=null,vn=null,Un=null,an=null;return{setTest:function(An){be||(An?pe(t.STENCIL_TEST):xe(t.STENCIL_TEST))},setMask:function(An){_t!==An&&!be&&(t.stencilMask(An),_t=An)},setFunc:function(An,Ri,Ni){(Ye!==An||Et!==Ri||Ot!==Ni)&&(t.stencilFunc(An,Ri,Ni),Ye=An,Et=Ri,Ot=Ni)},setOp:function(An,Ri,Ni){(Mt!==An||vn!==Ri||Un!==Ni)&&(t.stencilOp(An,Ri,Ni),Mt=An,vn=Ri,Un=Ni)},setLocked:function(An){be=An},setClear:function(An){an!==An&&(t.clearStencil(An),an=An)},reset:function(){be=!1,_t=null,Ye=null,Et=null,Ot=null,Mt=null,vn=null,Un=null,an=null}}}const s=new n,a=new i,o=new r,l=new WeakMap,u=new WeakMap;let c={},h={},d=new WeakMap,m=[],v=null,_=!1,y=null,g=null,x=null,S=null,E=null,A=null,T=null,C=new nn(0,0,0),O=0,M=!1,D=null,P=null,F=null,G=null,z=null;const Y=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let N=!1,k=0;const j=t.getParameter(t.VERSION);j.indexOf("WebGL")!==-1?(k=parseFloat(/^WebGL (\d)/.exec(j)[1]),N=k>=1):j.indexOf("OpenGL ES")!==-1&&(k=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),N=k>=2);let X=null,Q={};const H=t.getParameter(t.SCISSOR_BOX),$=t.getParameter(t.VIEWPORT),ne=new bi().fromArray(H),q=new bi().fromArray($);function se(be,_t,Ye,Et){const Ot=new Uint8Array(4),Mt=t.createTexture();t.bindTexture(be,Mt),t.texParameteri(be,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(be,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let vn=0;vn<Ye;vn++)be===t.TEXTURE_3D||be===t.TEXTURE_2D_ARRAY?t.texImage3D(_t,0,t.RGBA,1,1,Et,0,t.RGBA,t.UNSIGNED_BYTE,Ot):t.texImage2D(_t+vn,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,Ot);return Mt}const ve={};ve[t.TEXTURE_2D]=se(t.TEXTURE_2D,t.TEXTURE_2D,1),ve[t.TEXTURE_CUBE_MAP]=se(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),ve[t.TEXTURE_2D_ARRAY]=se(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),ve[t.TEXTURE_3D]=se(t.TEXTURE_3D,t.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),pe(t.DEPTH_TEST),a.setFunc(Kp),Ne(!1),Ve(WR),pe(t.CULL_FACE),K(gf);function pe(be){c[be]!==!0&&(t.enable(be),c[be]=!0)}function xe(be){c[be]!==!1&&(t.disable(be),c[be]=!1)}function ot(be,_t){return h[be]!==_t?(t.bindFramebuffer(be,_t),h[be]=_t,be===t.DRAW_FRAMEBUFFER&&(h[t.FRAMEBUFFER]=_t),be===t.FRAMEBUFFER&&(h[t.DRAW_FRAMEBUFFER]=_t),!0):!1}function st(be,_t){let Ye=m,Et=!1;if(be){Ye=d.get(_t),Ye===void 0&&(Ye=[],d.set(_t,Ye));const Ot=be.textures;if(Ye.length!==Ot.length||Ye[0]!==t.COLOR_ATTACHMENT0){for(let Mt=0,vn=Ot.length;Mt<vn;Mt++)Ye[Mt]=t.COLOR_ATTACHMENT0+Mt;Ye.length=Ot.length,Et=!0}}else Ye[0]!==t.BACK&&(Ye[0]=t.BACK,Et=!0);Et&&t.drawBuffers(Ye)}function et(be){return v!==be?(t.useProgram(be),v=be,!0):!1}const Te={[Fh]:t.FUNC_ADD,[q6]:t.FUNC_SUBTRACT,[K6]:t.FUNC_REVERSE_SUBTRACT};Te[Q6]=t.MIN,Te[J6]=t.MAX;const Xe={[$6]:t.ZERO,[eG]:t.ONE,[tG]:t.SRC_COLOR,[rw]:t.SRC_ALPHA,[oG]:t.SRC_ALPHA_SATURATE,[sG]:t.DST_COLOR,[iG]:t.DST_ALPHA,[nG]:t.ONE_MINUS_SRC_COLOR,[sw]:t.ONE_MINUS_SRC_ALPHA,[aG]:t.ONE_MINUS_DST_COLOR,[rG]:t.ONE_MINUS_DST_ALPHA,[lG]:t.CONSTANT_COLOR,[uG]:t.ONE_MINUS_CONSTANT_COLOR,[cG]:t.CONSTANT_ALPHA,[fG]:t.ONE_MINUS_CONSTANT_ALPHA};function K(be,_t,Ye,Et,Ot,Mt,vn,Un,an,An){if(be===gf){_===!0&&(xe(t.BLEND),_=!1);return}if(_===!1&&(pe(t.BLEND),_=!0),be!==Z6){if(be!==y||An!==M){if((g!==Fh||E!==Fh)&&(t.blendEquation(t.FUNC_ADD),g=Fh,E=Fh),An)switch(be){case Np:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case XR:t.blendFunc(t.ONE,t.ONE);break;case YR:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case ZR:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",be);break}else switch(be){case Np:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case XR:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case YR:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case ZR:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",be);break}x=null,S=null,A=null,T=null,C.set(0,0,0),O=0,y=be,M=An}return}Ot=Ot||_t,Mt=Mt||Ye,vn=vn||Et,(_t!==g||Ot!==E)&&(t.blendEquationSeparate(Te[_t],Te[Ot]),g=_t,E=Ot),(Ye!==x||Et!==S||Mt!==A||vn!==T)&&(t.blendFuncSeparate(Xe[Ye],Xe[Et],Xe[Mt],Xe[vn]),x=Ye,S=Et,A=Mt,T=vn),(Un.equals(C)===!1||an!==O)&&(t.blendColor(Un.r,Un.g,Un.b,an),C.copy(Un),O=an),y=be,M=!1}function Pe(be,_t){be.side===es?xe(t.CULL_FACE):pe(t.CULL_FACE);let Ye=be.side===La;_t&&(Ye=!Ye),Ne(Ye),be.blending===Np&&be.transparent===!1?K(gf):K(be.blending,be.blendEquation,be.blendSrc,be.blendDst,be.blendEquationAlpha,be.blendSrcAlpha,be.blendDstAlpha,be.blendColor,be.blendAlpha,be.premultipliedAlpha),a.setFunc(be.depthFunc),a.setTest(be.depthTest),a.setMask(be.depthWrite),s.setMask(be.colorWrite);const Et=be.stencilWrite;o.setTest(Et),Et&&(o.setMask(be.stencilWriteMask),o.setFunc(be.stencilFunc,be.stencilRef,be.stencilFuncMask),o.setOp(be.stencilFail,be.stencilZFail,be.stencilZPass)),ft(be.polygonOffset,be.polygonOffsetFactor,be.polygonOffsetUnits),be.alphaToCoverage===!0?pe(t.SAMPLE_ALPHA_TO_COVERAGE):xe(t.SAMPLE_ALPHA_TO_COVERAGE)}function Ne(be){D!==be&&(be?t.frontFace(t.CW):t.frontFace(t.CCW),D=be)}function Ve(be){be!==W6?(pe(t.CULL_FACE),be!==P&&(be===WR?t.cullFace(t.BACK):be===X6?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):xe(t.CULL_FACE),P=be}function _e(be){be!==F&&(N&&t.lineWidth(be),F=be)}function ft(be,_t,Ye){be?(pe(t.POLYGON_OFFSET_FILL),(G!==_t||z!==Ye)&&(t.polygonOffset(_t,Ye),G=_t,z=Ye)):xe(t.POLYGON_OFFSET_FILL)}function ke(be){be?pe(t.SCISSOR_TEST):xe(t.SCISSOR_TEST)}function Z(be){be===void 0&&(be=t.TEXTURE0+Y-1),X!==be&&(t.activeTexture(be),X=be)}function W(be,_t,Ye){Ye===void 0&&(X===null?Ye=t.TEXTURE0+Y-1:Ye=X);let Et=Q[Ye];Et===void 0&&(Et={type:void 0,texture:void 0},Q[Ye]=Et),(Et.type!==be||Et.texture!==_t)&&(X!==Ye&&(t.activeTexture(Ye),X=Ye),t.bindTexture(be,_t||ve[be]),Et.type=be,Et.texture=_t)}function I(){const be=Q[X];be!==void 0&&be.type!==void 0&&(t.bindTexture(be.type,null),be.type=void 0,be.texture=void 0)}function De(){try{t.compressedTexImage2D(...arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function ge(){try{t.compressedTexImage3D(...arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function ze(){try{t.texSubImage2D(...arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function ct(){try{t.texSubImage3D(...arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function at(){try{t.compressedTexSubImage2D(...arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Rt(){try{t.compressedTexSubImage3D(...arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Nt(){try{t.texStorage2D(...arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function vt(){try{t.texStorage3D(...arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Vt(){try{t.texImage2D(...arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Bt(){try{t.texImage3D(...arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Ht(be){ne.equals(be)===!1&&(t.scissor(be.x,be.y,be.z,be.w),ne.copy(be))}function ut(be){q.equals(be)===!1&&(t.viewport(be.x,be.y,be.z,be.w),q.copy(be))}function xn(be,_t){let Ye=u.get(_t);Ye===void 0&&(Ye=new WeakMap,u.set(_t,Ye));let Et=Ye.get(be);Et===void 0&&(Et=t.getUniformBlockIndex(_t,be.name),Ye.set(be,Et))}function un(be,_t){const Et=u.get(_t).get(be);l.get(_t)!==Et&&(t.uniformBlockBinding(_t,Et,be.__bindingPointIndex),l.set(_t,Et))}function Vn(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),a.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),c={},X=null,Q={},h={},d=new WeakMap,m=[],v=null,_=!1,y=null,g=null,x=null,S=null,E=null,A=null,T=null,C=new nn(0,0,0),O=0,M=!1,D=null,P=null,F=null,G=null,z=null,ne.set(0,0,t.canvas.width,t.canvas.height),q.set(0,0,t.canvas.width,t.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:pe,disable:xe,bindFramebuffer:ot,drawBuffers:st,useProgram:et,setBlending:K,setMaterial:Pe,setFlipSided:Ne,setCullFace:Ve,setLineWidth:_e,setPolygonOffset:ft,setScissorTest:ke,activeTexture:Z,bindTexture:W,unbindTexture:I,compressedTexImage2D:De,compressedTexImage3D:ge,texImage2D:Vt,texImage3D:Bt,updateUBOMapping:xn,uniformBlockBinding:un,texStorage2D:Nt,texStorage3D:vt,texSubImage2D:ze,texSubImage3D:ct,compressedTexSubImage2D:at,compressedTexSubImage3D:Rt,scissor:Ht,viewport:ut,reset:Vn}}function Pne(t,e,n,i,r,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Tt,c=new WeakMap;let h;const d=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(Z,W){return m?new OffscreenCanvas(Z,W):V1("canvas")}function _(Z,W,I){let De=1;const ge=ke(Z);if((ge.width>I||ge.height>I)&&(De=I/Math.max(ge.width,ge.height)),De<1)if(typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Z instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Z instanceof ImageBitmap||typeof VideoFrame<"u"&&Z instanceof VideoFrame){const ze=Math.floor(De*ge.width),ct=Math.floor(De*ge.height);h===void 0&&(h=v(ze,ct));const at=W?v(ze,ct):h;return at.width=ze,at.height=ct,at.getContext("2d").drawImage(Z,0,0,ze,ct),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ge.width+"x"+ge.height+") to ("+ze+"x"+ct+")."),at}else return"data"in Z&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ge.width+"x"+ge.height+")."),Z;return Z}function y(Z){return Z.generateMipmaps}function g(Z){t.generateMipmap(Z)}function x(Z){return Z.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:Z.isWebGL3DRenderTarget?t.TEXTURE_3D:Z.isWebGLArrayRenderTarget||Z.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function S(Z,W,I,De,ge=!1){if(Z!==null){if(t[Z]!==void 0)return t[Z];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Z+"'")}let ze=W;if(W===t.RED&&(I===t.FLOAT&&(ze=t.R32F),I===t.HALF_FLOAT&&(ze=t.R16F),I===t.UNSIGNED_BYTE&&(ze=t.R8)),W===t.RED_INTEGER&&(I===t.UNSIGNED_BYTE&&(ze=t.R8UI),I===t.UNSIGNED_SHORT&&(ze=t.R16UI),I===t.UNSIGNED_INT&&(ze=t.R32UI),I===t.BYTE&&(ze=t.R8I),I===t.SHORT&&(ze=t.R16I),I===t.INT&&(ze=t.R32I)),W===t.RG&&(I===t.FLOAT&&(ze=t.RG32F),I===t.HALF_FLOAT&&(ze=t.RG16F),I===t.UNSIGNED_BYTE&&(ze=t.RG8)),W===t.RG_INTEGER&&(I===t.UNSIGNED_BYTE&&(ze=t.RG8UI),I===t.UNSIGNED_SHORT&&(ze=t.RG16UI),I===t.UNSIGNED_INT&&(ze=t.RG32UI),I===t.BYTE&&(ze=t.RG8I),I===t.SHORT&&(ze=t.RG16I),I===t.INT&&(ze=t.RG32I)),W===t.RGB_INTEGER&&(I===t.UNSIGNED_BYTE&&(ze=t.RGB8UI),I===t.UNSIGNED_SHORT&&(ze=t.RGB16UI),I===t.UNSIGNED_INT&&(ze=t.RGB32UI),I===t.BYTE&&(ze=t.RGB8I),I===t.SHORT&&(ze=t.RGB16I),I===t.INT&&(ze=t.RGB32I)),W===t.RGBA_INTEGER&&(I===t.UNSIGNED_BYTE&&(ze=t.RGBA8UI),I===t.UNSIGNED_SHORT&&(ze=t.RGBA16UI),I===t.UNSIGNED_INT&&(ze=t.RGBA32UI),I===t.BYTE&&(ze=t.RGBA8I),I===t.SHORT&&(ze=t.RGBA16I),I===t.INT&&(ze=t.RGBA32I)),W===t.RGB&&I===t.UNSIGNED_INT_5_9_9_9_REV&&(ze=t.RGB9_E5),W===t.RGBA){const ct=ge?k1:Ei.getTransfer(De);I===t.FLOAT&&(ze=t.RGBA32F),I===t.HALF_FLOAT&&(ze=t.RGBA16F),I===t.UNSIGNED_BYTE&&(ze=ct===Ki?t.SRGB8_ALPHA8:t.RGBA8),I===t.UNSIGNED_SHORT_4_4_4_4&&(ze=t.RGBA4),I===t.UNSIGNED_SHORT_5_5_5_1&&(ze=t.RGB5_A1)}return(ze===t.R16F||ze===t.R32F||ze===t.RG16F||ze===t.RG32F||ze===t.RGBA16F||ze===t.RGBA32F)&&e.get("EXT_color_buffer_float"),ze}function E(Z,W){let I;return Z?W===null||W===Mf||W===F0?I=t.DEPTH24_STENCIL8:W===io?I=t.DEPTH32F_STENCIL8:W===k0&&(I=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):W===null||W===Mf||W===F0?I=t.DEPTH_COMPONENT24:W===io?I=t.DEPTH_COMPONENT32F:W===k0&&(I=t.DEPTH_COMPONENT16),I}function A(Z,W){return y(Z)===!0||Z.isFramebufferTexture&&Z.minFilter!==ia&&Z.minFilter!==ts?Math.log2(Math.max(W.width,W.height))+1:Z.mipmaps!==void 0&&Z.mipmaps.length>0?Z.mipmaps.length:Z.isCompressedTexture&&Array.isArray(Z.image)?W.mipmaps.length:1}function T(Z){const W=Z.target;W.removeEventListener("dispose",T),O(W),W.isVideoTexture&&c.delete(W)}function C(Z){const W=Z.target;W.removeEventListener("dispose",C),D(W)}function O(Z){const W=i.get(Z);if(W.__webglInit===void 0)return;const I=Z.source,De=d.get(I);if(De){const ge=De[W.__cacheKey];ge.usedTimes--,ge.usedTimes===0&&M(Z),Object.keys(De).length===0&&d.delete(I)}i.remove(Z)}function M(Z){const W=i.get(Z);t.deleteTexture(W.__webglTexture);const I=Z.source,De=d.get(I);delete De[W.__cacheKey],a.memory.textures--}function D(Z){const W=i.get(Z);if(Z.depthTexture&&(Z.depthTexture.dispose(),i.remove(Z.depthTexture)),Z.isWebGLCubeRenderTarget)for(let De=0;De<6;De++){if(Array.isArray(W.__webglFramebuffer[De]))for(let ge=0;ge<W.__webglFramebuffer[De].length;ge++)t.deleteFramebuffer(W.__webglFramebuffer[De][ge]);else t.deleteFramebuffer(W.__webglFramebuffer[De]);W.__webglDepthbuffer&&t.deleteRenderbuffer(W.__webglDepthbuffer[De])}else{if(Array.isArray(W.__webglFramebuffer))for(let De=0;De<W.__webglFramebuffer.length;De++)t.deleteFramebuffer(W.__webglFramebuffer[De]);else t.deleteFramebuffer(W.__webglFramebuffer);if(W.__webglDepthbuffer&&t.deleteRenderbuffer(W.__webglDepthbuffer),W.__webglMultisampledFramebuffer&&t.deleteFramebuffer(W.__webglMultisampledFramebuffer),W.__webglColorRenderbuffer)for(let De=0;De<W.__webglColorRenderbuffer.length;De++)W.__webglColorRenderbuffer[De]&&t.deleteRenderbuffer(W.__webglColorRenderbuffer[De]);W.__webglDepthRenderbuffer&&t.deleteRenderbuffer(W.__webglDepthRenderbuffer)}const I=Z.textures;for(let De=0,ge=I.length;De<ge;De++){const ze=i.get(I[De]);ze.__webglTexture&&(t.deleteTexture(ze.__webglTexture),a.memory.textures--),i.remove(I[De])}i.remove(Z)}let P=0;function F(){P=0}function G(){const Z=P;return Z>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Z+" texture units while this GPU supports only "+r.maxTextures),P+=1,Z}function z(Z){const W=[];return W.push(Z.wrapS),W.push(Z.wrapT),W.push(Z.wrapR||0),W.push(Z.magFilter),W.push(Z.minFilter),W.push(Z.anisotropy),W.push(Z.internalFormat),W.push(Z.format),W.push(Z.type),W.push(Z.generateMipmaps),W.push(Z.premultiplyAlpha),W.push(Z.flipY),W.push(Z.unpackAlignment),W.push(Z.colorSpace),W.join()}function Y(Z,W){const I=i.get(Z);if(Z.isVideoTexture&&_e(Z),Z.isRenderTargetTexture===!1&&Z.version>0&&I.__version!==Z.version){const De=Z.image;if(De===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(De.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{q(I,Z,W);return}}n.bindTexture(t.TEXTURE_2D,I.__webglTexture,t.TEXTURE0+W)}function N(Z,W){const I=i.get(Z);if(Z.version>0&&I.__version!==Z.version){q(I,Z,W);return}n.bindTexture(t.TEXTURE_2D_ARRAY,I.__webglTexture,t.TEXTURE0+W)}function k(Z,W){const I=i.get(Z);if(Z.version>0&&I.__version!==Z.version){q(I,Z,W);return}n.bindTexture(t.TEXTURE_3D,I.__webglTexture,t.TEXTURE0+W)}function j(Z,W){const I=i.get(Z);if(Z.version>0&&I.__version!==Z.version){se(I,Z,W);return}n.bindTexture(t.TEXTURE_CUBE_MAP,I.__webglTexture,t.TEXTURE0+W)}const X={[L1]:t.REPEAT,[ul]:t.CLAMP_TO_EDGE,[P1]:t.MIRRORED_REPEAT},Q={[ia]:t.NEAREST,[yU]:t.NEAREST_MIPMAP_NEAREST,[l0]:t.NEAREST_MIPMAP_LINEAR,[ts]:t.LINEAR,[t1]:t.LINEAR_MIPMAP_NEAREST,[Yu]:t.LINEAR_MIPMAP_LINEAR},H={[TG]:t.NEVER,[UG]:t.ALWAYS,[MG]:t.LESS,[CU]:t.LEQUAL,[CG]:t.EQUAL,[OG]:t.GEQUAL,[RG]:t.GREATER,[DG]:t.NOTEQUAL};function $(Z,W){if(W.type===io&&e.has("OES_texture_float_linear")===!1&&(W.magFilter===ts||W.magFilter===t1||W.magFilter===l0||W.magFilter===Yu||W.minFilter===ts||W.minFilter===t1||W.minFilter===l0||W.minFilter===Yu)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(Z,t.TEXTURE_WRAP_S,X[W.wrapS]),t.texParameteri(Z,t.TEXTURE_WRAP_T,X[W.wrapT]),(Z===t.TEXTURE_3D||Z===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Z,t.TEXTURE_WRAP_R,X[W.wrapR]),t.texParameteri(Z,t.TEXTURE_MAG_FILTER,Q[W.magFilter]),t.texParameteri(Z,t.TEXTURE_MIN_FILTER,Q[W.minFilter]),W.compareFunction&&(t.texParameteri(Z,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(Z,t.TEXTURE_COMPARE_FUNC,H[W.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(W.magFilter===ia||W.minFilter!==l0&&W.minFilter!==Yu||W.type===io&&e.has("OES_texture_float_linear")===!1)return;if(W.anisotropy>1||i.get(W).__currentAnisotropy){const I=e.get("EXT_texture_filter_anisotropic");t.texParameterf(Z,I.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(W.anisotropy,r.getMaxAnisotropy())),i.get(W).__currentAnisotropy=W.anisotropy}}}function ne(Z,W){let I=!1;Z.__webglInit===void 0&&(Z.__webglInit=!0,W.addEventListener("dispose",T));const De=W.source;let ge=d.get(De);ge===void 0&&(ge={},d.set(De,ge));const ze=z(W);if(ze!==Z.__cacheKey){ge[ze]===void 0&&(ge[ze]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,I=!0),ge[ze].usedTimes++;const ct=ge[Z.__cacheKey];ct!==void 0&&(ge[Z.__cacheKey].usedTimes--,ct.usedTimes===0&&M(W)),Z.__cacheKey=ze,Z.__webglTexture=ge[ze].texture}return I}function q(Z,W,I){let De=t.TEXTURE_2D;(W.isDataArrayTexture||W.isCompressedArrayTexture)&&(De=t.TEXTURE_2D_ARRAY),W.isData3DTexture&&(De=t.TEXTURE_3D);const ge=ne(Z,W),ze=W.source;n.bindTexture(De,Z.__webglTexture,t.TEXTURE0+I);const ct=i.get(ze);if(ze.version!==ct.__version||ge===!0){n.activeTexture(t.TEXTURE0+I);const at=Ei.getPrimaries(Ei.workingColorSpace),Rt=W.colorSpace===nf?null:Ei.getPrimaries(W.colorSpace),Nt=W.colorSpace===nf||at===Rt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,W.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,W.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Nt);let vt=_(W.image,!1,r.maxTextureSize);vt=ft(W,vt);const Vt=s.convert(W.format,W.colorSpace),Bt=s.convert(W.type);let Ht=S(W.internalFormat,Vt,Bt,W.colorSpace,W.isVideoTexture);$(De,W);let ut;const xn=W.mipmaps,un=W.isVideoTexture!==!0,Vn=ct.__version===void 0||ge===!0,be=ze.dataReady,_t=A(W,vt);if(W.isDepthTexture)Ht=E(W.format===V0,W.type),Vn&&(un?n.texStorage2D(t.TEXTURE_2D,1,Ht,vt.width,vt.height):n.texImage2D(t.TEXTURE_2D,0,Ht,vt.width,vt.height,0,Vt,Bt,null));else if(W.isDataTexture)if(xn.length>0){un&&Vn&&n.texStorage2D(t.TEXTURE_2D,_t,Ht,xn[0].width,xn[0].height);for(let Ye=0,Et=xn.length;Ye<Et;Ye++)ut=xn[Ye],un?be&&n.texSubImage2D(t.TEXTURE_2D,Ye,0,0,ut.width,ut.height,Vt,Bt,ut.data):n.texImage2D(t.TEXTURE_2D,Ye,Ht,ut.width,ut.height,0,Vt,Bt,ut.data);W.generateMipmaps=!1}else un?(Vn&&n.texStorage2D(t.TEXTURE_2D,_t,Ht,vt.width,vt.height),be&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,vt.width,vt.height,Vt,Bt,vt.data)):n.texImage2D(t.TEXTURE_2D,0,Ht,vt.width,vt.height,0,Vt,Bt,vt.data);else if(W.isCompressedTexture)if(W.isCompressedArrayTexture){un&&Vn&&n.texStorage3D(t.TEXTURE_2D_ARRAY,_t,Ht,xn[0].width,xn[0].height,vt.depth);for(let Ye=0,Et=xn.length;Ye<Et;Ye++)if(ut=xn[Ye],W.format!==Sa)if(Vt!==null)if(un){if(be)if(W.layerUpdates.size>0){const Ot=rD(ut.width,ut.height,W.format,W.type);for(const Mt of W.layerUpdates){const vn=ut.data.subarray(Mt*Ot/ut.data.BYTES_PER_ELEMENT,(Mt+1)*Ot/ut.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Ye,0,0,Mt,ut.width,ut.height,1,Vt,vn)}W.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Ye,0,0,0,ut.width,ut.height,vt.depth,Vt,ut.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Ye,Ht,ut.width,ut.height,vt.depth,0,ut.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else un?be&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,Ye,0,0,0,ut.width,ut.height,vt.depth,Vt,Bt,ut.data):n.texImage3D(t.TEXTURE_2D_ARRAY,Ye,Ht,ut.width,ut.height,vt.depth,0,Vt,Bt,ut.data)}else{un&&Vn&&n.texStorage2D(t.TEXTURE_2D,_t,Ht,xn[0].width,xn[0].height);for(let Ye=0,Et=xn.length;Ye<Et;Ye++)ut=xn[Ye],W.format!==Sa?Vt!==null?un?be&&n.compressedTexSubImage2D(t.TEXTURE_2D,Ye,0,0,ut.width,ut.height,Vt,ut.data):n.compressedTexImage2D(t.TEXTURE_2D,Ye,Ht,ut.width,ut.height,0,ut.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):un?be&&n.texSubImage2D(t.TEXTURE_2D,Ye,0,0,ut.width,ut.height,Vt,Bt,ut.data):n.texImage2D(t.TEXTURE_2D,Ye,Ht,ut.width,ut.height,0,Vt,Bt,ut.data)}else if(W.isDataArrayTexture)if(un){if(Vn&&n.texStorage3D(t.TEXTURE_2D_ARRAY,_t,Ht,vt.width,vt.height,vt.depth),be)if(W.layerUpdates.size>0){const Ye=rD(vt.width,vt.height,W.format,W.type);for(const Et of W.layerUpdates){const Ot=vt.data.subarray(Et*Ye/vt.data.BYTES_PER_ELEMENT,(Et+1)*Ye/vt.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,Et,vt.width,vt.height,1,Vt,Bt,Ot)}W.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,vt.width,vt.height,vt.depth,Vt,Bt,vt.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,Ht,vt.width,vt.height,vt.depth,0,Vt,Bt,vt.data);else if(W.isData3DTexture)un?(Vn&&n.texStorage3D(t.TEXTURE_3D,_t,Ht,vt.width,vt.height,vt.depth),be&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,vt.width,vt.height,vt.depth,Vt,Bt,vt.data)):n.texImage3D(t.TEXTURE_3D,0,Ht,vt.width,vt.height,vt.depth,0,Vt,Bt,vt.data);else if(W.isFramebufferTexture){if(Vn)if(un)n.texStorage2D(t.TEXTURE_2D,_t,Ht,vt.width,vt.height);else{let Ye=vt.width,Et=vt.height;for(let Ot=0;Ot<_t;Ot++)n.texImage2D(t.TEXTURE_2D,Ot,Ht,Ye,Et,0,Vt,Bt,null),Ye>>=1,Et>>=1}}else if(xn.length>0){if(un&&Vn){const Ye=ke(xn[0]);n.texStorage2D(t.TEXTURE_2D,_t,Ht,Ye.width,Ye.height)}for(let Ye=0,Et=xn.length;Ye<Et;Ye++)ut=xn[Ye],un?be&&n.texSubImage2D(t.TEXTURE_2D,Ye,0,0,Vt,Bt,ut):n.texImage2D(t.TEXTURE_2D,Ye,Ht,Vt,Bt,ut);W.generateMipmaps=!1}else if(un){if(Vn){const Ye=ke(vt);n.texStorage2D(t.TEXTURE_2D,_t,Ht,Ye.width,Ye.height)}be&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Vt,Bt,vt)}else n.texImage2D(t.TEXTURE_2D,0,Ht,Vt,Bt,vt);y(W)&&g(De),ct.__version=ze.version,W.onUpdate&&W.onUpdate(W)}Z.__version=W.version}function se(Z,W,I){if(W.image.length!==6)return;const De=ne(Z,W),ge=W.source;n.bindTexture(t.TEXTURE_CUBE_MAP,Z.__webglTexture,t.TEXTURE0+I);const ze=i.get(ge);if(ge.version!==ze.__version||De===!0){n.activeTexture(t.TEXTURE0+I);const ct=Ei.getPrimaries(Ei.workingColorSpace),at=W.colorSpace===nf?null:Ei.getPrimaries(W.colorSpace),Rt=W.colorSpace===nf||ct===at?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,W.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,W.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Rt);const Nt=W.isCompressedTexture||W.image[0].isCompressedTexture,vt=W.image[0]&&W.image[0].isDataTexture,Vt=[];for(let Et=0;Et<6;Et++)!Nt&&!vt?Vt[Et]=_(W.image[Et],!0,r.maxCubemapSize):Vt[Et]=vt?W.image[Et].image:W.image[Et],Vt[Et]=ft(W,Vt[Et]);const Bt=Vt[0],Ht=s.convert(W.format,W.colorSpace),ut=s.convert(W.type),xn=S(W.internalFormat,Ht,ut,W.colorSpace),un=W.isVideoTexture!==!0,Vn=ze.__version===void 0||De===!0,be=ge.dataReady;let _t=A(W,Bt);$(t.TEXTURE_CUBE_MAP,W);let Ye;if(Nt){un&&Vn&&n.texStorage2D(t.TEXTURE_CUBE_MAP,_t,xn,Bt.width,Bt.height);for(let Et=0;Et<6;Et++){Ye=Vt[Et].mipmaps;for(let Ot=0;Ot<Ye.length;Ot++){const Mt=Ye[Ot];W.format!==Sa?Ht!==null?un?be&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,Ot,0,0,Mt.width,Mt.height,Ht,Mt.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,Ot,xn,Mt.width,Mt.height,0,Mt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):un?be&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,Ot,0,0,Mt.width,Mt.height,Ht,ut,Mt.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,Ot,xn,Mt.width,Mt.height,0,Ht,ut,Mt.data)}}}else{if(Ye=W.mipmaps,un&&Vn){Ye.length>0&&_t++;const Et=ke(Vt[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,_t,xn,Et.width,Et.height)}for(let Et=0;Et<6;Et++)if(vt){un?be&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,0,0,0,Vt[Et].width,Vt[Et].height,Ht,ut,Vt[Et].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,0,xn,Vt[Et].width,Vt[Et].height,0,Ht,ut,Vt[Et].data);for(let Ot=0;Ot<Ye.length;Ot++){const vn=Ye[Ot].image[Et].image;un?be&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,Ot+1,0,0,vn.width,vn.height,Ht,ut,vn.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,Ot+1,xn,vn.width,vn.height,0,Ht,ut,vn.data)}}else{un?be&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,0,0,0,Ht,ut,Vt[Et]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,0,xn,Ht,ut,Vt[Et]);for(let Ot=0;Ot<Ye.length;Ot++){const Mt=Ye[Ot];un?be&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,Ot+1,0,0,Ht,ut,Mt.image[Et]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Et,Ot+1,xn,Ht,ut,Mt.image[Et])}}}y(W)&&g(t.TEXTURE_CUBE_MAP),ze.__version=ge.version,W.onUpdate&&W.onUpdate(W)}Z.__version=W.version}function ve(Z,W,I,De,ge,ze){const ct=s.convert(I.format,I.colorSpace),at=s.convert(I.type),Rt=S(I.internalFormat,ct,at,I.colorSpace),Nt=i.get(W),vt=i.get(I);if(vt.__renderTarget=W,!Nt.__hasExternalTextures){const Vt=Math.max(1,W.width>>ze),Bt=Math.max(1,W.height>>ze);ge===t.TEXTURE_3D||ge===t.TEXTURE_2D_ARRAY?n.texImage3D(ge,ze,Rt,Vt,Bt,W.depth,0,ct,at,null):n.texImage2D(ge,ze,Rt,Vt,Bt,0,ct,at,null)}n.bindFramebuffer(t.FRAMEBUFFER,Z),Ve(W)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,De,ge,vt.__webglTexture,0,Ne(W)):(ge===t.TEXTURE_2D||ge>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&ge<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,De,ge,vt.__webglTexture,ze),n.bindFramebuffer(t.FRAMEBUFFER,null)}function pe(Z,W,I){if(t.bindRenderbuffer(t.RENDERBUFFER,Z),W.depthBuffer){const De=W.depthTexture,ge=De&&De.isDepthTexture?De.type:null,ze=E(W.stencilBuffer,ge),ct=W.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,at=Ne(W);Ve(W)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,at,ze,W.width,W.height):I?t.renderbufferStorageMultisample(t.RENDERBUFFER,at,ze,W.width,W.height):t.renderbufferStorage(t.RENDERBUFFER,ze,W.width,W.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,ct,t.RENDERBUFFER,Z)}else{const De=W.textures;for(let ge=0;ge<De.length;ge++){const ze=De[ge],ct=s.convert(ze.format,ze.colorSpace),at=s.convert(ze.type),Rt=S(ze.internalFormat,ct,at,ze.colorSpace),Nt=Ne(W);I&&Ve(W)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Nt,Rt,W.width,W.height):Ve(W)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Nt,Rt,W.width,W.height):t.renderbufferStorage(t.RENDERBUFFER,Rt,W.width,W.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function xe(Z,W){if(W&&W.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,Z),!(W.depthTexture&&W.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const De=i.get(W.depthTexture);De.__renderTarget=W,(!De.__webglTexture||W.depthTexture.image.width!==W.width||W.depthTexture.image.height!==W.height)&&(W.depthTexture.image.width=W.width,W.depthTexture.image.height=W.height,W.depthTexture.needsUpdate=!0),Y(W.depthTexture,0);const ge=De.__webglTexture,ze=Ne(W);if(W.depthTexture.format===G0)Ve(W)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,ge,0,ze):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,ge,0);else if(W.depthTexture.format===V0)Ve(W)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,ge,0,ze):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,ge,0);else throw new Error("Unknown depthTexture format")}function ot(Z){const W=i.get(Z),I=Z.isWebGLCubeRenderTarget===!0;if(W.__boundDepthTexture!==Z.depthTexture){const De=Z.depthTexture;if(W.__depthDisposeCallback&&W.__depthDisposeCallback(),De){const ge=()=>{delete W.__boundDepthTexture,delete W.__depthDisposeCallback,De.removeEventListener("dispose",ge)};De.addEventListener("dispose",ge),W.__depthDisposeCallback=ge}W.__boundDepthTexture=De}if(Z.depthTexture&&!W.__autoAllocateDepthBuffer){if(I)throw new Error("target.depthTexture not supported in Cube render targets");const De=Z.texture.mipmaps;De&&De.length>0?xe(W.__webglFramebuffer[0],Z):xe(W.__webglFramebuffer,Z)}else if(I){W.__webglDepthbuffer=[];for(let De=0;De<6;De++)if(n.bindFramebuffer(t.FRAMEBUFFER,W.__webglFramebuffer[De]),W.__webglDepthbuffer[De]===void 0)W.__webglDepthbuffer[De]=t.createRenderbuffer(),pe(W.__webglDepthbuffer[De],Z,!1);else{const ge=Z.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ze=W.__webglDepthbuffer[De];t.bindRenderbuffer(t.RENDERBUFFER,ze),t.framebufferRenderbuffer(t.FRAMEBUFFER,ge,t.RENDERBUFFER,ze)}}else{const De=Z.texture.mipmaps;if(De&&De.length>0?n.bindFramebuffer(t.FRAMEBUFFER,W.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,W.__webglFramebuffer),W.__webglDepthbuffer===void 0)W.__webglDepthbuffer=t.createRenderbuffer(),pe(W.__webglDepthbuffer,Z,!1);else{const ge=Z.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ze=W.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,ze),t.framebufferRenderbuffer(t.FRAMEBUFFER,ge,t.RENDERBUFFER,ze)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}function st(Z,W,I){const De=i.get(Z);W!==void 0&&ve(De.__webglFramebuffer,Z,Z.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),I!==void 0&&ot(Z)}function et(Z){const W=Z.texture,I=i.get(Z),De=i.get(W);Z.addEventListener("dispose",C);const ge=Z.textures,ze=Z.isWebGLCubeRenderTarget===!0,ct=ge.length>1;if(ct||(De.__webglTexture===void 0&&(De.__webglTexture=t.createTexture()),De.__version=W.version,a.memory.textures++),ze){I.__webglFramebuffer=[];for(let at=0;at<6;at++)if(W.mipmaps&&W.mipmaps.length>0){I.__webglFramebuffer[at]=[];for(let Rt=0;Rt<W.mipmaps.length;Rt++)I.__webglFramebuffer[at][Rt]=t.createFramebuffer()}else I.__webglFramebuffer[at]=t.createFramebuffer()}else{if(W.mipmaps&&W.mipmaps.length>0){I.__webglFramebuffer=[];for(let at=0;at<W.mipmaps.length;at++)I.__webglFramebuffer[at]=t.createFramebuffer()}else I.__webglFramebuffer=t.createFramebuffer();if(ct)for(let at=0,Rt=ge.length;at<Rt;at++){const Nt=i.get(ge[at]);Nt.__webglTexture===void 0&&(Nt.__webglTexture=t.createTexture(),a.memory.textures++)}if(Z.samples>0&&Ve(Z)===!1){I.__webglMultisampledFramebuffer=t.createFramebuffer(),I.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,I.__webglMultisampledFramebuffer);for(let at=0;at<ge.length;at++){const Rt=ge[at];I.__webglColorRenderbuffer[at]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,I.__webglColorRenderbuffer[at]);const Nt=s.convert(Rt.format,Rt.colorSpace),vt=s.convert(Rt.type),Vt=S(Rt.internalFormat,Nt,vt,Rt.colorSpace,Z.isXRRenderTarget===!0),Bt=Ne(Z);t.renderbufferStorageMultisample(t.RENDERBUFFER,Bt,Vt,Z.width,Z.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+at,t.RENDERBUFFER,I.__webglColorRenderbuffer[at])}t.bindRenderbuffer(t.RENDERBUFFER,null),Z.depthBuffer&&(I.__webglDepthRenderbuffer=t.createRenderbuffer(),pe(I.__webglDepthRenderbuffer,Z,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(ze){n.bindTexture(t.TEXTURE_CUBE_MAP,De.__webglTexture),$(t.TEXTURE_CUBE_MAP,W);for(let at=0;at<6;at++)if(W.mipmaps&&W.mipmaps.length>0)for(let Rt=0;Rt<W.mipmaps.length;Rt++)ve(I.__webglFramebuffer[at][Rt],Z,W,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+at,Rt);else ve(I.__webglFramebuffer[at],Z,W,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+at,0);y(W)&&g(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(ct){for(let at=0,Rt=ge.length;at<Rt;at++){const Nt=ge[at],vt=i.get(Nt);n.bindTexture(t.TEXTURE_2D,vt.__webglTexture),$(t.TEXTURE_2D,Nt),ve(I.__webglFramebuffer,Z,Nt,t.COLOR_ATTACHMENT0+at,t.TEXTURE_2D,0),y(Nt)&&g(t.TEXTURE_2D)}n.unbindTexture()}else{let at=t.TEXTURE_2D;if((Z.isWebGL3DRenderTarget||Z.isWebGLArrayRenderTarget)&&(at=Z.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(at,De.__webglTexture),$(at,W),W.mipmaps&&W.mipmaps.length>0)for(let Rt=0;Rt<W.mipmaps.length;Rt++)ve(I.__webglFramebuffer[Rt],Z,W,t.COLOR_ATTACHMENT0,at,Rt);else ve(I.__webglFramebuffer,Z,W,t.COLOR_ATTACHMENT0,at,0);y(W)&&g(at),n.unbindTexture()}Z.depthBuffer&&ot(Z)}function Te(Z){const W=Z.textures;for(let I=0,De=W.length;I<De;I++){const ge=W[I];if(y(ge)){const ze=x(Z),ct=i.get(ge).__webglTexture;n.bindTexture(ze,ct),g(ze),n.unbindTexture()}}}const Xe=[],K=[];function Pe(Z){if(Z.samples>0){if(Ve(Z)===!1){const W=Z.textures,I=Z.width,De=Z.height;let ge=t.COLOR_BUFFER_BIT;const ze=Z.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ct=i.get(Z),at=W.length>1;if(at)for(let Nt=0;Nt<W.length;Nt++)n.bindFramebuffer(t.FRAMEBUFFER,ct.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Nt,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,ct.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Nt,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,ct.__webglMultisampledFramebuffer);const Rt=Z.texture.mipmaps;Rt&&Rt.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,ct.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,ct.__webglFramebuffer);for(let Nt=0;Nt<W.length;Nt++){if(Z.resolveDepthBuffer&&(Z.depthBuffer&&(ge|=t.DEPTH_BUFFER_BIT),Z.stencilBuffer&&Z.resolveStencilBuffer&&(ge|=t.STENCIL_BUFFER_BIT)),at){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,ct.__webglColorRenderbuffer[Nt]);const vt=i.get(W[Nt]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,vt,0)}t.blitFramebuffer(0,0,I,De,0,0,I,De,ge,t.NEAREST),l===!0&&(Xe.length=0,K.length=0,Xe.push(t.COLOR_ATTACHMENT0+Nt),Z.depthBuffer&&Z.resolveDepthBuffer===!1&&(Xe.push(ze),K.push(ze),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,K)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Xe))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),at)for(let Nt=0;Nt<W.length;Nt++){n.bindFramebuffer(t.FRAMEBUFFER,ct.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Nt,t.RENDERBUFFER,ct.__webglColorRenderbuffer[Nt]);const vt=i.get(W[Nt]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,ct.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Nt,t.TEXTURE_2D,vt,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,ct.__webglMultisampledFramebuffer)}else if(Z.depthBuffer&&Z.resolveDepthBuffer===!1&&l){const W=Z.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[W])}}}function Ne(Z){return Math.min(r.maxSamples,Z.samples)}function Ve(Z){const W=i.get(Z);return Z.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&W.__useRenderToTexture!==!1}function _e(Z){const W=a.render.frame;c.get(Z)!==W&&(c.set(Z,W),Z.update())}function ft(Z,W){const I=Z.colorSpace,De=Z.format,ge=Z.type;return Z.isCompressedTexture===!0||Z.isVideoTexture===!0||I!==od&&I!==nf&&(Ei.getTransfer(I)===Ki?(De!==Sa||ge!==ml)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",I)),W}function ke(Z){return typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement?(u.width=Z.naturalWidth||Z.width,u.height=Z.naturalHeight||Z.height):typeof VideoFrame<"u"&&Z instanceof VideoFrame?(u.width=Z.displayWidth,u.height=Z.displayHeight):(u.width=Z.width,u.height=Z.height),u}this.allocateTextureUnit=G,this.resetTextureUnits=F,this.setTexture2D=Y,this.setTexture2DArray=N,this.setTexture3D=k,this.setTextureCube=j,this.rebindTextures=st,this.setupRenderTarget=et,this.updateRenderTargetMipmap=Te,this.updateMultisampleRenderTarget=Pe,this.setupDepthRenderbuffer=ot,this.setupFrameBufferTexture=ve,this.useMultisampledRTT=Ve}function G8(t,e){function n(i,r=nf){let s;const a=Ei.getTransfer(r);if(i===ml)return t.UNSIGNED_BYTE;if(i===qA)return t.UNSIGNED_SHORT_4_4_4_4;if(i===KA)return t.UNSIGNED_SHORT_5_5_5_1;if(i===bU)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===xU)return t.BYTE;if(i===_U)return t.SHORT;if(i===k0)return t.UNSIGNED_SHORT;if(i===ZA)return t.INT;if(i===Mf)return t.UNSIGNED_INT;if(i===io)return t.FLOAT;if(i===pv)return t.HALF_FLOAT;if(i===SU)return t.ALPHA;if(i===EU)return t.RGB;if(i===Sa)return t.RGBA;if(i===G0)return t.DEPTH_COMPONENT;if(i===V0)return t.DEPTH_STENCIL;if(i===QA)return t.RED;if(i===k_)return t.RED_INTEGER;if(i===wU)return t.RG;if(i===JA)return t.RG_INTEGER;if(i===$A)return t.RGBA_INTEGER;if(i===n1||i===i1||i===r1||i===s1)if(a===Ki)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===n1)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===i1)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===r1)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===s1)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===n1)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===i1)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===r1)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===s1)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===dw||i===pw||i===mw||i===gw)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===dw)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===pw)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===mw)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===gw)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===vw||i===yw||i===xw)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===vw||i===yw)return a===Ki?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===xw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===_w||i===bw||i===Sw||i===Ew||i===ww||i===Aw||i===Tw||i===Mw||i===Cw||i===Rw||i===Dw||i===Ow||i===Uw||i===zw)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===_w)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===bw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===Sw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===Ew)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===ww)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===Aw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===Tw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===Mw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===Cw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===Rw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===Dw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===Ow)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===Uw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===zw)return a===Ki?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===a1||i===Iw||i===Lw)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===a1)return a===Ki?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===Iw)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===Lw)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===AU||i===Pw||i===Nw||i===Bw)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===a1)return s.COMPRESSED_RED_RGTC1_EXT;if(i===Pw)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===Nw)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===Bw)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===F0?t.UNSIGNED_INT_24_8:t[i]!==void 0?t[i]:null}return{convert:n}}const Nne=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Bne=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class kne{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,i){if(this.texture===null){const r=new Gr,s=e.properties.get(r);s.__webglTexture=n.texture,(n.depthNear!==i.depthNear||n.depthFar!==i.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,i=new su({vertexShader:Nne,fragmentShader:Bne,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new vr(new Nf(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Fne extends cc{constructor(e,n){super();const i=this;let r=null,s=1,a=null,o="local-floor",l=1,u=null,c=null,h=null,d=null,m=null,v=null;const _=new kne,y=n.getContextAttributes();let g=null,x=null;const S=[],E=[],A=new Tt;let T=null;const C=new ys;C.viewport=new bi;const O=new ys;O.viewport=new bi;const M=[C,O],D=new D8;let P=null,F=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let se=S[q];return se===void 0&&(se=new cE,S[q]=se),se.getTargetRaySpace()},this.getControllerGrip=function(q){let se=S[q];return se===void 0&&(se=new cE,S[q]=se),se.getGripSpace()},this.getHand=function(q){let se=S[q];return se===void 0&&(se=new cE,S[q]=se),se.getHandSpace()};function G(q){const se=E.indexOf(q.inputSource);if(se===-1)return;const ve=S[se];ve!==void 0&&(ve.update(q.inputSource,q.frame,u||a),ve.dispatchEvent({type:q.type,data:q.inputSource}))}function z(){r.removeEventListener("select",G),r.removeEventListener("selectstart",G),r.removeEventListener("selectend",G),r.removeEventListener("squeeze",G),r.removeEventListener("squeezestart",G),r.removeEventListener("squeezeend",G),r.removeEventListener("end",z),r.removeEventListener("inputsourceschange",Y);for(let q=0;q<S.length;q++){const se=E[q];se!==null&&(E[q]=null,S[q].disconnect(se))}P=null,F=null,_.reset(),e.setRenderTarget(g),m=null,d=null,h=null,r=null,x=null,ne.stop(),i.isPresenting=!1,e.setPixelRatio(T),e.setSize(A.width,A.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(q){s=q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){o=q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||a},this.setReferenceSpace=function(q){u=q},this.getBaseLayer=function(){return d!==null?d:m},this.getBinding=function(){return h},this.getFrame=function(){return v},this.getSession=function(){return r},this.setSession=async function(q){if(r=q,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",G),r.addEventListener("selectstart",G),r.addEventListener("selectend",G),r.addEventListener("squeeze",G),r.addEventListener("squeezestart",G),r.addEventListener("squeezeend",G),r.addEventListener("end",z),r.addEventListener("inputsourceschange",Y),y.xrCompatible!==!0&&await n.makeXRCompatible(),T=e.getPixelRatio(),e.getSize(A),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let ve=null,pe=null,xe=null;y.depth&&(xe=y.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,ve=y.stencil?V0:G0,pe=y.stencil?F0:Mf);const ot={colorFormat:n.RGBA8,depthFormat:xe,scaleFactor:s};h=new XRWebGLBinding(r,n),d=h.createProjectionLayer(ot),r.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),x=new sc(d.textureWidth,d.textureHeight,{format:Sa,type:ml,depthTexture:new fT(d.textureWidth,d.textureHeight,pe,void 0,void 0,void 0,void 0,void 0,void 0,ve),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1})}else{const ve={antialias:y.antialias,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(r,n,ve),r.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),x=new sc(m.framebufferWidth,m.framebufferHeight,{format:Sa,type:ml,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil,resolveDepthBuffer:m.ignoreDepthValues===!1,resolveStencilBuffer:m.ignoreDepthValues===!1})}x.isXRRenderTarget=!0,this.setFoveation(l),u=null,a=await r.requestReferenceSpace(o),ne.setContext(r),ne.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return _.getDepthTexture()};function Y(q){for(let se=0;se<q.removed.length;se++){const ve=q.removed[se],pe=E.indexOf(ve);pe>=0&&(E[pe]=null,S[pe].disconnect(ve))}for(let se=0;se<q.added.length;se++){const ve=q.added[se];let pe=E.indexOf(ve);if(pe===-1){for(let ot=0;ot<S.length;ot++)if(ot>=E.length){E.push(ve),pe=ot;break}else if(E[ot]===null){E[ot]=ve,pe=ot;break}if(pe===-1)break}const xe=S[pe];xe&&xe.connect(ve)}}const N=new re,k=new re;function j(q,se,ve){N.setFromMatrixPosition(se.matrixWorld),k.setFromMatrixPosition(ve.matrixWorld);const pe=N.distanceTo(k),xe=se.projectionMatrix.elements,ot=ve.projectionMatrix.elements,st=xe[14]/(xe[10]-1),et=xe[14]/(xe[10]+1),Te=(xe[9]+1)/xe[5],Xe=(xe[9]-1)/xe[5],K=(xe[8]-1)/xe[0],Pe=(ot[8]+1)/ot[0],Ne=st*K,Ve=st*Pe,_e=pe/(-K+Pe),ft=_e*-K;if(se.matrixWorld.decompose(q.position,q.quaternion,q.scale),q.translateX(ft),q.translateZ(_e),q.matrixWorld.compose(q.position,q.quaternion,q.scale),q.matrixWorldInverse.copy(q.matrixWorld).invert(),xe[10]===-1)q.projectionMatrix.copy(se.projectionMatrix),q.projectionMatrixInverse.copy(se.projectionMatrixInverse);else{const ke=st+_e,Z=et+_e,W=Ne-ft,I=Ve+(pe-ft),De=Te*et/Z*ke,ge=Xe*et/Z*ke;q.projectionMatrix.makePerspective(W,I,De,ge,ke,Z),q.projectionMatrixInverse.copy(q.projectionMatrix).invert()}}function X(q,se){se===null?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(se.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(r===null)return;let se=q.near,ve=q.far;_.texture!==null&&(_.depthNear>0&&(se=_.depthNear),_.depthFar>0&&(ve=_.depthFar)),D.near=O.near=C.near=se,D.far=O.far=C.far=ve,(P!==D.near||F!==D.far)&&(r.updateRenderState({depthNear:D.near,depthFar:D.far}),P=D.near,F=D.far),C.layers.mask=q.layers.mask|2,O.layers.mask=q.layers.mask|4,D.layers.mask=C.layers.mask|O.layers.mask;const pe=q.parent,xe=D.cameras;X(D,pe);for(let ot=0;ot<xe.length;ot++)X(xe[ot],pe);xe.length===2?j(D,C,O):D.projectionMatrix.copy(C.projectionMatrix),Q(q,D,pe)};function Q(q,se,ve){ve===null?q.matrix.copy(se.matrixWorld):(q.matrix.copy(ve.matrixWorld),q.matrix.invert(),q.matrix.multiply(se.matrixWorld)),q.matrix.decompose(q.position,q.quaternion,q.scale),q.updateMatrixWorld(!0),q.projectionMatrix.copy(se.projectionMatrix),q.projectionMatrixInverse.copy(se.projectionMatrixInverse),q.isPerspectiveCamera&&(q.fov=H0*2*Math.atan(1/q.projectionMatrix.elements[5]),q.zoom=1)}this.getCamera=function(){return D},this.getFoveation=function(){if(!(d===null&&m===null))return l},this.setFoveation=function(q){l=q,d!==null&&(d.fixedFoveation=q),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=q)},this.hasDepthSensing=function(){return _.texture!==null},this.getDepthSensingMesh=function(){return _.getMesh(D)};let H=null;function $(q,se){if(c=se.getViewerPose(u||a),v=se,c!==null){const ve=c.views;m!==null&&(e.setRenderTargetFramebuffer(x,m.framebuffer),e.setRenderTarget(x));let pe=!1;ve.length!==D.cameras.length&&(D.cameras.length=0,pe=!0);for(let st=0;st<ve.length;st++){const et=ve[st];let Te=null;if(m!==null)Te=m.getViewport(et);else{const K=h.getViewSubImage(d,et);Te=K.viewport,st===0&&(e.setRenderTargetTextures(x,K.colorTexture,K.depthStencilTexture),e.setRenderTarget(x))}let Xe=M[st];Xe===void 0&&(Xe=new ys,Xe.layers.enable(st),Xe.viewport=new bi,M[st]=Xe),Xe.matrix.fromArray(et.transform.matrix),Xe.matrix.decompose(Xe.position,Xe.quaternion,Xe.scale),Xe.projectionMatrix.fromArray(et.projectionMatrix),Xe.projectionMatrixInverse.copy(Xe.projectionMatrix).invert(),Xe.viewport.set(Te.x,Te.y,Te.width,Te.height),st===0&&(D.matrix.copy(Xe.matrix),D.matrix.decompose(D.position,D.quaternion,D.scale)),pe===!0&&D.cameras.push(Xe)}const xe=r.enabledFeatures;if(xe&&xe.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&h){const st=h.getDepthInformation(ve[0]);st&&st.isValid&&st.texture&&_.init(e,st,r.renderState)}}for(let ve=0;ve<S.length;ve++){const pe=E[ve],xe=S[ve];pe!==null&&xe!==void 0&&xe.update(pe,se,u||a)}H&&H(q,se),se.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:se}),v=null}const ne=new P8;ne.setAnimationLoop($),this.setAnimationLoop=function(q){H=q},this.dispose=function(){}}}const hp=new Ea,Gne=new kn;function Vne(t,e){function n(y,g){y.matrixAutoUpdate===!0&&y.updateMatrix(),g.value.copy(y.matrix)}function i(y,g){g.color.getRGB(y.fogColor.value,NG(t)),g.isFog?(y.fogNear.value=g.near,y.fogFar.value=g.far):g.isFogExp2&&(y.fogDensity.value=g.density)}function r(y,g,x,S,E){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(y,g):g.isMeshToonMaterial?(s(y,g),h(y,g)):g.isMeshPhongMaterial?(s(y,g),c(y,g)):g.isMeshStandardMaterial?(s(y,g),d(y,g),g.isMeshPhysicalMaterial&&m(y,g,E)):g.isMeshMatcapMaterial?(s(y,g),v(y,g)):g.isMeshDepthMaterial?s(y,g):g.isMeshDistanceMaterial?(s(y,g),_(y,g)):g.isMeshNormalMaterial?s(y,g):g.isLineBasicMaterial?(a(y,g),g.isLineDashedMaterial&&o(y,g)):g.isPointsMaterial?l(y,g,x,S):g.isSpriteMaterial?u(y,g):g.isShadowMaterial?(y.color.value.copy(g.color),y.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(y,g){y.opacity.value=g.opacity,g.color&&y.diffuse.value.copy(g.color),g.emissive&&y.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(y.map.value=g.map,n(g.map,y.mapTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,n(g.alphaMap,y.alphaMapTransform)),g.bumpMap&&(y.bumpMap.value=g.bumpMap,n(g.bumpMap,y.bumpMapTransform),y.bumpScale.value=g.bumpScale,g.side===La&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,n(g.normalMap,y.normalMapTransform),y.normalScale.value.copy(g.normalScale),g.side===La&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,n(g.displacementMap,y.displacementMapTransform),y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias),g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap,n(g.emissiveMap,y.emissiveMapTransform)),g.specularMap&&(y.specularMap.value=g.specularMap,n(g.specularMap,y.specularMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest);const x=e.get(g),S=x.envMap,E=x.envMapRotation;S&&(y.envMap.value=S,hp.copy(E),hp.x*=-1,hp.y*=-1,hp.z*=-1,S.isCubeTexture&&S.isRenderTargetTexture===!1&&(hp.y*=-1,hp.z*=-1),y.envMapRotation.value.setFromMatrix4(Gne.makeRotationFromEuler(hp)),y.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=g.reflectivity,y.ior.value=g.ior,y.refractionRatio.value=g.refractionRatio),g.lightMap&&(y.lightMap.value=g.lightMap,y.lightMapIntensity.value=g.lightMapIntensity,n(g.lightMap,y.lightMapTransform)),g.aoMap&&(y.aoMap.value=g.aoMap,y.aoMapIntensity.value=g.aoMapIntensity,n(g.aoMap,y.aoMapTransform))}function a(y,g){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,g.map&&(y.map.value=g.map,n(g.map,y.mapTransform))}function o(y,g){y.dashSize.value=g.dashSize,y.totalSize.value=g.dashSize+g.gapSize,y.scale.value=g.scale}function l(y,g,x,S){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.size.value=g.size*x,y.scale.value=S*.5,g.map&&(y.map.value=g.map,n(g.map,y.uvTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,n(g.alphaMap,y.alphaMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest)}function u(y,g){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.rotation.value=g.rotation,g.map&&(y.map.value=g.map,n(g.map,y.mapTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,n(g.alphaMap,y.alphaMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest)}function c(y,g){y.specular.value.copy(g.specular),y.shininess.value=Math.max(g.shininess,1e-4)}function h(y,g){g.gradientMap&&(y.gradientMap.value=g.gradientMap)}function d(y,g){y.metalness.value=g.metalness,g.metalnessMap&&(y.metalnessMap.value=g.metalnessMap,n(g.metalnessMap,y.metalnessMapTransform)),y.roughness.value=g.roughness,g.roughnessMap&&(y.roughnessMap.value=g.roughnessMap,n(g.roughnessMap,y.roughnessMapTransform)),g.envMap&&(y.envMapIntensity.value=g.envMapIntensity)}function m(y,g,x){y.ior.value=g.ior,g.sheen>0&&(y.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),y.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(y.sheenColorMap.value=g.sheenColorMap,n(g.sheenColorMap,y.sheenColorMapTransform)),g.sheenRoughnessMap&&(y.sheenRoughnessMap.value=g.sheenRoughnessMap,n(g.sheenRoughnessMap,y.sheenRoughnessMapTransform))),g.clearcoat>0&&(y.clearcoat.value=g.clearcoat,y.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(y.clearcoatMap.value=g.clearcoatMap,n(g.clearcoatMap,y.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,n(g.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(y.clearcoatNormalMap.value=g.clearcoatNormalMap,n(g.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===La&&y.clearcoatNormalScale.value.negate())),g.dispersion>0&&(y.dispersion.value=g.dispersion),g.iridescence>0&&(y.iridescence.value=g.iridescence,y.iridescenceIOR.value=g.iridescenceIOR,y.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(y.iridescenceMap.value=g.iridescenceMap,n(g.iridescenceMap,y.iridescenceMapTransform)),g.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=g.iridescenceThicknessMap,n(g.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),g.transmission>0&&(y.transmission.value=g.transmission,y.transmissionSamplerMap.value=x.texture,y.transmissionSamplerSize.value.set(x.width,x.height),g.transmissionMap&&(y.transmissionMap.value=g.transmissionMap,n(g.transmissionMap,y.transmissionMapTransform)),y.thickness.value=g.thickness,g.thicknessMap&&(y.thicknessMap.value=g.thicknessMap,n(g.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=g.attenuationDistance,y.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(y.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(y.anisotropyMap.value=g.anisotropyMap,n(g.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=g.specularIntensity,y.specularColor.value.copy(g.specularColor),g.specularColorMap&&(y.specularColorMap.value=g.specularColorMap,n(g.specularColorMap,y.specularColorMapTransform)),g.specularIntensityMap&&(y.specularIntensityMap.value=g.specularIntensityMap,n(g.specularIntensityMap,y.specularIntensityMapTransform))}function v(y,g){g.matcap&&(y.matcap.value=g.matcap)}function _(y,g){const x=e.get(g).light;y.referencePosition.value.setFromMatrixPosition(x.matrixWorld),y.nearDistance.value=x.shadow.camera.near,y.farDistance.value=x.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function Hne(t,e,n,i){let r={},s={},a=[];const o=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(x,S){const E=S.program;i.uniformBlockBinding(x,E)}function u(x,S){let E=r[x.id];E===void 0&&(v(x),E=c(x),r[x.id]=E,x.addEventListener("dispose",y));const A=S.program;i.updateUBOMapping(x,A);const T=e.render.frame;s[x.id]!==T&&(d(x),s[x.id]=T)}function c(x){const S=h();x.__bindingPointIndex=S;const E=t.createBuffer(),A=x.__size,T=x.usage;return t.bindBuffer(t.UNIFORM_BUFFER,E),t.bufferData(t.UNIFORM_BUFFER,A,T),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,S,E),E}function h(){for(let x=0;x<o;x++)if(a.indexOf(x)===-1)return a.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(x){const S=r[x.id],E=x.uniforms,A=x.__cache;t.bindBuffer(t.UNIFORM_BUFFER,S);for(let T=0,C=E.length;T<C;T++){const O=Array.isArray(E[T])?E[T]:[E[T]];for(let M=0,D=O.length;M<D;M++){const P=O[M];if(m(P,T,M,A)===!0){const F=P.__offset,G=Array.isArray(P.value)?P.value:[P.value];let z=0;for(let Y=0;Y<G.length;Y++){const N=G[Y],k=_(N);typeof N=="number"||typeof N=="boolean"?(P.__data[0]=N,t.bufferSubData(t.UNIFORM_BUFFER,F+z,P.__data)):N.isMatrix3?(P.__data[0]=N.elements[0],P.__data[1]=N.elements[1],P.__data[2]=N.elements[2],P.__data[3]=0,P.__data[4]=N.elements[3],P.__data[5]=N.elements[4],P.__data[6]=N.elements[5],P.__data[7]=0,P.__data[8]=N.elements[6],P.__data[9]=N.elements[7],P.__data[10]=N.elements[8],P.__data[11]=0):(N.toArray(P.__data,z),z+=k.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,F,P.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function m(x,S,E,A){const T=x.value,C=S+"_"+E;if(A[C]===void 0)return typeof T=="number"||typeof T=="boolean"?A[C]=T:A[C]=T.clone(),!0;{const O=A[C];if(typeof T=="number"||typeof T=="boolean"){if(O!==T)return A[C]=T,!0}else if(O.equals(T)===!1)return O.copy(T),!0}return!1}function v(x){const S=x.uniforms;let E=0;const A=16;for(let C=0,O=S.length;C<O;C++){const M=Array.isArray(S[C])?S[C]:[S[C]];for(let D=0,P=M.length;D<P;D++){const F=M[D],G=Array.isArray(F.value)?F.value:[F.value];for(let z=0,Y=G.length;z<Y;z++){const N=G[z],k=_(N),j=E%A,X=j%k.boundary,Q=j+X;E+=X,Q!==0&&A-Q<k.storage&&(E+=A-Q),F.__data=new Float32Array(k.storage/Float32Array.BYTES_PER_ELEMENT),F.__offset=E,E+=k.storage}}}const T=E%A;return T>0&&(E+=A-T),x.__size=E,x.__cache={},this}function _(x){const S={boundary:0,storage:0};return typeof x=="number"||typeof x=="boolean"?(S.boundary=4,S.storage=4):x.isVector2?(S.boundary=8,S.storage=8):x.isVector3||x.isColor?(S.boundary=16,S.storage=12):x.isVector4?(S.boundary=16,S.storage=16):x.isMatrix3?(S.boundary=48,S.storage=48):x.isMatrix4?(S.boundary=64,S.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),S}function y(x){const S=x.target;S.removeEventListener("dispose",y);const E=a.indexOf(S.__bindingPointIndex);a.splice(E,1),t.deleteBuffer(r[S.id]),delete r[S.id],delete s[S.id]}function g(){for(const x in r)t.deleteBuffer(r[x]);a=[],r={},s={}}return{bind:l,update:u,dispose:g}}class V8{constructor(e={}){const{canvas:n=IG(),context:i=null,depth:r=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1,reverseDepthBuffer:d=!1}=e;this.isWebGLRenderer=!0;let m;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");m=i.getContextAttributes().alpha}else m=a;const v=new Uint32Array(4),_=new Int32Array(4);let y=null,g=null;const x=[],S=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Ju,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const E=this;let A=!1;this._outputColorSpace=xa;let T=0,C=0,O=null,M=-1,D=null;const P=new bi,F=new bi;let G=null;const z=new nn(0);let Y=0,N=n.width,k=n.height,j=1,X=null,Q=null;const H=new bi(0,0,N,k),$=new bi(0,0,N,k);let ne=!1;const q=new fm;let se=!1,ve=!1;const pe=new kn,xe=new kn,ot=new re,st=new bi,et={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Te=!1;function Xe(){return O===null?j:1}let K=i;function Pe(te,we){return n.getContext(te,we)}try{const te={alpha:!0,depth:r,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${WA}`),n.addEventListener("webglcontextlost",Et,!1),n.addEventListener("webglcontextrestored",Ot,!1),n.addEventListener("webglcontextcreationerror",Mt,!1),K===null){const we="webgl2";if(K=Pe(we,te),K===null)throw Pe(we)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(te){throw console.error("THREE.WebGLRenderer: "+te.message),te}let Ne,Ve,_e,ft,ke,Z,W,I,De,ge,ze,ct,at,Rt,Nt,vt,Vt,Bt,Ht,ut,xn,un,Vn,be;function _t(){Ne=new tte(K),Ne.init(),un=new G8(K,Ne),Ve=new Zee(K,Ne,e,un),_e=new Lne(K,Ne),Ve.reverseDepthBuffer&&d&&_e.buffers.depth.setReversed(!0),ft=new rte(K),ke=new Sne,Z=new Pne(K,Ne,_e,ke,Ve,un,ft),W=new Kee(E),I=new ete(E),De=new cJ(K),Vn=new Xee(K,De),ge=new nte(K,De,ft,Vn),ze=new ate(K,ge,De,ft),Ht=new ste(K,Ve,Z),vt=new qee(ke),ct=new bne(E,W,I,Ne,Ve,Vn,vt),at=new Vne(E,ke),Rt=new wne,Nt=new Dne(Ne),Bt=new Wee(E,W,I,_e,ze,m,l),Vt=new zne(E,ze,Ve),be=new Hne(K,ft,Ve,_e),ut=new Yee(K,Ne,ft),xn=new ite(K,Ne,ft),ft.programs=ct.programs,E.capabilities=Ve,E.extensions=Ne,E.properties=ke,E.renderLists=Rt,E.shadowMap=Vt,E.state=_e,E.info=ft}_t();const Ye=new Fne(E,K);this.xr=Ye,this.getContext=function(){return K},this.getContextAttributes=function(){return K.getContextAttributes()},this.forceContextLoss=function(){const te=Ne.get("WEBGL_lose_context");te&&te.loseContext()},this.forceContextRestore=function(){const te=Ne.get("WEBGL_lose_context");te&&te.restoreContext()},this.getPixelRatio=function(){return j},this.setPixelRatio=function(te){te!==void 0&&(j=te,this.setSize(N,k,!1))},this.getSize=function(te){return te.set(N,k)},this.setSize=function(te,we,Ke=!0){if(Ye.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}N=te,k=we,n.width=Math.floor(te*j),n.height=Math.floor(we*j),Ke===!0&&(n.style.width=te+"px",n.style.height=we+"px"),this.setViewport(0,0,te,we)},this.getDrawingBufferSize=function(te){return te.set(N*j,k*j).floor()},this.setDrawingBufferSize=function(te,we,Ke){N=te,k=we,j=Ke,n.width=Math.floor(te*Ke),n.height=Math.floor(we*Ke),this.setViewport(0,0,te,we)},this.getCurrentViewport=function(te){return te.copy(P)},this.getViewport=function(te){return te.copy(H)},this.setViewport=function(te,we,Ke,Ee){te.isVector4?H.set(te.x,te.y,te.z,te.w):H.set(te,we,Ke,Ee),_e.viewport(P.copy(H).multiplyScalar(j).round())},this.getScissor=function(te){return te.copy($)},this.setScissor=function(te,we,Ke,Ee){te.isVector4?$.set(te.x,te.y,te.z,te.w):$.set(te,we,Ke,Ee),_e.scissor(F.copy($).multiplyScalar(j).round())},this.getScissorTest=function(){return ne},this.setScissorTest=function(te){_e.setScissorTest(ne=te)},this.setOpaqueSort=function(te){X=te},this.setTransparentSort=function(te){Q=te},this.getClearColor=function(te){return te.copy(Bt.getClearColor())},this.setClearColor=function(){Bt.setClearColor(...arguments)},this.getClearAlpha=function(){return Bt.getClearAlpha()},this.setClearAlpha=function(){Bt.setClearAlpha(...arguments)},this.clear=function(te=!0,we=!0,Ke=!0){let Ee=0;if(te){let Ue=!1;if(O!==null){const It=O.texture.format;Ue=It===$A||It===JA||It===k_}if(Ue){const It=O.texture.type,en=It===ml||It===Mf||It===k0||It===F0||It===qA||It===KA,on=Bt.getClearColor(),fn=Bt.getClearAlpha(),zn=on.r,Dn=on.g,En=on.b;en?(v[0]=zn,v[1]=Dn,v[2]=En,v[3]=fn,K.clearBufferuiv(K.COLOR,0,v)):(_[0]=zn,_[1]=Dn,_[2]=En,_[3]=fn,K.clearBufferiv(K.COLOR,0,_))}else Ee|=K.COLOR_BUFFER_BIT}we&&(Ee|=K.DEPTH_BUFFER_BIT),Ke&&(Ee|=K.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),K.clear(Ee)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Et,!1),n.removeEventListener("webglcontextrestored",Ot,!1),n.removeEventListener("webglcontextcreationerror",Mt,!1),Bt.dispose(),Rt.dispose(),Nt.dispose(),ke.dispose(),W.dispose(),I.dispose(),ze.dispose(),Vn.dispose(),be.dispose(),ct.dispose(),Ye.dispose(),Ye.removeEventListener("sessionstart",lr),Ye.removeEventListener("sessionend",us),Vr.stop()};function Et(te){te.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),A=!0}function Ot(){console.log("THREE.WebGLRenderer: Context Restored."),A=!1;const te=ft.autoReset,we=Vt.enabled,Ke=Vt.autoUpdate,Ee=Vt.needsUpdate,Ue=Vt.type;_t(),ft.autoReset=te,Vt.enabled=we,Vt.autoUpdate=Ke,Vt.needsUpdate=Ee,Vt.type=Ue}function Mt(te){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",te.statusMessage)}function vn(te){const we=te.target;we.removeEventListener("dispose",vn),Un(we)}function Un(te){an(te),ke.remove(te)}function an(te){const we=ke.get(te).programs;we!==void 0&&(we.forEach(function(Ke){ct.releaseProgram(Ke)}),te.isShaderMaterial&&ct.releaseShaderCache(te))}this.renderBufferDirect=function(te,we,Ke,Ee,Ue,It){we===null&&(we=et);const en=Ue.isMesh&&Ue.matrixWorld.determinant()<0,on=Vf(te,we,Ke,Ee,Ue);_e.setMaterial(Ee,en);let fn=Ke.index,zn=1;if(Ee.wireframe===!0){if(fn=ge.getWireframeAttribute(Ke),fn===void 0)return;zn=2}const Dn=Ke.drawRange,En=Ke.attributes.position;let ai=Dn.start*zn,ui=(Dn.start+Dn.count)*zn;It!==null&&(ai=Math.max(ai,It.start*zn),ui=Math.min(ui,(It.start+It.count)*zn)),fn!==null?(ai=Math.max(ai,0),ui=Math.min(ui,fn.count)):En!=null&&(ai=Math.max(ai,0),ui=Math.min(ui,En.count));const er=ui-ai;if(er<0||er===1/0)return;Vn.setup(Ue,Ee,on,Ke,fn);let Di,ci=ut;if(fn!==null&&(Di=De.get(fn),ci=xn,ci.setIndex(Di)),Ue.isMesh)Ee.wireframe===!0?(_e.setLineWidth(Ee.wireframeLinewidth*Xe()),ci.setMode(K.LINES)):ci.setMode(K.TRIANGLES);else if(Ue.isLine){let Tn=Ee.linewidth;Tn===void 0&&(Tn=1),_e.setLineWidth(Tn*Xe()),Ue.isLineSegments?ci.setMode(K.LINES):Ue.isLineLoop?ci.setMode(K.LINE_LOOP):ci.setMode(K.LINE_STRIP)}else Ue.isPoints?ci.setMode(K.POINTS):Ue.isSprite&&ci.setMode(K.TRIANGLES);if(Ue.isBatchedMesh)if(Ue._multiDrawInstances!==null)uE("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),ci.renderMultiDrawInstances(Ue._multiDrawStarts,Ue._multiDrawCounts,Ue._multiDrawCount,Ue._multiDrawInstances);else if(Ne.get("WEBGL_multi_draw"))ci.renderMultiDraw(Ue._multiDrawStarts,Ue._multiDrawCounts,Ue._multiDrawCount);else{const Tn=Ue._multiDrawStarts,Zi=Ue._multiDrawCounts,ei=Ue._multiDrawCount,cs=fn?De.get(fn).bytesPerElement:1,oa=ke.get(Ee).currentProgram.getUniforms();for(let dr=0;dr<ei;dr++)oa.setValue(K,"_gl_DrawID",dr),ci.render(Tn[dr]/cs,Zi[dr])}else if(Ue.isInstancedMesh)ci.renderInstances(ai,er,Ue.count);else if(Ke.isInstancedBufferGeometry){const Tn=Ke._maxInstanceCount!==void 0?Ke._maxInstanceCount:1/0,Zi=Math.min(Ke.instanceCount,Tn);ci.renderInstances(ai,er,Zi)}else ci.render(ai,er)};function An(te,we,Ke){te.transparent===!0&&te.side===es&&te.forceSinglePass===!1?(te.side=La,te.needsUpdate=!0,xi(te,we,Ke),te.side=Af,te.needsUpdate=!0,xi(te,we,Ke),te.side=es):xi(te,we,Ke)}this.compile=function(te,we,Ke=null){Ke===null&&(Ke=te),g=Nt.get(Ke),g.init(we),S.push(g),Ke.traverseVisible(function(Ue){Ue.isLight&&Ue.layers.test(we.layers)&&(g.pushLight(Ue),Ue.castShadow&&g.pushShadow(Ue))}),te!==Ke&&te.traverseVisible(function(Ue){Ue.isLight&&Ue.layers.test(we.layers)&&(g.pushLight(Ue),Ue.castShadow&&g.pushShadow(Ue))}),g.setupLights();const Ee=new Set;return te.traverse(function(Ue){if(!(Ue.isMesh||Ue.isPoints||Ue.isLine||Ue.isSprite))return;const It=Ue.material;if(It)if(Array.isArray(It))for(let en=0;en<It.length;en++){const on=It[en];An(on,Ke,Ue),Ee.add(on)}else An(It,Ke,Ue),Ee.add(It)}),g=S.pop(),Ee},this.compileAsync=function(te,we,Ke=null){const Ee=this.compile(te,we,Ke);return new Promise(Ue=>{function It(){if(Ee.forEach(function(en){ke.get(en).currentProgram.isReady()&&Ee.delete(en)}),Ee.size===0){Ue(te);return}setTimeout(It,10)}Ne.get("KHR_parallel_shader_compile")!==null?It():setTimeout(It,10)})};let Ri=null;function Ni(te){Ri&&Ri(te)}function lr(){Vr.stop()}function us(){Vr.start()}const Vr=new P8;Vr.setAnimationLoop(Ni),typeof self<"u"&&Vr.setContext(self),this.setAnimationLoop=function(te){Ri=te,Ye.setAnimationLoop(te),te===null?Vr.stop():Vr.start()},Ye.addEventListener("sessionstart",lr),Ye.addEventListener("sessionend",us),this.render=function(te,we){if(we!==void 0&&we.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(A===!0)return;if(te.matrixWorldAutoUpdate===!0&&te.updateMatrixWorld(),we.parent===null&&we.matrixWorldAutoUpdate===!0&&we.updateMatrixWorld(),Ye.enabled===!0&&Ye.isPresenting===!0&&(Ye.cameraAutoUpdate===!0&&Ye.updateCamera(we),we=Ye.getCamera()),te.isScene===!0&&te.onBeforeRender(E,te,we,O),g=Nt.get(te,S.length),g.init(we),S.push(g),xe.multiplyMatrices(we.projectionMatrix,we.matrixWorldInverse),q.setFromProjectionMatrix(xe),ve=this.localClippingEnabled,se=vt.init(this.clippingPlanes,ve),y=Rt.get(te,x.length),y.init(),x.push(y),Ye.enabled===!0&&Ye.isPresenting===!0){const It=E.xr.getDepthSensingMesh();It!==null&&Sr(It,we,-1/0,E.sortObjects)}Sr(te,we,0,E.sortObjects),y.finish(),E.sortObjects===!0&&y.sort(X,Q),Te=Ye.enabled===!1||Ye.isPresenting===!1||Ye.hasDepthSensing()===!1,Te&&Bt.addToRenderList(y,te),this.info.render.frame++,se===!0&&vt.beginShadows();const Ke=g.state.shadowsArray;Vt.render(Ke,te,we),se===!0&&vt.endShadows(),this.info.autoReset===!0&&this.info.reset();const Ee=y.opaque,Ue=y.transmissive;if(g.setupLights(),we.isArrayCamera){const It=we.cameras;if(Ue.length>0)for(let en=0,on=It.length;en<on;en++){const fn=It[en];Hr(Ee,Ue,te,fn)}Te&&Bt.render(te);for(let en=0,on=It.length;en<on;en++){const fn=It[en];aa(y,te,fn,fn.viewport)}}else Ue.length>0&&Hr(Ee,Ue,te,we),Te&&Bt.render(te),aa(y,te,we);O!==null&&C===0&&(Z.updateMultisampleRenderTarget(O),Z.updateRenderTargetMipmap(O)),te.isScene===!0&&te.onAfterRender(E,te,we),Vn.resetDefaultState(),M=-1,D=null,S.pop(),S.length>0?(g=S[S.length-1],se===!0&&vt.setGlobalState(E.clippingPlanes,g.state.camera)):g=null,x.pop(),x.length>0?y=x[x.length-1]:y=null};function Sr(te,we,Ke,Ee){if(te.visible===!1)return;if(te.layers.test(we.layers)){if(te.isGroup)Ke=te.renderOrder;else if(te.isLOD)te.autoUpdate===!0&&te.update(we);else if(te.isLight)g.pushLight(te),te.castShadow&&g.pushShadow(te);else if(te.isSprite){if(!te.frustumCulled||q.intersectsSprite(te)){Ee&&st.setFromMatrixPosition(te.matrixWorld).applyMatrix4(xe);const en=ze.update(te),on=te.material;on.visible&&y.push(te,en,on,Ke,st.z,null)}}else if((te.isMesh||te.isLine||te.isPoints)&&(!te.frustumCulled||q.intersectsObject(te))){const en=ze.update(te),on=te.material;if(Ee&&(te.boundingSphere!==void 0?(te.boundingSphere===null&&te.computeBoundingSphere(),st.copy(te.boundingSphere.center)):(en.boundingSphere===null&&en.computeBoundingSphere(),st.copy(en.boundingSphere.center)),st.applyMatrix4(te.matrixWorld).applyMatrix4(xe)),Array.isArray(on)){const fn=en.groups;for(let zn=0,Dn=fn.length;zn<Dn;zn++){const En=fn[zn],ai=on[En.materialIndex];ai&&ai.visible&&y.push(te,en,ai,Ke,st.z,En)}}else on.visible&&y.push(te,en,on,Ke,st.z,null)}}const It=te.children;for(let en=0,on=It.length;en<on;en++)Sr(It[en],we,Ke,Ee)}function aa(te,we,Ke,Ee){const Ue=te.opaque,It=te.transmissive,en=te.transparent;g.setupLightsView(Ke),se===!0&&vt.setGlobalState(E.clippingPlanes,Ke),Ee&&_e.viewport(P.copy(Ee)),Ue.length>0&&ur(Ue,we,Ke),It.length>0&&ur(It,we,Ke),en.length>0&&ur(en,we,Ke),_e.buffers.depth.setTest(!0),_e.buffers.depth.setMask(!0),_e.buffers.color.setMask(!0),_e.setPolygonOffset(!1)}function Hr(te,we,Ke,Ee){if((Ke.isScene===!0?Ke.overrideMaterial:null)!==null)return;g.state.transmissionRenderTarget[Ee.id]===void 0&&(g.state.transmissionRenderTarget[Ee.id]=new sc(1,1,{generateMipmaps:!0,type:Ne.has("EXT_color_buffer_half_float")||Ne.has("EXT_color_buffer_float")?pv:ml,minFilter:Yu,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Ei.workingColorSpace}));const It=g.state.transmissionRenderTarget[Ee.id],en=Ee.viewport||P;It.setSize(en.z*E.transmissionResolutionScale,en.w*E.transmissionResolutionScale);const on=E.getRenderTarget();E.setRenderTarget(It),E.getClearColor(z),Y=E.getClearAlpha(),Y<1&&E.setClearColor(16777215,.5),E.clear(),Te&&Bt.render(Ke);const fn=E.toneMapping;E.toneMapping=Ju;const zn=Ee.viewport;if(Ee.viewport!==void 0&&(Ee.viewport=void 0),g.setupLightsView(Ee),se===!0&&vt.setGlobalState(E.clippingPlanes,Ee),ur(te,Ke,Ee),Z.updateMultisampleRenderTarget(It),Z.updateRenderTargetMipmap(It),Ne.has("WEBGL_multisampled_render_to_texture")===!1){let Dn=!1;for(let En=0,ai=we.length;En<ai;En++){const ui=we[En],er=ui.object,Di=ui.geometry,ci=ui.material,Tn=ui.group;if(ci.side===es&&er.layers.test(Ee.layers)){const Zi=ci.side;ci.side=La,ci.needsUpdate=!0,Zn(er,Ke,Ee,Di,ci,Tn),ci.side=Zi,ci.needsUpdate=!0,Dn=!0}}Dn===!0&&(Z.updateMultisampleRenderTarget(It),Z.updateRenderTargetMipmap(It))}E.setRenderTarget(on),E.setClearColor(z,Y),zn!==void 0&&(Ee.viewport=zn),E.toneMapping=fn}function ur(te,we,Ke){const Ee=we.isScene===!0?we.overrideMaterial:null;for(let Ue=0,It=te.length;Ue<It;Ue++){const en=te[Ue],on=en.object,fn=en.geometry,zn=en.group;let Dn=en.material;Dn.allowOverride===!0&&Ee!==null&&(Dn=Ee),on.layers.test(Ke.layers)&&Zn(on,we,Ke,fn,Dn,zn)}}function Zn(te,we,Ke,Ee,Ue,It){te.onBeforeRender(E,we,Ke,Ee,Ue,It),te.modelViewMatrix.multiplyMatrices(Ke.matrixWorldInverse,te.matrixWorld),te.normalMatrix.getNormalMatrix(te.modelViewMatrix),Ue.onBeforeRender(E,we,Ke,Ee,te,It),Ue.transparent===!0&&Ue.side===es&&Ue.forceSinglePass===!1?(Ue.side=La,Ue.needsUpdate=!0,E.renderBufferDirect(Ke,we,Ee,Ue,te,It),Ue.side=Af,Ue.needsUpdate=!0,E.renderBufferDirect(Ke,we,Ee,Ue,te,It),Ue.side=es):E.renderBufferDirect(Ke,we,Ee,Ue,te,It),te.onAfterRender(E,we,Ke,Ee,Ue,It)}function xi(te,we,Ke){we.isScene!==!0&&(we=et);const Ee=ke.get(te),Ue=g.state.lights,It=g.state.shadowsArray,en=Ue.state.version,on=ct.getParameters(te,Ue.state,It,we,Ke),fn=ct.getProgramCacheKey(on);let zn=Ee.programs;Ee.environment=te.isMeshStandardMaterial?we.environment:null,Ee.fog=we.fog,Ee.envMap=(te.isMeshStandardMaterial?I:W).get(te.envMap||Ee.environment),Ee.envMapRotation=Ee.environment!==null&&te.envMap===null?we.environmentRotation:te.envMapRotation,zn===void 0&&(te.addEventListener("dispose",vn),zn=new Map,Ee.programs=zn);let Dn=zn.get(fn);if(Dn!==void 0){if(Ee.currentProgram===Dn&&Ee.lightsStateVersion===en)return Po(te,on),Dn}else on.uniforms=ct.getUniforms(te),te.onBeforeCompile(on,E),Dn=ct.acquireProgram(on,fn),zn.set(fn,Dn),Ee.uniforms=on.uniforms;const En=Ee.uniforms;return(!te.isShaderMaterial&&!te.isRawShaderMaterial||te.clipping===!0)&&(En.clippingPlanes=vt.uniform),Po(te,on),Ee.needsLights=fu(te),Ee.lightsStateVersion=en,Ee.needsLights&&(En.ambientLightColor.value=Ue.state.ambient,En.lightProbe.value=Ue.state.probe,En.directionalLights.value=Ue.state.directional,En.directionalLightShadows.value=Ue.state.directionalShadow,En.spotLights.value=Ue.state.spot,En.spotLightShadows.value=Ue.state.spotShadow,En.rectAreaLights.value=Ue.state.rectArea,En.ltc_1.value=Ue.state.rectAreaLTC1,En.ltc_2.value=Ue.state.rectAreaLTC2,En.pointLights.value=Ue.state.point,En.pointLightShadows.value=Ue.state.pointShadow,En.hemisphereLights.value=Ue.state.hemi,En.directionalShadowMap.value=Ue.state.directionalShadowMap,En.directionalShadowMatrix.value=Ue.state.directionalShadowMatrix,En.spotShadowMap.value=Ue.state.spotShadowMap,En.spotLightMatrix.value=Ue.state.spotLightMatrix,En.spotLightMap.value=Ue.state.spotLightMap,En.pointShadowMap.value=Ue.state.pointShadowMap,En.pointShadowMatrix.value=Ue.state.pointShadowMatrix),Ee.currentProgram=Dn,Ee.uniformsList=null,Dn}function xl(te){if(te.uniformsList===null){const we=te.currentProgram.getUniforms();te.uniformsList=fE.seqWithValue(we.seq,te.uniforms)}return te.uniformsList}function Po(te,we){const Ke=ke.get(te);Ke.outputColorSpace=we.outputColorSpace,Ke.batching=we.batching,Ke.batchingColor=we.batchingColor,Ke.instancing=we.instancing,Ke.instancingColor=we.instancingColor,Ke.instancingMorph=we.instancingMorph,Ke.skinning=we.skinning,Ke.morphTargets=we.morphTargets,Ke.morphNormals=we.morphNormals,Ke.morphColors=we.morphColors,Ke.morphTargetsCount=we.morphTargetsCount,Ke.numClippingPlanes=we.numClippingPlanes,Ke.numIntersection=we.numClipIntersection,Ke.vertexAlphas=we.vertexAlphas,Ke.vertexTangents=we.vertexTangents,Ke.toneMapping=we.toneMapping}function Vf(te,we,Ke,Ee,Ue){we.isScene!==!0&&(we=et),Z.resetTextureUnits();const It=we.fog,en=Ee.isMeshStandardMaterial?we.environment:null,on=O===null?E.outputColorSpace:O.isXRRenderTarget===!0?O.texture.colorSpace:od,fn=(Ee.isMeshStandardMaterial?I:W).get(Ee.envMap||en),zn=Ee.vertexColors===!0&&!!Ke.attributes.color&&Ke.attributes.color.itemSize===4,Dn=!!Ke.attributes.tangent&&(!!Ee.normalMap||Ee.anisotropy>0),En=!!Ke.morphAttributes.position,ai=!!Ke.morphAttributes.normal,ui=!!Ke.morphAttributes.color;let er=Ju;Ee.toneMapped&&(O===null||O.isXRRenderTarget===!0)&&(er=E.toneMapping);const Di=Ke.morphAttributes.position||Ke.morphAttributes.normal||Ke.morphAttributes.color,ci=Di!==void 0?Di.length:0,Tn=ke.get(Ee),Zi=g.state.lights;if(se===!0&&(ve===!0||te!==D)){const jr=te===D&&Ee.id===M;vt.setState(Ee,te,jr)}let ei=!1;Ee.version===Tn.__version?(Tn.needsLights&&Tn.lightsStateVersion!==Zi.state.version||Tn.outputColorSpace!==on||Ue.isBatchedMesh&&Tn.batching===!1||!Ue.isBatchedMesh&&Tn.batching===!0||Ue.isBatchedMesh&&Tn.batchingColor===!0&&Ue.colorTexture===null||Ue.isBatchedMesh&&Tn.batchingColor===!1&&Ue.colorTexture!==null||Ue.isInstancedMesh&&Tn.instancing===!1||!Ue.isInstancedMesh&&Tn.instancing===!0||Ue.isSkinnedMesh&&Tn.skinning===!1||!Ue.isSkinnedMesh&&Tn.skinning===!0||Ue.isInstancedMesh&&Tn.instancingColor===!0&&Ue.instanceColor===null||Ue.isInstancedMesh&&Tn.instancingColor===!1&&Ue.instanceColor!==null||Ue.isInstancedMesh&&Tn.instancingMorph===!0&&Ue.morphTexture===null||Ue.isInstancedMesh&&Tn.instancingMorph===!1&&Ue.morphTexture!==null||Tn.envMap!==fn||Ee.fog===!0&&Tn.fog!==It||Tn.numClippingPlanes!==void 0&&(Tn.numClippingPlanes!==vt.numPlanes||Tn.numIntersection!==vt.numIntersection)||Tn.vertexAlphas!==zn||Tn.vertexTangents!==Dn||Tn.morphTargets!==En||Tn.morphNormals!==ai||Tn.morphColors!==ui||Tn.toneMapping!==er||Tn.morphTargetsCount!==ci)&&(ei=!0):(ei=!0,Tn.__version=Ee.version);let cs=Tn.currentProgram;ei===!0&&(cs=xi(Ee,we,Ue));let oa=!1,dr=!1,Rr=!1;const Oi=cs.getUniforms(),Er=Tn.uniforms;if(_e.useProgram(cs.program)&&(oa=!0,dr=!0,Rr=!0),Ee.id!==M&&(M=Ee.id,dr=!0),oa||D!==te){_e.buffers.depth.getReversed()?(pe.copy(te.projectionMatrix),Oq(pe),Uq(pe),Oi.setValue(K,"projectionMatrix",pe)):Oi.setValue(K,"projectionMatrix",te.projectionMatrix),Oi.setValue(K,"viewMatrix",te.matrixWorldInverse);const wr=Oi.map.cameraPosition;wr!==void 0&&wr.setValue(K,ot.setFromMatrixPosition(te.matrixWorld)),Ve.logarithmicDepthBuffer&&Oi.setValue(K,"logDepthBufFC",2/(Math.log(te.far+1)/Math.LN2)),(Ee.isMeshPhongMaterial||Ee.isMeshToonMaterial||Ee.isMeshLambertMaterial||Ee.isMeshBasicMaterial||Ee.isMeshStandardMaterial||Ee.isShaderMaterial)&&Oi.setValue(K,"isOrthographic",te.isOrthographicCamera===!0),D!==te&&(D=te,dr=!0,Rr=!0)}if(Ue.isSkinnedMesh){Oi.setOptional(K,Ue,"bindMatrix"),Oi.setOptional(K,Ue,"bindMatrixInverse");const jr=Ue.skeleton;jr&&(jr.boneTexture===null&&jr.computeBoneTexture(),Oi.setValue(K,"boneTexture",jr.boneTexture,Z))}Ue.isBatchedMesh&&(Oi.setOptional(K,Ue,"batchingTexture"),Oi.setValue(K,"batchingTexture",Ue._matricesTexture,Z),Oi.setOptional(K,Ue,"batchingIdTexture"),Oi.setValue(K,"batchingIdTexture",Ue._indirectTexture,Z),Oi.setOptional(K,Ue,"batchingColorTexture"),Ue._colorsTexture!==null&&Oi.setValue(K,"batchingColorTexture",Ue._colorsTexture,Z));const Dr=Ke.morphAttributes;if((Dr.position!==void 0||Dr.normal!==void 0||Dr.color!==void 0)&&Ht.update(Ue,Ke,cs),(dr||Tn.receiveShadow!==Ue.receiveShadow)&&(Tn.receiveShadow=Ue.receiveShadow,Oi.setValue(K,"receiveShadow",Ue.receiveShadow)),Ee.isMeshGouraudMaterial&&Ee.envMap!==null&&(Er.envMap.value=fn,Er.flipEnvMap.value=fn.isCubeTexture&&fn.isRenderTargetTexture===!1?-1:1),Ee.isMeshStandardMaterial&&Ee.envMap===null&&we.environment!==null&&(Er.envMapIntensity.value=we.environmentIntensity),dr&&(Oi.setValue(K,"toneMappingExposure",E.toneMappingExposure),Tn.needsLights&&dc(Er,Rr),It&&Ee.fog===!0&&at.refreshFogUniforms(Er,It),at.refreshMaterialUniforms(Er,Ee,j,k,g.state.transmissionRenderTarget[te.id]),fE.upload(K,xl(Tn),Er,Z)),Ee.isShaderMaterial&&Ee.uniformsNeedUpdate===!0&&(fE.upload(K,xl(Tn),Er,Z),Ee.uniformsNeedUpdate=!1),Ee.isSpriteMaterial&&Oi.setValue(K,"center",Ue.center),Oi.setValue(K,"modelViewMatrix",Ue.modelViewMatrix),Oi.setValue(K,"normalMatrix",Ue.normalMatrix),Oi.setValue(K,"modelMatrix",Ue.matrixWorld),Ee.isShaderMaterial||Ee.isRawShaderMaterial){const jr=Ee.uniformsGroups;for(let wr=0,qs=jr.length;wr<qs;wr++){const pr=jr[wr];be.update(pr,cs),be.bind(pr,cs)}}return cs}function dc(te,we){te.ambientLightColor.needsUpdate=we,te.lightProbe.needsUpdate=we,te.directionalLights.needsUpdate=we,te.directionalLightShadows.needsUpdate=we,te.pointLights.needsUpdate=we,te.pointLightShadows.needsUpdate=we,te.spotLights.needsUpdate=we,te.spotLightShadows.needsUpdate=we,te.rectAreaLights.needsUpdate=we,te.hemisphereLights.needsUpdate=we}function fu(te){return te.isMeshLambertMaterial||te.isMeshToonMaterial||te.isMeshPhongMaterial||te.isMeshStandardMaterial||te.isShadowMaterial||te.isShaderMaterial&&te.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return C},this.getRenderTarget=function(){return O},this.setRenderTargetTextures=function(te,we,Ke){const Ee=ke.get(te);Ee.__autoAllocateDepthBuffer=te.resolveDepthBuffer===!1,Ee.__autoAllocateDepthBuffer===!1&&(Ee.__useRenderToTexture=!1),ke.get(te.texture).__webglTexture=we,ke.get(te.depthTexture).__webglTexture=Ee.__autoAllocateDepthBuffer?void 0:Ke,Ee.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(te,we){const Ke=ke.get(te);Ke.__webglFramebuffer=we,Ke.__useDefaultFramebuffer=we===void 0};const _l=K.createFramebuffer();this.setRenderTarget=function(te,we=0,Ke=0){O=te,T=we,C=Ke;let Ee=!0,Ue=null,It=!1,en=!1;if(te){const fn=ke.get(te);if(fn.__useDefaultFramebuffer!==void 0)_e.bindFramebuffer(K.FRAMEBUFFER,null),Ee=!1;else if(fn.__webglFramebuffer===void 0)Z.setupRenderTarget(te);else if(fn.__hasExternalTextures)Z.rebindTextures(te,ke.get(te.texture).__webglTexture,ke.get(te.depthTexture).__webglTexture);else if(te.depthBuffer){const En=te.depthTexture;if(fn.__boundDepthTexture!==En){if(En!==null&&ke.has(En)&&(te.width!==En.image.width||te.height!==En.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Z.setupDepthRenderbuffer(te)}}const zn=te.texture;(zn.isData3DTexture||zn.isDataArrayTexture||zn.isCompressedArrayTexture)&&(en=!0);const Dn=ke.get(te).__webglFramebuffer;te.isWebGLCubeRenderTarget?(Array.isArray(Dn[we])?Ue=Dn[we][Ke]:Ue=Dn[we],It=!0):te.samples>0&&Z.useMultisampledRTT(te)===!1?Ue=ke.get(te).__webglMultisampledFramebuffer:Array.isArray(Dn)?Ue=Dn[Ke]:Ue=Dn,P.copy(te.viewport),F.copy(te.scissor),G=te.scissorTest}else P.copy(H).multiplyScalar(j).floor(),F.copy($).multiplyScalar(j).floor(),G=ne;if(Ke!==0&&(Ue=_l),_e.bindFramebuffer(K.FRAMEBUFFER,Ue)&&Ee&&_e.drawBuffers(te,Ue),_e.viewport(P),_e.scissor(F),_e.setScissorTest(G),It){const fn=ke.get(te.texture);K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_CUBE_MAP_POSITIVE_X+we,fn.__webglTexture,Ke)}else if(en){const fn=ke.get(te.texture),zn=we;K.framebufferTextureLayer(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,fn.__webglTexture,Ke,zn)}else if(te!==null&&Ke!==0){const fn=ke.get(te.texture);K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,fn.__webglTexture,Ke)}M=-1},this.readRenderTargetPixels=function(te,we,Ke,Ee,Ue,It,en){if(!(te&&te.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let on=ke.get(te).__webglFramebuffer;if(te.isWebGLCubeRenderTarget&&en!==void 0&&(on=on[en]),on){_e.bindFramebuffer(K.FRAMEBUFFER,on);try{const fn=te.texture,zn=fn.format,Dn=fn.type;if(!Ve.textureFormatReadable(zn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ve.textureTypeReadable(Dn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}we>=0&&we<=te.width-Ee&&Ke>=0&&Ke<=te.height-Ue&&K.readPixels(we,Ke,Ee,Ue,un.convert(zn),un.convert(Dn),It)}finally{const fn=O!==null?ke.get(O).__webglFramebuffer:null;_e.bindFramebuffer(K.FRAMEBUFFER,fn)}}},this.readRenderTargetPixelsAsync=async function(te,we,Ke,Ee,Ue,It,en){if(!(te&&te.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let on=ke.get(te).__webglFramebuffer;if(te.isWebGLCubeRenderTarget&&en!==void 0&&(on=on[en]),on)if(we>=0&&we<=te.width-Ee&&Ke>=0&&Ke<=te.height-Ue){_e.bindFramebuffer(K.FRAMEBUFFER,on);const fn=te.texture,zn=fn.format,Dn=fn.type;if(!Ve.textureFormatReadable(zn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ve.textureTypeReadable(Dn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const En=K.createBuffer();K.bindBuffer(K.PIXEL_PACK_BUFFER,En),K.bufferData(K.PIXEL_PACK_BUFFER,It.byteLength,K.STREAM_READ),K.readPixels(we,Ke,Ee,Ue,un.convert(zn),un.convert(Dn),0);const ai=O!==null?ke.get(O).__webglFramebuffer:null;_e.bindFramebuffer(K.FRAMEBUFFER,ai);const ui=K.fenceSync(K.SYNC_GPU_COMMANDS_COMPLETE,0);return K.flush(),await Dq(K,ui,4),K.bindBuffer(K.PIXEL_PACK_BUFFER,En),K.getBufferSubData(K.PIXEL_PACK_BUFFER,0,It),K.deleteBuffer(En),K.deleteSync(ui),It}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(te,we=null,Ke=0){const Ee=Math.pow(2,-Ke),Ue=Math.floor(te.image.width*Ee),It=Math.floor(te.image.height*Ee),en=we!==null?we.x:0,on=we!==null?we.y:0;Z.setTexture2D(te,0),K.copyTexSubImage2D(K.TEXTURE_2D,Ke,0,0,en,on,Ue,It),_e.unbindTexture()};const pc=K.createFramebuffer(),hu=K.createFramebuffer();this.copyTextureToTexture=function(te,we,Ke=null,Ee=null,Ue=0,It=null){It===null&&(Ue!==0?(uE("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),It=Ue,Ue=0):It=0);let en,on,fn,zn,Dn,En,ai,ui,er;const Di=te.isCompressedTexture?te.mipmaps[It]:te.image;if(Ke!==null)en=Ke.max.x-Ke.min.x,on=Ke.max.y-Ke.min.y,fn=Ke.isBox3?Ke.max.z-Ke.min.z:1,zn=Ke.min.x,Dn=Ke.min.y,En=Ke.isBox3?Ke.min.z:0;else{const Dr=Math.pow(2,-Ue);en=Math.floor(Di.width*Dr),on=Math.floor(Di.height*Dr),te.isDataArrayTexture?fn=Di.depth:te.isData3DTexture?fn=Math.floor(Di.depth*Dr):fn=1,zn=0,Dn=0,En=0}Ee!==null?(ai=Ee.x,ui=Ee.y,er=Ee.z):(ai=0,ui=0,er=0);const ci=un.convert(we.format),Tn=un.convert(we.type);let Zi;we.isData3DTexture?(Z.setTexture3D(we,0),Zi=K.TEXTURE_3D):we.isDataArrayTexture||we.isCompressedArrayTexture?(Z.setTexture2DArray(we,0),Zi=K.TEXTURE_2D_ARRAY):(Z.setTexture2D(we,0),Zi=K.TEXTURE_2D),K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,we.flipY),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),K.pixelStorei(K.UNPACK_ALIGNMENT,we.unpackAlignment);const ei=K.getParameter(K.UNPACK_ROW_LENGTH),cs=K.getParameter(K.UNPACK_IMAGE_HEIGHT),oa=K.getParameter(K.UNPACK_SKIP_PIXELS),dr=K.getParameter(K.UNPACK_SKIP_ROWS),Rr=K.getParameter(K.UNPACK_SKIP_IMAGES);K.pixelStorei(K.UNPACK_ROW_LENGTH,Di.width),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,Di.height),K.pixelStorei(K.UNPACK_SKIP_PIXELS,zn),K.pixelStorei(K.UNPACK_SKIP_ROWS,Dn),K.pixelStorei(K.UNPACK_SKIP_IMAGES,En);const Oi=te.isDataArrayTexture||te.isData3DTexture,Er=we.isDataArrayTexture||we.isData3DTexture;if(te.isDepthTexture){const Dr=ke.get(te),jr=ke.get(we),wr=ke.get(Dr.__renderTarget),qs=ke.get(jr.__renderTarget);_e.bindFramebuffer(K.READ_FRAMEBUFFER,wr.__webglFramebuffer),_e.bindFramebuffer(K.DRAW_FRAMEBUFFER,qs.__webglFramebuffer);for(let pr=0;pr<fn;pr++)Oi&&(K.framebufferTextureLayer(K.READ_FRAMEBUFFER,K.COLOR_ATTACHMENT0,ke.get(te).__webglTexture,Ue,En+pr),K.framebufferTextureLayer(K.DRAW_FRAMEBUFFER,K.COLOR_ATTACHMENT0,ke.get(we).__webglTexture,It,er+pr)),K.blitFramebuffer(zn,Dn,en,on,ai,ui,en,on,K.DEPTH_BUFFER_BIT,K.NEAREST);_e.bindFramebuffer(K.READ_FRAMEBUFFER,null),_e.bindFramebuffer(K.DRAW_FRAMEBUFFER,null)}else if(Ue!==0||te.isRenderTargetTexture||ke.has(te)){const Dr=ke.get(te),jr=ke.get(we);_e.bindFramebuffer(K.READ_FRAMEBUFFER,pc),_e.bindFramebuffer(K.DRAW_FRAMEBUFFER,hu);for(let wr=0;wr<fn;wr++)Oi?K.framebufferTextureLayer(K.READ_FRAMEBUFFER,K.COLOR_ATTACHMENT0,Dr.__webglTexture,Ue,En+wr):K.framebufferTexture2D(K.READ_FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,Dr.__webglTexture,Ue),Er?K.framebufferTextureLayer(K.DRAW_FRAMEBUFFER,K.COLOR_ATTACHMENT0,jr.__webglTexture,It,er+wr):K.framebufferTexture2D(K.DRAW_FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,jr.__webglTexture,It),Ue!==0?K.blitFramebuffer(zn,Dn,en,on,ai,ui,en,on,K.COLOR_BUFFER_BIT,K.NEAREST):Er?K.copyTexSubImage3D(Zi,It,ai,ui,er+wr,zn,Dn,en,on):K.copyTexSubImage2D(Zi,It,ai,ui,zn,Dn,en,on);_e.bindFramebuffer(K.READ_FRAMEBUFFER,null),_e.bindFramebuffer(K.DRAW_FRAMEBUFFER,null)}else Er?te.isDataTexture||te.isData3DTexture?K.texSubImage3D(Zi,It,ai,ui,er,en,on,fn,ci,Tn,Di.data):we.isCompressedArrayTexture?K.compressedTexSubImage3D(Zi,It,ai,ui,er,en,on,fn,ci,Di.data):K.texSubImage3D(Zi,It,ai,ui,er,en,on,fn,ci,Tn,Di):te.isDataTexture?K.texSubImage2D(K.TEXTURE_2D,It,ai,ui,en,on,ci,Tn,Di.data):te.isCompressedTexture?K.compressedTexSubImage2D(K.TEXTURE_2D,It,ai,ui,Di.width,Di.height,ci,Di.data):K.texSubImage2D(K.TEXTURE_2D,It,ai,ui,en,on,ci,Tn,Di);K.pixelStorei(K.UNPACK_ROW_LENGTH,ei),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,cs),K.pixelStorei(K.UNPACK_SKIP_PIXELS,oa),K.pixelStorei(K.UNPACK_SKIP_ROWS,dr),K.pixelStorei(K.UNPACK_SKIP_IMAGES,Rr),It===0&&we.generateMipmaps&&K.generateMipmap(Zi),_e.unbindTexture()},this.copyTextureToTexture3D=function(te,we,Ke=null,Ee=null,Ue=0){return uE('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(te,we,Ke,Ee,Ue)},this.initRenderTarget=function(te){ke.get(te).__webglFramebuffer===void 0&&Z.setupRenderTarget(te)},this.initTexture=function(te){te.isCubeTexture?Z.setTextureCube(te,0):te.isData3DTexture?Z.setTexture3D(te,0):te.isDataArrayTexture||te.isCompressedArrayTexture?Z.setTexture2DArray(te,0):Z.setTexture2D(te,0),_e.unbindTexture()},this.resetState=function(){T=0,C=0,O=null,_e.reset(),Vn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return cl}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=Ei._getDrawingBufferColorSpace(e),n.unpackColorSpace=Ei._getUnpackColorSpace()}}const H8=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:vU,AddEquation:Fh,AddOperation:dG,AdditiveAnimationBlendMode:TU,AdditiveBlending:XR,AgXToneMapping:yG,AlphaFormat:SU,AlwaysCompare:UG,AlwaysDepth:ow,AlwaysStencilFunc:KR,AmbientLight:A8,AnimationAction:z8,AnimationClip:Z1,AnimationLoader:sQ,AnimationMixer:zQ,AnimationObjectGroup:OQ,AnimationUtils:tQ,ArcCurve:KG,ArrayCamera:D8,ArrowHelper:tJ,AttachedBindMode:qR,Audio:O8,AudioAnalyser:bQ,AudioContext:qU,AudioListener:yQ,AudioLoader:mQ,AxesHelper:nJ,BackSide:La,BasicDepthPacking:wG,BasicShadowMap:Y6,BatchedMesh:WG,Bone:IU,BooleanKeyframeTrack:hm,Box2:GQ,Box3:bs,Box3Helper:$Q,BoxGeometry:Pf,BoxHelper:JQ,BufferAttribute:Yi,BufferGeometry:ni,BufferGeometryLoader:R8,ByteType:xU,Cache:ff,Camera:iT,CameraHelper:QQ,CanvasTexture:EK,CapsuleGeometry:hT,CatmullRomCurve3:QG,CineonToneMapping:gG,CircleGeometry:dT,ClampToEdgeWrapping:ul,Clock:KU,Color:nn,ColorKeyframeTrack:WU,ColorManagement:Ei,CompressedArrayTexture:bK,CompressedCubeTexture:SK,CompressedTexture:cT,CompressedTextureLoader:aQ,ConeGeometry:V_,ConstantAlphaFactor:cG,ConstantColorFactor:lG,Controls:rJ,CubeCamera:BG,CubeReflectionMapping:Tf,CubeRefractionMapping:ad,CubeTexture:G_,CubeTextureLoader:oQ,CubeUVReflectionMapping:dv,CubicBezierCurve:NU,CubicBezierCurve3:JG,CubicInterpolant:g8,CullFaceBack:WR,CullFaceFront:X6,CullFaceFrontBack:DZ,CullFaceNone:W6,Curve:uu,CurvePath:$G,CustomBlending:Z6,CustomToneMapping:vG,CylinderGeometry:gv,Cylindrical:FQ,Data3DTexture:nT,DataArrayTexture:F_,DataTexture:$u,DataTextureLoader:lQ,DataUtils:Yq,DecrementStencilOp:jZ,DecrementWrapStencilOp:XZ,DefaultLoadingManager:x8,DepthArrayTexture:wK,DepthFormat:G0,DepthStencilFormat:V0,DepthTexture:fT,DetachedBindMode:_G,DirectionalLight:w8,DirectionalLightHelper:KQ,DiscreteInterpolant:v8,DodecahedronGeometry:pT,DoubleSide:es,DstAlphaFactor:iG,DstColorFactor:sG,DynamicCopyUsage:oq,DynamicDrawUsage:tq,DynamicReadUsage:rq,EdgesGeometry:qG,EllipseCurve:mT,EqualCompare:CG,EqualDepth:uw,EqualStencilFunc:KZ,EquirectangularReflectionMapping:z1,EquirectangularRefractionMapping:I1,Euler:Ea,EventDispatcher:cc,ExtrudeGeometry:vT,FileLoader:Cf,Float16BufferAttribute:eK,Float32BufferAttribute:_n,FloatType:io,Fog:sT,FogExp2:rT,FramebufferTexture:_K,FrontSide:Af,Frustum:fm,FrustumArray:uT,GLBufferAttribute:kQ,GLSL1:uq,GLSL3:QR,GreaterCompare:RG,GreaterDepth:fw,GreaterEqualCompare:OG,GreaterEqualDepth:cw,GreaterEqualStencilFunc:eq,GreaterStencilFunc:JZ,GridHelper:ZQ,Group:c0,HalfFloatType:pv,HemisphereLight:b8,HemisphereLightHelper:YQ,IcosahedronGeometry:yT,ImageBitmapLoader:pQ,ImageLoader:q1,ImageUtils:LG,IncrementStencilOp:HZ,IncrementWrapStencilOp:WZ,InstancedBufferAttribute:Jp,InstancedBufferGeometry:ZU,InstancedInterleavedBuffer:BQ,InstancedMesh:jG,Int16BufferAttribute:Jq,Int32BufferAttribute:$q,Int8BufferAttribute:qq,IntType:ZA,InterleavedBuffer:oT,InterleavedBufferAttribute:Qp,Interpolant:W_,InterpolateDiscrete:N1,InterpolateLinear:kw,InterpolateSmooth:lE,InterpolationSamplingMode:hq,InterpolationSamplingType:fq,InvertStencilOp:YZ,KeepStencilOp:_p,KeyframeTrack:yl,LOD:VG,LatheGeometry:xT,Layers:j0,LessCompare:MG,LessDepth:lw,LessEqualCompare:CU,LessEqualDepth:Kp,LessEqualStencilFunc:QZ,LessStencilFunc:qZ,Light:md,LightProbe:C8,Line:ld,Line3:VQ,LineBasicMaterial:Na,LineCurve:BU,LineCurve3:kU,LineDashedMaterial:d8,LineLoop:XG,LineSegments:fc,LinearFilter:ts,LinearInterpolant:jU,LinearMipMapLinearFilter:IZ,LinearMipMapNearestFilter:zZ,LinearMipmapLinearFilter:Yu,LinearMipmapNearestFilter:t1,LinearSRGBColorSpace:od,LinearToneMapping:pG,LinearTransfer:k1,Loader:lo,LoaderUtils:nD,LoadingManager:XU,LoopOnce:bG,LoopPingPong:EG,LoopRepeat:SG,MOUSE:j6,Material:wa,MaterialLoader:MT,MathUtils:Ih,Matrix2:tz,Matrix3:Qn,Matrix4:kn,MaxEquation:J6,Mesh:vr,MeshBasicMaterial:Lf,MeshDepthMaterial:AT,MeshDistanceMaterial:TT,MeshLambertMaterial:f8,MeshMatcapMaterial:h8,MeshNormalMaterial:c8,MeshPhongMaterial:l8,MeshPhysicalMaterial:o8,MeshStandardMaterial:VU,MeshToonMaterial:u8,MinEquation:Q6,MirroredRepeatWrapping:P1,MixOperation:hG,MultiplyBlending:ZR,MultiplyOperation:B_,NearestFilter:ia,NearestMipMapLinearFilter:UZ,NearestMipMapNearestFilter:OZ,NearestMipmapLinearFilter:l0,NearestMipmapNearestFilter:yU,NeutralToneMapping:xG,NeverCompare:TG,NeverDepth:aw,NeverStencilFunc:ZZ,NoBlending:gf,NoColorSpace:nf,NoToneMapping:Ju,NormalAnimationBlendMode:eT,NormalBlending:Np,NotEqualCompare:DG,NotEqualDepth:hw,NotEqualStencilFunc:$Z,NumberKeyframeTrack:X1,Object3D:Ci,ObjectLoader:hQ,ObjectSpaceNormalMap:AG,OctahedronGeometry:H_,OneFactor:eG,OneMinusConstantAlphaFactor:fG,OneMinusConstantColorFactor:uG,OneMinusDstAlphaFactor:rG,OneMinusDstColorFactor:aG,OneMinusSrcAlphaFactor:sw,OneMinusSrcColorFactor:nG,OrthographicCamera:pm,PCFShadowMap:XA,PCFSoftShadowMap:e1,PMREMGenerator:sD,Path:Hw,PerspectiveCamera:ys,Plane:ef,PlaneGeometry:Nf,PlaneHelper:eJ,PointLight:E8,PointLightHelper:WQ,Points:YG,PointsMaterial:LU,PolarGridHelper:qQ,PolyhedronGeometry:pd,PositionalAudio:_Q,PropertyBinding:Mi,PropertyMixer:U8,QuadraticBezierCurve:FU,QuadraticBezierCurve3:gT,Quaternion:ra,QuaternionKeyframeTrack:X_,QuaternionLinearInterpolant:y8,RED_GREEN_RGTC2_Format:Nw,RED_RGTC1_Format:AU,REVISION:WA,RGBADepthPacking:MU,RGBAFormat:Sa,RGBAIntegerFormat:$A,RGBA_ASTC_10x10_Format:Ow,RGBA_ASTC_10x5_Format:Cw,RGBA_ASTC_10x6_Format:Rw,RGBA_ASTC_10x8_Format:Dw,RGBA_ASTC_12x10_Format:Uw,RGBA_ASTC_12x12_Format:zw,RGBA_ASTC_4x4_Format:_w,RGBA_ASTC_5x4_Format:bw,RGBA_ASTC_5x5_Format:Sw,RGBA_ASTC_6x5_Format:Ew,RGBA_ASTC_6x6_Format:ww,RGBA_ASTC_8x5_Format:Aw,RGBA_ASTC_8x6_Format:Tw,RGBA_ASTC_8x8_Format:Mw,RGBA_BPTC_Format:a1,RGBA_ETC2_EAC_Format:xw,RGBA_PVRTC_2BPPV1_Format:gw,RGBA_PVRTC_4BPPV1_Format:mw,RGBA_S3TC_DXT1_Format:i1,RGBA_S3TC_DXT3_Format:r1,RGBA_S3TC_DXT5_Format:s1,RGBDepthPacking:kZ,RGBFormat:EU,RGBIntegerFormat:LZ,RGB_BPTC_SIGNED_Format:Iw,RGB_BPTC_UNSIGNED_Format:Lw,RGB_ETC1_Format:vw,RGB_ETC2_Format:yw,RGB_PVRTC_2BPPV1_Format:pw,RGB_PVRTC_4BPPV1_Format:dw,RGB_S3TC_DXT1_Format:n1,RGDepthPacking:FZ,RGFormat:wU,RGIntegerFormat:JA,RawShaderMaterial:a8,Ray:mv,Raycaster:ez,RectAreaLight:T8,RedFormat:QA,RedIntegerFormat:k_,ReinhardToneMapping:mG,RenderTarget:tT,RenderTarget3D:IQ,RenderTargetArray:LQ,RepeatWrapping:L1,ReplaceStencilOp:VZ,ReverseSubtractEquation:K6,RingGeometry:_T,SIGNED_RED_GREEN_RGTC2_Format:Bw,SIGNED_RED_RGTC1_Format:Pw,SRGBColorSpace:xa,SRGBTransfer:Ki,Scene:aT,ShaderChunk:ri,ShaderLib:Kl,ShaderMaterial:su,ShadowMaterial:s8,Shape:kp,ShapeGeometry:bT,ShapePath:iJ,ShapeUtils:tu,ShortType:_U,Skeleton:lT,SkeletonHelper:jQ,SkinnedMesh:HG,Source:Wh,Sphere:Us,SphereGeometry:j_,Spherical:I8,SphericalHarmonics3:M8,SplineCurve:GU,SpotLight:S8,SpotLightHelper:HQ,Sprite:GG,SpriteMaterial:zU,SrcAlphaFactor:rw,SrcAlphaSaturateFactor:oG,SrcColorFactor:tG,StaticCopyUsage:aq,StaticDrawUsage:F1,StaticReadUsage:iq,StereoCamera:gQ,StreamCopyUsage:lq,StreamDrawUsage:nq,StreamReadUsage:sq,StringKeyframeTrack:dm,SubtractEquation:q6,SubtractiveBlending:YR,TOUCH:RZ,TangentSpaceNormalMap:dd,TetrahedronGeometry:ST,Texture:Gr,TextureLoader:_8,TextureUtils:uJ,TimestampQuery:cq,TorusGeometry:ET,TorusKnotGeometry:wT,Triangle:no,TriangleFanDrawMode:BZ,TriangleStripDrawMode:NZ,TrianglesDrawMode:PZ,TubeGeometry:em,UVMapping:YA,Uint16BufferAttribute:DU,Uint32BufferAttribute:OU,Uint8BufferAttribute:Kq,Uint8ClampedBufferAttribute:Qq,Uniform:$U,UniformsGroup:NQ,UniformsLib:ln,UniformsUtils:UU,UnsignedByteType:ml,UnsignedInt248Type:F0,UnsignedInt5999Type:bU,UnsignedIntType:Mf,UnsignedShort4444Type:qA,UnsignedShort5551Type:KA,UnsignedShortType:k0,VSMShadowMap:Zl,Vector2:Tt,Vector3:re,Vector4:bi,VectorKeyframeTrack:Y1,VideoFrameTexture:xK,VideoTexture:ZG,WebGL3DRenderTarget:Nq,WebGLArrayRenderTarget:Pq,WebGLCoordinateSystem:cl,WebGLCubeRenderTarget:kG,WebGLRenderTarget:sc,WebGLRenderer:V8,WebGLUtils:G8,WebGPUCoordinateSystem:G1,WebXRController:cE,WireframeGeometry:r8,WrapAroundEnding:B1,ZeroCurvatureEnding:Ap,ZeroFactor:$6,ZeroSlopeEnding:Tp,ZeroStencilOp:GZ,createCanvasElement:IG},Symbol.toStringTag,{value:"Module"}));var j8={exports:{}},gd={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */gd.ConcurrentRoot=1;gd.ContinuousEventPriority=8;gd.DefaultEventPriority=32;gd.DiscreteEventPriority=2;gd.IdleEventPriority=268435456;gd.LegacyRoot=0;gd.NoEventPriority=0;j8.exports=gd;var hE=j8.exports,W8={exports:{}},X8={},Y8={exports:{}},Z8={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y0=V;function jne(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Wne=typeof Object.is=="function"?Object.is:jne,Xne=Y0.useState,Yne=Y0.useEffect,Zne=Y0.useLayoutEffect,qne=Y0.useDebugValue;function Kne(t,e){var n=e(),i=Xne({inst:{value:n,getSnapshot:e}}),r=i[0].inst,s=i[1];return Zne(function(){r.value=n,r.getSnapshot=e,n3(r)&&s({inst:r})},[t,n,e]),Yne(function(){return n3(r)&&s({inst:r}),t(function(){n3(r)&&s({inst:r})})},[t]),qne(n),n}function n3(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Wne(t,n)}catch{return!0}}function Qne(t,e){return e()}var Jne=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Qne:Kne;Z8.useSyncExternalStore=Y0.useSyncExternalStore!==void 0?Y0.useSyncExternalStore:Jne;Y8.exports=Z8;var $ne=Y8.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RT=V,eie=$ne;function tie(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var nie=typeof Object.is=="function"?Object.is:tie,iie=eie.useSyncExternalStore,rie=RT.useRef,sie=RT.useEffect,aie=RT.useMemo,oie=RT.useDebugValue;X8.useSyncExternalStoreWithSelector=function(t,e,n,i,r){var s=rie(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=aie(function(){function l(m){if(!u){if(u=!0,c=m,m=i(m),r!==void 0&&a.hasValue){var v=a.value;if(r(v,m))return h=v}return h=m}if(v=h,nie(c,m))return v;var _=i(m);return r!==void 0&&r(v,_)?(c=m,v):(c=m,h=_)}var u=!1,c,h,d=n===void 0?null:n;return[function(){return l(e())},d===null?void 0:function(){return l(d())}]},[e,n,i,r]);var o=iie(t,s[0],s[1]);return sie(function(){a.hasValue=!0,a.value=o},[o]),oie(o),o};W8.exports=X8;var lie=W8.exports;const uie=Lo(lie),TP=t=>{let e;const n=new Set,i=(u,c)=>{const h=typeof u=="function"?u(e):u;if(!Object.is(h,e)){const d=e;e=c??(typeof h!="object"||h===null)?h:Object.assign({},e,h),n.forEach(m=>m(e,d))}},r=()=>e,o={setState:i,getState:r,getInitialState:()=>l,subscribe:u=>(n.add(u),()=>n.delete(u))},l=e=t(i,r,o);return o},q8=t=>t?TP(t):TP,{useSyncExternalStoreWithSelector:cie}=uie,fie=t=>t;function hie(t,e=fie,n){const i=cie(t.subscribe,t.getState,t.getInitialState,e,n);return iu.useDebugValue(i),i}const MP=(t,e)=>{const n=q8(t),i=(r,s=e)=>hie(n,r,s);return Object.assign(i,n),i},die=(t,e)=>t?MP(t,e):MP;var K8={exports:{}},Q8={exports:{}},J8={exports:{}},$8={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,k){var j=N.length;N.push(k);e:for(;0<j;){var X=j-1>>>1,Q=N[X];if(0<r(Q,k))N[X]=k,N[j]=Q,j=X;else break e}}function n(N){return N.length===0?null:N[0]}function i(N){if(N.length===0)return null;var k=N[0],j=N.pop();if(j!==k){N[0]=j;e:for(var X=0,Q=N.length,H=Q>>>1;X<H;){var $=2*(X+1)-1,ne=N[$],q=$+1,se=N[q];if(0>r(ne,j))q<Q&&0>r(se,ne)?(N[X]=se,N[q]=j,X=q):(N[X]=ne,N[$]=j,X=$);else if(q<Q&&0>r(se,j))N[X]=se,N[q]=j,X=q;else break e}}return k}function r(N,k){var j=N.sortIndex-k.sortIndex;return j!==0?j:N.id-k.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,h=null,d=3,m=!1,v=!1,_=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function S(N){for(var k=n(u);k!==null;){if(k.callback===null)i(u);else if(k.startTime<=N)i(u),k.sortIndex=k.expirationTime,e(l,k);else break;k=n(u)}}function E(N){if(_=!1,S(N),!v)if(n(l)!==null)v=!0,z();else{var k=n(u);k!==null&&Y(E,k.startTime-N)}}var A=!1,T=-1,C=5,O=-1;function M(){return!(t.unstable_now()-O<C)}function D(){if(A){var N=t.unstable_now();O=N;var k=!0;try{e:{v=!1,_&&(_=!1,g(T),T=-1),m=!0;var j=d;try{t:{for(S(N),h=n(l);h!==null&&!(h.expirationTime>N&&M());){var X=h.callback;if(typeof X=="function"){h.callback=null,d=h.priorityLevel;var Q=X(h.expirationTime<=N);if(N=t.unstable_now(),typeof Q=="function"){h.callback=Q,S(N),k=!0;break t}h===n(l)&&i(l),S(N)}else i(l);h=n(l)}if(h!==null)k=!0;else{var H=n(u);H!==null&&Y(E,H.startTime-N),k=!1}}break e}finally{h=null,d=j,m=!1}k=void 0}}finally{k?P():A=!1}}}var P;if(typeof x=="function")P=function(){x(D)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,G=F.port2;F.port1.onmessage=D,P=function(){G.postMessage(null)}}else P=function(){y(D,0)};function z(){A||(A=!0,P())}function Y(N,k){T=y(function(){N(t.unstable_now())},k)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,z())},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(N){switch(d){case 1:case 2:case 3:var k=3;break;default:k=d}var j=d;d=k;try{return N()}finally{d=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,k){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var j=d;d=N;try{return k()}finally{d=j}},t.unstable_scheduleCallback=function(N,k,j){var X=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?X+j:X):j=X,N){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=j+Q,N={id:c++,callback:k,priorityLevel:N,startTime:j,expirationTime:Q,sortIndex:-1},j>X?(N.sortIndex=j,e(u,N),n(l)===null&&N===n(u)&&(_?(g(T),T=-1):_=!0,Y(E,j-X))):(N.sortIndex=Q,e(l,N),v||m||(v=!0,z())),N},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(N){var k=d;return function(){var j=d;d=k;try{return N.apply(this,arguments)}finally{d=j}}}})($8);J8.exports=$8;var oD=J8.exports;/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){t.exports=function(e){function n(f,p,b,w){return new iM(f,p,b,w)}function i(){}function r(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)p+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(f){return f===null||typeof f!="object"?null:(f=Fb&&f[Fb]||f["@@iterator"],typeof f=="function"?f:null)}function a(f){if(f==null)return null;if(typeof f=="function")return f.$$typeof===uM?null:f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case ih:return"Fragment";case nh:return"Portal";case Jv:return"Profiler";case Mc:return"StrictMode";case Pd:return"Suspense";case ey:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case mo:return(f.displayName||"Context")+".Provider";case $v:return(f._context.displayName||"Context")+".Consumer";case jm:var p=f.render;return f=f.displayName,f||(f=p.displayName||p.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case Wm:return p=f.displayName||null,p!==null?p:a(f.type)||"Memo";case Au:p=f._payload,f=f._init;try{return a(f(p))}catch{}}return null}function o(f){if(ty===void 0)try{throw Error()}catch(b){var p=b.stack.trim().match(/\n( *(at )?)/);ty=p&&p[1]||"",Nd=-1<b.stack.indexOf(`
    at`)?" (<anonymous>)":-1<b.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ty+f+Nd}function l(f,p){if(!f||ny)return"";ny=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(p){var cn=function(){throw Error()};if(Object.defineProperty(cn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(cn,[])}catch(ii){var gn=ii}Reflect.construct(f,[],cn)}else{try{cn.call()}catch(ii){gn=ii}f.call(cn.prototype)}}else{try{throw Error()}catch(ii){gn=ii}(cn=f())&&typeof cn.catch=="function"&&cn.catch(function(){})}}catch(ii){if(ii&&gn&&typeof ii.stack=="string")return[ii.stack,gn.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var R=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");R&&R.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var U=w.DetermineComponentFrameRoot(),ie=U[0],ye=U[1];if(ie&&ye){var We=ie.split(`
`),At=ye.split(`
`);for(R=w=0;w<We.length&&!We[w].includes("DetermineComponentFrameRoot");)w++;for(;R<At.length&&!At[R].includes("DetermineComponentFrameRoot");)R++;if(w===We.length||R===At.length)for(w=We.length-1,R=At.length-1;1<=w&&0<=R&&We[w]!==At[R];)R--;for(;1<=w&&0<=R;w--,R--)if(We[w]!==At[R]){if(w!==1||R!==1)do if(w--,R--,0>R||We[w]!==At[R]){var Qt=`
`+We[w].replace(" at new "," at ");return f.displayName&&Qt.includes("<anonymous>")&&(Qt=Qt.replace("<anonymous>",f.displayName)),Qt}while(1<=w&&0<=R);break}}}finally{ny=!1,Error.prepareStackTrace=b}return(b=f?f.displayName||f.name:"")?o(b):""}function u(f){switch(f.tag){case 26:case 27:case 5:return o(f.type);case 16:return o("Lazy");case 13:return o("Suspense");case 19:return o("SuspenseList");case 0:case 15:return f=l(f.type,!1),f;case 11:return f=l(f.type.render,!1),f;case 1:return f=l(f.type,!0),f;default:return""}}function c(f){try{var p="";do p+=u(f),f=f.return;while(f);return p}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}function h(f){var p=f,b=f;if(f.alternate)for(;p.return;)p=p.return;else{f=p;do p=f,p.flags&4098&&(b=p.return),f=p.return;while(f)}return p.tag===3?b:null}function d(f){if(h(f)!==f)throw Error(r(188))}function m(f){var p=f.alternate;if(!p){if(p=h(f),p===null)throw Error(r(188));return p!==f?null:f}for(var b=f,w=p;;){var R=b.return;if(R===null)break;var U=R.alternate;if(U===null){if(w=R.return,w!==null){b=w;continue}break}if(R.child===U.child){for(U=R.child;U;){if(U===b)return d(R),f;if(U===w)return d(R),p;U=U.sibling}throw Error(r(188))}if(b.return!==w.return)b=R,w=U;else{for(var ie=!1,ye=R.child;ye;){if(ye===b){ie=!0,b=R,w=U;break}if(ye===w){ie=!0,w=R,b=U;break}ye=ye.sibling}if(!ie){for(ye=U.child;ye;){if(ye===b){ie=!0,b=U,w=R;break}if(ye===w){ie=!0,w=U,b=R;break}ye=ye.sibling}if(!ie)throw Error(r(189))}}if(b.alternate!==w)throw Error(r(190))}if(b.tag!==3)throw Error(r(188));return b.stateNode.current===b?f:p}function v(f){var p=f.tag;if(p===5||p===26||p===27||p===6)return f;for(f=f.child;f!==null;){if(p=v(f),p!==null)return p;f=f.sibling}return null}function _(f){var p=f.tag;if(p===5||p===26||p===27||p===6)return f;for(f=f.child;f!==null;){if(f.tag!==4&&(p=_(f),p!==null))return p;f=f.sibling}return null}function y(f){return{current:f}}function g(f){0>Du||(f.current=ug[Du],ug[Du]=null,Du--)}function x(f,p){Du++,ug[Du]=f.current,f.current=p}function S(f){return f>>>=0,f===0?32:31-(Zr(f)/Ou|0)|0}function E(f){var p=f&42;if(p!==0)return p;switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return f&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return f}}function A(f,p){var b=f.pendingLanes;if(b===0)return 0;var w=0,R=f.suspendedLanes,U=f.pingedLanes,ie=f.warmLanes;f=f.finishedLanes!==0;var ye=b&134217727;return ye!==0?(b=ye&~R,b!==0?w=E(b):(U&=ye,U!==0?w=E(U):f||(ie=ye&~ie,ie!==0&&(w=E(ie))))):(ye=b&~R,ye!==0?w=E(ye):U!==0?w=E(U):f||(ie=b&~ie,ie!==0&&(w=E(ie)))),w===0?0:p!==0&&p!==w&&!(p&R)&&(R=w&-w,ie=p&-p,R>=ie||R===32&&(ie&4194176)!==0)?p:w}function T(f,p){return(f.pendingLanes&~(f.suspendedLanes&~f.pingedLanes)&p)===0}function C(f,p){switch(f){case 1:case 2:case 4:case 8:return p+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function O(){var f=cr;return cr<<=1,!(cr&4194176)&&(cr=128),f}function M(){var f=Cs;return Cs<<=1,!(Cs&62914560)&&(Cs=4194304),f}function D(f){for(var p=[],b=0;31>b;b++)p.push(f);return p}function P(f,p){f.pendingLanes|=p,p!==268435456&&(f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0)}function F(f,p,b,w,R,U){var ie=f.pendingLanes;f.pendingLanes=b,f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0,f.expiredLanes&=b,f.entangledLanes&=b,f.errorRecoveryDisabledLanes&=b,f.shellSuspendCounter=0;var ye=f.entanglements,We=f.expirationTimes,At=f.hiddenUpdates;for(b=ie&~b;0<b;){var Qt=31-ha(b),cn=1<<Qt;ye[Qt]=0,We[Qt]=-1;var gn=At[Qt];if(gn!==null)for(At[Qt]=null,Qt=0;Qt<gn.length;Qt++){var ii=gn[Qt];ii!==null&&(ii.lane&=-536870913)}b&=~cn}w!==0&&G(f,w,0),U!==0&&R===0&&f.tag!==0&&(f.suspendedLanes|=U&~(ie&~p))}function G(f,p,b){f.pendingLanes|=p,f.suspendedLanes&=~p;var w=31-ha(p);f.entangledLanes|=p,f.entanglements[w]=f.entanglements[w]|1073741824|b&4194218}function z(f,p){var b=f.entangledLanes|=p;for(f=f.entanglements;b;){var w=31-ha(b),R=1<<w;R&p|f[w]&p&&(f[w]|=p),b&=~R}}function Y(f){return f&=-f,2<f?8<f?f&134217727?32:268435456:8:2}function N(f){if(da&&typeof da.onCommitFiberRoot=="function")try{da.onCommitFiberRoot(dh,f,void 0,(f.current.flags&128)===128)}catch{}}function k(f){if(typeof wM=="function"&&AM(f),da&&typeof da.setStrictMode=="function")try{da.setStrictMode(dh,f)}catch{}}function j(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}function X(f,p){if(typeof f=="object"&&f!==null){var b=lS.get(f);return b!==void 0?b:(p={value:f,source:p,stack:c(p)},lS.set(f,p),p)}return{value:f,source:p,stack:c(p)}}function Q(f,p){ph[Ic++]=L,ph[Ic++]=cg,cg=f,L=p}function H(f,p,b){ee[fe++]=nt,ee[fe++]=Le,ee[fe++]=Be,Be=f;var w=nt;f=Le;var R=32-ha(w)-1;w&=~(1<<R),b+=1;var U=32-ha(p)+R;if(30<U){var ie=R-R%5;U=(w&(1<<ie)-1).toString(32),w>>=ie,R-=ie,nt=1<<32-ha(p)+R|b<<R|w,Le=U+f}else nt=1<<U|b<<R|w,Le=f}function $(f){f.return!==null&&(Q(f,1),H(f,1,0))}function ne(f){for(;f===cg;)cg=ph[--Ic],ph[Ic]=null,L=ph[--Ic],ph[Ic]=null;for(;f===Be;)Be=ee[--fe],ee[fe]=null,Le=ee[--fe],ee[fe]=null,nt=ee[--fe],ee[fe]=null}function q(f,p){x(mt,p),x(yt,f),x(He,null),f=ah(p),g(He),x(He,f)}function se(){g(He),g(yt),g(mt)}function ve(f){f.memoizedState!==null&&x(Ct,f);var p=He.current,b=iy(p,f.type);p!==b&&(x(yt,f),x(He,b))}function pe(f){yt.current===f&&(g(He),g(yt)),Ct.current===f&&(g(Ct),go?Mu._currentValue=Rc:Mu._currentValue2=Rc)}function xe(f){var p=Error(r(418,""));throw Xe(X(p,f)),Me}function ot(f,p){if(!Ta)throw Error(r(175));tg(f.stateNode,f.type,f.memoizedProps,p,f)||xe(f)}function st(f){for(xt=f.return;xt;)switch(xt.tag){case 3:case 27:bt=!0;return;case 5:case 13:bt=!1;return;default:xt=xt.return}}function et(f){if(!Ta||f!==xt)return!1;if(!ht)return st(f),ht=!0,!1;var p=!1;if(Ms?f.tag!==3&&f.tag!==27&&(f.tag!==5||fh(f.type)&&!Fd(f.type,f.memoizedProps))&&(p=!0):f.tag!==3&&(f.tag!==5||fh(f.type)&&!Fd(f.type,f.memoizedProps))&&(p=!0),p&&gt&&xe(f),st(f),f.tag===13){if(!Ta)throw Error(r(316));if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));gt=Sy(f)}else gt=xt?eS(f.stateNode):null;return!0}function Te(){Ta&&(gt=xt=null,ht=!1)}function Xe(f){dt===null?dt=[f]:dt.push(f)}function K(){for(var f=wt,p=Wt=wt=0;p<f;){var b=je[p];je[p++]=null;var w=je[p];je[p++]=null;var R=je[p];je[p++]=null;var U=je[p];if(je[p++]=null,w!==null&&R!==null){var ie=w.pending;ie===null?R.next=R:(R.next=ie.next,ie.next=R),w.pending=R}U!==0&&_e(b,R,U)}}function Pe(f,p,b,w){je[wt++]=f,je[wt++]=p,je[wt++]=b,je[wt++]=w,Wt|=w,f.lanes|=w,f=f.alternate,f!==null&&(f.lanes|=w)}function Ne(f,p,b,w){return Pe(f,p,b,w),ft(f)}function Ve(f,p){return Pe(f,null,null,p),ft(f)}function _e(f,p,b){f.lanes|=b;var w=f.alternate;w!==null&&(w.lanes|=b);for(var R=!1,U=f.return;U!==null;)U.childLanes|=b,w=U.alternate,w!==null&&(w.childLanes|=b),U.tag===22&&(f=U.stateNode,f===null||f._visibility&1||(R=!0)),f=U,U=U.return;R&&p!==null&&f.tag===3&&(U=f.stateNode,R=31-ha(b),U=U.hiddenUpdates,f=U[R],f===null?U[R]=[p]:f.push(p),p.lane=b|536870912)}function ft(f){if(50<Oy)throw Oy=0,UM=null,Error(r(185));for(var p=f.return;p!==null;)f=p,p=f.return;return f.tag===3?f.stateNode:null}function ke(f){f!==Ft&&f.next===null&&(Ft===null?pt=Ft=f:Ft=Ft.next=f),hn=!0,Gt||(Gt=!0,ze(W))}function Z(f,p){if(!lt&&hn){lt=!0;do for(var b=!1,w=pt;w!==null;){if(f!==0){var R=w.pendingLanes;if(R===0)var U=0;else{var ie=w.suspendedLanes,ye=w.pingedLanes;U=(1<<31-ha(42|f)+1)-1,U&=R&~(ie&~ye),U=U&201326677?U&201326677|1:U?U|2:0}U!==0&&(b=!0,ge(w,U))}else U=Wn,U=A(w,w===hi?U:0),!(U&3)||T(w,U)||(b=!0,ge(w,U));w=w.next}while(b);lt=!1}}function W(){hn=Gt=!1;var f=0;it!==0&&(uy()&&(f=it),it=0);for(var p=yo(),b=null,w=pt;w!==null;){var R=w.next,U=I(w,p);U===0?(w.next=null,b===null?pt=R:b.next=R,R===null&&(Ft=b)):(b=w,(f!==0||U&3)&&(hn=!0)),w=R}Z(f)}function I(f,p){for(var b=f.suspendedLanes,w=f.pingedLanes,R=f.expirationTimes,U=f.pendingLanes&-62914561;0<U;){var ie=31-ha(U),ye=1<<ie,We=R[ie];We===-1?(!(ye&b)||ye&w)&&(R[ie]=C(ye,p)):We<=p&&(f.expiredLanes|=ye),U&=~ye}if(p=hi,b=Wn,b=A(f,f===p?b:0),w=f.callbackNode,b===0||f===p&&qi===2||f.cancelPendingCommit!==null)return w!==null&&w!==null&&Ay(w),f.callbackNode=null,f.callbackPriority=0;if(!(b&3)||T(f,b)){if(p=b&-b,p===f.callbackPriority)return p;switch(w!==null&&Ay(w),Y(b)){case 2:case 8:b=SM;break;case 32:b=My;break;case 268435456:b=EM;break;default:b=My}return w=De.bind(null,f),b=qd(b,w),f.callbackPriority=p,f.callbackNode=b,p}return w!==null&&w!==null&&Ay(w),f.callbackPriority=2,f.callbackNode=null,2}function De(f,p){var b=f.callbackNode;if(Qs()&&f.callbackNode!==b)return null;var w=Wn;return w=A(f,f===hi?w:0),w===0?null:(_b(f,w,p),I(f,yo()),f.callbackNode!=null&&f.callbackNode===b?De.bind(null,f):null)}function ge(f,p){if(Qs())return null;_b(f,p,!0)}function ze(f){py?Gd(function(){Bi&6?qd(Ty,f):f()}):qd(Ty,f)}function ct(){return it===0&&(it=O()),it}function at(f,p){if(Zt===null){var b=Zt=[];Pt=0,St=ct(),Ut={status:"pending",value:void 0,then:function(w){b.push(w)}}}return Pt++,p.then(Rt,Rt),p}function Rt(){if(--Pt===0&&Zt!==null){Ut!==null&&(Ut.status="fulfilled");var f=Zt;Zt=null,St=0,Ut=null;for(var p=0;p<f.length;p++)(0,f[p])()}}function Nt(f,p){var b=[],w={status:"pending",value:null,reason:null,then:function(R){b.push(R)}};return f.then(function(){w.status="fulfilled",w.value=p;for(var R=0;R<b.length;R++)(0,b[R])(p)},function(R){for(w.status="rejected",w.reason=R,R=0;R<b.length;R++)(0,b[R])(void 0)}),w}function vt(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Vt(f,p){f=f.updateQueue,p.updateQueue===f&&(p.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,callbacks:null})}function Bt(f){return{lane:f,tag:0,payload:null,callback:null,next:null}}function Ht(f,p,b){var w=f.updateQueue;if(w===null)return null;if(w=w.shared,Bi&2){var R=w.pending;return R===null?p.next=p:(p.next=R.next,R.next=p),w.pending=p,p=ft(f),_e(f,null,b),p}return Pe(f,w,p,b),ft(f)}function ut(f,p,b){if(p=p.updateQueue,p!==null&&(p=p.shared,(b&4194176)!==0)){var w=p.lanes;w&=f.pendingLanes,b|=w,p.lanes=b,z(f,b)}}function xn(f,p){var b=f.updateQueue,w=f.alternate;if(w!==null&&(w=w.updateQueue,b===w)){var R=null,U=null;if(b=b.firstBaseUpdate,b!==null){do{var ie={lane:b.lane,tag:b.tag,payload:b.payload,callback:null,next:null};U===null?R=U=ie:U=U.next=ie,b=b.next}while(b!==null);U===null?R=U=p:U=U.next=p}else R=U=p;b={baseState:w.baseState,firstBaseUpdate:R,lastBaseUpdate:U,shared:w.shared,callbacks:w.callbacks},f.updateQueue=b;return}f=b.lastBaseUpdate,f===null?b.firstBaseUpdate=p:f.next=p,b.lastBaseUpdate=p}function un(){if(Cn){var f=Ut;if(f!==null)throw f}}function Vn(f,p,b,w){Cn=!1;var R=f.updateQueue;Lt=!1;var U=R.firstBaseUpdate,ie=R.lastBaseUpdate,ye=R.shared.pending;if(ye!==null){R.shared.pending=null;var We=ye,At=We.next;We.next=null,ie===null?U=At:ie.next=At,ie=We;var Qt=f.alternate;Qt!==null&&(Qt=Qt.updateQueue,ye=Qt.lastBaseUpdate,ye!==ie&&(ye===null?Qt.firstBaseUpdate=At:ye.next=At,Qt.lastBaseUpdate=We))}if(U!==null){var cn=R.baseState;ie=0,Qt=At=We=null,ye=U;do{var gn=ye.lane&-536870913,ii=gn!==ye.lane;if(ii?(Wn&gn)===gn:(w&gn)===gn){gn!==0&&gn===St&&(Cn=!0),Qt!==null&&(Qt=Qt.next={lane:0,tag:ye.tag,payload:ye.payload,callback:null,next:null});e:{var Yo=f,Uy=ye;gn=p;var Jd=b;switch(Uy.tag){case 1:if(Yo=Uy.payload,typeof Yo=="function"){cn=Yo.call(Jd,cn,gn);break e}cn=Yo;break e;case 3:Yo.flags=Yo.flags&-65537|128;case 0:if(Yo=Uy.payload,gn=typeof Yo=="function"?Yo.call(Jd,cn,gn):Yo,gn==null)break e;cn=Qv({},cn,gn);break e;case 2:Lt=!0}}gn=ye.callback,gn!==null&&(f.flags|=64,ii&&(f.flags|=8192),ii=R.callbacks,ii===null?R.callbacks=[gn]:ii.push(gn))}else ii={lane:gn,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},Qt===null?(At=Qt=ii,We=cn):Qt=Qt.next=ii,ie|=gn;if(ye=ye.next,ye===null){if(ye=R.shared.pending,ye===null)break;ii=ye,ye=ii.next,ii.next=null,R.lastBaseUpdate=ii,R.shared.pending=null}}while(!0);Qt===null&&(We=cn),R.baseState=We,R.firstBaseUpdate=At,R.lastBaseUpdate=Qt,U===null&&(R.shared.lanes=0),mh|=ie,f.lanes=ie,f.memoizedState=cn}}function be(f,p){if(typeof f!="function")throw Error(r(191,f));f.call(p)}function _t(f,p){var b=f.callbacks;if(b!==null)for(f.callbacks=null,f=0;f<b.length;f++)be(b[f],p)}function Ye(f,p){if(pa(f,p))return!0;if(typeof f!="object"||f===null||typeof p!="object"||p===null)return!1;var b=Object.keys(f),w=Object.keys(p);if(b.length!==w.length)return!1;for(w=0;w<b.length;w++){var R=b[w];if(!Mn.call(p,R)||!pa(f[R],p[R]))return!1}return!0}function Et(f){return f=f.status,f==="fulfilled"||f==="rejected"}function Ot(){}function Mt(f,p,b){switch(b=f[b],b===void 0?f.push(p):b!==p&&(p.then(Ot,Ot),p=b),p.status){case"fulfilled":return p.value;case"rejected":throw f=p.reason,f===kt?Error(r(483)):f;default:if(typeof p.status=="string")p.then(Ot,Ot);else{if(f=hi,f!==null&&100<f.shellSuspendCounter)throw Error(r(482));f=p,f.status="pending",f.then(function(w){if(p.status==="pending"){var R=p;R.status="fulfilled",R.value=w}},function(w){if(p.status==="pending"){var R=p;R.status="rejected",R.reason=w}})}switch(p.status){case"fulfilled":return p.value;case"rejected":throw f=p.reason,f===kt?Error(r(483)):f}throw wn=p,kt}}function vn(){if(wn===null)throw Error(r(459));var f=wn;return wn=null,f}function Un(f){var p=Ui;return Ui+=1,In===null&&(In=[]),Mt(In,f,p)}function an(f,p){p=p.props.ref,f.ref=p!==void 0?p:null}function An(f,p){throw p.$$typeof===aM?Error(r(525)):(f=Object.prototype.toString.call(p),Error(r(31,f==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":f)))}function Ri(f){var p=f._init;return p(f._payload)}function Ni(f){function p(Je,Fe){if(f){var rt=Je.deletions;rt===null?(Je.deletions=[Fe],Je.flags|=16):rt.push(Fe)}}function b(Je,Fe){if(!f)return null;for(;Fe!==null;)p(Je,Fe),Fe=Fe.sibling;return null}function w(Je){for(var Fe=new Map;Je!==null;)Je.key!==null?Fe.set(Je.key,Je):Fe.set(Je.index,Je),Je=Je.sibling;return Fe}function R(Je,Fe){return Je=wu(Je,Fe),Je.index=0,Je.sibling=null,Je}function U(Je,Fe,rt){return Je.index=rt,f?(rt=Je.alternate,rt!==null?(rt=rt.index,rt<Fe?(Je.flags|=33554434,Fe):rt):(Je.flags|=33554434,Fe)):(Je.flags|=1048576,Fe)}function ie(Je){return f&&Je.alternate===null&&(Je.flags|=33554434),Je}function ye(Je,Fe,rt,Yt){return Fe===null||Fe.tag!==6?(Fe=Fm(rt,Je.mode,Yt),Fe.return=Je,Fe):(Fe=R(Fe,rt),Fe.return=Je,Fe)}function We(Je,Fe,rt,Yt){var On=rt.type;return On===ih?Qt(Je,Fe,rt.props.children,Yt,rt.key):Fe!==null&&(Fe.elementType===On||typeof On=="object"&&On!==null&&On.$$typeof===Au&&Ri(On)===Fe.type)?(Fe=R(Fe,rt.props),an(Fe,rt),Fe.return=Je,Fe):(Fe=km(rt.type,rt.key,rt.props,null,Je.mode,Yt),an(Fe,rt),Fe.return=Je,Fe)}function At(Je,Fe,rt,Yt){return Fe===null||Fe.tag!==4||Fe.stateNode.containerInfo!==rt.containerInfo||Fe.stateNode.implementation!==rt.implementation?(Fe=Gm(rt,Je.mode,Yt),Fe.return=Je,Fe):(Fe=R(Fe,rt.children||[]),Fe.return=Je,Fe)}function Qt(Je,Fe,rt,Yt,On){return Fe===null||Fe.tag!==7?(Fe=Tc(rt,Je.mode,Yt,On),Fe.return=Je,Fe):(Fe=R(Fe,rt),Fe.return=Je,Fe)}function cn(Je,Fe,rt){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return Fe=Fm(""+Fe,Je.mode,rt),Fe.return=Je,Fe;if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case Hm:return rt=km(Fe.type,Fe.key,Fe.props,null,Je.mode,rt),an(rt,Fe),rt.return=Je,rt;case nh:return Fe=Gm(Fe,Je.mode,rt),Fe.return=Je,Fe;case Au:var Yt=Fe._init;return Fe=Yt(Fe._payload),cn(Je,Fe,rt)}if(zl(Fe)||s(Fe))return Fe=Tc(Fe,Je.mode,rt,null),Fe.return=Je,Fe;if(typeof Fe.then=="function")return cn(Je,Un(Fe),rt);if(Fe.$$typeof===mo)return cn(Je,Zf(Je,Fe),rt);An(Je,Fe)}return null}function gn(Je,Fe,rt,Yt){var On=Fe!==null?Fe.key:null;if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return On!==null?null:ye(Je,Fe,""+rt,Yt);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case Hm:return rt.key===On?We(Je,Fe,rt,Yt):null;case nh:return rt.key===On?At(Je,Fe,rt,Yt):null;case Au:return On=rt._init,rt=On(rt._payload),gn(Je,Fe,rt,Yt)}if(zl(rt)||s(rt))return On!==null?null:Qt(Je,Fe,rt,Yt,null);if(typeof rt.then=="function")return gn(Je,Fe,Un(rt),Yt);if(rt.$$typeof===mo)return gn(Je,Fe,Zf(Je,rt),Yt);An(Je,rt)}return null}function ii(Je,Fe,rt,Yt,On){if(typeof Yt=="string"&&Yt!==""||typeof Yt=="number"||typeof Yt=="bigint")return Je=Je.get(rt)||null,ye(Fe,Je,""+Yt,On);if(typeof Yt=="object"&&Yt!==null){switch(Yt.$$typeof){case Hm:return Je=Je.get(Yt.key===null?rt:Yt.key)||null,We(Fe,Je,Yt,On);case nh:return Je=Je.get(Yt.key===null?rt:Yt.key)||null,At(Fe,Je,Yt,On);case Au:var xr=Yt._init;return Yt=xr(Yt._payload),ii(Je,Fe,rt,Yt,On)}if(zl(Yt)||s(Yt))return Je=Je.get(rt)||null,Qt(Fe,Je,Yt,On,null);if(typeof Yt.then=="function")return ii(Je,Fe,rt,Un(Yt),On);if(Yt.$$typeof===mo)return ii(Je,Fe,rt,Zf(Fe,Yt),On);An(Fe,Yt)}return null}function Yo(Je,Fe,rt,Yt){for(var On=null,xr=null,Xn=Fe,Ii=Fe=0,Fs=null;Xn!==null&&Ii<rt.length;Ii++){Xn.index>Ii?(Fs=Xn,Xn=null):Fs=Xn.sibling;var Li=gn(Je,Xn,rt[Ii],Yt);if(Li===null){Xn===null&&(Xn=Fs);break}f&&Xn&&Li.alternate===null&&p(Je,Xn),Fe=U(Li,Fe,Ii),xr===null?On=Li:xr.sibling=Li,xr=Li,Xn=Fs}if(Ii===rt.length)return b(Je,Xn),ht&&Q(Je,Ii),On;if(Xn===null){for(;Ii<rt.length;Ii++)Xn=cn(Je,rt[Ii],Yt),Xn!==null&&(Fe=U(Xn,Fe,Ii),xr===null?On=Xn:xr.sibling=Xn,xr=Xn);return ht&&Q(Je,Ii),On}for(Xn=w(Xn);Ii<rt.length;Ii++)Fs=ii(Xn,Je,Ii,rt[Ii],Yt),Fs!==null&&(f&&Fs.alternate!==null&&Xn.delete(Fs.key===null?Ii:Fs.key),Fe=U(Fs,Fe,Ii),xr===null?On=Fs:xr.sibling=Fs,xr=Fs);return f&&Xn.forEach(function(vh){return p(Je,vh)}),ht&&Q(Je,Ii),On}function Uy(Je,Fe,rt,Yt){if(rt==null)throw Error(r(151));for(var On=null,xr=null,Xn=Fe,Ii=Fe=0,Fs=null,Li=rt.next();Xn!==null&&!Li.done;Ii++,Li=rt.next()){Xn.index>Ii?(Fs=Xn,Xn=null):Fs=Xn.sibling;var vh=gn(Je,Xn,Li.value,Yt);if(vh===null){Xn===null&&(Xn=Fs);break}f&&Xn&&vh.alternate===null&&p(Je,Xn),Fe=U(vh,Fe,Ii),xr===null?On=vh:xr.sibling=vh,xr=vh,Xn=Fs}if(Li.done)return b(Je,Xn),ht&&Q(Je,Ii),On;if(Xn===null){for(;!Li.done;Ii++,Li=rt.next())Li=cn(Je,Li.value,Yt),Li!==null&&(Fe=U(Li,Fe,Ii),xr===null?On=Li:xr.sibling=Li,xr=Li);return ht&&Q(Je,Ii),On}for(Xn=w(Xn);!Li.done;Ii++,Li=rt.next())Li=ii(Xn,Je,Ii,Li.value,Yt),Li!==null&&(f&&Li.alternate!==null&&Xn.delete(Li.key===null?Ii:Li.key),Fe=U(Li,Fe,Ii),xr===null?On=Li:xr.sibling=Li,xr=Li);return f&&Xn.forEach(function($7){return p(Je,$7)}),ht&&Q(Je,Ii),On}function Jd(Je,Fe,rt,Yt){if(typeof rt=="object"&&rt!==null&&rt.type===ih&&rt.key===null&&(rt=rt.props.children),typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case Hm:e:{for(var On=rt.key;Fe!==null;){if(Fe.key===On){if(On=rt.type,On===ih){if(Fe.tag===7){b(Je,Fe.sibling),Yt=R(Fe,rt.props.children),Yt.return=Je,Je=Yt;break e}}else if(Fe.elementType===On||typeof On=="object"&&On!==null&&On.$$typeof===Au&&Ri(On)===Fe.type){b(Je,Fe.sibling),Yt=R(Fe,rt.props),an(Yt,rt),Yt.return=Je,Je=Yt;break e}b(Je,Fe);break}else p(Je,Fe);Fe=Fe.sibling}rt.type===ih?(Yt=Tc(rt.props.children,Je.mode,Yt,rt.key),Yt.return=Je,Je=Yt):(Yt=km(rt.type,rt.key,rt.props,null,Je.mode,Yt),an(Yt,rt),Yt.return=Je,Je=Yt)}return ie(Je);case nh:e:{for(On=rt.key;Fe!==null;){if(Fe.key===On)if(Fe.tag===4&&Fe.stateNode.containerInfo===rt.containerInfo&&Fe.stateNode.implementation===rt.implementation){b(Je,Fe.sibling),Yt=R(Fe,rt.children||[]),Yt.return=Je,Je=Yt;break e}else{b(Je,Fe);break}else p(Je,Fe);Fe=Fe.sibling}Yt=Gm(rt,Je.mode,Yt),Yt.return=Je,Je=Yt}return ie(Je);case Au:return On=rt._init,rt=On(rt._payload),Jd(Je,Fe,rt,Yt)}if(zl(rt))return Yo(Je,Fe,rt,Yt);if(s(rt)){if(On=s(rt),typeof On!="function")throw Error(r(150));return rt=On.call(rt),Uy(Je,Fe,rt,Yt)}if(typeof rt.then=="function")return Jd(Je,Fe,Un(rt),Yt);if(rt.$$typeof===mo)return Jd(Je,Fe,Zf(Je,rt),Yt);An(Je,rt)}return typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint"?(rt=""+rt,Fe!==null&&Fe.tag===6?(b(Je,Fe.sibling),Yt=R(Fe,rt),Yt.return=Je,Je=Yt):(b(Je,Fe),Yt=Fm(rt,Je.mode,Yt),Yt.return=Je,Je=Yt),ie(Je)):b(Je,Fe)}return function(Je,Fe,rt,Yt){try{Ui=0;var On=Jd(Je,Fe,rt,Yt);return In=null,On}catch(Xn){if(Xn===kt)throw Xn;var xr=n(29,Xn,null,Je.mode);return xr.lanes=Yt,xr.return=Je,xr}finally{}}}function lr(f,p){f=Pc,x(Ti,f),x(tr,p),Pc=f|p.baseLanes}function us(){x(Ti,Pc),x(tr,tr.current)}function Vr(){Pc=Ti.current,g(tr),g(Ti)}function Sr(f){var p=f.alternate;x(oi,oi.current&1),x(Si,f),zi===null&&(p===null||tr.current!==null||p.memoizedState!==null)&&(zi=f)}function aa(f){if(f.tag===22){if(x(oi,oi.current),x(Si,f),zi===null){var p=f.alternate;p!==null&&p.memoizedState!==null&&(zi=f)}}else Hr()}function Hr(){x(oi,oi.current),x(Si,Si.current)}function ur(f){g(Si),zi===f&&(zi=null),g(oi)}function Zn(f){for(var p=f;p!==null;){if(p.tag===13){var b=p.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||yy(b)||xy(b)))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if(p.flags&128)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===f)break;for(;p.sibling===null;){if(p.return===null||p.return===f)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}function xi(){throw Error(r(321))}function xl(f,p){if(p===null)return!1;for(var b=0;b<p.length&&b<f.length;b++)if(!pa(f[b],p[b]))return!1;return!0}function Po(f,p,b,w,R,U){return nr=U,Rn=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,Pn.H=f===null||f.memoizedState===null?Ge:Oe,pn=!1,U=b(w,R),pn=!1,ti&&(U=dc(p,b,w,R)),Vf(f),U}function Vf(f){Pn.H=ue;var p=Ln!==null&&Ln.next!==null;if(nr=0,dn=Ln=Rn=null,Or=!1,qn=0,Hi=null,p)throw Error(r(300));f===null||he||(f=f.dependencies,f!==null&&xu(f)&&(he=!0))}function dc(f,p,b,w){Rn=f;var R=0;do{if(ti&&(Hi=null),qn=0,ti=!1,25<=R)throw Error(r(301));if(R+=1,dn=Ln=null,f.updateQueue!=null){var U=f.updateQueue;U.lastEffect=null,U.events=null,U.stores=null,U.memoCache!=null&&(U.memoCache.index=0)}Pn.H=Xt,U=p(b,w)}while(ti);return U}function fu(){var f=Pn.H,p=f.useState()[0];return p=typeof p.then=="function"?Ke(p):p,f=f.useState()[0],(Ln!==null?Ln.memoizedState:null)!==f&&(Rn.flags|=1024),p}function _l(){var f=Fn!==0;return Fn=0,f}function pc(f,p,b){p.updateQueue=f.updateQueue,p.flags&=-2053,f.lanes&=~b}function hu(f){if(Or){for(f=f.memoizedState;f!==null;){var p=f.queue;p!==null&&(p.pending=null),f=f.next}Or=!1}nr=0,dn=Ln=Rn=null,ti=!1,qn=Fn=0,Hi=null}function te(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?Rn.memoizedState=dn=f:dn=dn.next=f,dn}function we(){if(Ln===null){var f=Rn.alternate;f=f!==null?f.memoizedState:null}else f=Ln.next;var p=dn===null?Rn.memoizedState:dn.next;if(p!==null)dn=p,Ln=f;else{if(f===null)throw Rn.alternate===null?Error(r(467)):Error(r(310));Ln=f,f={memoizedState:Ln.memoizedState,baseState:Ln.baseState,baseQueue:Ln.baseQueue,queue:Ln.queue,next:null},dn===null?Rn.memoizedState=dn=f:dn=dn.next=f}return dn}function Ke(f){var p=qn;return qn+=1,Hi===null&&(Hi=[]),f=Mt(Hi,f,p),p=Rn,(dn===null?p.memoizedState:dn.next)===null&&(p=p.alternate,Pn.H=p===null||p.memoizedState===null?Ge:Oe),f}function Ee(f){if(f!==null&&typeof f=="object"){if(typeof f.then=="function")return Ke(f);if(f.$$typeof===mo)return ws(f)}throw Error(r(438,String(f)))}function Ue(f){var p=null,b=Rn.updateQueue;if(b!==null&&(p=b.memoCache),p==null){var w=Rn.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(p={data:w.data.map(function(R){return R.slice()}),index:0})))}if(p==null&&(p={data:[],index:0}),b===null&&(b=Bl(),Rn.updateQueue=b),b.memoCache=p,b=p.data[p.index],b===void 0)for(b=p.data[p.index]=Array(f),w=0;w<f;w++)b[w]=lM;return p.index++,b}function It(f,p){return typeof p=="function"?p(f):p}function en(f){var p=we();return on(p,Ln,f)}function on(f,p,b){var w=f.queue;if(w===null)throw Error(r(311));w.lastRenderedReducer=b;var R=f.baseQueue,U=w.pending;if(U!==null){if(R!==null){var ie=R.next;R.next=U.next,U.next=ie}p.baseQueue=R=U,w.pending=null}if(U=f.baseState,R===null)f.memoizedState=U;else{p=R.next;var ye=ie=null,We=null,At=p,Qt=!1;do{var cn=At.lane&-536870913;if(cn!==At.lane?(Wn&cn)===cn:(nr&cn)===cn){var gn=At.revertLane;if(gn===0)We!==null&&(We=We.next={lane:0,revertLane:0,action:At.action,hasEagerState:At.hasEagerState,eagerState:At.eagerState,next:null}),cn===St&&(Qt=!0);else if((nr&gn)===gn){At=At.next,gn===St&&(Qt=!0);continue}else cn={lane:0,revertLane:At.revertLane,action:At.action,hasEagerState:At.hasEagerState,eagerState:At.eagerState,next:null},We===null?(ye=We=cn,ie=U):We=We.next=cn,Rn.lanes|=gn,mh|=gn;cn=At.action,pn&&b(U,cn),U=At.hasEagerState?At.eagerState:b(U,cn)}else gn={lane:cn,revertLane:At.revertLane,action:At.action,hasEagerState:At.hasEagerState,eagerState:At.eagerState,next:null},We===null?(ye=We=gn,ie=U):We=We.next=gn,Rn.lanes|=cn,mh|=cn;At=At.next}while(At!==null&&At!==p);if(We===null?ie=U:We.next=ye,!pa(U,f.memoizedState)&&(he=!0,Qt&&(b=Ut,b!==null)))throw b;f.memoizedState=U,f.baseState=ie,f.baseQueue=We,w.lastRenderedState=U}return R===null&&(w.lanes=0),[f.memoizedState,w.dispatch]}function fn(f){var p=we(),b=p.queue;if(b===null)throw Error(r(311));b.lastRenderedReducer=f;var w=b.dispatch,R=b.pending,U=p.memoizedState;if(R!==null){b.pending=null;var ie=R=R.next;do U=f(U,ie.action),ie=ie.next;while(ie!==R);pa(U,p.memoizedState)||(he=!0),p.memoizedState=U,p.baseQueue===null&&(p.baseState=U),b.lastRenderedState=U}return[U,w]}function zn(f,p,b){var w=Rn,R=we(),U=ht;if(U){if(b===void 0)throw Error(r(407));b=b()}else b=p();var ie=!pa((Ln||R).memoizedState,b);if(ie&&(R.memoizedState=b,he=!0),R=R.queue,bl(ai.bind(null,w,R,f),[f]),R.getSnapshot!==p||ie||dn!==null&&dn.memoizedState.tag&1){if(w.flags|=2048,qs(9,En.bind(null,w,R,b,p),{destroy:void 0},null),hi===null)throw Error(r(349));U||nr&60||Dn(w,p,b)}return b}function Dn(f,p,b){f.flags|=16384,f={getSnapshot:p,value:b},p=Rn.updateQueue,p===null?(p=Bl(),Rn.updateQueue=p,p.stores=[f]):(b=p.stores,b===null?p.stores=[f]:b.push(f))}function En(f,p,b,w){p.value=b,p.getSnapshot=w,ui(p)&&er(f)}function ai(f,p,b){return b(function(){ui(p)&&er(f)})}function ui(f){var p=f.getSnapshot;f=f.value;try{var b=p();return!pa(f,b)}catch{return!0}}function er(f){var p=Ve(f,2);p!==null&&Ks(p,f,2)}function Di(f){var p=te();if(typeof f=="function"){var b=f;if(f=b(),pn){k(!0);try{b()}finally{k(!1)}}}return p.memoizedState=p.baseState=f,p.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:It,lastRenderedState:f},p}function ci(f,p,b,w){return f.baseState=b,on(f,Ln,typeof w=="function"?w:It)}function Tn(f,p,b,w,R){if(gu(f))throw Error(r(485));if(f=p.action,f!==null){var U={payload:R,action:f,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ie){U.listeners.push(ie)}};Pn.T!==null?b(!0):U.isTransition=!1,w(U),b=p.pending,b===null?(U.next=p.pending=U,Zi(p,U)):(U.next=b.next,p.pending=b.next=U)}}function Zi(f,p){var b=p.action,w=p.payload,R=f.state;if(p.isTransition){var U=Pn.T,ie={};Pn.T=ie;try{var ye=b(R,w),We=Pn.S;We!==null&&We(ie,ye),ei(f,p,ye)}catch(At){oa(f,p,At)}finally{Pn.T=U}}else try{U=b(R,w),ei(f,p,U)}catch(At){oa(f,p,At)}}function ei(f,p,b){b!==null&&typeof b=="object"&&typeof b.then=="function"?b.then(function(w){cs(f,p,w)},function(w){return oa(f,p,w)}):cs(f,p,b)}function cs(f,p,b){p.status="fulfilled",p.value=b,dr(p),f.state=b,p=f.pending,p!==null&&(b=p.next,b===p?f.pending=null:(b=b.next,p.next=b,Zi(f,b)))}function oa(f,p,b){var w=f.pending;if(f.pending=null,w!==null){w=w.next;do p.status="rejected",p.reason=b,dr(p),p=p.next;while(p!==w)}f.action=null}function dr(f){f=f.listeners;for(var p=0;p<f.length;p++)(0,f[p])()}function Rr(f,p){return p}function Oi(f,p){if(ht){var b=hi.formState;if(b!==null){e:{var w=Rn;if(ht){if(gt){var R=gM(gt,bt);if(R){gt=eS(R),w=vM(R);break e}}xe(w)}w=!1}w&&(p=b[0])}}b=te(),b.memoizedState=b.baseState=p,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rr,lastRenderedState:p},b.queue=w,b=mu.bind(null,Rn,w),w.dispatch=b,w=Di(!1);var U=yc.bind(null,Rn,!1,w.queue);return w=te(),R={state:p,dispatch:null,action:f,pending:null},w.queue=R,b=Tn.bind(null,Rn,R,U,b),R.dispatch=b,w.memoizedState=f,[p,b,!1]}function Er(f){var p=we();return Dr(p,Ln,f)}function Dr(f,p,b){p=on(f,p,Rr)[0],f=en(It)[0],p=typeof p=="object"&&p!==null&&typeof p.then=="function"?Ke(p):p;var w=we(),R=w.queue,U=R.dispatch;return b!==w.memoizedState&&(Rn.flags|=2048,qs(9,jr.bind(null,R,b),{destroy:void 0},null)),[p,U,f]}function jr(f,p){f.action=p}function wr(f){var p=we(),b=Ln;if(b!==null)return Dr(p,b,f);we(),p=p.memoizedState,b=we();var w=b.queue.dispatch;return b.memoizedState=f,[p,w,!1]}function qs(f,p,b,w){return f={tag:f,create:p,inst:b,deps:w,next:null},p=Rn.updateQueue,p===null&&(p=Bl(),Rn.updateQueue=p),b=p.lastEffect,b===null?p.lastEffect=f.next=f:(w=b.next,b.next=f,f.next=w,p.lastEffect=f),f}function pr(){return we().memoizedState}function is(f,p,b,w){var R=te();Rn.flags|=f,R.memoizedState=qs(1|p,b,{destroy:void 0},w===void 0?null:w)}function No(f,p,b,w){var R=we();w=w===void 0?null:w;var U=R.memoizedState.inst;Ln!==null&&w!==null&&xl(w,Ln.memoizedState.deps)?R.memoizedState=qs(p,b,U,w):(Rn.flags|=f,R.memoizedState=qs(1|p,b,U,w))}function Hf(f,p){is(8390656,8,f,p)}function bl(f,p){No(2048,8,f,p)}function jf(f,p){return No(4,2,f,p)}function du(f,p){return No(4,4,f,p)}function Sl(f,p){if(typeof p=="function"){f=f();var b=p(f);return function(){typeof b=="function"?b():p(null)}}if(p!=null)return f=f(),p.current=f,function(){p.current=null}}function El(f,p,b){b=b!=null?b.concat([f]):null,No(4,4,Sl.bind(null,p,f),b)}function co(){}function yd(f,p){var b=we();p=p===void 0?null:p;var w=b.memoizedState;return p!==null&&xl(p,w[1])?w[0]:(b.memoizedState=[f,p],f)}function pu(f,p){var b=we();p=p===void 0?null:p;var w=b.memoizedState;if(p!==null&&xl(p,w[1]))return w[0];if(w=f(),pn){k(!0);try{f()}finally{k(!1)}}return b.memoizedState=[w,p],w}function mc(f,p,b){return b===void 0||nr&1073741824?f.memoizedState=p:(f.memoizedState=b,f=Vv(),Rn.lanes|=f,mh|=f,b)}function Wf(f,p,b,w){return pa(b,p)?b:tr.current!==null?(f=mc(f,b,w),pa(f,p)||(he=!0),f):nr&42?(f=Vv(),Rn.lanes|=f,mh|=f,p):(he=!0,f.memoizedState=b)}function xd(f,p,b,w,R){var U=Tu();Bs(U!==0&&8>U?U:8);var ie=Pn.T,ye={};Pn.T=ye,yc(f,!1,p,b);try{var We=R(),At=Pn.S;if(At!==null&&At(ye,We),We!==null&&typeof We=="object"&&typeof We.then=="function"){var Qt=Nt(We,w);fo(f,p,Qt,ca(f))}else fo(f,p,w,ca(f))}catch(cn){fo(f,p,{then:function(){},status:"rejected",reason:cn},ca())}finally{Bs(U),Pn.T=ie}}function gc(f){var p=f.memoizedState;if(p!==null)return p;p={memoizedState:Rc,baseState:Rc,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:It,lastRenderedState:Rc},next:null};var b={};return p.next={memoizedState:b,baseState:b,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:It,lastRenderedState:b},next:null},f.memoizedState=p,f=f.alternate,f!==null&&(f.memoizedState=p),p}function vc(){return ws(Mu)}function _d(){return we().memoizedState}function Wr(){return we().memoizedState}function bd(f){for(var p=f.return;p!==null;){switch(p.tag){case 24:case 3:var b=ca();f=Bt(b);var w=Ht(p,f,b);w!==null&&(Ks(w,p,b),ut(w,p,b)),p={cache:zv()},f.payload=p;return}p=p.return}}function _m(f,p,b){var w=ca();b={lane:w,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null},gu(f)?vu(p,b):(b=Ne(f,p,b,w),b!==null&&(Ks(b,f,w),Bo(b,p,w)))}function mu(f,p,b){var w=ca();fo(f,p,b,w)}function fo(f,p,b,w){var R={lane:w,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null};if(gu(f))vu(p,R);else{var U=f.alternate;if(f.lanes===0&&(U===null||U.lanes===0)&&(U=p.lastRenderedReducer,U!==null))try{var ie=p.lastRenderedState,ye=U(ie,b);if(R.hasEagerState=!0,R.eagerState=ye,pa(ye,ie))return Pe(f,p,R,0),hi===null&&K(),!1}catch{}finally{}if(b=Ne(f,p,R,w),b!==null)return Ks(b,f,w),Bo(b,p,w),!0}return!1}function yc(f,p,b,w){if(w={lane:2,revertLane:ct(),action:w,hasEagerState:!1,eagerState:null,next:null},gu(f)){if(p)throw Error(r(479))}else p=Ne(f,b,w,2),p!==null&&Ks(p,f,2)}function gu(f){var p=f.alternate;return f===Rn||p!==null&&p===Rn}function vu(f,p){ti=Or=!0;var b=f.pending;b===null?p.next=p:(p.next=b.next,b.next=p),f.pending=p}function Bo(f,p,b){if(b&4194176){var w=p.lanes;w&=f.pendingLanes,b|=w,p.lanes=b,z(f,b)}}function la(f,p,b,w){p=f.memoizedState,b=b(w,p),b=b==null?p:Qv({},p,b),f.memoizedState=b,f.lanes===0&&(f.updateQueue.baseState=b)}function ka(f,p,b,w,R,U,ie){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(w,U,ie):p.prototype&&p.prototype.isPureReactComponent?!Ye(b,w)||!Ye(R,U):!0}function wl(f,p,b,w){f=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(b,w),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(b,w),p.state!==f&&Gn.enqueueReplaceState(p,p.state,null)}function Fa(f,p){var b=p;if("ref"in p){b={};for(var w in p)w!=="ref"&&(b[w]=p[w])}if(f=f.defaultProps){b===p&&(b=Qv({},b));for(var R in f)b[R]===void 0&&(b[R]=f[R])}return b}function ho(f,p){try{var b=f.onUncaughtError;b(p.value,{componentStack:p.stack})}catch(w){setTimeout(function(){throw w})}}function Sd(f,p,b){try{var w=f.onCaughtError;w(b.value,{componentStack:b.stack,errorBoundary:p.tag===1?p.stateNode:null})}catch(R){setTimeout(function(){throw R})}}function Al(f,p,b){return b=Bt(b),b.tag=3,b.payload={element:null},b.callback=function(){ho(f,p)},b}function Xf(f){return f=Bt(f),f.tag=3,f}function Ps(f,p,b,w){var R=b.type.getDerivedStateFromError;if(typeof R=="function"){var U=w.value;f.payload=function(){return R(U)},f.callback=function(){Sd(p,b,w)}}var ie=b.stateNode;ie!==null&&typeof ie.componentDidCatch=="function"&&(f.callback=function(){Sd(p,b,w),typeof R!="function"&&(gh===null?gh=new Set([this]):gh.add(this));var ye=w.stack;this.componentDidCatch(w.value,{componentStack:ye!==null?ye:""})})}function Tv(f,p,b,w,R){if(b.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(p=b.alternate,p!==null&&yu(p,b,R,!0),b=Si.current,b!==null){switch(b.tag){case 13:return zi===null?eh():b.alternate===null&&qr===0&&(qr=3),b.flags&=-257,b.flags|=65536,b.lanes=R,w===yn?b.flags|=16384:(p=b.updateQueue,p===null?b.updateQueue=new Set([w]):p.add(w),th(f,w,R)),!1;case 22:return b.flags|=65536,w===yn?b.flags|=16384:(p=b.updateQueue,p===null?(p={transitions:null,markerInstances:null,retryQueue:new Set([w])},b.updateQueue=p):(b=p.retryQueue,b===null?p.retryQueue=new Set([w]):b.add(w)),th(f,w,R)),!1}throw Error(r(435,b.tag))}return th(f,w,R),eh(),!1}if(ht)return p=Si.current,p!==null?(!(p.flags&65536)&&(p.flags|=256),p.flags|=65536,p.lanes=R,w!==Me&&(f=Error(r(422),{cause:w}),Xe(X(f,b)))):(w!==Me&&(p=Error(r(423),{cause:w}),Xe(X(p,b))),f=f.current.alternate,f.flags|=65536,R&=-R,f.lanes|=R,w=X(w,b),R=Al(f.stateNode,w,R),xn(f,R),qr!==4&&(qr=2)),!1;var U=Error(r(520),{cause:w});if(U=X(U,b),Cy===null?Cy=[U]:Cy.push(U),qr!==4&&(qr=2),p===null)return!0;w=X(w,b),b=p;do{switch(b.tag){case 3:return b.flags|=65536,f=R&-R,b.lanes|=f,f=Al(b.stateNode,w,f),xn(b,f),!1;case 1:if(p=b.type,U=b.stateNode,(b.flags&128)===0&&(typeof p.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(gh===null||!gh.has(U))))return b.flags|=65536,R&=-R,b.lanes|=R,R=Xf(R),Ps(R,f,b,w),xn(b,R),!1}b=b.return}while(b!==null);return!1}function Ar(f,p,b,w){p.child=f===null?jn(p,null,b,w):Ai(p,f.child,b,w)}function xc(f,p,b,w,R){b=b.render;var U=p.ref;if("ref"in w){var ie={};for(var ye in w)ye!=="ref"&&(ie[ye]=w[ye])}else ie=w;return Fo(p),w=Po(f,p,b,ie,U,R),ye=_l(),f!==null&&!he?(pc(f,p,R),_i(f,p,R)):(ht&&ye&&$(p),p.flags|=1,Ar(f,p,w,R),p.child)}function Ga(f,p,b,w,R){if(f===null){var U=b.type;return typeof U=="function"&&!qv(U)&&U.defaultProps===void 0&&b.compare===null?(p.tag=15,p.type=U,bm(f,p,U,w,R)):(f=km(b.type,null,w,p,p.mode,R),f.ref=p.ref,f.return=p,p.child=f)}if(U=f.child,!Em(f,R)){var ie=U.memoizedProps;if(b=b.compare,b=b!==null?b:Ye,b(ie,w)&&f.ref===p.ref)return _i(f,p,R)}return p.flags|=1,f=wu(U,w),f.ref=p.ref,f.return=p,p.child=f}function bm(f,p,b,w,R){if(f!==null){var U=f.memoizedProps;if(Ye(U,w)&&f.ref===p.ref)if(he=!1,p.pendingProps=w=U,Em(f,R))f.flags&131072&&(he=!0);else return p.lanes=f.lanes,_i(f,p,R)}return Es(f,p,b,w,R)}function Ss(f,p,b){var w=p.pendingProps,R=w.children,U=(p.stateNode._pendingVisibility&2)!==0,ie=f!==null?f.memoizedState:null;if(Xr(f,p),w.mode==="hidden"||U){if(p.flags&128){if(w=ie!==null?ie.baseLanes|b:b,f!==null){for(R=p.child=f.child,U=0;R!==null;)U=U|R.lanes|R.childLanes,R=R.sibling;p.childLanes=U&~w}else p.childLanes=0,p.child=null;return fs(f,p,w,b)}if(b&536870912)p.memoizedState={baseLanes:0,cachePool:null},f!==null&&wm(p,ie!==null?ie.cachePool:null),ie!==null?lr(p,ie):us(),aa(p);else return p.lanes=p.childLanes=536870912,fs(f,p,ie!==null?ie.baseLanes|b:b,b)}else ie!==null?(wm(p,ie.cachePool),lr(p,ie),Hr(),p.memoizedState=null):(f!==null&&wm(p,null),us(),Hr());return Ar(f,p,R,b),p.child}function fs(f,p,b,w){var R=Iv();return R=R===null?null:{parent:go?oe._currentValue:oe._currentValue2,pool:R},p.memoizedState={baseLanes:b,cachePool:R},f!==null&&wm(p,null),us(),aa(p),f!==null&&yu(f,p,w,!0),null}function Xr(f,p){var b=p.ref;if(b===null)f!==null&&f.ref!==null&&(p.flags|=2097664);else{if(typeof b!="function"&&typeof b!="object")throw Error(r(284));(f===null||f.ref!==b)&&(p.flags|=2097664)}}function Es(f,p,b,w,R){return Fo(p),b=Po(f,p,b,w,void 0,R),w=_l(),f!==null&&!he?(pc(f,p,R),_i(f,p,R)):(ht&&w&&$(p),p.flags|=1,Ar(f,p,b,R),p.child)}function Yf(f,p,b,w,R,U){return Fo(p),p.updateQueue=null,b=dc(p,w,b,R),Vf(f),w=_l(),f!==null&&!he?(pc(f,p,U),_i(f,p,U)):(ht&&w&&$(p),p.flags|=1,Ar(f,p,b,U),p.child)}function _c(f,p,b,w,R){if(Fo(p),p.stateNode===null){var U=Nl,ie=b.contextType;typeof ie=="object"&&ie!==null&&(U=ws(ie)),U=new b(w,U),p.memoizedState=U.state!==null&&U.state!==void 0?U.state:null,U.updater=Gn,p.stateNode=U,U._reactInternals=p,U=p.stateNode,U.props=w,U.state=p.memoizedState,U.refs={},vt(p),ie=b.contextType,U.context=typeof ie=="object"&&ie!==null?ws(ie):Nl,U.state=p.memoizedState,ie=b.getDerivedStateFromProps,typeof ie=="function"&&(la(p,b,ie,w),U.state=p.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof U.getSnapshotBeforeUpdate=="function"||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(ie=U.state,typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount(),ie!==U.state&&Gn.enqueueReplaceState(U,U.state,null),Vn(p,w,U,R),un(),U.state=p.memoizedState),typeof U.componentDidMount=="function"&&(p.flags|=4194308),w=!0}else if(f===null){U=p.stateNode;var ye=p.memoizedProps,We=Fa(b,ye);U.props=We;var At=U.context,Qt=b.contextType;ie=Nl,typeof Qt=="object"&&Qt!==null&&(ie=ws(Qt));var cn=b.getDerivedStateFromProps;Qt=typeof cn=="function"||typeof U.getSnapshotBeforeUpdate=="function",ye=p.pendingProps!==ye,Qt||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(ye||At!==ie)&&wl(p,U,w,ie),Lt=!1;var gn=p.memoizedState;U.state=gn,Vn(p,w,U,R),un(),At=p.memoizedState,ye||gn!==At||Lt?(typeof cn=="function"&&(la(p,b,cn,w),At=p.memoizedState),(We=Lt||ka(p,b,We,w,gn,At,ie))?(Qt||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(p.flags|=4194308)):(typeof U.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=w,p.memoizedState=At),U.props=w,U.state=At,U.context=ie,w=We):(typeof U.componentDidMount=="function"&&(p.flags|=4194308),w=!1)}else{U=p.stateNode,Vt(f,p),ie=p.memoizedProps,Qt=Fa(b,ie),U.props=Qt,cn=p.pendingProps,gn=U.context,At=b.contextType,We=Nl,typeof At=="object"&&At!==null&&(We=ws(At)),ye=b.getDerivedStateFromProps,(At=typeof ye=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(ie!==cn||gn!==We)&&wl(p,U,w,We),Lt=!1,gn=p.memoizedState,U.state=gn,Vn(p,w,U,R),un();var ii=p.memoizedState;ie!==cn||gn!==ii||Lt||f!==null&&f.dependencies!==null&&xu(f.dependencies)?(typeof ye=="function"&&(la(p,b,ye,w),ii=p.memoizedState),(Qt=Lt||ka(p,b,Qt,w,gn,ii,We)||f!==null&&f.dependencies!==null&&xu(f.dependencies))?(At||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(w,ii,We),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(w,ii,We)),typeof U.componentDidUpdate=="function"&&(p.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof U.componentDidUpdate!="function"||ie===f.memoizedProps&&gn===f.memoizedState||(p.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||ie===f.memoizedProps&&gn===f.memoizedState||(p.flags|=1024),p.memoizedProps=w,p.memoizedState=ii),U.props=w,U.state=ii,U.context=We,w=Qt):(typeof U.componentDidUpdate!="function"||ie===f.memoizedProps&&gn===f.memoizedState||(p.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||ie===f.memoizedProps&&gn===f.memoizedState||(p.flags|=1024),w=!1)}return U=w,Xr(f,p),w=(p.flags&128)!==0,U||w?(U=p.stateNode,b=w&&typeof b.getDerivedStateFromError!="function"?null:U.render(),p.flags|=1,f!==null&&w?(p.child=Ai(p,f.child,null,R),p.child=Ai(p,null,b,R)):Ar(f,p,b,R),p.memoizedState=U.state,f=p.child):f=_i(f,p,R),f}function Mv(f,p,b,w){return Te(),p.flags|=256,Ar(f,p,b,w),p.child}function Tl(f){return{baseLanes:f,cachePool:Am()}}function Ed(f,p,b){return f=f!==null?f.childLanes&~b:0,p&&(f|=Xo),f}function lb(f,p,b){var w=p.pendingProps,R=!1,U=(p.flags&128)!==0,ie;if((ie=U)||(ie=f!==null&&f.memoizedState===null?!1:(oi.current&2)!==0),ie&&(R=!0,p.flags&=-129),ie=(p.flags&32)!==0,p.flags&=-33,f===null){if(ht){if(R?Sr(p):Hr(),ht){var ye=gt,We;(We=ye)&&(ye=by(ye,bt),ye!==null?(p.memoizedState={dehydrated:ye,treeContext:Be!==null?{id:nt,overflow:Le}:null,retryLane:536870912},We=n(18,null,null,0),We.stateNode=ye,We.return=p,p.child=We,xt=p,gt=null,We=!0):We=!1),We||xe(p)}if(ye=p.memoizedState,ye!==null&&(ye=ye.dehydrated,ye!==null))return xy(ye)?p.lanes=16:p.lanes=536870912,null;ur(p)}return ye=w.children,w=w.fallback,R?(Hr(),R=p.mode,ye=Rv({mode:"hidden",children:ye},R),w=Tc(w,R,b,null),ye.return=p,w.return=p,ye.sibling=w,p.child=ye,R=p.child,R.memoizedState=Tl(b),R.childLanes=Ed(f,ie,b),p.memoizedState=Ae,w):(Sr(p),Cv(p,ye))}if(We=f.memoizedState,We!==null&&(ye=We.dehydrated,ye!==null)){if(U)p.flags&256?(Sr(p),p.flags&=-257,p=Sm(f,p,b)):p.memoizedState!==null?(Hr(),p.child=f.child,p.flags|=128,p=null):(Hr(),R=w.fallback,ye=p.mode,w=Rv({mode:"visible",children:w.children},ye),R=Tc(R,ye,b,null),R.flags|=2,w.return=p,R.return=p,w.sibling=R,p.child=w,Ai(p,f.child,null,b),w=p.child,w.memoizedState=Tl(b),w.childLanes=Ed(f,ie,b),p.memoizedState=Ae,p=R);else if(Sr(p),xy(ye))ie=pM(ye).digest,w=Error(r(419)),w.stack="",w.digest=ie,Xe({value:w,source:null,stack:null}),p=Sm(f,p,b);else if(he||yu(f,p,b,!1),ie=(b&f.childLanes)!==0,he||ie){if(ie=hi,ie!==null){if(w=b&-b,w&42)w=1;else switch(w){case 2:w=1;break;case 8:w=4;break;case 32:w=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:w=64;break;case 268435456:w=134217728;break;default:w=0}if(w=w&(ie.suspendedLanes|b)?0:w,w!==0&&w!==We.retryLane)throw We.retryLane=w,Ve(f,w),Ks(ie,f,w),J}yy(ye)||eh(),p=Sm(f,p,b)}else yy(ye)?(p.flags|=128,p.child=f.child,p=Ob.bind(null,f),mM(ye,p),p=null):(f=We.treeContext,Ta&&(gt=Jm(ye),xt=p,ht=!0,dt=null,bt=!1,f!==null&&(ee[fe++]=nt,ee[fe++]=Le,ee[fe++]=Be,nt=f.id,Le=f.overflow,Be=p)),p=Cv(p,w.children),p.flags|=4096);return p}return R?(Hr(),R=w.fallback,ye=p.mode,We=f.child,U=We.sibling,w=wu(We,{mode:"hidden",children:w.children}),w.subtreeFlags=We.subtreeFlags&31457280,U!==null?R=wu(U,R):(R=Tc(R,ye,b,null),R.flags|=2),R.return=p,w.return=p,w.sibling=R,p.child=w,w=R,R=p.child,ye=f.child.memoizedState,ye===null?ye=Tl(b):(We=ye.cachePool,We!==null?(U=go?oe._currentValue:oe._currentValue2,We=We.parent!==U?{parent:U,pool:U}:We):We=Am(),ye={baseLanes:ye.baseLanes|b,cachePool:We}),R.memoizedState=ye,R.childLanes=Ed(f,ie,b),p.memoizedState=Ae,w):(Sr(p),b=f.child,f=b.sibling,b=wu(b,{mode:"visible",children:w.children}),b.return=p,b.sibling=null,f!==null&&(ie=p.deletions,ie===null?(p.deletions=[f],p.flags|=16):ie.push(f)),p.child=b,p.memoizedState=null,b)}function Cv(f,p){return p=Rv({mode:"visible",children:p},f.mode),p.return=f,f.child=p}function Rv(f,p){return Lb(f,p,0,null)}function Sm(f,p,b){return Ai(p,f.child,null,b),f=Cv(p,p.pendingProps.children),f.flags|=2,p.memoizedState=null,f}function ub(f,p,b){f.lanes|=p;var w=f.alternate;w!==null&&(w.lanes|=p),Ml(f.return,p,b)}function Dv(f,p,b,w,R){var U=f.memoizedState;U===null?f.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:w,tail:b,tailMode:R}:(U.isBackwards=p,U.rendering=null,U.renderingStartTime=0,U.last=w,U.tail=b,U.tailMode=R)}function Ov(f,p,b){var w=p.pendingProps,R=w.revealOrder,U=w.tail;if(Ar(f,p,w.children,b),w=oi.current,w&2)w=w&1|2,p.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=p.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&ub(f,b,p);else if(f.tag===19)ub(f,b,p);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===p)break e;for(;f.sibling===null;){if(f.return===null||f.return===p)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}w&=1}switch(x(oi,w),R){case"forwards":for(b=p.child,R=null;b!==null;)f=b.alternate,f!==null&&Zn(f)===null&&(R=b),b=b.sibling;b=R,b===null?(R=p.child,p.child=null):(R=b.sibling,b.sibling=null),Dv(p,!1,R,b,U);break;case"backwards":for(b=null,R=p.child,p.child=null;R!==null;){if(f=R.alternate,f!==null&&Zn(f)===null){p.child=R;break}f=R.sibling,R.sibling=b,b=R,R=f}Dv(p,!0,b,null,U);break;case"together":Dv(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function _i(f,p,b){if(f!==null&&(p.dependencies=f.dependencies),mh|=p.lanes,!(b&p.childLanes))if(f!==null){if(yu(f,p,b,!1),(b&p.childLanes)===0)return null}else return null;if(f!==null&&p.child!==f.child)throw Error(r(153));if(p.child!==null){for(f=p.child,b=wu(f,f.pendingProps),p.child=b,b.return=p;f.sibling!==null;)f=f.sibling,b=b.sibling=wu(f,f.pendingProps),b.return=p;b.sibling=null}return p.child}function Em(f,p){return f.lanes&p?!0:(f=f.dependencies,!!(f!==null&&xu(f)))}function tM(f,p,b){switch(p.tag){case 3:q(p,p.stateNode.containerInfo),ko(p,oe,f.memoizedState.cache),Te();break;case 27:case 5:ve(p);break;case 4:q(p,p.stateNode.containerInfo);break;case 10:ko(p,p.type,p.memoizedProps.value);break;case 13:var w=p.memoizedState;if(w!==null)return w.dehydrated!==null?(Sr(p),p.flags|=128,null):b&p.child.childLanes?lb(f,p,b):(Sr(p),f=_i(f,p,b),f!==null?f.sibling:null);Sr(p);break;case 19:var R=(f.flags&128)!==0;if(w=(b&p.childLanes)!==0,w||(yu(f,p,b,!1),w=(b&p.childLanes)!==0),R){if(w)return Ov(f,p,b);p.flags|=128}if(R=p.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),x(oi,oi.current),w)break;return null;case 22:case 23:return p.lanes=0,Ss(f,p,b);case 24:ko(p,oe,f.memoizedState.cache)}return _i(f,p,b)}function po(f,p,b){if(f!==null)if(f.memoizedProps!==p.pendingProps)he=!0;else{if(!Em(f,b)&&!(p.flags&128))return he=!1,tM(f,p,b);he=!!(f.flags&131072)}else he=!1,ht&&p.flags&1048576&&H(p,L,p.index);switch(p.lanes=0,p.tag){case 16:e:{f=p.pendingProps;var w=p.elementType,R=w._init;if(w=R(w._payload),p.type=w,typeof w=="function")qv(w)?(f=Fa(w,f),p.tag=1,p=_c(null,p,w,f,b)):(p.tag=0,p=Es(null,p,w,f,b));else{if(w!=null){if(R=w.$$typeof,R===jm){p.tag=11,p=xc(null,p,w,f,b);break e}else if(R===Wm){p.tag=14,p=Ga(null,p,w,f,b);break e}}throw p=a(w)||w,Error(r(306,p,""))}}return p;case 0:return Es(f,p,p.type,p.pendingProps,b);case 1:return w=p.type,R=Fa(w,p.pendingProps),_c(f,p,w,R,b);case 3:e:{if(q(p,p.stateNode.containerInfo),f===null)throw Error(r(387));var U=p.pendingProps;R=p.memoizedState,w=R.element,Vt(f,p),Vn(p,U,null,b);var ie=p.memoizedState;if(U=ie.cache,ko(p,oe,U),U!==R.cache&&wd(p,[oe],b,!0),un(),U=ie.element,Ta&&R.isDehydrated)if(R={element:U,isDehydrated:!1,cache:ie.cache},p.updateQueue.baseState=R,p.memoizedState=R,p.flags&256){p=Mv(f,p,U,b);break e}else if(U!==w){w=X(Error(r(424)),p),Xe(w),p=Mv(f,p,U,b);break e}else for(Ta&&(gt=_y(p.stateNode.containerInfo),xt=p,ht=!0,dt=null,bt=!0),b=jn(p,null,U,b),p.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Te(),U===w){p=_i(f,p,b);break e}Ar(f,p,U,b)}p=p.child}return p;case 26:if(ks)return Xr(f,p),f===null?(b=Cu(p.type,null,p.pendingProps,null))?p.memoizedState=b:ht||(p.stateNode=Ru(p.type,p.pendingProps,mt.current,p)):p.memoizedState=Cu(p.type,f.memoizedProps,p.pendingProps,f.memoizedState),null;case 27:if(Ms)return ve(p),f===null&&Ms&&ht&&(w=p.stateNode=aS(p.type,p.pendingProps,mt.current,He.current,!1),xt=p,bt=!0,gt=tS(w)),w=p.pendingProps.children,f!==null||ht?Ar(f,p,w,b):p.child=Ai(p,null,w,b),Xr(f,p),p.child;case 5:return f===null&&ht&&(Yd(p.type,p.pendingProps,He.current),(R=w=gt)&&(w=$m(w,p.type,p.pendingProps,bt),w!==null?(p.stateNode=w,xt=p,gt=tS(w),bt=!1,R=!0):R=!1),R||xe(p)),ve(p),R=p.type,U=p.pendingProps,ie=f!==null?f.memoizedProps:null,w=U.children,Fd(R,U)?w=null:ie!==null&&Fd(R,ie)&&(p.flags|=32),p.memoizedState!==null&&(R=Po(f,p,fu,null,null,b),go?Mu._currentValue=R:Mu._currentValue2=R),Xr(f,p),Ar(f,p,w,b),p.child;case 6:return f===null&&ht&&(Zd(p.pendingProps,He.current),(f=b=gt)&&(b=eg(b,p.pendingProps,bt),b!==null?(p.stateNode=b,xt=p,gt=null,f=!0):f=!1),f||xe(p)),null;case 13:return lb(f,p,b);case 4:return q(p,p.stateNode.containerInfo),w=p.pendingProps,f===null?p.child=Ai(p,null,w,b):Ar(f,p,w,b),p.child;case 11:return xc(f,p,p.type,p.pendingProps,b);case 7:return Ar(f,p,p.pendingProps,b),p.child;case 8:return Ar(f,p,p.pendingProps.children,b),p.child;case 12:return Ar(f,p,p.pendingProps.children,b),p.child;case 10:return w=p.pendingProps,ko(p,p.type,w.value),Ar(f,p,w.children,b),p.child;case 9:return R=p.type._context,w=p.pendingProps.children,Fo(p),R=ws(R),w=w(R),p.flags|=1,Ar(f,p,w,b),p.child;case 14:return Ga(f,p,p.type,p.pendingProps,b);case 15:return bm(f,p,p.type,p.pendingProps,b);case 19:return Ov(f,p,b);case 22:return Ss(f,p,b);case 24:return Fo(p),w=ws(oe),f===null?(R=Iv(),R===null&&(R=hi,U=zv(),R.pooledCache=U,U.refCount++,U!==null&&(R.pooledCacheLanes|=b),R=U),p.memoizedState={parent:w,cache:R},vt(p),ko(p,oe,R)):(f.lanes&b&&(Vt(f,p),Vn(p,null,null,b),un()),R=f.memoizedState,U=p.memoizedState,R.parent!==w?(R={parent:w,cache:w},p.memoizedState=R,p.lanes===0&&(p.memoizedState=p.updateQueue.baseState=R),ko(p,oe,w)):(w=U.cache,ko(p,oe,w),w!==R.cache&&wd(p,[oe],b,!0))),Ar(f,p,p.pendingProps.children,b),p.child;case 29:throw p.pendingProps}throw Error(r(156,p.tag))}function ko(f,p,b){go?(x(Ce,p._currentValue),p._currentValue=b):(x(Ce,p._currentValue2),p._currentValue2=b)}function Va(f){var p=Ce.current;go?f._currentValue=p:f._currentValue2=p,g(Ce)}function Ml(f,p,b){for(;f!==null;){var w=f.alternate;if((f.childLanes&p)!==p?(f.childLanes|=p,w!==null&&(w.childLanes|=p)):w!==null&&(w.childLanes&p)!==p&&(w.childLanes|=p),f===b)break;f=f.return}}function wd(f,p,b,w){var R=f.child;for(R!==null&&(R.return=f);R!==null;){var U=R.dependencies;if(U!==null){var ie=R.child;U=U.firstContext;e:for(;U!==null;){var ye=U;U=R;for(var We=0;We<p.length;We++)if(ye.context===p[We]){U.lanes|=b,ye=U.alternate,ye!==null&&(ye.lanes|=b),Ml(U.return,b,f),w||(ie=null);break e}U=ye.next}}else if(R.tag===18){if(ie=R.return,ie===null)throw Error(r(341));ie.lanes|=b,U=ie.alternate,U!==null&&(U.lanes|=b),Ml(ie,b,f),ie=null}else ie=R.child;if(ie!==null)ie.return=R;else for(ie=R;ie!==null;){if(ie===f){ie=null;break}if(R=ie.sibling,R!==null){R.return=ie.return,ie=R;break}ie=ie.return}R=ie}}function yu(f,p,b,w){f=null;for(var R=p,U=!1;R!==null;){if(!U){if(R.flags&524288)U=!0;else if(R.flags&262144)break}if(R.tag===10){var ie=R.alternate;if(ie===null)throw Error(r(387));if(ie=ie.memoizedProps,ie!==null){var ye=R.type;pa(R.pendingProps.value,ie.value)||(f!==null?f.push(ye):f=[ye])}}else if(R===Ct.current){if(ie=R.alternate,ie===null)throw Error(r(387));ie.memoizedState.memoizedState!==R.memoizedState.memoizedState&&(f!==null?f.push(Mu):f=[Mu])}R=R.return}f!==null&&wd(p,f,b,w),p.flags|=262144}function xu(f){for(f=f.firstContext;f!==null;){var p=f.context;if(!pa(go?p._currentValue:p._currentValue2,f.memoizedValue))return!0;f=f.next}return!1}function Fo(f){me=f,de=null,f=f.dependencies,f!==null&&(f.firstContext=null)}function ws(f){return Uv(me,f)}function Zf(f,p){return me===null&&Fo(f),Uv(f,p)}function Uv(f,p){var b=go?p._currentValue:p._currentValue2;if(p={context:p,memoizedValue:b,next:null},de===null){if(f===null)throw Error(r(308));de=p,f.dependencies={lanes:0,firstContext:p},f.flags|=524288}else de=de.next=p;return b}function zv(){return{controller:new Se,data:new Map,refCount:0}}function Ad(f){f.refCount--,f.refCount===0&&le(ce,function(){f.controller.abort()})}function Iv(){var f=Re.current;return f!==null?f:hi.pooledCache}function wm(f,p){p===null?x(Re,Re.current):x(Re,p.pool)}function Am(){var f=Iv();return f===null?null:{parent:go?oe._currentValue:oe._currentValue2,pool:f}}function Ns(f){f.flags|=4}function Tm(f,p){if(f!==null&&f.child===p.child)return!1;if(p.flags&16)return!0;for(f=p.child;f!==null;){if(f.flags&13878||f.subtreeFlags&13878)return!0;f=f.sibling}return!1}function Td(f,p,b,w){if(hs)for(b=p.child;b!==null;){if(b.tag===5||b.tag===6)Bd(f,b.stateNode);else if(!(b.tag===4||Ms&&b.tag===27)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===p)break;for(;b.sibling===null;){if(b.return===null||b.return===p)return;b=b.return}b.sibling.return=b.return,b=b.sibling}else if(Il)for(var R=p.child;R!==null;){if(R.tag===5){var U=R.stateNode;b&&w&&(U=Jb(U,R.type,R.memoizedProps)),Bd(f,U)}else if(R.tag===6)U=R.stateNode,b&&w&&(U=$b(U,R.memoizedProps)),Bd(f,U);else if(R.tag!==4){if(R.tag===22&&R.memoizedState!==null)U=R.child,U!==null&&(U.return=R),Td(f,R,!0,!0);else if(R.child!==null){R.child.return=R,R=R.child;continue}}if(R===p)break;for(;R.sibling===null;){if(R.return===null||R.return===p)return;R=R.return}R.sibling.return=R.return,R=R.sibling}}function bc(f,p,b,w){if(Il)for(var R=p.child;R!==null;){if(R.tag===5){var U=R.stateNode;b&&w&&(U=Jb(U,R.type,R.memoizedProps)),Qb(f,U)}else if(R.tag===6)U=R.stateNode,b&&w&&(U=$b(U,R.memoizedProps)),Qb(f,U);else if(R.tag!==4){if(R.tag===22&&R.memoizedState!==null)U=R.child,U!==null&&(U.return=R),bc(f,R,!(R.memoizedProps!==null&&R.memoizedProps.mode==="manual"),!0);else if(R.child!==null){R.child.return=R,R=R.child;continue}}if(R===p)break;for(;R.sibling===null;){if(R.return===null||R.return===p)return;R=R.return}R.sibling.return=R.return,R=R.sibling}}function Mm(f,p){if(Il&&Tm(f,p)){f=p.stateNode;var b=f.containerInfo,w=Qm();bc(w,p,!1,!1),f.pendingChildren=w,Ns(p),dM(b,w)}}function Md(f,p,b,w){if(hs)f.memoizedProps!==w&&Ns(p);else if(Il){var R=f.stateNode,U=f.memoizedProps;if((f=Tm(f,p))||U!==w){var ie=He.current;U=ch(R,b,U,w,!f,null),U===R?p.stateNode=R:(kd(U,b,w,ie)&&Ns(p),p.stateNode=U,f?Td(U,p,!1,!1):Ns(p))}else p.stateNode=R}}function Cd(f,p,b){if(Wb(p,b)){if(f.flags|=16777216,!Ym(p,b))if(zd())f.flags|=8192;else throw wn=yn,jt}else f.flags&=-16777217}function Cm(f,p){if(sS(p)){if(f.flags|=16777216,!wy(p))if(zd())f.flags|=8192;else throw wn=yn,jt}else f.flags&=-16777217}function Rd(f,p){p!==null&&(f.flags|=4),f.flags&16384&&(p=f.tag!==22?M():536870912,f.lanes|=p,fg|=p)}function qf(f,p){if(!ht)switch(f.tailMode){case"hidden":p=f.tail;for(var b=null;p!==null;)p.alternate!==null&&(b=p),p=p.sibling;b===null?f.tail=null:b.sibling=null;break;case"collapsed":b=f.tail;for(var w=null;b!==null;)b.alternate!==null&&(w=b),b=b.sibling;w===null?p||f.tail===null?f.tail=null:f.tail.sibling=null:w.sibling=null}}function mr(f){var p=f.alternate!==null&&f.alternate.child===f.child,b=0,w=0;if(p)for(var R=f.child;R!==null;)b|=R.lanes|R.childLanes,w|=R.subtreeFlags&31457280,w|=R.flags&31457280,R.return=f,R=R.sibling;else for(R=f.child;R!==null;)b|=R.lanes|R.childLanes,w|=R.subtreeFlags,w|=R.flags,R.return=f,R=R.sibling;return f.subtreeFlags|=w,f.childLanes=b,p}function cb(f,p,b){var w=p.pendingProps;switch(ne(p),p.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mr(p),null;case 1:return mr(p),null;case 3:return b=p.stateNode,w=null,f!==null&&(w=f.memoizedState.cache),p.memoizedState.cache!==w&&(p.flags|=2048),Va(oe),se(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(f===null||f.child===null)&&(et(p)?Ns(p):f===null||f.memoizedState.isDehydrated&&!(p.flags&256)||(p.flags|=1024,dt!==null&&(Hv(dt),dt=null))),Mm(f,p),mr(p),null;case 26:if(ks){b=p.type;var R=p.memoizedState;return f===null?(Ns(p),R!==null?(mr(p),Cm(p,R)):(mr(p),Cd(p,b,w))):R?R!==f.memoizedState?(Ns(p),mr(p),Cm(p,R)):(mr(p),p.flags&=-16777217):(hs?f.memoizedProps!==w&&Ns(p):Md(f,p,b,w),mr(p),Cd(p,b,w)),null}case 27:if(Ms){if(pe(p),b=mt.current,R=p.type,f!==null&&p.stateNode!=null)hs?f.memoizedProps!==w&&Ns(p):Md(f,p,R,w);else{if(!w){if(p.stateNode===null)throw Error(r(166));return mr(p),null}f=He.current,et(p)?ot(p,f):(f=aS(R,w,b,f,!0),p.stateNode=f,Ns(p))}return mr(p),null}case 5:if(pe(p),b=p.type,f!==null&&p.stateNode!=null)Md(f,p,b,w);else{if(!w){if(p.stateNode===null)throw Error(r(166));return mr(p),null}f=He.current,et(p)?ot(p,f):(R=ay(b,w,mt.current,f,p),Td(R,p,!1,!1),p.stateNode=R,kd(R,b,w,f)&&Ns(p))}return mr(p),Cd(p,p.type,p.pendingProps),null;case 6:if(f&&p.stateNode!=null)b=f.memoizedProps,hs?b!==w&&Ns(p):Il&&(b!==w?(p.stateNode=oy(w,mt.current,He.current,p),Ns(p)):p.stateNode=f.stateNode);else{if(typeof w!="string"&&p.stateNode===null)throw Error(r(166));if(f=mt.current,b=He.current,et(p)){if(!Ta)throw Error(r(176));if(f=p.stateNode,b=p.memoizedProps,w=null,R=xt,R!==null)switch(R.tag){case 27:case 5:w=R.memoizedProps}ng(f,b,p,w)||xe(p)}else p.stateNode=oy(w,f,b,p)}return mr(p),null;case 13:if(w=p.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(R=et(p),w!==null&&w.dehydrated!==null){if(f===null){if(!R)throw Error(r(318));if(!Ta)throw Error(r(344));if(R=p.memoizedState,R=R!==null?R.dehydrated:null,!R)throw Error(r(317));ig(R,p)}else Te(),!(p.flags&128)&&(p.memoizedState=null),p.flags|=4;mr(p),R=!1}else dt!==null&&(Hv(dt),dt=null),R=!0;if(!R)return p.flags&256?(ur(p),p):(ur(p),null)}if(ur(p),p.flags&128)return p.lanes=b,p;if(b=w!==null,f=f!==null&&f.memoizedState!==null,b){w=p.child,R=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(R=w.alternate.memoizedState.cachePool.pool);var U=null;w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(U=w.memoizedState.cachePool.pool),U!==R&&(w.flags|=2048)}return b!==f&&b&&(p.child.flags|=8192),Rd(p,p.updateQueue),mr(p),null;case 4:return se(),Mm(f,p),f===null&&Hb(p.stateNode.containerInfo),mr(p),null;case 10:return Va(p.type),mr(p),null;case 19:if(g(oi),R=p.memoizedState,R===null)return mr(p),null;if(w=(p.flags&128)!==0,U=R.rendering,U===null)if(w)qf(R,!1);else{if(qr!==0||f!==null&&f.flags&128)for(f=p.child;f!==null;){if(U=Zn(f),U!==null){for(p.flags|=128,qf(R,!1),f=U.updateQueue,p.updateQueue=f,Rd(p,f),p.subtreeFlags=0,f=b,b=p.child;b!==null;)Ib(b,f),b=b.sibling;return x(oi,oi.current&1|2),p.child}f=f.sibling}R.tail!==null&&yo()>Ry&&(p.flags|=128,w=!0,qf(R,!1),p.lanes=4194304)}else{if(!w)if(f=Zn(U),f!==null){if(p.flags|=128,w=!0,f=f.updateQueue,p.updateQueue=f,Rd(p,f),qf(R,!0),R.tail===null&&R.tailMode==="hidden"&&!U.alternate&&!ht)return mr(p),null}else 2*yo()-R.renderingStartTime>Ry&&b!==536870912&&(p.flags|=128,w=!0,qf(R,!1),p.lanes=4194304);R.isBackwards?(U.sibling=p.child,p.child=U):(f=R.last,f!==null?f.sibling=U:p.child=U,R.last=U)}return R.tail!==null?(p=R.tail,R.rendering=p,R.tail=p.sibling,R.renderingStartTime=yo(),p.sibling=null,f=oi.current,x(oi,w?f&1|2:f&1),p):(mr(p),null);case 22:case 23:return ur(p),Vr(),w=p.memoizedState!==null,f!==null?f.memoizedState!==null!==w&&(p.flags|=8192):w&&(p.flags|=8192),w?b&536870912&&!(p.flags&128)&&(mr(p),p.subtreeFlags&6&&(p.flags|=8192)):mr(p),b=p.updateQueue,b!==null&&Rd(p,b.retryQueue),b=null,f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),w=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(w=p.memoizedState.cachePool.pool),w!==b&&(p.flags|=2048),f!==null&&g(Re),null;case 24:return b=null,f!==null&&(b=f.memoizedState.cache),p.memoizedState.cache!==b&&(p.flags|=2048),Va(oe),mr(p),null;case 25:return null}throw Error(r(156,p.tag))}function fb(f,p){switch(ne(p),p.tag){case 1:return f=p.flags,f&65536?(p.flags=f&-65537|128,p):null;case 3:return Va(oe),se(),f=p.flags,f&65536&&!(f&128)?(p.flags=f&-65537|128,p):null;case 26:case 27:case 5:return pe(p),null;case 13:if(ur(p),f=p.memoizedState,f!==null&&f.dehydrated!==null){if(p.alternate===null)throw Error(r(340));Te()}return f=p.flags,f&65536?(p.flags=f&-65537|128,p):null;case 19:return g(oi),null;case 4:return se(),null;case 10:return Va(p.type),null;case 22:case 23:return ur(p),Vr(),f!==null&&g(Re),f=p.flags,f&65536?(p.flags=f&-65537|128,p):null;case 24:return Va(oe),null;case 25:return null;default:return null}}function Lv(f,p){switch(ne(p),p.tag){case 3:Va(oe),se();break;case 26:case 27:case 5:pe(p);break;case 4:se();break;case 13:ur(p);break;case 19:g(oi);break;case 10:Va(p.type);break;case 22:case 23:ur(p),Vr(),f!==null&&g(Re);break;case 24:Va(oe)}}function Kf(f,p){try{var b=p.updateQueue,w=b!==null?b.lastEffect:null;if(w!==null){var R=w.next;b=R;do{if((b.tag&f)===f){w=void 0;var U=b.create,ie=b.inst;w=U(),ie.destroy=w}b=b.next}while(b!==R)}}catch(ye){gi(p,p.return,ye)}}function Cl(f,p,b){try{var w=p.updateQueue,R=w!==null?w.lastEffect:null;if(R!==null){var U=R.next;w=U;do{if((w.tag&f)===f){var ie=w.inst,ye=ie.destroy;if(ye!==void 0){ie.destroy=void 0,R=p;var We=b;try{ye()}catch(At){gi(R,We,At)}}}w=w.next}while(w!==U)}}catch(At){gi(p,p.return,At)}}function Sc(f){var p=f.updateQueue;if(p!==null){var b=f.stateNode;try{_t(p,b)}catch(w){gi(f,f.return,w)}}}function Rm(f,p,b){b.props=Fa(f.type,f.memoizedProps),b.state=f.memoizedState;try{b.componentWillUnmount()}catch(w){gi(f,p,w)}}function Rl(f,p){try{var b=f.ref;if(b!==null){var w=f.stateNode;switch(f.tag){case 26:case 27:case 5:var R=sh(w);break;default:R=w}typeof b=="function"?f.refCleanup=b(R):b.current=R}}catch(U){gi(f,p,U)}}function As(f,p){var b=f.ref,w=f.refCleanup;if(b!==null)if(typeof w=="function")try{w()}catch(R){gi(f,p,R)}finally{f.refCleanup=null,f=f.alternate,f!=null&&(f.refCleanup=null)}else if(typeof b=="function")try{b(null)}catch(R){gi(f,p,R)}else b.current=null}function hb(f){var p=f.type,b=f.memoizedProps,w=f.stateNode;try{Km(w,p,b,f)}catch(R){gi(f,f.return,R)}}function db(f,p,b){try{Wd(f.stateNode,f.type,b,p,f)}catch(w){gi(f,f.return,w)}}function pb(f){return f.tag===5||f.tag===3||(ks?f.tag===26:!1)||(Ms?f.tag===27:!1)||f.tag===4}function Dd(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||pb(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&(!Ms||f.tag!==27)&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function Pv(f,p,b){var w=f.tag;if(w===5||w===6)f=f.stateNode,p?gy(b,f,p):Uc(b,f);else if(!(w===4||Ms&&w===27)&&(f=f.child,f!==null))for(Pv(f,p,b),f=f.sibling;f!==null;)Pv(f,p,b),f=f.sibling}function Dm(f,p,b){var w=f.tag;if(w===5||w===6)f=f.stateNode,p?my(b,f,p):Oc(b,f);else if(!(w===4||Ms&&w===27)&&(f=f.child,f!==null))for(Dm(f,p,b),f=f.sibling;f!==null;)Dm(f,p,b),f=f.sibling}function mb(f,p,b){f=f.containerInfo;try{vy(f,b)}catch(w){gi(p,p.return,w)}}function Nv(f,p){for(ry(f.containerInfo),Jt=p;Jt!==null;)if(f=Jt,p=f.child,(f.subtreeFlags&1028)!==0&&p!==null)p.return=f,Jt=p;else for(;Jt!==null;){f=Jt;var b=f.alternate;switch(p=f.flags,f.tag){case 0:break;case 11:case 15:break;case 1:if(p&1024&&b!==null){p=void 0;var w=f,R=b.memoizedProps;b=b.memoizedState;var U=w.stateNode;try{var ie=Fa(w.type,R,w.elementType===w.type);p=U.getSnapshotBeforeUpdate(ie,b),U.__reactInternalSnapshotBeforeUpdate=p}catch(ye){gi(w,w.return,ye)}}break;case 3:p&1024&&hs&&hM(f.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(p&1024)throw Error(r(163))}if(p=f.sibling,p!==null){p.return=f.return,Jt=p;break}Jt=f.return}return ie=qt,qt=!1,ie}function gb(f,p,b){var w=b.flags;switch(b.tag){case 0:case 11:case 15:Dl(f,b),w&4&&Kf(5,b);break;case 1:if(Dl(f,b),w&4)if(f=b.stateNode,p===null)try{f.componentDidMount()}catch(ye){gi(b,b.return,ye)}else{var R=Fa(b.type,p.memoizedProps);p=p.memoizedState;try{f.componentDidUpdate(R,p,f.__reactInternalSnapshotBeforeUpdate)}catch(ye){gi(b,b.return,ye)}}w&64&&Sc(b),w&512&&Rl(b,b.return);break;case 3:if(Dl(f,b),w&64&&(w=b.updateQueue,w!==null)){if(f=null,b.child!==null)switch(b.child.tag){case 27:case 5:f=sh(b.child.stateNode);break;case 1:f=b.child.stateNode}try{_t(w,f)}catch(ye){gi(b,b.return,ye)}}break;case 26:if(ks){Dl(f,b),w&512&&Rl(b,b.return);break}case 27:case 5:Dl(f,b),p===null&&w&4&&hb(b),w&512&&Rl(b,b.return);break;case 12:Dl(f,b);break;case 13:Dl(f,b),w&4&&zm(f,b);break;case 22:if(R=b.memoizedState!==null||Qe,!R){p=p!==null&&p.memoizedState!==null||qe;var U=Qe,ie=qe;Qe=R,(qe=p)&&!ie?_u(f,b,(b.subtreeFlags&8772)!==0):Dl(f,b),Qe=U,qe=ie}w&512&&(b.memoizedProps.mode==="manual"?Rl(b,b.return):As(b,b.return));break;default:Dl(f,b)}}function Om(f){var p=f.alternate;p!==null&&(f.alternate=null,Om(p)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(p=f.stateNode,p!==null&&cy(p)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function Ha(f,p,b){for(b=b.child;b!==null;)Um(f,p,b),b=b.sibling}function Um(f,p,b){if(da&&typeof da.onCommitFiberUnmount=="function")try{da.onCommitFiberUnmount(dh,b)}catch{}switch(b.tag){case 26:if(ks){qe||As(b,p),Ha(f,p,b),b.memoizedState?lg(b.memoizedState):b.stateNode&&iS(b.stateNode);break}case 27:if(Ms){qe||As(b,p);var w=tt,R=Ze;tt=b.stateNode,Ha(f,p,b),hh(b.stateNode),tt=w,Ze=R;break}case 5:qe||As(b,p);case 6:if(hs){if(w=tt,R=Ze,tt=null,Ha(f,p,b),tt=w,Ze=R,tt!==null)if(Ze)try{uh(tt,b.stateNode)}catch(U){gi(b,p,U)}else try{lh(tt,b.stateNode)}catch(U){gi(b,p,U)}}else Ha(f,p,b);break;case 18:hs&&tt!==null&&(Ze?Xd(tt,b.stateNode):ag(tt,b.stateNode));break;case 4:hs?(w=tt,R=Ze,tt=b.stateNode.containerInfo,Ze=!0,Ha(f,p,b),tt=w,Ze=R):(Il&&mb(b.stateNode,b,Qm()),Ha(f,p,b));break;case 0:case 11:case 14:case 15:qe||Cl(2,b,p),qe||Cl(4,b,p),Ha(f,p,b);break;case 1:qe||(As(b,p),w=b.stateNode,typeof w.componentWillUnmount=="function"&&Rm(b,p,w)),Ha(f,p,b);break;case 21:Ha(f,p,b);break;case 22:qe||As(b,p),qe=(w=qe)||b.memoizedState!==null,Ha(f,p,b),qe=w;break;default:Ha(f,p,b)}}function zm(f,p){if(Ta&&p.memoizedState===null&&(f=p.alternate,f!==null&&(f=f.memoizedState,f!==null&&(f=f.dehydrated,f!==null))))try{sg(f)}catch(b){gi(p,p.return,b)}}function nM(f){switch(f.tag){case 13:case 19:var p=f.stateNode;return p===null&&(p=f.stateNode=new bn),p;case 22:return f=f.stateNode,p=f._retryCache,p===null&&(p=f._retryCache=new bn),p;default:throw Error(r(435,f.tag))}}function Qf(f,p){var b=nM(f);p.forEach(function(w){var R=Ub.bind(null,f,w);b.has(w)||(b.add(w),w.then(R,R))})}function ua(f,p){var b=p.deletions;if(b!==null)for(var w=0;w<b.length;w++){var R=b[w],U=f,ie=p;if(hs){var ye=ie;e:for(;ye!==null;){switch(ye.tag){case 27:case 5:tt=ye.stateNode,Ze=!1;break e;case 3:tt=ye.stateNode.containerInfo,Ze=!0;break e;case 4:tt=ye.stateNode.containerInfo,Ze=!0;break e}ye=ye.return}if(tt===null)throw Error(r(160));Um(U,ie,R),tt=null,Ze=!1}else Um(U,ie,R);U=R.alternate,U!==null&&(U.return=null),R.return=null}if(p.subtreeFlags&13878)for(p=p.child;p!==null;)vb(p,f),p=p.sibling}function vb(f,p){var b=f.alternate,w=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:ua(p,f),Aa(f),w&4&&(Cl(3,f,f.return),Kf(3,f),Cl(5,f,f.return));break;case 1:ua(p,f),Aa(f),w&512&&(qe||b===null||As(b,b.return)),w&64&&Qe&&(f=f.updateQueue,f!==null&&(w=f.callbacks,w!==null&&(b=f.shared.hiddenCallbacks,f.shared.hiddenCallbacks=b===null?w:b.concat(w))));break;case 26:if(ks){var R=Kt;ua(p,f),Aa(f),w&512&&(qe||b===null||As(b,b.return)),w&4&&(w=b!==null?b.memoizedState:null,p=f.memoizedState,b===null?p===null?f.stateNode===null?f.stateNode=yM(R,f.type,f.memoizedProps,f):nS(R,f.type,f.stateNode):f.stateNode=Ey(R,p,f.memoizedProps):w!==p?(w===null?b.stateNode!==null&&iS(b.stateNode):lg(w),p===null?nS(R,f.type,f.stateNode):Ey(R,p,f.memoizedProps)):p===null&&f.stateNode!==null&&db(f,f.memoizedProps,b.memoizedProps));break}case 27:if(Ms&&w&4&&f.alternate===null){R=f.stateNode;var U=f.memoizedProps;try{Ho(R),oS(f.type,U,R,f)}catch(Qt){gi(f,f.return,Qt)}}case 5:if(ua(p,f),Aa(f),w&512&&(qe||b===null||As(b,b.return)),hs){if(f.flags&32){p=f.stateNode;try{Yb(p)}catch(Qt){gi(f,f.return,Qt)}}w&4&&f.stateNode!=null&&(p=f.memoizedProps,db(f,p,b!==null?b.memoizedProps:p)),w&1024&&(zt=!0)}break;case 6:if(ua(p,f),Aa(f),w&4&&hs){if(f.stateNode===null)throw Error(r(162));w=f.memoizedProps,b=b!==null?b.memoizedProps:w,p=f.stateNode;try{qm(p,b,w)}catch(Qt){gi(f,f.return,Qt)}}break;case 3:if(ks?(rS(),R=Kt,Kt=zc(p.containerInfo),ua(p,f),Kt=R):ua(p,f),Aa(f),w&4){if(hs&&Ta&&b!==null&&b.memoizedState.isDehydrated)try{rg(p.containerInfo)}catch(Qt){gi(f,f.return,Qt)}if(Il){w=p.containerInfo,b=p.pendingChildren;try{vy(w,b)}catch(Qt){gi(f,f.return,Qt)}}}zt&&(zt=!1,yb(f));break;case 4:ks?(b=Kt,Kt=zc(f.stateNode.containerInfo),ua(p,f),Aa(f),Kt=b):(ua(p,f),Aa(f)),w&4&&Il&&mb(f.stateNode,f,f.stateNode.pendingChildren);break;case 12:ua(p,f),Aa(f);break;case 13:ua(p,f),Aa(f),f.child.flags&8192&&f.memoizedState!==null!=(b!==null&&b.memoizedState!==null)&&(RM=yo()),w&4&&(w=f.updateQueue,w!==null&&(f.updateQueue=null,Qf(f,w)));break;case 22:w&512&&(qe||b===null||As(b,b.return)),R=f.memoizedState!==null;var ie=b!==null&&b.memoizedState!==null,ye=Qe,We=qe;if(Qe=ye||R,qe=We||ie,ua(p,f),qe=We,Qe=ye,Aa(f),p=f.stateNode,p._current=f,p._visibility&=-3,p._visibility|=p._pendingVisibility&2,w&8192&&(p._visibility=R?p._visibility&-2:p._visibility|1,R&&(p=Qe||qe,b===null||ie||p||Jf(f)),hs&&(f.memoizedProps===null||f.memoizedProps.mode!=="manual"))){e:if(b=null,hs)for(p=f;;){if(p.tag===5||ks&&p.tag===26||Ms&&p.tag===27){if(b===null){ie=b=p;try{U=ie.stateNode,R?fM(U):qb(ie.stateNode,ie.memoizedProps)}catch(Qt){gi(ie,ie.return,Qt)}}}else if(p.tag===6){if(b===null){ie=p;try{var At=ie.stateNode;R?Zb(At):Kb(At,ie.memoizedProps)}catch(Qt){gi(ie,ie.return,Qt)}}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===f)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===f)break e;for(;p.sibling===null;){if(p.return===null||p.return===f)break e;b===p&&(b=null),p=p.return}b===p&&(b=null),p.sibling.return=p.return,p=p.sibling}}w&4&&(w=f.updateQueue,w!==null&&(b=w.retryQueue,b!==null&&(w.retryQueue=null,Qf(f,b))));break;case 19:ua(p,f),Aa(f),w&4&&(w=f.updateQueue,w!==null&&(f.updateQueue=null,Qf(f,w)));break;case 21:break;default:ua(p,f),Aa(f)}}function Aa(f){var p=f.flags;if(p&2){try{if(hs&&(!Ms||f.tag!==27)){e:{for(var b=f.return;b!==null;){if(pb(b)){var w=b;break e}b=b.return}throw Error(r(160))}switch(w.tag){case 27:if(Ms){var R=w.stateNode,U=Dd(f);Dm(f,U,R);break}case 5:var ie=w.stateNode;w.flags&32&&(Yb(ie),w.flags&=-33);var ye=Dd(f);Dm(f,ye,ie);break;case 3:case 4:var We=w.stateNode.containerInfo,At=Dd(f);Pv(f,At,We);break;default:throw Error(r(161))}}}catch(Qt){gi(f,f.return,Qt)}f.flags&=-3}p&4096&&(f.flags&=-4097)}function yb(f){if(f.subtreeFlags&1024)for(f=f.child;f!==null;){var p=f;yb(p),p.tag===5&&p.flags&1024&&dy(p.stateNode),f=f.sibling}}function Dl(f,p){if(p.subtreeFlags&8772)for(p=p.child;p!==null;)gb(f,p.alternate,p),p=p.sibling}function Jf(f){for(f=f.child;f!==null;){var p=f;switch(p.tag){case 0:case 11:case 14:case 15:Cl(4,p,p.return),Jf(p);break;case 1:As(p,p.return);var b=p.stateNode;typeof b.componentWillUnmount=="function"&&Rm(p,p.return,b),Jf(p);break;case 26:case 27:case 5:As(p,p.return),Jf(p);break;case 22:As(p,p.return),p.memoizedState===null&&Jf(p);break;default:Jf(p)}f=f.sibling}}function _u(f,p,b){for(b=b&&(p.subtreeFlags&8772)!==0,p=p.child;p!==null;){var w=p.alternate,R=f,U=p,ie=U.flags;switch(U.tag){case 0:case 11:case 15:_u(R,U,b),Kf(4,U);break;case 1:if(_u(R,U,b),w=U,R=w.stateNode,typeof R.componentDidMount=="function")try{R.componentDidMount()}catch(At){gi(w,w.return,At)}if(w=U,R=w.updateQueue,R!==null){var ye=w.stateNode;try{var We=R.shared.hiddenCallbacks;if(We!==null)for(R.shared.hiddenCallbacks=null,R=0;R<We.length;R++)be(We[R],ye)}catch(At){gi(w,w.return,At)}}b&&ie&64&&Sc(U),Rl(U,U.return);break;case 26:case 27:case 5:_u(R,U,b),b&&w===null&&ie&4&&hb(U),Rl(U,U.return);break;case 12:_u(R,U,b);break;case 13:_u(R,U,b),b&&ie&4&&zm(R,U);break;case 22:U.memoizedState===null&&_u(R,U,b),Rl(U,U.return);break;default:_u(R,U,b)}p=p.sibling}}function Im(f,p){var b=null;f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),f=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(f=p.memoizedState.cachePool.pool),f!==b&&(f!=null&&f.refCount++,b!=null&&Ad(b))}function Ec(f,p){f=null,p.alternate!==null&&(f=p.alternate.memoizedState.cache),p=p.memoizedState.cache,p!==f&&(p.refCount++,f!=null&&Ad(f))}function bu(f,p,b,w){if(p.subtreeFlags&10256)for(p=p.child;p!==null;)Od(f,p,b,w),p=p.sibling}function Od(f,p,b,w){var R=p.flags;switch(p.tag){case 0:case 11:case 15:bu(f,p,b,w),R&2048&&Kf(9,p);break;case 3:bu(f,p,b,w),R&2048&&(f=null,p.alternate!==null&&(f=p.alternate.memoizedState.cache),p=p.memoizedState.cache,p!==f&&(p.refCount++,f!=null&&Ad(f)));break;case 12:if(R&2048){bu(f,p,b,w),f=p.stateNode;try{var U=p.memoizedProps,ie=U.id,ye=U.onPostCommit;typeof ye=="function"&&ye(ie,p.alternate===null?"mount":"update",f.passiveEffectDuration,-0)}catch(We){gi(p,p.return,We)}}else bu(f,p,b,w);break;case 23:break;case 22:U=p.stateNode,p.memoizedState!==null?U._visibility&4?bu(f,p,b,w):Go(f,p):U._visibility&4?bu(f,p,b,w):(U._visibility|=4,Ts(f,p,b,w,(p.subtreeFlags&10256)!==0)),R&2048&&Im(p.alternate,p);break;case 24:bu(f,p,b,w),R&2048&&Ec(p.alternate,p);break;default:bu(f,p,b,w)}}function Ts(f,p,b,w,R){for(R=R&&(p.subtreeFlags&10256)!==0,p=p.child;p!==null;){var U=f,ie=p,ye=b,We=w,At=ie.flags;switch(ie.tag){case 0:case 11:case 15:Ts(U,ie,ye,We,R),Kf(8,ie);break;case 23:break;case 22:var Qt=ie.stateNode;ie.memoizedState!==null?Qt._visibility&4?Ts(U,ie,ye,We,R):Go(U,ie):(Qt._visibility|=4,Ts(U,ie,ye,We,R)),R&&At&2048&&Im(ie.alternate,ie);break;case 24:Ts(U,ie,ye,We,R),R&&At&2048&&Ec(ie.alternate,ie);break;default:Ts(U,ie,ye,We,R)}p=p.sibling}}function Go(f,p){if(p.subtreeFlags&10256)for(p=p.child;p!==null;){var b=f,w=p,R=w.flags;switch(w.tag){case 22:Go(b,w),R&2048&&Im(w.alternate,w);break;case 24:Go(b,w),R&2048&&Ec(w.alternate,w);break;default:Go(b,w)}p=p.sibling}}function Su(f){if(f.subtreeFlags&$t)for(f=f.child;f!==null;)Bv(f),f=f.sibling}function Bv(f){switch(f.tag){case 26:Su(f),f.flags&$t&&(f.memoizedState!==null?xM(Kt,f.memoizedState,f.memoizedProps):fy(f.type,f.memoizedProps));break;case 5:Su(f),f.flags&$t&&fy(f.type,f.memoizedProps);break;case 3:case 4:if(ks){var p=Kt;Kt=zc(f.stateNode.containerInfo),Su(f),Kt=p}else Su(f);break;case 22:f.memoizedState===null&&(p=f.alternate,p!==null&&p.memoizedState!==null?(p=$t,$t=16777216,Su(f),$t=p):Su(f));break;default:Su(f)}}function kv(f){var p=f.alternate;if(p!==null&&(f=p.child,f!==null)){p.child=null;do p=f.sibling,f.sibling=null,f=p;while(f!==null)}}function $f(f){var p=f.deletions;if(f.flags&16){if(p!==null)for(var b=0;b<p.length;b++){var w=p[b];Jt=w,xb(w,f)}kv(f)}if(f.subtreeFlags&10256)for(f=f.child;f!==null;)Fv(f),f=f.sibling}function Fv(f){switch(f.tag){case 0:case 11:case 15:$f(f),f.flags&2048&&Cl(9,f,f.return);break;case 3:$f(f);break;case 12:$f(f);break;case 22:var p=f.stateNode;f.memoizedState!==null&&p._visibility&4&&(f.return===null||f.return.tag!==13)?(p._visibility&=-5,Ud(f)):$f(f);break;default:$f(f)}}function Ud(f){var p=f.deletions;if(f.flags&16){if(p!==null)for(var b=0;b<p.length;b++){var w=p[b];Jt=w,xb(w,f)}kv(f)}for(f=f.child;f!==null;){switch(p=f,p.tag){case 0:case 11:case 15:Cl(8,p,p.return),Ud(p);break;case 22:b=p.stateNode,b._visibility&4&&(b._visibility&=-5,Ud(p));break;default:Ud(p)}f=f.sibling}}function xb(f,p){for(;Jt!==null;){var b=Jt;switch(b.tag){case 0:case 11:case 15:Cl(8,b,p);break;case 23:case 22:if(b.memoizedState!==null&&b.memoizedState.cachePool!==null){var w=b.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:Ad(b.memoizedState.cache)}if(w=b.child,w!==null)w.return=b,Jt=w;else e:for(b=f;Jt!==null;){w=Jt;var R=w.sibling,U=w.return;if(Om(w),w===b){Jt=null;break e}if(R!==null){R.return=U,Jt=R;break e}Jt=U}}}function Eu(f){var p=ly(f);if(p!=null){if(typeof p.memoizedProps["data-testname"]!="string")throw Error(r(364));return p}if(f=Zm(f),f===null)throw Error(r(362));return f.stateNode.current}function Yr(f,p){var b=f.tag;switch(p.$$typeof){case fi:if(f.type===p.value)return!0;break;case Ur:e:{for(p=p.value,f=[f,0],b=0;b<f.length;){var w=f[b++],R=w.tag,U=f[b++],ie=p[U];if(R!==5&&R!==26&&R!==27||!vo(w)){for(;ie!=null&&Yr(w,ie);)U++,ie=p[U];if(U===p.length){p=!0;break e}else for(w=w.child;w!==null;)f.push(w,U),w=w.sibling}}p=!1}return p;case Wo:if((b===5||b===26||b===27)&&Hd(f.stateNode,p.value))return!0;break;case Ma:if((b===5||b===6||b===26||b===27)&&(f=Vd(f),f!==null&&0<=f.indexOf(p.value)))return!0;break;case Wa:if((b===5||b===26||b===27)&&(f=f.memoizedProps["data-testname"],typeof f=="string"&&f.toLowerCase()===p.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Lm(f){switch(f.$$typeof){case fi:return"<"+(a(f.value)||"Unknown")+">";case Ur:return":has("+(Lm(f)||"")+")";case Wo:return'[role="'+f.value+'"]';case Ma:return'"'+f.value+'"';case Wa:return'[data-testname="'+f.value+'"]';default:throw Error(r(365))}}function Gv(f,p){var b=[];f=[f,0];for(var w=0;w<f.length;){var R=f[w++],U=R.tag,ie=f[w++],ye=p[ie];if(U!==5&&U!==26&&U!==27||!vo(R)){for(;ye!=null&&Yr(R,ye);)ie++,ye=p[ie];if(ie===p.length)b.push(R);else for(R=R.child;R!==null;)f.push(R,ie),R=R.sibling}}return b}function Ol(f,p){if(!oh)throw Error(r(363));f=Eu(f),f=Gv(f,p),p=[],f=Array.from(f);for(var b=0;b<f.length;){var w=f[b++],R=w.tag;if(R===5||R===26||R===27)vo(w)||p.push(w.stateNode);else for(w=w.child;w!==null;)f.push(w),w=w.sibling}return p}function ca(){if(Bi&2&&Wn!==0)return Wn&-Wn;if(Pn.T!==null){var f=St;return f!==0?f:ct()}return jb()}function Vv(){Xo===0&&(Xo=!(Wn&536870912)||ht?O():536870912);var f=Si.current;return f!==null&&(f.flags|=32),Xo}function Ks(f,p,b){(f===hi&&qi===2||f.cancelPendingCommit!==null)&&(wc(f,0),Vo(f,Wn,Xo,!1)),P(f,b),(!(Bi&2)||f!==hi)&&(f===hi&&(!(Bi&2)&&(Kd|=b),qr===4&&Vo(f,Wn,Xo,!1)),ke(f))}function _b(f,p,b){if(Bi&6)throw Error(r(327));var w=!b&&(p&60)===0&&(p&f.expiredLanes)===0||T(f,p),R=w?Tb(f,p):Nm(f,p,!0),U=w;do{if(R===0){kl&&!w&&Vo(f,p,0,!1);break}else if(R===6)Vo(f,p,0,!Ya);else{if(b=f.current.alternate,U&&!jv(b)){R=Nm(f,p,!1),U=!1;continue}if(R===2){if(U=p,f.errorRecoveryDisabledLanes&U)var ie=0;else ie=f.pendingLanes&-536870913,ie=ie!==0?ie:ie&536870912?536870912:0;if(ie!==0){p=ie;e:{var ye=f;R=Cy;var We=Ta&&ye.current.memoizedState.isDehydrated;if(We&&(wc(ye,ie).flags|=256),ie=Nm(ye,ie,!1),ie!==2){if(TM&&!We){ye.errorRecoveryDisabledLanes|=U,Kd|=U,R=4;break e}U=Uu,Uu=R,U!==null&&Hv(U)}R=ie}if(U=!1,R!==2)continue}}if(R===1){wc(f,0),Vo(f,p,0,!0);break}e:{switch(w=f,R){case 0:case 1:throw Error(r(345));case 4:if((p&4194176)===p){Vo(w,p,Xo,!Ya);break e}break;case 2:Uu=null;break;case 3:case 5:break;default:throw Error(r(329))}if(w.finishedWork=b,w.finishedLanes=p,(p&62914560)===p&&(U=RM+300-yo(),10<U)){if(Vo(w,p,Xo,!Ya),A(w,0)!==0)break e;w.timeoutHandle=Gb(bb.bind(null,w,b,Uu,uS,CM,p,Xo,Kd,fg,Ya,2,-0,0),U);break e}bb(w,b,Uu,uS,CM,p,Xo,Kd,fg,Ya,0,-0,0)}}break}while(!0);ke(f)}function Hv(f){Uu===null?Uu=f:Uu.push.apply(Uu,f)}function bb(f,p,b,w,R,U,ie,ye,We,At,Qt,cn,gn){var ii=p.subtreeFlags;if((ii&8192||(ii&16785408)===16785408)&&(Xb(),Bv(p),p=hy(),p!==null)){f.cancelPendingCommit=p(ja.bind(null,f,b,w,R,ie,ye,We,1,cn,gn)),Vo(f,U,ie,!At);return}ja(f,b,w,R,ie,ye,We,Qt,cn,gn)}function jv(f){for(var p=f;;){var b=p.tag;if((b===0||b===11||b===15)&&p.flags&16384&&(b=p.updateQueue,b!==null&&(b=b.stores,b!==null)))for(var w=0;w<b.length;w++){var R=b[w],U=R.getSnapshot;R=R.value;try{if(!pa(U(),R))return!1}catch{return!1}}if(b=p.child,p.subtreeFlags&16384&&b!==null)b.return=p,p=b;else{if(p===f)break;for(;p.sibling===null;){if(p.return===null||p.return===f)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Vo(f,p,b,w){p&=~MM,p&=~Kd,f.suspendedLanes|=p,f.pingedLanes&=~p,w&&(f.warmLanes|=p),w=f.expirationTimes;for(var R=p;0<R;){var U=31-ha(R),ie=1<<U;w[U]=-1,R&=~ie}b!==0&&G(f,b,p)}function Sb(){return Bi&6?!0:(Z(0),!1)}function Pm(){if(Kn!==null){if(qi===0)var f=Kn.return;else f=Kn,de=me=null,hu(f),In=null,Ui=0,f=Kn;for(;f!==null;)Lv(f.alternate,f),f=f.return;Kn=null}}function wc(f,p){f.finishedWork=null,f.finishedLanes=0;var b=f.timeoutHandle;b!==Xm&&(f.timeoutHandle=Xm,Vb(b)),b=f.cancelPendingCommit,b!==null&&(f.cancelPendingCommit=null,b()),Pm(),hi=f,Kn=b=wu(f.current,null),Wn=p,qi=0,ir=null,Ya=!1,kl=T(f,p),TM=!1,fg=Xo=MM=Kd=mh=qr=0,Uu=Cy=null,CM=!1,p&8&&(p|=p&32);var w=f.entangledLanes;if(w!==0)for(f=f.entanglements,w&=p;0<w;){var R=31-ha(w),U=1<<R;p|=f[R],w&=~U}return Pc=p,K(),b}function Eb(f,p){Rn=null,Pn.H=ue,p===kt?(p=vn(),qi=3):p===jt?(p=vn(),qi=4):qi=p===J?8:p!==null&&typeof p=="object"&&typeof p.then=="function"?6:1,ir=p,Kn===null&&(qr=1,ho(f,X(p,f.current)))}function zd(){var f=Si.current;return f===null?!0:(Wn&4194176)===Wn?zi===null:(Wn&62914560)===Wn||Wn&536870912?f===zi:!1}function wb(){var f=Pn.H;return Pn.H=ue,f===null?ue:f}function Ul(){var f=Pn.A;return Pn.A=Sn,f}function eh(){qr=4,Ya||(Wn&4194176)!==Wn&&Si.current!==null||(kl=!0),!(mh&134217727)&&!(Kd&134217727)||hi===null||Vo(hi,Wn,Xo,!1)}function Nm(f,p,b){var w=Bi;Bi|=2;var R=wb(),U=Ul();(hi!==f||Wn!==p)&&(uS=null,wc(f,p)),p=!1;var ie=qr;e:do try{if(qi!==0&&Kn!==null){var ye=Kn,We=ir;switch(qi){case 8:Pm(),ie=6;break e;case 3:case 2:case 6:Si.current===null&&(p=!0);var At=qi;if(qi=0,ir=null,Ac(f,ye,We,At),b&&kl){ie=0;break e}break;default:At=qi,qi=0,ir=null,Ac(f,ye,We,At)}}Ab(),ie=qr;break}catch(Qt){Eb(f,Qt)}while(!0);return p&&f.shellSuspendCounter++,de=me=null,Bi=w,Pn.H=R,Pn.A=U,Kn===null&&(hi=null,Wn=0,K()),ie}function Ab(){for(;Kn!==null;)Wv(Kn)}function Tb(f,p){var b=Bi;Bi|=2;var w=wb(),R=Ul();hi!==f||Wn!==p?(uS=null,Ry=yo()+500,wc(f,p)):kl=T(f,p);e:do try{if(qi!==0&&Kn!==null){p=Kn;var U=ir;t:switch(qi){case 1:qi=0,ir=null,Ac(f,p,U,1);break;case 2:if(Et(U)){qi=0,ir=null,Xv(p);break}p=function(){qi===2&&hi===f&&(qi=7),ke(f)},U.then(p,p);break e;case 3:qi=7;break e;case 4:qi=5;break e;case 7:Et(U)?(qi=0,ir=null,Xv(p)):(qi=0,ir=null,Ac(f,p,U,7));break;case 5:var ie=null;switch(Kn.tag){case 26:ie=Kn.memoizedState;case 5:case 27:var ye=Kn,We=ye.type,At=ye.pendingProps;if(ie?wy(ie):Ym(We,At)){qi=0,ir=null;var Qt=ye.sibling;if(Qt!==null)Kn=Qt;else{var cn=ye.return;cn!==null?(Kn=cn,Id(cn)):Kn=null}break t}}qi=0,ir=null,Ac(f,p,U,5);break;case 6:qi=0,ir=null,Ac(f,p,U,6);break;case 8:Pm(),qr=6;break e;default:throw Error(r(462))}}Mb();break}catch(gn){Eb(f,gn)}while(!0);return de=me=null,Pn.H=w,Pn.A=R,Bi=b,Kn!==null?0:(hi=null,Wn=0,K(),qr)}function Mb(){for(;Kn!==null&&!_M();)Wv(Kn)}function Wv(f){var p=po(f.alternate,f,Pc);f.memoizedProps=f.pendingProps,p===null?Id(f):Kn=p}function Xv(f){var p=f,b=p.alternate;switch(p.tag){case 15:case 0:p=Yf(b,p,p.pendingProps,p.type,void 0,Wn);break;case 11:p=Yf(b,p,p.pendingProps,p.type.render,p.ref,Wn);break;case 5:hu(p);default:Lv(b,p),p=Kn=Ib(p,Pc),p=po(b,p,Pc)}f.memoizedProps=f.pendingProps,p===null?Id(f):Kn=p}function Ac(f,p,b,w){de=me=null,hu(p),In=null,Ui=0;var R=p.return;try{if(Tv(f,R,p,b,Wn)){qr=1,ho(f,X(b,f.current)),Kn=null;return}}catch(U){if(R!==null)throw Kn=R,U;qr=1,ho(f,X(b,f.current)),Kn=null;return}p.flags&32768?(ht||w===1?f=!0:kl||Wn&536870912?f=!1:(Ya=f=!0,(w===2||w===3||w===6)&&(w=Si.current,w!==null&&w.tag===13&&(w.flags|=16384))),Yv(p,f)):Id(p)}function Id(f){var p=f;do{if(p.flags&32768){Yv(p,Ya);return}f=p.return;var b=cb(p.alternate,p,Pc);if(b!==null){Kn=b;return}if(p=p.sibling,p!==null){Kn=p;return}Kn=p=f}while(p!==null);qr===0&&(qr=5)}function Yv(f,p){do{var b=fb(f.alternate,f);if(b!==null){b.flags&=32767,Kn=b;return}if(b=f.return,b!==null&&(b.flags|=32768,b.subtreeFlags=0,b.deletions=null),!p&&(f=f.sibling,f!==null)){Kn=f;return}Kn=f=b}while(f!==null);qr=6,Kn=null}function ja(f,p,b,w,R,U,ie,ye,We,At){var Qt=Pn.T,cn=Tu();try{Bs(2),Pn.T=null,Cb(f,p,b,w,cn,R,U,ie,ye,We,At)}finally{Pn.T=Qt,Bs(cn)}}function Cb(f,p,b,w,R,U,ie,ye){do Qs();while(Qd!==null);if(Bi&6)throw Error(r(327));var We=f.finishedWork;if(w=f.finishedLanes,We===null)return null;if(f.finishedWork=null,f.finishedLanes=0,We===f.current)throw Error(r(177));f.callbackNode=null,f.callbackPriority=0,f.cancelPendingCommit=null;var At=We.lanes|We.childLanes;if(At|=Wt,F(f,w,At,U,ie,ye),f===hi&&(Kn=hi=null,Wn=0),!(We.subtreeFlags&10256)&&!(We.flags&10256)||cS||(cS=!0,DM=At,OM=b,zb(My,function(){return Qs(),null})),b=(We.flags&15990)!==0,We.subtreeFlags&15990||b?(b=Pn.T,Pn.T=null,U=Tu(),Bs(2),ie=Bi,Bi|=4,Nv(f,We),vb(We,f),sy(f.containerInfo),f.current=We,gb(f,We.alternate,We),bM(),Bi=ie,Bs(U),Pn.T=b):f.current=We,cS?(cS=!1,Qd=f,Dy=w):Rb(f,At),At=f.pendingLanes,At===0&&(gh=null),N(We.stateNode),ke(f),p!==null)for(R=f.onRecoverableError,We=0;We<p.length;We++)At=p[We],R(At.value,{componentStack:At.stack});return Dy&3&&Qs(),At=f.pendingLanes,w&4194218&&At&42?f===UM?Oy++:(Oy=0,UM=f):Oy=0,Z(0),null}function Rb(f,p){(f.pooledCacheLanes&=p)===0&&(p=f.pooledCache,p!=null&&(f.pooledCache=null,Ad(p)))}function Qs(){if(Qd!==null){var f=Qd,p=DM;DM=0;var b=Y(Dy),w=32>b?32:b;b=Pn.T;var R=Tu();try{if(Bs(w),Pn.T=null,Qd===null)var U=!1;else{w=OM,OM=null;var ie=Qd,ye=Dy;if(Qd=null,Dy=0,Bi&6)throw Error(r(331));var We=Bi;if(Bi|=4,Fv(ie.current),Od(ie,ie.current,ye,w),Bi=We,Z(0,!1),da&&typeof da.onPostCommitFiberRoot=="function")try{da.onPostCommitFiberRoot(dh,ie)}catch{}U=!0}return U}finally{Bs(R),Pn.T=b,Rb(f,p)}}return!1}function Bm(f,p,b){p=X(b,p),p=Al(f.stateNode,p,2),f=Ht(f,p,2),f!==null&&(P(f,2),ke(f))}function gi(f,p,b){if(f.tag===3)Bm(f,f,b);else for(;p!==null;){if(p.tag===3){Bm(p,f,b);break}else if(p.tag===1){var w=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(gh===null||!gh.has(w))){f=X(b,f),b=Xf(2),w=Ht(p,b,2),w!==null&&(Ps(b,w,p,f),P(w,2),ke(w));break}}p=p.return}}function th(f,p,b){var w=f.pingCache;if(w===null){w=f.pingCache=new Lc;var R=new Set;w.set(p,R)}else R=w.get(p),R===void 0&&(R=new Set,w.set(p,R));R.has(b)||(TM=!0,R.add(b),f=Db.bind(null,f,p,b),p.then(f,f))}function Db(f,p,b){var w=f.pingCache;w!==null&&w.delete(p),f.pingedLanes|=f.suspendedLanes&b,f.warmLanes&=~b,hi===f&&(Wn&b)===b&&(qr===4||qr===3&&(Wn&62914560)===Wn&&300>yo()-RM?!(Bi&2)&&wc(f,0):MM|=b,fg===Wn&&(fg=0)),ke(f)}function Zv(f,p){p===0&&(p=M()),f=Ve(f,p),f!==null&&(P(f,p),ke(f))}function Ob(f){var p=f.memoizedState,b=0;p!==null&&(b=p.retryLane),Zv(f,b)}function Ub(f,p){var b=0;switch(f.tag){case 13:var w=f.stateNode,R=f.memoizedState;R!==null&&(b=R.retryLane);break;case 19:w=f.stateNode;break;case 22:w=f.stateNode._retryCache;break;default:throw Error(r(314))}w!==null&&w.delete(p),Zv(f,b)}function zb(f,p){return qd(f,p)}function iM(f,p,b,w){this.tag=f,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qv(f){return f=f.prototype,!(!f||!f.isReactComponent)}function wu(f,p){var b=f.alternate;return b===null?(b=n(f.tag,p,f.key,f.mode),b.elementType=f.elementType,b.type=f.type,b.stateNode=f.stateNode,b.alternate=f,f.alternate=b):(b.pendingProps=p,b.type=f.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=f.flags&31457280,b.childLanes=f.childLanes,b.lanes=f.lanes,b.child=f.child,b.memoizedProps=f.memoizedProps,b.memoizedState=f.memoizedState,b.updateQueue=f.updateQueue,p=f.dependencies,b.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},b.sibling=f.sibling,b.index=f.index,b.ref=f.ref,b.refCleanup=f.refCleanup,b}function Ib(f,p){f.flags&=31457282;var b=f.alternate;return b===null?(f.childLanes=0,f.lanes=p,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=b.childLanes,f.lanes=b.lanes,f.child=b.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=b.memoizedProps,f.memoizedState=b.memoizedState,f.updateQueue=b.updateQueue,f.type=b.type,p=b.dependencies,f.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext}),f}function km(f,p,b,w,R,U){var ie=0;if(w=f,typeof f=="function")qv(f)&&(ie=1);else if(typeof f=="string")ie=ks&&Ms?og(f,b,He.current)?26:Pl(f)?27:5:ks?og(f,b,He.current)?26:5:Ms&&Pl(f)?27:5;else e:switch(f){case ih:return Tc(b.children,R,U,p);case Mc:ie=8,R|=24;break;case Jv:return f=n(12,b,p,R|2),f.elementType=Jv,f.lanes=U,f;case Pd:return f=n(13,b,p,R),f.elementType=Pd,f.lanes=U,f;case ey:return f=n(19,b,p,R),f.elementType=ey,f.lanes=U,f;case kb:return Lb(b,R,U,p);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case oM:case mo:ie=10;break e;case $v:ie=9;break e;case jm:ie=11;break e;case Wm:ie=14;break e;case Au:ie=16,w=null;break e}ie=29,b=Error(r(130,f===null?"null":typeof f,"")),w=null}return p=n(ie,b,p,R),p.elementType=f,p.type=w,p.lanes=U,p}function Tc(f,p,b,w){return f=n(7,f,w,p),f.lanes=b,f}function Lb(f,p,b,w){f=n(22,f,w,p),f.elementType=kb,f.lanes=b;var R={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var U=R._current;if(U===null)throw Error(r(456));if(!(R._pendingVisibility&2)){var ie=Ve(U,2);ie!==null&&(R._pendingVisibility|=2,Ks(ie,U,2))}},attach:function(){var U=R._current;if(U===null)throw Error(r(456));if(R._pendingVisibility&2){var ie=Ve(U,2);ie!==null&&(R._pendingVisibility&=-3,Ks(ie,U,2))}}};return f.stateNode=R,f}function Fm(f,p,b){return f=n(6,f,null,p),f.lanes=b,f}function Gm(f,p,b){return p=n(4,f.children!==null?f.children:[],f.key,p),p.lanes=b,p.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},p}function rM(f,p,b,w,R,U,ie,ye){this.tag=1,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Xm,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=D(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=D(0),this.hiddenUpdates=D(null),this.identifierPrefix=w,this.onUncaughtError=R,this.onCaughtError=U,this.onRecoverableError=ie,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ye,this.incompleteTransitions=new Map}function Pb(f,p,b,w,R,U,ie,ye,We,At,Qt,cn){return f=new rM(f,p,b,ie,ye,We,At,cn),p=1,U===!0&&(p|=24),U=n(3,null,null,p),f.current=U,U.stateNode=f,p=zv(),p.refCount++,f.pooledCache=p,p.refCount++,U.memoizedState={element:w,isDehydrated:b,cache:p},vt(U),f}function Vm(f){return f?(f=Nl,f):Nl}function Ld(f){var p=f._reactInternals;if(p===void 0)throw typeof f.render=="function"?Error(r(188)):(f=Object.keys(f).join(","),Error(r(268,f)));return f=m(p),f=f!==null?v(f):null,f===null?null:sh(f.stateNode)}function Nb(f,p,b,w,R,U){R=Vm(R),w.context===null?w.context=R:w.pendingContext=R,w=Bt(p),w.payload={element:b},U=U===void 0?null:U,U!==null&&(w.callback=U),b=Ht(f,w,p),b!==null&&(Ks(b,f,p),ut(b,f,p))}function Bb(f,p){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var b=f.retryLane;f.retryLane=b!==0&&b<p?b:p}}function Kv(f,p){Bb(f,p),(f=f.alternate)&&Bb(f,p)}var pi={},sM=V,fa=oD,Qv=Object.assign,aM=Symbol.for("react.element"),Hm=Symbol.for("react.transitional.element"),nh=Symbol.for("react.portal"),ih=Symbol.for("react.fragment"),Mc=Symbol.for("react.strict_mode"),Jv=Symbol.for("react.profiler"),oM=Symbol.for("react.provider"),$v=Symbol.for("react.consumer"),mo=Symbol.for("react.context"),jm=Symbol.for("react.forward_ref"),Pd=Symbol.for("react.suspense"),ey=Symbol.for("react.suspense_list"),Wm=Symbol.for("react.memo"),Au=Symbol.for("react.lazy"),kb=Symbol.for("react.offscreen"),lM=Symbol.for("react.memo_cache_sentinel"),Fb=Symbol.iterator,uM=Symbol.for("react.client.reference"),Pn=sM.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ty,Nd,ny=!1,zl=Array.isArray,rh=e.rendererVersion,cM=e.rendererPackageName,Cc=e.extraDevToolsConfig,sh=e.getPublicInstance,ah=e.getRootHostContext,iy=e.getChildHostContext,ry=e.prepareForCommit,sy=e.resetAfterCommit,ay=e.createInstance,Bd=e.appendInitialChild,kd=e.finalizeInitialChildren,Fd=e.shouldSetTextContent,oy=e.createTextInstance,Gb=e.scheduleTimeout,Vb=e.cancelTimeout,Xm=e.noTimeout,go=e.isPrimaryRenderer;e.warnsIfNotActing;var hs=e.supportsMutation,Il=e.supportsPersistence,Ta=e.supportsHydration,ly=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var Hb=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Bs=e.setCurrentUpdatePriority,Tu=e.getCurrentUpdatePriority,jb=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var uy=e.shouldAttemptEagerTransition,cy=e.detachDeletedInstance;e.requestPostPaintCallback;var Wb=e.maySuspendCommit,Ym=e.preloadInstance,Xb=e.startSuspendingCommit,fy=e.suspendInstance,hy=e.waitForCommitToBeReady,Rc=e.NotPendingTransition,Mu=e.HostTransitionContext,dy=e.resetFormInstance;e.bindToConsole;var py=e.supportsMicrotasks,Gd=e.scheduleMicrotask,oh=e.supportsTestSelectors,Zm=e.findFiberRoot,Ll=e.getBoundingRect,Vd=e.getTextContent,vo=e.isHiddenSubtree,Hd=e.matchAccessibilityRole,jd=e.setFocusIfFocusable,Dc=e.setupIntersectionObserver,Oc=e.appendChild,Uc=e.appendChildToContainer,qm=e.commitTextUpdate,Km=e.commitMount,Wd=e.commitUpdate,my=e.insertBefore,gy=e.insertInContainerBefore,lh=e.removeChild,uh=e.removeChildFromContainer,Yb=e.resetTextContent,fM=e.hideInstance,Zb=e.hideTextInstance,qb=e.unhideInstance,Kb=e.unhideTextInstance,hM=e.clearContainer,ch=e.cloneInstance,Qm=e.createContainerChildSet,Qb=e.appendChildToContainerChildSet,dM=e.finalizeContainerChildren,vy=e.replaceContainerChildren,Jb=e.cloneHiddenInstance,$b=e.cloneHiddenTextInstance,yy=e.isSuspenseInstancePending,xy=e.isSuspenseInstanceFallback,pM=e.getSuspenseInstanceFallbackErrorDetails,mM=e.registerSuspenseInstanceRetry,gM=e.canHydrateFormStateMarker,vM=e.isFormStateMarkerMatching,eS=e.getNextHydratableSibling,tS=e.getFirstHydratableChild,_y=e.getFirstHydratableChildWithinContainer,Jm=e.getFirstHydratableChildWithinSuspenseInstance,$m=e.canHydrateInstance,eg=e.canHydrateTextInstance,by=e.canHydrateSuspenseInstance,tg=e.hydrateInstance,ng=e.hydrateTextInstance,ig=e.hydrateSuspenseInstance,Sy=e.getNextHydratableInstanceAfterSuspenseInstance,rg=e.commitHydratedContainer,sg=e.commitHydratedSuspenseInstance,ag=e.clearSuspenseBoundary,Xd=e.clearSuspenseBoundaryFromContainer,fh=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var Yd=e.validateHydratableInstance,Zd=e.validateHydratableTextInstance,ks=e.supportsResources,og=e.isHostHoistableType,zc=e.getHoistableRoot,Cu=e.getResource,Ey=e.acquireResource,lg=e.releaseResource,yM=e.hydrateHoistable,nS=e.mountHoistable,iS=e.unmountHoistable,Ru=e.createHoistableInstance,rS=e.prepareToCommitHoistables,sS=e.mayResourceSuspendCommit,wy=e.preloadResource,xM=e.suspendResource,Ms=e.supportsSingletons,aS=e.resolveSingletonInstance,Ho=e.clearSingleton,oS=e.acquireSingletonInstance,hh=e.releaseSingletonInstance,Pl=e.isHostSingletonType,ug=[],Du=-1,Nl={},ha=Math.clz32?Math.clz32:S,Zr=Math.log,Ou=Math.LN2,cr=128,Cs=4194304,qd=fa.unstable_scheduleCallback,Ay=fa.unstable_cancelCallback,_M=fa.unstable_shouldYield,bM=fa.unstable_requestPaint,yo=fa.unstable_now,Ty=fa.unstable_ImmediatePriority,SM=fa.unstable_UserBlockingPriority,My=fa.unstable_NormalPriority,EM=fa.unstable_IdlePriority,wM=fa.log,AM=fa.unstable_setDisableYieldValue,dh=null,da=null,pa=typeof Object.is=="function"?Object.is:j,lS=new WeakMap,ph=[],Ic=0,cg=null,L=0,ee=[],fe=0,Be=null,nt=1,Le="",He=y(null),yt=y(null),mt=y(null),Ct=y(null),xt=null,gt=null,ht=!1,dt=null,bt=!1,Me=Error(r(519)),je=[],wt=0,Wt=0,pt=null,Ft=null,Gt=!1,hn=!1,lt=!1,it=0,Zt=null,Pt=0,St=0,Ut=null,Lt=!1,Cn=!1,Mn=Object.prototype.hasOwnProperty,kt=Error(r(460)),jt=Error(r(474)),yn={then:function(){}},wn=null,In=null,Ui=0,Ai=Ni(!0),jn=Ni(!1),tr=y(null),Ti=y(0),Si=y(null),zi=null,oi=y(0),nr=0,Rn=null,Ln=null,dn=null,Or=!1,ti=!1,pn=!1,Fn=0,qn=0,Hi=null,jo=0,Bl=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},ue={readContext:ws,use:Ee,useCallback:xi,useContext:xi,useEffect:xi,useImperativeHandle:xi,useLayoutEffect:xi,useInsertionEffect:xi,useMemo:xi,useReducer:xi,useRef:xi,useState:xi,useDebugValue:xi,useDeferredValue:xi,useTransition:xi,useSyncExternalStore:xi,useId:xi};ue.useCacheRefresh=xi,ue.useMemoCache=xi,ue.useHostTransitionStatus=xi,ue.useFormState=xi,ue.useActionState=xi,ue.useOptimistic=xi;var Ge={readContext:ws,use:Ee,useCallback:function(f,p){return te().memoizedState=[f,p===void 0?null:p],f},useContext:ws,useEffect:Hf,useImperativeHandle:function(f,p,b){b=b!=null?b.concat([f]):null,is(4194308,4,Sl.bind(null,p,f),b)},useLayoutEffect:function(f,p){return is(4194308,4,f,p)},useInsertionEffect:function(f,p){is(4,2,f,p)},useMemo:function(f,p){var b=te();p=p===void 0?null:p;var w=f();if(pn){k(!0);try{f()}finally{k(!1)}}return b.memoizedState=[w,p],w},useReducer:function(f,p,b){var w=te();if(b!==void 0){var R=b(p);if(pn){k(!0);try{b(p)}finally{k(!1)}}}else R=p;return w.memoizedState=w.baseState=R,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:R},w.queue=f,f=f.dispatch=_m.bind(null,Rn,f),[w.memoizedState,f]},useRef:function(f){var p=te();return f={current:f},p.memoizedState=f},useState:function(f){f=Di(f);var p=f.queue,b=mu.bind(null,Rn,p);return p.dispatch=b,[f.memoizedState,b]},useDebugValue:co,useDeferredValue:function(f,p){var b=te();return mc(b,f,p)},useTransition:function(){var f=Di(!1);return f=xd.bind(null,Rn,f.queue,!0,!1),te().memoizedState=f,[!1,f]},useSyncExternalStore:function(f,p,b){var w=Rn,R=te();if(ht){if(b===void 0)throw Error(r(407));b=b()}else{if(b=p(),hi===null)throw Error(r(349));Wn&60||Dn(w,p,b)}R.memoizedState=b;var U={value:b,getSnapshot:p};return R.queue=U,Hf(ai.bind(null,w,U,f),[f]),w.flags|=2048,qs(9,En.bind(null,w,U,b,p),{destroy:void 0},null),b},useId:function(){var f=te(),p=hi.identifierPrefix;if(ht){var b=Le,w=nt;b=(w&~(1<<32-ha(w)-1)).toString(32)+b,p=":"+p+"R"+b,b=Fn++,0<b&&(p+="H"+b.toString(32)),p+=":"}else b=jo++,p=":"+p+"r"+b.toString(32)+":";return f.memoizedState=p},useCacheRefresh:function(){return te().memoizedState=bd.bind(null,Rn)}};Ge.useMemoCache=Ue,Ge.useHostTransitionStatus=vc,Ge.useFormState=Oi,Ge.useActionState=Oi,Ge.useOptimistic=function(f){var p=te();p.memoizedState=p.baseState=f;var b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return p.queue=b,p=yc.bind(null,Rn,!0,b),b.dispatch=p,[f,p]};var Oe={readContext:ws,use:Ee,useCallback:yd,useContext:ws,useEffect:bl,useImperativeHandle:El,useInsertionEffect:jf,useLayoutEffect:du,useMemo:pu,useReducer:en,useRef:pr,useState:function(){return en(It)},useDebugValue:co,useDeferredValue:function(f,p){var b=we();return Wf(b,Ln.memoizedState,f,p)},useTransition:function(){var f=en(It)[0],p=we().memoizedState;return[typeof f=="boolean"?f:Ke(f),p]},useSyncExternalStore:zn,useId:_d};Oe.useCacheRefresh=Wr,Oe.useMemoCache=Ue,Oe.useHostTransitionStatus=vc,Oe.useFormState=Er,Oe.useActionState=Er,Oe.useOptimistic=function(f,p){var b=we();return ci(b,Ln,f,p)};var Xt={readContext:ws,use:Ee,useCallback:yd,useContext:ws,useEffect:bl,useImperativeHandle:El,useInsertionEffect:jf,useLayoutEffect:du,useMemo:pu,useReducer:fn,useRef:pr,useState:function(){return fn(It)},useDebugValue:co,useDeferredValue:function(f,p){var b=we();return Ln===null?mc(b,f,p):Wf(b,Ln.memoizedState,f,p)},useTransition:function(){var f=fn(It)[0],p=we().memoizedState;return[typeof f=="boolean"?f:Ke(f),p]},useSyncExternalStore:zn,useId:_d};Xt.useCacheRefresh=Wr,Xt.useMemoCache=Ue,Xt.useHostTransitionStatus=vc,Xt.useFormState=wr,Xt.useActionState=wr,Xt.useOptimistic=function(f,p){var b=we();return Ln!==null?ci(b,Ln,f,p):(b.baseState=f,[f,b.queue.dispatch])};var Gn={isMounted:function(f){return(f=f._reactInternals)?h(f)===f:!1},enqueueSetState:function(f,p,b){f=f._reactInternals;var w=ca(),R=Bt(w);R.payload=p,b!=null&&(R.callback=b),p=Ht(f,R,w),p!==null&&(Ks(p,f,w),ut(p,f,w))},enqueueReplaceState:function(f,p,b){f=f._reactInternals;var w=ca(),R=Bt(w);R.tag=1,R.payload=p,b!=null&&(R.callback=b),p=Ht(f,R,w),p!==null&&(Ks(p,f,w),ut(p,f,w))},enqueueForceUpdate:function(f,p){f=f._reactInternals;var b=ca(),w=Bt(b);w.tag=2,p!=null&&(w.callback=p),p=Ht(f,w,b),p!==null&&(Ks(p,f,b),ut(p,f,b))}},ae=typeof reportError=="function"?reportError:function(f){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var p=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof f=="object"&&f!==null&&typeof f.message=="string"?String(f.message):String(f),error:f});if(!window.dispatchEvent(p))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",f);return}console.error(f)},J=Error(r(461)),he=!1,Ae={dehydrated:null,treeContext:null,retryLane:0},Ce=y(null),me=null,de=null,Se=typeof AbortController<"u"?AbortController:function(){var f=[],p=this.signal={aborted:!1,addEventListener:function(b,w){f.push(w)}};this.abort=function(){p.aborted=!0,f.forEach(function(b){return b()})}},le=fa.unstable_scheduleCallback,ce=fa.unstable_NormalPriority,oe={$$typeof:mo,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Ie=Pn.S;Pn.S=function(f,p){typeof p=="object"&&p!==null&&typeof p.then=="function"&&at(f,p),Ie!==null&&Ie(f,p)};var Re=y(null),Qe=!1,qe=!1,zt=!1,bn=typeof WeakSet=="function"?WeakSet:Set,Jt=null,qt=!1,tt=null,Ze=!1,Kt=null,$t=8192,Sn={getCacheForType:function(f){var p=ws(oe),b=p.data.get(f);return b===void 0&&(b=f(),p.data.set(f,b)),b}},fi=0,Ur=1,Wo=2,Wa=3,Ma=4;if(typeof Symbol=="function"&&Symbol.for){var Xa=Symbol.for;fi=Xa("selector.component"),Ur=Xa("selector.has_pseudo_class"),Wo=Xa("selector.role"),Wa=Xa("selector.test_id"),Ma=Xa("selector.text")}var Lc=typeof WeakMap=="function"?WeakMap:Map,Bi=0,hi=null,Kn=null,Wn=0,qi=0,ir=null,Ya=!1,kl=!1,TM=!1,Pc=0,qr=0,mh=0,Kd=0,MM=0,Xo=0,fg=0,Cy=null,Uu=null,CM=!1,RM=0,Ry=1/0,uS=null,gh=null,cS=!1,Qd=null,Dy=0,DM=0,OM=null,Oy=0,UM=null;return pi.attemptContinuousHydration=function(f){if(f.tag===13){var p=Ve(f,67108864);p!==null&&Ks(p,f,67108864),Kv(f,67108864)}},pi.attemptHydrationAtCurrentPriority=function(f){if(f.tag===13){var p=ca(),b=Ve(f,p);b!==null&&Ks(b,f,p),Kv(f,p)}},pi.attemptSynchronousHydration=function(f){switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var p=E(f.pendingLanes);if(p!==0){for(f.pendingLanes|=2,f.entangledLanes|=2;p;){var b=1<<31-ha(p);f.entanglements[1]|=b,p&=~b}ke(f),!(Bi&6)&&(Ry=yo()+500,Z(0))}}break;case 13:p=Ve(f,2),p!==null&&Ks(p,f,2),Sb(),Kv(f,2)}},pi.batchedUpdates=function(f,p){return f(p)},pi.createComponentSelector=function(f){return{$$typeof:fi,value:f}},pi.createContainer=function(f,p,b,w,R,U,ie,ye,We,At){return Pb(f,p,!1,null,b,w,U,ie,ye,We,At,null)},pi.createHasPseudoClassSelector=function(f){return{$$typeof:Ur,value:f}},pi.createHydrationContainer=function(f,p,b,w,R,U,ie,ye,We,At,Qt,cn,gn){return f=Pb(b,w,!0,f,R,U,ye,We,At,Qt,cn,gn),f.context=Vm(null),b=f.current,w=ca(),R=Bt(w),R.callback=p??null,Ht(b,R,w),f.current.lanes=w,P(f,w),ke(f),f},pi.createPortal=function(f,p,b){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nh,key:w==null?null:""+w,children:f,containerInfo:p,implementation:b}},pi.createRoleSelector=function(f){return{$$typeof:Wo,value:f}},pi.createTestNameSelector=function(f){return{$$typeof:Wa,value:f}},pi.createTextSelector=function(f){return{$$typeof:Ma,value:f}},pi.defaultOnCaughtError=function(f){console.error(f)},pi.defaultOnRecoverableError=function(f){ae(f)},pi.defaultOnUncaughtError=function(f){ae(f)},pi.deferredUpdates=function(f){var p=Pn.T,b=Tu();try{return Bs(32),Pn.T=null,f()}finally{Bs(b),Pn.T=p}},pi.discreteUpdates=function(f,p,b,w,R){var U=Pn.T,ie=Tu();try{return Bs(2),Pn.T=null,f(p,b,w,R)}finally{Bs(ie),Pn.T=U,Bi===0&&(Ry=yo()+500)}},pi.findAllNodes=Ol,pi.findBoundingRects=function(f,p){if(!oh)throw Error(r(363));p=Ol(f,p),f=[];for(var b=0;b<p.length;b++)f.push(Ll(p[b]));for(p=f.length-1;0<p;p--){b=f[p];for(var w=b.x,R=w+b.width,U=b.y,ie=U+b.height,ye=p-1;0<=ye;ye--)if(p!==ye){var We=f[ye],At=We.x,Qt=At+We.width,cn=We.y,gn=cn+We.height;if(w>=At&&U>=cn&&R<=Qt&&ie<=gn){f.splice(p,1);break}else if(w!==At||b.width!==We.width||gn<U||cn>ie){if(!(U!==cn||b.height!==We.height||Qt<w||At>R)){At>w&&(We.width+=At-w,We.x=w),Qt<R&&(We.width=R-At),f.splice(p,1);break}}else{cn>U&&(We.height+=cn-U,We.y=U),gn<ie&&(We.height=ie-cn),f.splice(p,1);break}}}return f},pi.findHostInstance=Ld,pi.findHostInstanceWithNoPortals=function(f){return f=m(f),f=f!==null?_(f):null,f===null?null:sh(f.stateNode)},pi.findHostInstanceWithWarning=function(f){return Ld(f)},pi.flushPassiveEffects=Qs,pi.flushSyncFromReconciler=function(f){var p=Bi;Bi|=1;var b=Pn.T,w=Tu();try{if(Bs(2),Pn.T=null,f)return f()}finally{Bs(w),Pn.T=b,Bi=p,!(Bi&6)&&Z(0)}},pi.flushSyncWork=Sb,pi.focusWithin=function(f,p){if(!oh)throw Error(r(363));for(f=Eu(f),p=Gv(f,p),p=Array.from(p),f=0;f<p.length;){var b=p[f++],w=b.tag;if(!vo(b)){if((w===5||w===26||w===27)&&jd(b.stateNode))return!0;for(b=b.child;b!==null;)p.push(b),b=b.sibling}}return!1},pi.getFindAllNodesFailureDescription=function(f,p){if(!oh)throw Error(r(363));var b=0,w=[];f=[Eu(f),0];for(var R=0;R<f.length;){var U=f[R++],ie=U.tag,ye=f[R++],We=p[ye];if((ie!==5&&ie!==26&&ie!==27||!vo(U))&&(Yr(U,We)&&(w.push(Lm(We)),ye++,ye>b&&(b=ye)),ye<p.length))for(U=U.child;U!==null;)f.push(U,ye),U=U.sibling}if(b<p.length){for(f=[];b<p.length;b++)f.push(Lm(p[b]));return`findAllNodes was able to match part of the selector:
  `+(w.join(" > ")+`

No matching component was found for:
  `)+f.join(" > ")}return null},pi.getPublicRootInstance=function(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 27:case 5:return sh(f.child.stateNode);default:return f.child.stateNode}},pi.injectIntoDevTools=function(){var f={bundleType:0,version:rh,rendererPackageName:cM,currentDispatcherRef:Pn,findFiberByHostInstance:ly,reconcilerVersion:"19.0.0"};if(Cc!==null&&(f.rendererConfig=Cc),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")f=!1;else{var p=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(p.isDisabled||!p.supportsFiber)f=!0;else{try{dh=p.inject(f),da=p}catch{}f=!!p.checkDCE}}return f},pi.isAlreadyRendering=function(){return!1},pi.observeVisibleRects=function(f,p,b,w){if(!oh)throw Error(r(363));f=Ol(f,p);var R=Dc(f,b,w).disconnect;return{disconnect:function(){R()}}},pi.shouldError=function(){return null},pi.shouldSuspend=function(){return!1},pi.startHostTransition=function(f,p,b,w){if(f.tag!==5)throw Error(r(476));var R=gc(f).queue;xd(f,R,p,Rc,b===null?i:function(){var U=gc(f).next.queue;return fo(f,U,{},ca()),b(w)})},pi.updateContainer=function(f,p,b,w){var R=p.current,U=ca();return Nb(R,U,f,p,b,w),U},pi.updateContainerSync=function(f,p,b,w){return p.tag===0&&Qs(),Nb(p.current,2,f,p,b,w),2},pi},t.exports.default=t.exports,Object.defineProperty(t.exports,"__esModule",{value:!0})})(Q8);var pie=Q8.exports;K8.exports=pie;var mie=K8.exports;const gie=Lo(mie),vie=t=>typeof t=="object"&&typeof t.then=="function",y2=[];function yie(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;const i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}function xie(t,e=null,n=!1,i={}){e===null&&(e=[t]);for(const s of y2)if(yie(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return i.lifespan&&i.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,i.lifespan)),s.response;if(!n)throw s.promise}const r={keys:e,equal:i.equal,remove:()=>{const s=y2.indexOf(r);s!==-1&&y2.splice(s,1)},promise:(vie(t)?t:t(...e)).then(s=>{r.response=s,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(s=>r.error=s)};if(y2.push(r),!n)throw r.promise}const _ie=(t,e,n)=>xie(t,e,!1,n);function iz(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=e?t.return:t.child;for(;i;){const r=iz(i,e,n);if(r)return r;i=e?null:i.sibling}}function eV(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const rz=eV(V.createContext(null));let tV=class extends V.Component{render(){return V.createElement(rz.Provider,{value:this._reactInternals},this.props.children)}};function nV(){const t=V.useContext(rz);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=V.useId();return V.useMemo(()=>{for(const n of[t,t==null?void 0:t.alternate]){if(!n)continue;const i=iz(n,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(i)return i}},[t,e])}const bie=Symbol.for("react.context"),Sie=t=>t!==null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===bie;function Eie(){const t=nV(),[e]=V.useState(()=>new Map);e.clear();let n=t;for(;n;){const i=n.type;Sie(i)&&i!==rz&&!e.has(i)&&e.set(i,V.use(eV(i))),n=n.return}return e}function wie(){const t=Eie();return V.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>V.createElement(e,null,V.createElement(n.Provider,{...i,value:t.get(n)})),e=>V.createElement(tV,{...e})),[t])}function iV(t){let e=t.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const rV=t=>t&&t.isOrthographicCamera,Aie=t=>t&&t.hasOwnProperty("current"),Tie=t=>t!=null&&(typeof t=="string"||typeof t=="number"||t.isColor),Y_=((t,e)=>typeof window<"u"&&(((t=window.document)==null?void 0:t.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?V.useLayoutEffect:V.useEffect;function sV(t){const e=V.useRef(t);return Y_(()=>void(e.current=t),[t]),e}function Mie(){const t=nV(),e=wie();return V.useMemo(()=>({children:n})=>{const r=!!iz(t,!0,s=>s.type===V.StrictMode)?V.StrictMode:V.Fragment;return B.jsx(r,{children:B.jsx(e,{children:n})})},[t,e])}function Cie({set:t}){return Y_(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}const Rie=(t=>(t=class extends V.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}},t.getDerivedStateFromError=()=>({error:!0}),t))();function aV(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}function Ug(t){var e;return(e=t.__r3f)==null?void 0:e.root.getState()}const Pr={obj:t=>t===Object(t)&&!Pr.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,nul:t=>t===null,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(Pr.str(t)||Pr.num(t)||Pr.boo(t))return t===e;const s=Pr.obj(t);if(s&&i==="reference")return t===e;const a=Pr.arr(t);if(a&&n==="reference")return t===e;if((a||s)&&t===e)return!0;let o;for(o in t)if(!(o in e))return!1;if(s&&n==="shallow"&&i==="shallow"){for(o in r?e:t)if(!Pr.equ(t[o],e[o],{strict:r,objects:"reference"}))return!1}else for(o in r?e:t)if(t[o]!==e[o])return!1;if(Pr.und(o)){if(a&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function Die(t){t.type!=="Scene"&&(t.dispose==null||t.dispose());for(const e in t){const n=t[e];(n==null?void 0:n.type)!=="Scene"&&(n==null||n.dispose==null||n.dispose())}}const oV=["children","key","ref"];function Oie(t){const e={};for(const n in t)oV.includes(n)||(e[n]=t[n]);return e}function jw(t,e,n,i){const r=t;let s=r==null?void 0:r.__r3f;return s||(s={root:e,type:n,parent:null,children:[],props:Oie(i),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=s)),s}function K1(t,e){var n;let i=t[e];if(!e.includes("-"))return{root:t,key:e,target:i};const r=e.split("-");return i=r.reduce((s,a)=>s[a],t),e=r.pop(),(n=i)!=null&&n.set||(t=r.reduce((s,a)=>s[a],t)),{root:t,key:e,target:i}}const CP=/-\d+$/;function Ww(t,e){if(Pr.str(e.props.attach)){if(CP.test(e.props.attach)){const r=e.props.attach.replace(CP,""),{root:s,key:a}=K1(t.object,r);Array.isArray(s[a])||(s[a]=[])}const{root:n,key:i}=K1(t.object,e.props.attach);e.previousAttach=n[i],n[i]=e.object}else Pr.fun(e.props.attach)&&(e.previousAttach=e.props.attach(t.object,e.object))}function Xw(t,e){if(Pr.str(e.props.attach)){const{root:n,key:i}=K1(t.object,e.props.attach),r=e.previousAttach;r===void 0?delete n[i]:n[i]=r}else e.previousAttach==null||e.previousAttach(t.object,e.object);delete e.previousAttach}const lD=[...oV,"args","dispose","attach","object","onUpdate","dispose"],RP=new Map;function Uie(t){let e=RP.get(t.constructor);try{e||(e=new t.constructor,RP.set(t.constructor,e))}catch{}return e}function zie(t,e){const n={};for(const i in e)if(!lD.includes(i)&&!Pr.equ(e[i],t.props[i])){n[i]=e[i];for(const r in e)r.startsWith(`${i}-`)&&(n[r]=e[r])}for(const i in t.props){if(lD.includes(i)||e.hasOwnProperty(i))continue;const{root:r,key:s}=K1(t.object,i);if(r.constructor&&r.constructor.length===0){const a=Uie(r);Pr.und(a)||(n[s]=a[s])}else n[s]=0}return n}const Iie=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Lie=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function sf(t,e){var n;const i=t.__r3f,r=i&&iV(i).getState(),s=i==null?void 0:i.eventCount;for(const o in e){let l=e[o];if(lD.includes(o))continue;if(i&&Lie.test(o)){typeof l=="function"?i.handlers[o]=l:delete i.handlers[o],i.eventCount=Object.keys(i.handlers).length;continue}if(l===void 0)continue;let{root:u,key:c,target:h}=K1(t,o);if(h instanceof j0&&l instanceof j0)h.mask=l.mask;else if(h instanceof nn&&Tie(l))h.set(l);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&typeof h.copy=="function"&&l!=null&&l.constructor&&h.constructor===l.constructor)h.copy(l);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&Array.isArray(l))typeof h.fromArray=="function"?h.fromArray(l):h.set(...l);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&typeof l=="number")typeof h.setScalar=="function"?h.setScalar(l):h.set(l);else{var a;u[c]=l,r&&!r.linear&&Iie.includes(c)&&(a=u[c])!=null&&a.isTexture&&u[c].format===Sa&&u[c].type===ml&&(u[c].colorSpace=xa)}}if(i!=null&&i.parent&&r!=null&&r.internal&&(n=i.object)!=null&&n.isObject3D&&s!==i.eventCount){const o=i.object,l=r.internal.interaction.indexOf(o);l>-1&&r.internal.interaction.splice(l,1),i.eventCount&&o.raycast!==null&&r.internal.interaction.push(o)}return i&&i.props.attach===void 0&&(i.object.isBufferGeometry?i.props.attach="geometry":i.object.isMaterial&&(i.props.attach="material")),i&&yv(i),t}function yv(t){var e;if(!t.parent)return;t.props.onUpdate==null||t.props.onUpdate(t.object);const n=(e=t.root)==null||e.getState==null?void 0:e.getState();n&&n.internal.frames===0&&n.invalidate()}function Pie(t,e){t.manual||(rV(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix())}const to=t=>t==null?void 0:t.isObject3D;function x2(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function lV(t,e,n,i){const r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function Nie(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{lV(n.capturedMap,e,i,r)})}function Bie(t){function e(l){const{internal:u}=t.getState(),c=l.offsetX-u.initialClick[0],h=l.offsetY-u.initialClick[1];return Math.round(Math.sqrt(c*c+h*h))}function n(l){return l.filter(u=>["Move","Over","Enter","Out","Leave"].some(c=>{var h;return(h=u.__r3f)==null?void 0:h.handlers["onPointer"+c]}))}function i(l,u){const c=t.getState(),h=new Set,d=[],m=u?u(c.internal.interaction):c.internal.interaction;for(let g=0;g<m.length;g++){const x=Ug(m[g]);x&&(x.raycaster.camera=void 0)}c.previousRoot||c.events.compute==null||c.events.compute(l,c);function v(g){const x=Ug(g);if(!x||!x.events.enabled||x.raycaster.camera===null)return[];if(x.raycaster.camera===void 0){var S;x.events.compute==null||x.events.compute(l,x,(S=x.previousRoot)==null?void 0:S.getState()),x.raycaster.camera===void 0&&(x.raycaster.camera=null)}return x.raycaster.camera?x.raycaster.intersectObject(g,!0):[]}let _=m.flatMap(v).sort((g,x)=>{const S=Ug(g.object),E=Ug(x.object);return!S||!E?g.distance-x.distance:E.events.priority-S.events.priority||g.distance-x.distance}).filter(g=>{const x=x2(g);return h.has(x)?!1:(h.add(x),!0)});c.events.filter&&(_=c.events.filter(_,c));for(const g of _){let x=g.object;for(;x;){var y;(y=x.__r3f)!=null&&y.eventCount&&d.push({...g,eventObject:x}),x=x.parent}}if("pointerId"in l&&c.internal.capturedMap.has(l.pointerId))for(let g of c.internal.capturedMap.get(l.pointerId).values())h.has(x2(g.intersection))||d.push(g.intersection);return d}function r(l,u,c,h){if(l.length){const d={stopped:!1};for(const m of l){let v=Ug(m.object);if(v||m.object.traverseAncestors(_=>{const y=Ug(_);if(y)return v=y,!1}),v){const{raycaster:_,pointer:y,camera:g,internal:x}=v,S=new re(y.x,y.y,0).unproject(g),E=M=>{var D,P;return(D=(P=x.capturedMap.get(M))==null?void 0:P.has(m.eventObject))!=null?D:!1},A=M=>{const D={intersection:m,target:u.target};x.capturedMap.has(M)?x.capturedMap.get(M).set(m.eventObject,D):x.capturedMap.set(M,new Map([[m.eventObject,D]])),u.target.setPointerCapture(M)},T=M=>{const D=x.capturedMap.get(M);D&&lV(x.capturedMap,m.eventObject,D,M)};let C={};for(let M in u){let D=u[M];typeof D!="function"&&(C[M]=D)}let O={...m,...C,pointer:y,intersections:l,stopped:d.stopped,delta:c,unprojectedPoint:S,ray:_.ray,camera:g,stopPropagation(){const M="pointerId"in u&&x.capturedMap.get(u.pointerId);if((!M||M.has(m.eventObject))&&(O.stopped=d.stopped=!0,x.hovered.size&&Array.from(x.hovered.values()).find(D=>D.eventObject===m.eventObject))){const D=l.slice(0,l.indexOf(m));s([...D,m])}},target:{hasPointerCapture:E,setPointerCapture:A,releasePointerCapture:T},currentTarget:{hasPointerCapture:E,setPointerCapture:A,releasePointerCapture:T},nativeEvent:u};if(h(O),d.stopped===!0)break}}}return l}function s(l){const{internal:u}=t.getState();for(const c of u.hovered.values())if(!l.length||!l.find(h=>h.object===c.object&&h.index===c.index&&h.instanceId===c.instanceId)){const d=c.eventObject.__r3f;if(u.hovered.delete(x2(c)),d!=null&&d.eventCount){const m=d.handlers,v={...c,intersections:l};m.onPointerOut==null||m.onPointerOut(v),m.onPointerLeave==null||m.onPointerLeave(v)}}}function a(l,u){for(let c=0;c<u.length;c++){const h=u[c].__r3f;h==null||h.handlers.onPointerMissed==null||h.handlers.onPointerMissed(l)}}function o(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return u=>{const{internal:c}=t.getState();"pointerId"in u&&c.capturedMap.has(u.pointerId)&&requestAnimationFrame(()=>{c.capturedMap.has(u.pointerId)&&(c.capturedMap.delete(u.pointerId),s([]))})}}return function(c){const{onPointerMissed:h,internal:d}=t.getState();d.lastEvent.current=c;const m=l==="onPointerMove",v=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",y=i(c,m?n:void 0),g=v?e(c):0;l==="onPointerDown"&&(d.initialClick=[c.offsetX,c.offsetY],d.initialHits=y.map(S=>S.eventObject)),v&&!y.length&&g<=2&&(a(c,d.interaction),h&&h(c)),m&&s(y);function x(S){const E=S.eventObject,A=E.__r3f;if(!(A!=null&&A.eventCount))return;const T=A.handlers;if(m){if(T.onPointerOver||T.onPointerEnter||T.onPointerOut||T.onPointerLeave){const C=x2(S),O=d.hovered.get(C);O?O.stopped&&S.stopPropagation():(d.hovered.set(C,S),T.onPointerOver==null||T.onPointerOver(S),T.onPointerEnter==null||T.onPointerEnter(S))}T.onPointerMove==null||T.onPointerMove(S)}else{const C=T[l];C?(!v||d.initialHits.includes(E))&&(a(c,d.interaction.filter(O=>!d.initialHits.includes(O))),C(S)):v&&d.initialHits.includes(E)&&a(c,d.interaction.filter(O=>!d.initialHits.includes(O)))}}r(y,c,g,x)}}return{handlePointer:o}}const DP=t=>!!(t!=null&&t.render),uV=V.createContext(null),kie=(t,e)=>{const n=die((o,l)=>{const u=new re,c=new re,h=new re;function d(g=l().camera,x=c,S=l().size){const{width:E,height:A,top:T,left:C}=S,O=E/A;x.isVector3?h.copy(x):h.set(...x);const M=g.getWorldPosition(u).distanceTo(h);if(rV(g))return{width:E/g.zoom,height:A/g.zoom,top:T,left:C,factor:1,distance:M,aspect:O};{const D=g.fov*Math.PI/180,P=2*Math.tan(D/2)*M,F=P*(E/A);return{width:F,height:P,top:T,left:C,factor:E/F,distance:M,aspect:O}}}let m;const v=g=>o(x=>({performance:{...x.performance,current:g}})),_=new Tt;return{set:o,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(g=1)=>t(l(),g),advance:(g,x)=>e(g,x,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new KU,pointer:_,mouse:_,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const g=l();m&&clearTimeout(m),g.performance.current!==g.performance.min&&v(g.performance.min),m=setTimeout(()=>v(l().performance.max),g.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:g=>o(x=>({...x,events:{...x.events,...g}})),setSize:(g,x,S=0,E=0)=>{const A=l().camera,T={width:g,height:x,top:S,left:E};o(C=>({size:T,viewport:{...C.viewport,...d(A,c,T)}}))},setDpr:g=>o(x=>{const S=aV(g);return{viewport:{...x.viewport,dpr:S,initialDpr:x.viewport.initialDpr||S}}}),setFrameloop:(g="always")=>{const x=l().clock;x.stop(),x.elapsedTime=0,g!=="never"&&(x.start(),x.elapsedTime=0),o(()=>({frameloop:g}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:V.createRef(),active:!1,frames:0,priority:0,subscribe:(g,x,S)=>{const E=l().internal;return E.priority=E.priority+(x>0?1:0),E.subscribers.push({ref:g,priority:x,store:S}),E.subscribers=E.subscribers.sort((A,T)=>A.priority-T.priority),()=>{const A=l().internal;A!=null&&A.subscribers&&(A.priority=A.priority-(x>0?1:0),A.subscribers=A.subscribers.filter(T=>T.ref!==g))}}}}}),i=n.getState();let r=i.size,s=i.viewport.dpr,a=i.camera;return n.subscribe(()=>{const{camera:o,size:l,viewport:u,gl:c,set:h}=n.getState();if(l.width!==r.width||l.height!==r.height||u.dpr!==s){r=l,s=u.dpr,Pie(o,l),u.dpr>0&&c.setPixelRatio(u.dpr);const d=typeof HTMLCanvasElement<"u"&&c.domElement instanceof HTMLCanvasElement;c.setSize(l.width,l.height,d)}o!==a&&(a=o,h(d=>({viewport:{...d.viewport,...d.viewport.getCurrentViewport(o)}})))}),n.subscribe(o=>t(o)),n};function cV(){const t=V.useContext(uV);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function xs(t=n=>n,e){return cV()(t,e)}function DT(t,e=0){const n=cV(),i=n.getState().internal.subscribe,r=sV(t);return Y_(()=>i(r,e,n),[e,i,n]),null}function Fie(t){const e=gie(t);return e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:V.version}),e}const fV=0,Z0={},Gie=/^three(?=[A-Z])/,OT=t=>`${t[0].toUpperCase()}${t.slice(1)}`;let Vie=0;const Hie=t=>typeof t=="function";function hV(t){if(Hie(t)){const e=`${Vie++}`;return Z0[e]=t,e}else Object.assign(Z0,t)}function dV(t,e){const n=OT(t),i=Z0[n];if(t!=="primitive"&&!i)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(t==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function jie(t,e,n){var i;return t=OT(t)in Z0?t:t.replace(Gie,""),dV(t,e),t==="primitive"&&(i=e.object)!=null&&i.__r3f&&delete e.object.__r3f,jw(e.object,n,t,e)}function Wie(t){if(!t.isHidden){var e;t.props.attach&&(e=t.parent)!=null&&e.object?Xw(t.parent,t):to(t.object)&&(t.object.visible=!1),t.isHidden=!0,yv(t)}}function pV(t){if(t.isHidden){var e;t.props.attach&&(e=t.parent)!=null&&e.object?Ww(t.parent,t):to(t.object)&&t.props.visible!==!1&&(t.object.visible=!0),t.isHidden=!1,yv(t)}}function sz(t,e,n){const i=e.root.getState();if(!(!t.parent&&t.object!==i.scene)){if(!e.object){var r,s;const a=Z0[OT(e.type)];e.object=(r=e.props.object)!=null?r:new a(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(sf(e.object,e.props),e.props.attach)Ww(t,e);else if(to(e.object)&&to(t.object)){const a=t.object.children.indexOf(n==null?void 0:n.object);n&&a!==-1?(e.object.parent=t.object,t.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),t.object.dispatchEvent({type:"childadded",child:e.object})):t.object.add(e.object)}for(const a of e.children)sz(e,a);yv(e)}}function i3(t,e){e&&(e.parent=t,t.children.push(e),sz(t,e))}function OP(t,e,n){if(!e||!n)return;e.parent=t;const i=t.children.indexOf(n);i!==-1?t.children.splice(i,0,e):t.children.push(e),sz(t,e,n)}function mV(t){if(typeof t.dispose=="function"){const e=()=>{try{t.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():oD.unstable_scheduleCallback(oD.unstable_IdlePriority,e)}}function uD(t,e,n){if(!e)return;e.parent=null;const i=t.children.indexOf(e);i!==-1&&t.children.splice(i,1),e.props.attach?Xw(t,e):to(e.object)&&to(t.object)&&(t.object.remove(e.object),Nie(iV(e),e.object));const r=e.props.dispose!==null&&n!==!1;for(let s=e.children.length-1;s>=0;s--){const a=e.children[s];uD(e,a,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&mV(e.object),n===void 0&&yv(e)}function Xie(t,e){for(const n of[t,t.alternate])if(n!==null)if(typeof n.ref=="function"){n.refCleanup==null||n.refCleanup();const i=n.ref(e);typeof i=="function"&&(n.refCleanup=i)}else n.ref&&(n.ref.current=e)}const dE=[];function Yie(){for(const[n]of dE){const i=n.parent;if(i){n.props.attach?Xw(i,n):to(n.object)&&to(i.object)&&i.object.remove(n.object);for(const r of n.children)r.props.attach?Xw(n,r):to(r.object)&&to(n.object)&&n.object.remove(r.object)}n.isHidden&&pV(n),n.object.__r3f&&delete n.object.__r3f,n.type!=="primitive"&&mV(n.object)}for(const[n,i,r]of dE){n.props=i;const s=n.parent;if(s){var t,e;const a=Z0[OT(n.type)];n.object=(t=n.props.object)!=null?t:new a(...(e=n.props.args)!=null?e:[]),n.object.__r3f=n,Xie(r,n.object),sf(n.object,n.props),n.props.attach?Ww(s,n):to(n.object)&&to(s.object)&&s.object.add(n.object);for(const o of n.children)o.props.attach?Ww(n,o):to(o.object)&&to(n.object)&&n.object.add(o.object);yv(n)}}dE.length=0}const r3=()=>{},UP={};let _2=fV;const Zie=0,qie=4,cD=Fie({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:jie,removeChild:uD,appendChild:i3,appendInitialChild:i3,insertBefore:OP,appendChildToContainer(t,e){const n=t.getState().scene.__r3f;!e||!n||i3(n,e)},removeChildFromContainer(t,e){const n=t.getState().scene.__r3f;!e||!n||uD(n,e)},insertInContainerBefore(t,e,n){const i=t.getState().scene.__r3f;!e||!n||!i||OP(i,e,n)},getRootHostContext:()=>UP,getChildHostContext:()=>UP,commitUpdate(t,e,n,i,r){var s,a,o;dV(e,i);let l=!1;if((t.type==="primitive"&&n.object!==i.object||((s=i.args)==null?void 0:s.length)!==((a=n.args)==null?void 0:a.length)||(o=i.args)!=null&&o.some((c,h)=>{var d;return c!==((d=n.args)==null?void 0:d[h])}))&&(l=!0),l)dE.push([t,{...i},r]);else{const c=zie(t,i);Object.keys(c).length&&(Object.assign(t.props,c),sf(t.object,c))}(r.sibling===null||(r.flags&qie)===Zie)&&Yie()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:t=>t==null?void 0:t.object,prepareForCommit:()=>null,preparePortalMount:t=>jw(t.getState().scene,t,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:Wie,unhideInstance:pV,createTextInstance:r3,hideTextInstance:r3,unhideTextInstance:r3,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:V.createContext(null),setCurrentUpdatePriority(t){_2=t},getCurrentUpdatePriority(){return _2},resolveUpdatePriority(){var t;if(_2!==fV)return _2;switch(typeof window<"u"&&((t=window.event)==null?void 0:t.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return hE.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return hE.ContinuousEventPriority;default:return hE.DefaultEventPriority}},resetFormInstance(){}}),tm=new Map,zg={objects:"shallow",strict:!1};function Kie(t,e){if(!e&&typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:n,height:i,top:r,left:s}=t.parentElement.getBoundingClientRect();return{width:n,height:i,top:r,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function Qie(t){const e=tm.get(t),n=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||kie(dD,IP),a=n||cD.createContainer(s,hE.ConcurrentRoot,null,!1,null,"",r,r,r,null);e||tm.set(t,{fiber:a,store:s});let o,l,u=!1,c=null;return{async configure(h={}){let d;c=new Promise(H=>d=H);let{gl:m,size:v,scene:_,events:y,onCreated:g,shadows:x=!1,linear:S=!1,flat:E=!1,legacy:A=!1,orthographic:T=!1,frameloop:C="always",dpr:O=[1,2],performance:M,raycaster:D,camera:P,onPointerMissed:F}=h,G=s.getState(),z=G.gl;if(!G.gl){const H={canvas:t,powerPreference:"high-performance",antialias:!0,alpha:!0},$=typeof m=="function"?await m(H):m;DP($)?z=$:z=new V8({...H,...m}),G.set({gl:z})}let Y=G.raycaster;Y||G.set({raycaster:Y=new ez});const{params:N,...k}=D||{};if(Pr.equ(k,Y,zg)||sf(Y,{...k}),Pr.equ(N,Y.params,zg)||sf(Y,{params:{...Y.params,...N}}),!G.camera||G.camera===l&&!Pr.equ(l,P,zg)){l=P;const H=P==null?void 0:P.isCamera,$=H?P:T?new pm(0,0,0,0,.1,1e3):new ys(75,0,.1,1e3);H||($.position.z=5,P&&(sf($,P),$.manual||("aspect"in P||"left"in P||"right"in P||"bottom"in P||"top"in P)&&($.manual=!0,$.updateProjectionMatrix())),!G.camera&&!(P!=null&&P.rotation)&&$.lookAt(0,0,0)),G.set({camera:$}),Y.camera=$}if(!G.scene){let H;_!=null&&_.isScene?(H=_,jw(H,s,"",{})):(H=new aT,jw(H,s,"",{}),_&&sf(H,_)),G.set({scene:H})}y&&!G.events.handlers&&G.set({events:y(s)});const j=Kie(t,v);if(Pr.equ(j,G.size,zg)||G.setSize(j.width,j.height,j.top,j.left),O&&G.viewport.dpr!==aV(O)&&G.setDpr(O),G.frameloop!==C&&G.setFrameloop(C),G.onPointerMissed||G.set({onPointerMissed:F}),M&&!Pr.equ(M,G.performance,zg)&&G.set(H=>({performance:{...H.performance,...M}})),!G.xr){var X;const H=(q,se)=>{const ve=s.getState();ve.frameloop!=="never"&&IP(q,!0,ve,se)},$=()=>{const q=s.getState();q.gl.xr.enabled=q.gl.xr.isPresenting,q.gl.xr.setAnimationLoop(q.gl.xr.isPresenting?H:null),q.gl.xr.isPresenting||dD(q)},ne={connect(){const q=s.getState().gl;q.xr.addEventListener("sessionstart",$),q.xr.addEventListener("sessionend",$)},disconnect(){const q=s.getState().gl;q.xr.removeEventListener("sessionstart",$),q.xr.removeEventListener("sessionend",$)}};typeof((X=z.xr)==null?void 0:X.addEventListener)=="function"&&ne.connect(),G.set({xr:ne})}if(z.shadowMap){const H=z.shadowMap.enabled,$=z.shadowMap.type;if(z.shadowMap.enabled=!!x,Pr.boo(x))z.shadowMap.type=e1;else if(Pr.str(x)){var Q;const ne={basic:Y6,percentage:XA,soft:e1,variance:Zl};z.shadowMap.type=(Q=ne[x])!=null?Q:e1}else Pr.obj(x)&&Object.assign(z.shadowMap,x);(H!==z.shadowMap.enabled||$!==z.shadowMap.type)&&(z.shadowMap.needsUpdate=!0)}return Ei.enabled=!A,u||(z.outputColorSpace=S?od:xa,z.toneMapping=E?Ju:vU),G.legacy!==A&&G.set(()=>({legacy:A})),G.linear!==S&&G.set(()=>({linear:S})),G.flat!==E&&G.set(()=>({flat:E})),m&&!Pr.fun(m)&&!DP(m)&&!Pr.equ(m,z,zg)&&sf(z,m),o=g,u=!0,d(),this},render(h){return!u&&!c&&this.configure(),c.then(()=>{cD.updateContainer(B.jsx(Jie,{store:s,children:h,onCreated:o,rootElement:t}),a,null,()=>{})}),s},unmount(){gV(t)}}}function Jie({store:t,children:e,onCreated:n,rootElement:i}){return Y_(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),B.jsx(uV.Provider,{value:t,children:e})}function gV(t,e){const n=tm.get(t),i=n==null?void 0:n.fiber;if(i){const r=n==null?void 0:n.store.getState();r&&(r.internal.active=!1),cD.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,a,o,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=r.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),Die(r.scene),tm.delete(t)}catch{}},500)})}}function $ie(t,e){const n={callback:t};return e.add(n),()=>void e.delete(n)}const vV=new Set,ere=new Set,tre=new Set,nre=t=>$ie(t,vV);function s3(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function c1(t,e){switch(t){case"before":return s3(vV,e);case"after":return s3(ere,e);case"tail":return s3(tre,e)}}let a3,o3;function fD(t,e,n){let i=e.clock.getDelta();e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),a3=e.internal.subscribers;for(let r=0;r<a3.length;r++)o3=a3[r],o3.ref.current(o3.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let Yw=!1,hD=!1,l3,zP,Ig;function yV(t){zP=requestAnimationFrame(yV),Yw=!0,l3=0,c1("before",t),hD=!0;for(const n of tm.values()){var e;Ig=n.store.getState(),Ig.internal.active&&(Ig.frameloop==="always"||Ig.internal.frames>0)&&!((e=Ig.gl.xr)!=null&&e.isPresenting)&&(l3+=fD(t,Ig))}if(hD=!1,c1("after",t),l3===0)return c1("tail",t),Yw=!1,cancelAnimationFrame(zP)}function dD(t,e=1){var n;if(!t)return tm.forEach(i=>dD(i.store.getState(),e));(n=t.gl.xr)!=null&&n.isPresenting||!t.internal.active||t.frameloop==="never"||(e>1?t.internal.frames=Math.min(60,t.internal.frames+e):hD?t.internal.frames=2:t.internal.frames=1,Yw||(Yw=!0,requestAnimationFrame(yV)))}function IP(t,e=!0,n,i){if(e&&c1("before",t),n)fD(t,n,i);else for(const r of tm.values())fD(t,r.store.getState());e&&c1("after",t)}const u3={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function ire(t){const{handlePointer:e}=Bie(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(u3).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;const{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{const{set:i,events:r}=t.getState();if(r.disconnect==null||r.disconnect(),i(s=>({events:{...s.events,connected:n}})),r.handlers)for(const s in r.handlers){const a=r.handlers[s],[o,l]=u3[s];n.addEventListener(o,a,{passive:l})}},disconnect:()=>{const{set:n,events:i}=t.getState();if(i.connected){if(i.handlers)for(const r in i.handlers){const s=i.handlers[r],[a]=u3[r];i.connected.removeEventListener(a,s)}n(r=>({events:{...r.events,connected:void 0}}))}}}}function LP(t,e){let n;return(...i)=>{window.clearTimeout(n),n=window.setTimeout(()=>t(...i),e)}}function rre({debounce:t,scroll:e,polyfill:n,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=V.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=V.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=t?typeof t=="number"?t:t.scroll:null,u=t?typeof t=="number"?t:t.resize:null,c=V.useRef(!1);V.useEffect(()=>(c.current=!0,()=>void(c.current=!1)));const[h,d,m]=V.useMemo(()=>{const g=()=>{if(!o.current.element)return;const{left:x,top:S,width:E,height:A,bottom:T,right:C,x:O,y:M}=o.current.element.getBoundingClientRect(),D={left:x,top:S,width:E,height:A,bottom:T,right:C,x:O,y:M};o.current.element instanceof HTMLElement&&i&&(D.height=o.current.element.offsetHeight,D.width=o.current.element.offsetWidth),Object.freeze(D),c.current&&!lre(o.current.lastBounds,D)&&a(o.current.lastBounds=D)};return[g,u?LP(g,u):g,l?LP(g,l):g]},[a,i,l,u]);function v(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(g=>g.removeEventListener("scroll",m,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function _(){o.current.element&&(o.current.resizeObserver=new r(m),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(g=>g.addEventListener("scroll",m,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{m()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const y=g=>{!g||g===o.current.element||(v(),o.current.element=g,o.current.scrollContainers=xV(g),_())};return are(m,!!e),sre(d),V.useEffect(()=>{v(),_()},[e,m,d]),V.useEffect(()=>v,[]),[y,s,h]}function sre(t){V.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function are(t,e){V.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function xV(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...xV(t.parentElement)]}const ore=["x","y","top","bottom","left","right","width","height"],lre=(t,e)=>ore.every(n=>t[n]===e[n]);function ure({ref:t,children:e,fallback:n,resize:i,style:r,gl:s,events:a=ire,eventSource:o,eventPrefix:l,shadows:u,linear:c,flat:h,legacy:d,orthographic:m,frameloop:v,dpr:_,performance:y,raycaster:g,camera:x,scene:S,onPointerMissed:E,onCreated:A,...T}){V.useMemo(()=>hV(H8),[]);const C=Mie(),[O,M]=rre({scroll:!0,debounce:{scroll:50,resize:0},...i}),D=V.useRef(null),P=V.useRef(null);V.useImperativeHandle(t,()=>D.current);const F=sV(E),[G,z]=V.useState(!1),[Y,N]=V.useState(!1);if(G)throw G;if(Y)throw Y;const k=V.useRef(null);Y_(()=>{const X=D.current;if(M.width>0&&M.height>0&&X){k.current||(k.current=Qie(X));async function Q(){await k.current.configure({gl:s,scene:S,events:a,shadows:u,linear:c,flat:h,legacy:d,orthographic:m,frameloop:v,dpr:_,performance:y,raycaster:g,camera:x,size:M,onPointerMissed:(...H)=>F.current==null?void 0:F.current(...H),onCreated:H=>{H.events.connect==null||H.events.connect(o?Aie(o)?o.current:o:P.current),l&&H.setEvents({compute:($,ne)=>{const q=$[l+"X"],se=$[l+"Y"];ne.pointer.set(q/ne.size.width*2-1,-(se/ne.size.height)*2+1),ne.raycaster.setFromCamera(ne.pointer,ne.camera)}}),A==null||A(H)}}),k.current.render(B.jsx(C,{children:B.jsx(Rie,{set:N,children:B.jsx(V.Suspense,{fallback:B.jsx(Cie,{set:z}),children:e??null})})}))}Q()}}),V.useEffect(()=>{const X=D.current;if(X)return()=>gV(X)},[]);const j=o?"none":"auto";return B.jsx("div",{ref:P,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:j,...r},...T,children:B.jsx("div",{ref:O,style:{width:"100%",height:"100%"},children:B.jsx("canvas",{ref:D,style:{display:"block"},children:n})})})}function _V(t){return B.jsx(tV,{children:B.jsx(ure,{...t})})}function cre(t,e,n){var i,r=1;t==null&&(t=0),e==null&&(e=0),n==null&&(n=0);function s(){var a,o=i.length,l,u=0,c=0,h=0;for(a=0;a<o;++a)l=i[a],u+=l.x||0,c+=l.y||0,h+=l.z||0;for(u=(u/o-t)*r,c=(c/o-e)*r,h=(h/o-n)*r,a=0;a<o;++a)l=i[a],u&&(l.x-=u),c&&(l.y-=c),h&&(l.z-=h)}return s.initialize=function(a){i=a},s.x=function(a){return arguments.length?(t=+a,s):t},s.y=function(a){return arguments.length?(e=+a,s):e},s.z=function(a){return arguments.length?(n=+a,s):n},s.strength=function(a){return arguments.length?(r=+a,s):r},s}function fre(t){const e=+this._x.call(null,t);return bV(this.cover(e),e,t)}function bV(t,e,n){if(isNaN(e))return t;var i,r=t._root,s={data:n},a=t._x0,o=t._x1,l,u,c,h,d;if(!r)return t._root=s,t;for(;r.length;)if((c=e>=(l=(a+o)/2))?a=l:o=l,i=r,!(r=r[h=+c]))return i[h]=s,t;if(u=+t._x.call(null,r.data),e===u)return s.next=r,i?i[h]=s:t._root=s,t;do i=i?i[h]=new Array(2):t._root=new Array(2),(c=e>=(l=(a+o)/2))?a=l:o=l;while((h=+c)==(d=+(u>=l)));return i[d]=r,i[h]=s,t}function hre(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,n=new Float64Array(e);let i=1/0,r=-1/0;for(let s=0,a;s<e;++s)isNaN(a=+this._x.call(null,t[s]))||(n[s]=a,a<i&&(i=a),a>r&&(r=a));if(i>r)return this;this.cover(i).cover(r);for(let s=0;s<e;++s)bV(this,n[s],t[s]);return this}function dre(t){if(isNaN(t=+t))return this;var e=this._x0,n=this._x1;if(isNaN(e))n=(e=Math.floor(t))+1;else{for(var i=n-e||1,r=this._root,s,a;e>t||t>=n;)switch(a=+(t<e),s=new Array(2),s[a]=r,r=s,i*=2,a){case 0:n=e+i;break;case 1:e=n-i;break}this._root&&this._root.length&&(this._root=r)}return this._x0=e,this._x1=n,this}function pre(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function mre(t){return arguments.length?this.cover(+t[0][0]).cover(+t[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function yf(t,e,n){this.node=t,this.x0=e,this.x1=n}function gre(t,e){var n,i=this._x0,r,s,a=this._x1,o=[],l=this._root,u,c;for(l&&o.push(new yf(l,i,a)),e==null?e=1/0:(i=t-e,a=t+e);u=o.pop();)if(!(!(l=u.node)||(r=u.x0)>a||(s=u.x1)<i))if(l.length){var h=(r+s)/2;o.push(new yf(l[1],h,s),new yf(l[0],r,h)),(c=+(t>=h))&&(u=o[o.length-1],o[o.length-1]=o[o.length-1-c],o[o.length-1-c]=u)}else{var d=Math.abs(t-+this._x.call(null,l.data));d<e&&(e=d,i=t-d,a=t+d,n=l.data)}return n}function vre(t){if(isNaN(l=+this._x.call(null,t)))return this;var e,n=this._root,i,r,s,a=this._x0,o=this._x1,l,u,c,h,d;if(!n)return this;if(n.length)for(;;){if((c=l>=(u=(a+o)/2))?a=u:o=u,e=n,!(n=n[h=+c]))return this;if(!n.length)break;e[h+1&1]&&(i=e,d=h)}for(;n.data!==t;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):e?(s?e[h]=s:delete e[h],(n=e[0]||e[1])&&n===(e[1]||e[0])&&!n.length&&(i?i[d]=n:this._root=n),this):(this._root=s,this)}function yre(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function xre(){return this._root}function _re(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function bre(t){var e=[],n,i=this._root,r,s,a;for(i&&e.push(new yf(i,this._x0,this._x1));n=e.pop();)if(!t(i=n.node,s=n.x0,a=n.x1)&&i.length){var o=(s+a)/2;(r=i[1])&&e.push(new yf(r,o,a)),(r=i[0])&&e.push(new yf(r,s,o))}return this}function Sre(t){var e=[],n=[],i;for(this._root&&e.push(new yf(this._root,this._x0,this._x1));i=e.pop();){var r=i.node;if(r.length){var s,a=i.x0,o=i.x1,l=(a+o)/2;(s=r[0])&&e.push(new yf(s,a,l)),(s=r[1])&&e.push(new yf(s,l,o))}n.push(i)}for(;i=n.pop();)t(i.node,i.x0,i.x1);return this}function Ere(t){return t[0]}function wre(t){return arguments.length?(this._x=t,this):this._x}function az(t,e){var n=new oz(e??Ere,NaN,NaN);return t==null?n:n.addAll(t)}function oz(t,e,n){this._x=t,this._x0=e,this._x1=n,this._root=void 0}function PP(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var uo=az.prototype=oz.prototype;uo.copy=function(){var t=new oz(this._x,this._x0,this._x1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=PP(e),t;for(n=[{source:e,target:t._root=new Array(2)}];e=n.pop();)for(var r=0;r<2;++r)(i=e.source[r])&&(i.length?n.push({source:i,target:e.target[r]=new Array(2)}):e.target[r]=PP(i));return t};uo.add=fre;uo.addAll=hre;uo.cover=dre;uo.data=pre;uo.extent=mre;uo.find=gre;uo.remove=vre;uo.removeAll=yre;uo.root=xre;uo.size=_re;uo.visit=bre;uo.visitAfter=Sre;uo.x=wre;function Are(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return SV(this.cover(e,n),e,n,t)}function SV(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,s=t._root,a={data:i},o=t._x0,l=t._y0,u=t._x1,c=t._y1,h,d,m,v,_,y,g,x;if(!s)return t._root=a,t;for(;s.length;)if((_=e>=(h=(o+u)/2))?o=h:u=h,(y=n>=(d=(l+c)/2))?l=d:c=d,r=s,!(s=s[g=y<<1|_]))return r[g]=a,t;if(m=+t._x.call(null,s.data),v=+t._y.call(null,s.data),e===m&&n===v)return a.next=s,r?r[g]=a:t._root=a,t;do r=r?r[g]=new Array(4):t._root=new Array(4),(_=e>=(h=(o+u)/2))?o=h:u=h,(y=n>=(d=(l+c)/2))?l=d:c=d;while((g=y<<1|_)===(x=(v>=d)<<1|m>=h));return r[x]=s,r[g]=a,t}function Tre(t){var e,n,i=t.length,r,s,a=new Array(i),o=new Array(i),l=1/0,u=1/0,c=-1/0,h=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(s=+this._y.call(null,e))||(a[n]=r,o[n]=s,r<l&&(l=r),r>c&&(c=r),s<u&&(u=s),s>h&&(h=s));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),n=0;n<i;++n)SV(this,a[n],o[n],t[n]);return this}function Mre(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,s=(i=Math.floor(e))+1;else{for(var a=r-n||1,o=this._root,l,u;n>t||t>=r||i>e||e>=s;)switch(u=(e<i)<<1|t<n,l=new Array(4),l[u]=o,o=l,a*=2,u){case 0:r=n+a,s=i+a;break;case 1:n=r-a,s=i+a;break;case 2:r=n+a,i=s-a;break;case 3:n=r-a,i=s-a;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function Cre(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function Rre(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function za(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function Dre(t,e,n){var i,r=this._x0,s=this._y0,a,o,l,u,c=this._x1,h=this._y1,d=[],m=this._root,v,_;for(m&&d.push(new za(m,r,s,c,h)),n==null?n=1/0:(r=t-n,s=e-n,c=t+n,h=e+n,n*=n);v=d.pop();)if(!(!(m=v.node)||(a=v.x0)>c||(o=v.y0)>h||(l=v.x1)<r||(u=v.y1)<s))if(m.length){var y=(a+l)/2,g=(o+u)/2;d.push(new za(m[3],y,g,l,u),new za(m[2],a,g,y,u),new za(m[1],y,o,l,g),new za(m[0],a,o,y,g)),(_=(e>=g)<<1|t>=y)&&(v=d[d.length-1],d[d.length-1]=d[d.length-1-_],d[d.length-1-_]=v)}else{var x=t-+this._x.call(null,m.data),S=e-+this._y.call(null,m.data),E=x*x+S*S;if(E<n){var A=Math.sqrt(n=E);r=t-A,s=e-A,c=t+A,h=e+A,i=m.data}}return i}function Ore(t){if(isNaN(c=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var e,n=this._root,i,r,s,a=this._x0,o=this._y0,l=this._x1,u=this._y1,c,h,d,m,v,_,y,g;if(!n)return this;if(n.length)for(;;){if((v=c>=(d=(a+l)/2))?a=d:l=d,(_=h>=(m=(o+u)/2))?o=m:u=m,e=n,!(n=n[y=_<<1|v]))return this;if(!n.length)break;(e[y+1&3]||e[y+2&3]||e[y+3&3])&&(i=e,g=y)}for(;n.data!==t;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):e?(s?e[y]=s:delete e[y],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[g]=n:this._root=n),this):(this._root=s,this)}function Ure(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function zre(){return this._root}function Ire(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function Lre(t){var e=[],n,i=this._root,r,s,a,o,l;for(i&&e.push(new za(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(i=n.node,s=n.x0,a=n.y0,o=n.x1,l=n.y1)&&i.length){var u=(s+o)/2,c=(a+l)/2;(r=i[3])&&e.push(new za(r,u,c,o,l)),(r=i[2])&&e.push(new za(r,s,c,u,l)),(r=i[1])&&e.push(new za(r,u,a,o,c)),(r=i[0])&&e.push(new za(r,s,a,u,c))}return this}function Pre(t){var e=[],n=[],i;for(this._root&&e.push(new za(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var r=i.node;if(r.length){var s,a=i.x0,o=i.y0,l=i.x1,u=i.y1,c=(a+l)/2,h=(o+u)/2;(s=r[0])&&e.push(new za(s,a,o,c,h)),(s=r[1])&&e.push(new za(s,c,o,l,h)),(s=r[2])&&e.push(new za(s,a,h,c,u)),(s=r[3])&&e.push(new za(s,c,h,l,u))}n.push(i)}for(;i=n.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}function Nre(t){return t[0]}function Bre(t){return arguments.length?(this._x=t,this):this._x}function kre(t){return t[1]}function Fre(t){return arguments.length?(this._y=t,this):this._y}function lz(t,e,n){var i=new uz(e??Nre,n??kre,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function uz(t,e,n,i,r,s){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function NP(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Ba=lz.prototype=uz.prototype;Ba.copy=function(){var t=new uz(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=NP(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var r=0;r<4;++r)(i=e.source[r])&&(i.length?n.push({source:i,target:e.target[r]=new Array(4)}):e.target[r]=NP(i));return t};Ba.add=Are;Ba.addAll=Tre;Ba.cover=Mre;Ba.data=Cre;Ba.extent=Rre;Ba.find=Dre;Ba.remove=Ore;Ba.removeAll=Ure;Ba.root=zre;Ba.size=Ire;Ba.visit=Lre;Ba.visitAfter=Pre;Ba.x=Bre;Ba.y=Fre;function Gre(t){const e=+this._x.call(null,t),n=+this._y.call(null,t),i=+this._z.call(null,t);return EV(this.cover(e,n,i),e,n,i,t)}function EV(t,e,n,i,r){if(isNaN(e)||isNaN(n)||isNaN(i))return t;var s,a=t._root,o={data:r},l=t._x0,u=t._y0,c=t._z0,h=t._x1,d=t._y1,m=t._z1,v,_,y,g,x,S,E,A,T,C,O;if(!a)return t._root=o,t;for(;a.length;)if((E=e>=(v=(l+h)/2))?l=v:h=v,(A=n>=(_=(u+d)/2))?u=_:d=_,(T=i>=(y=(c+m)/2))?c=y:m=y,s=a,!(a=a[C=T<<2|A<<1|E]))return s[C]=o,t;if(g=+t._x.call(null,a.data),x=+t._y.call(null,a.data),S=+t._z.call(null,a.data),e===g&&n===x&&i===S)return o.next=a,s?s[C]=o:t._root=o,t;do s=s?s[C]=new Array(8):t._root=new Array(8),(E=e>=(v=(l+h)/2))?l=v:h=v,(A=n>=(_=(u+d)/2))?u=_:d=_,(T=i>=(y=(c+m)/2))?c=y:m=y;while((C=T<<2|A<<1|E)===(O=(S>=y)<<2|(x>=_)<<1|g>=v));return s[O]=a,s[C]=o,t}function Vre(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,n=new Float64Array(e),i=new Float64Array(e),r=new Float64Array(e);let s=1/0,a=1/0,o=1/0,l=-1/0,u=-1/0,c=-1/0;for(let h=0,d,m,v,_;h<e;++h)isNaN(m=+this._x.call(null,d=t[h]))||isNaN(v=+this._y.call(null,d))||isNaN(_=+this._z.call(null,d))||(n[h]=m,i[h]=v,r[h]=_,m<s&&(s=m),m>l&&(l=m),v<a&&(a=v),v>u&&(u=v),_<o&&(o=_),_>c&&(c=_));if(s>l||a>u||o>c)return this;this.cover(s,a,o).cover(l,u,c);for(let h=0;h<e;++h)EV(this,n[h],i[h],r[h],t[h]);return this}function Hre(t,e,n){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(n=+n))return this;var i=this._x0,r=this._y0,s=this._z0,a=this._x1,o=this._y1,l=this._z1;if(isNaN(i))a=(i=Math.floor(t))+1,o=(r=Math.floor(e))+1,l=(s=Math.floor(n))+1;else{for(var u=a-i||1,c=this._root,h,d;i>t||t>=a||r>e||e>=o||s>n||n>=l;)switch(d=(n<s)<<2|(e<r)<<1|t<i,h=new Array(8),h[d]=c,c=h,u*=2,d){case 0:a=i+u,o=r+u,l=s+u;break;case 1:i=a-u,o=r+u,l=s+u;break;case 2:a=i+u,r=o-u,l=s+u;break;case 3:i=a-u,r=o-u,l=s+u;break;case 4:a=i+u,o=r+u,s=l-u;break;case 5:i=a-u,o=r+u,s=l-u;break;case 6:a=i+u,r=o-u,s=l-u;break;case 7:i=a-u,r=o-u,s=l-u;break}this._root&&this._root.length&&(this._root=c)}return this._x0=i,this._y0=r,this._z0=s,this._x1=a,this._y1=o,this._z1=l,this}function jre(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function Wre(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function fr(t,e,n,i,r,s,a){this.node=t,this.x0=e,this.y0=n,this.z0=i,this.x1=r,this.y1=s,this.z1=a}function Xre(t,e,n,i){var r,s=this._x0,a=this._y0,o=this._z0,l,u,c,h,d,m,v=this._x1,_=this._y1,y=this._z1,g=[],x=this._root,S,E;for(x&&g.push(new fr(x,s,a,o,v,_,y)),i==null?i=1/0:(s=t-i,a=e-i,o=n-i,v=t+i,_=e+i,y=n+i,i*=i);S=g.pop();)if(!(!(x=S.node)||(l=S.x0)>v||(u=S.y0)>_||(c=S.z0)>y||(h=S.x1)<s||(d=S.y1)<a||(m=S.z1)<o))if(x.length){var A=(l+h)/2,T=(u+d)/2,C=(c+m)/2;g.push(new fr(x[7],A,T,C,h,d,m),new fr(x[6],l,T,C,A,d,m),new fr(x[5],A,u,C,h,T,m),new fr(x[4],l,u,C,A,T,m),new fr(x[3],A,T,c,h,d,C),new fr(x[2],l,T,c,A,d,C),new fr(x[1],A,u,c,h,T,C),new fr(x[0],l,u,c,A,T,C)),(E=(n>=C)<<2|(e>=T)<<1|t>=A)&&(S=g[g.length-1],g[g.length-1]=g[g.length-1-E],g[g.length-1-E]=S)}else{var O=t-+this._x.call(null,x.data),M=e-+this._y.call(null,x.data),D=n-+this._z.call(null,x.data),P=O*O+M*M+D*D;if(P<i){var F=Math.sqrt(i=P);s=t-F,a=e-F,o=n-F,v=t+F,_=e+F,y=n+F,r=x.data}}return r}const Yre=(t,e,n,i,r,s)=>Math.sqrt((t-i)**2+(e-r)**2+(n-s)**2);function Zre(t,e,n,i){const r=[],s=t-i,a=e-i,o=n-i,l=t+i,u=e+i,c=n+i;return this.visit((h,d,m,v,_,y,g)=>{if(!h.length)do{const x=h.data;Yre(t,e,n,this._x(x),this._y(x),this._z(x))<=i&&r.push(x)}while(h=h.next);return d>l||m>u||v>c||_<s||y<a||g<o}),r}function qre(t){if(isNaN(d=+this._x.call(null,t))||isNaN(m=+this._y.call(null,t))||isNaN(v=+this._z.call(null,t)))return this;var e,n=this._root,i,r,s,a=this._x0,o=this._y0,l=this._z0,u=this._x1,c=this._y1,h=this._z1,d,m,v,_,y,g,x,S,E,A,T;if(!n)return this;if(n.length)for(;;){if((x=d>=(_=(a+u)/2))?a=_:u=_,(S=m>=(y=(o+c)/2))?o=y:c=y,(E=v>=(g=(l+h)/2))?l=g:h=g,e=n,!(n=n[A=E<<2|S<<1|x]))return this;if(!n.length)break;(e[A+1&7]||e[A+2&7]||e[A+3&7]||e[A+4&7]||e[A+5&7]||e[A+6&7]||e[A+7&7])&&(i=e,T=A)}for(;n.data!==t;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):e?(s?e[A]=s:delete e[A],(n=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&n===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[T]=n:this._root=n),this):(this._root=s,this)}function Kre(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Qre(){return this._root}function Jre(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function $re(t){var e=[],n,i=this._root,r,s,a,o,l,u,c;for(i&&e.push(new fr(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();)if(!t(i=n.node,s=n.x0,a=n.y0,o=n.z0,l=n.x1,u=n.y1,c=n.z1)&&i.length){var h=(s+l)/2,d=(a+u)/2,m=(o+c)/2;(r=i[7])&&e.push(new fr(r,h,d,m,l,u,c)),(r=i[6])&&e.push(new fr(r,s,d,m,h,u,c)),(r=i[5])&&e.push(new fr(r,h,a,m,l,d,c)),(r=i[4])&&e.push(new fr(r,s,a,m,h,d,c)),(r=i[3])&&e.push(new fr(r,h,d,o,l,u,m)),(r=i[2])&&e.push(new fr(r,s,d,o,h,u,m)),(r=i[1])&&e.push(new fr(r,h,a,o,l,d,m)),(r=i[0])&&e.push(new fr(r,s,a,o,h,d,m))}return this}function ese(t){var e=[],n=[],i;for(this._root&&e.push(new fr(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=e.pop();){var r=i.node;if(r.length){var s,a=i.x0,o=i.y0,l=i.z0,u=i.x1,c=i.y1,h=i.z1,d=(a+u)/2,m=(o+c)/2,v=(l+h)/2;(s=r[0])&&e.push(new fr(s,a,o,l,d,m,v)),(s=r[1])&&e.push(new fr(s,d,o,l,u,m,v)),(s=r[2])&&e.push(new fr(s,a,m,l,d,c,v)),(s=r[3])&&e.push(new fr(s,d,m,l,u,c,v)),(s=r[4])&&e.push(new fr(s,a,o,v,d,m,h)),(s=r[5])&&e.push(new fr(s,d,o,v,u,m,h)),(s=r[6])&&e.push(new fr(s,a,m,v,d,c,h)),(s=r[7])&&e.push(new fr(s,d,m,v,u,c,h))}n.push(i)}for(;i=n.pop();)t(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function tse(t){return t[0]}function nse(t){return arguments.length?(this._x=t,this):this._x}function ise(t){return t[1]}function rse(t){return arguments.length?(this._y=t,this):this._y}function sse(t){return t[2]}function ase(t){return arguments.length?(this._z=t,this):this._z}function cz(t,e,n,i){var r=new fz(e??tse,n??ise,i??sse,NaN,NaN,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function fz(t,e,n,i,r,s,a,o,l){this._x=t,this._y=e,this._z=n,this._x0=i,this._y0=r,this._z0=s,this._x1=a,this._y1=o,this._z1=l,this._root=void 0}function BP(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var sa=cz.prototype=fz.prototype;sa.copy=function(){var t=new fz(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=BP(e),t;for(n=[{source:e,target:t._root=new Array(8)}];e=n.pop();)for(var r=0;r<8;++r)(i=e.source[r])&&(i.length?n.push({source:i,target:e.target[r]=new Array(8)}):e.target[r]=BP(i));return t};sa.add=Gre;sa.addAll=Vre;sa.cover=Hre;sa.data=jre;sa.extent=Wre;sa.find=Xre;sa.findAllWithinRadius=Zre;sa.remove=qre;sa.removeAll=Kre;sa.root=Qre;sa.size=Jre;sa.visit=$re;sa.visitAfter=ese;sa.x=nse;sa.y=rse;sa.z=ase;function Br(t){return function(){return t}}function il(t){return(t()-.5)*1e-6}function c3(t){return t.x+t.vx}function kP(t){return t.y+t.vy}function ose(t){return t.z+t.vz}function wV(t){var e,n,i,r,s=1,a=1;typeof t!="function"&&(t=Br(t==null?1:+t));function o(){for(var c,h=e.length,d,m,v,_,y,g,x,S=0;S<a;++S)for(d=(n===1?az(e,c3):n===2?lz(e,c3,kP):n===3?cz(e,c3,kP,ose):null).visitAfter(l),c=0;c<h;++c)m=e[c],g=i[m.index],x=g*g,v=m.x+m.vx,n>1&&(_=m.y+m.vy),n>2&&(y=m.z+m.vz),d.visit(E);function E(A,T,C,O,M,D,P){var F=[T,C,O,M,D,P],G=F[0],z=F[1],Y=F[2],N=F[n],k=F[n+1],j=F[n+2],X=A.data,Q=A.r,H=g+Q;if(X){if(X.index>m.index){var $=v-X.x-X.vx,ne=n>1?_-X.y-X.vy:0,q=n>2?y-X.z-X.vz:0,se=$*$+ne*ne+q*q;se<H*H&&($===0&&($=il(r),se+=$*$),n>1&&ne===0&&(ne=il(r),se+=ne*ne),n>2&&q===0&&(q=il(r),se+=q*q),se=(H-(se=Math.sqrt(se)))/se*s,m.vx+=($*=se)*(H=(Q*=Q)/(x+Q)),n>1&&(m.vy+=(ne*=se)*H),n>2&&(m.vz+=(q*=se)*H),X.vx-=$*(H=1-H),n>1&&(X.vy-=ne*H),n>2&&(X.vz-=q*H))}return}return G>v+H||N<v-H||n>1&&(z>_+H||k<_-H)||n>2&&(Y>y+H||j<y-H)}}function l(c){if(c.data)return c.r=i[c.data.index];for(var h=c.r=0;h<Math.pow(2,n);++h)c[h]&&c[h].r>c.r&&(c.r=c[h].r)}function u(){if(e){var c,h=e.length,d;for(i=new Array(h),c=0;c<h;++c)d=e[c],i[d.index]=+t(d,c,e)}}return o.initialize=function(c,...h){e=c,r=h.find(d=>typeof d=="function")||Math.random,n=h.find(d=>[1,2,3].includes(d))||2,u()},o.iterations=function(c){return arguments.length?(a=+c,o):a},o.strength=function(c){return arguments.length?(s=+c,o):s},o.radius=function(c){return arguments.length?(t=typeof c=="function"?c:Br(+c),u(),o):t},o}function lse(t){return t.index}function FP(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function AV(t){var e=lse,n=d,i,r=Br(30),s,a,o,l,u,c,h=1;t==null&&(t=[]);function d(g){return 1/Math.min(l[g.source.index],l[g.target.index])}function m(g){for(var x=0,S=t.length;x<h;++x)for(var E=0,A,T,C,O=0,M=0,D=0,P,F;E<S;++E)A=t[E],T=A.source,C=A.target,O=C.x+C.vx-T.x-T.vx||il(c),o>1&&(M=C.y+C.vy-T.y-T.vy||il(c)),o>2&&(D=C.z+C.vz-T.z-T.vz||il(c)),P=Math.sqrt(O*O+M*M+D*D),P=(P-s[E])/P*g*i[E],O*=P,M*=P,D*=P,C.vx-=O*(F=u[E]),o>1&&(C.vy-=M*F),o>2&&(C.vz-=D*F),T.vx+=O*(F=1-F),o>1&&(T.vy+=M*F),o>2&&(T.vz+=D*F)}function v(){if(a){var g,x=a.length,S=t.length,E=new Map(a.map((T,C)=>[e(T,C,a),T])),A;for(g=0,l=new Array(x);g<S;++g)A=t[g],A.index=g,typeof A.source!="object"&&(A.source=FP(E,A.source)),typeof A.target!="object"&&(A.target=FP(E,A.target)),l[A.source.index]=(l[A.source.index]||0)+1,l[A.target.index]=(l[A.target.index]||0)+1;for(g=0,u=new Array(S);g<S;++g)A=t[g],u[g]=l[A.source.index]/(l[A.source.index]+l[A.target.index]);i=new Array(S),_(),s=new Array(S),y()}}function _(){if(a)for(var g=0,x=t.length;g<x;++g)i[g]=+n(t[g],g,t)}function y(){if(a)for(var g=0,x=t.length;g<x;++g)s[g]=+r(t[g],g,t)}return m.initialize=function(g,...x){a=g,c=x.find(S=>typeof S=="function")||Math.random,o=x.find(S=>[1,2,3].includes(S))||2,v()},m.links=function(g){return arguments.length?(t=g,v(),m):t},m.id=function(g){return arguments.length?(e=g,m):e},m.iterations=function(g){return arguments.length?(h=+g,m):h},m.strength=function(g){return arguments.length?(n=typeof g=="function"?g:Br(+g),_(),m):n},m.distance=function(g){return arguments.length?(r=typeof g=="function"?g:Br(+g),y(),m):r},m}var use={value:()=>{}};function TV(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new pE(n)}function pE(t){this._=t}function cse(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}pE.prototype=TV.prototype={constructor:pE,on:function(t,e){var n=this._,i=cse(t+"",n),r,s=-1,a=i.length;if(arguments.length<2){for(;++s<a;)if((r=(t=i[s]).type)&&(r=fse(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<a;)if(r=(t=i[s]).type)n[r]=GP(n[r],t.name,e);else if(e==null)for(r in n)n[r]=GP(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new pE(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function fse(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function GP(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=use,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var q0=0,zx=0,ex=0,MV=1e3,Zw,Ix,qw=0,nm=0,UT=0,Q1=typeof performance=="object"&&performance.now?performance:Date,CV=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function RV(){return nm||(CV(hse),nm=Q1.now()+UT)}function hse(){nm=0}function pD(){this._call=this._time=this._next=null}pD.prototype=DV.prototype={constructor:pD,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?RV():+n)+(e==null?0:+e),!this._next&&Ix!==this&&(Ix?Ix._next=this:Zw=this,Ix=this),this._call=t,this._time=n,mD()},stop:function(){this._call&&(this._call=null,this._time=1/0,mD())}};function DV(t,e,n){var i=new pD;return i.restart(t,e,n),i}function dse(){RV(),++q0;for(var t=Zw,e;t;)(e=nm-t._time)>=0&&t._call.call(void 0,e),t=t._next;--q0}function VP(){nm=(qw=Q1.now())+UT,q0=zx=0;try{dse()}finally{q0=0,mse(),nm=0}}function pse(){var t=Q1.now(),e=t-qw;e>MV&&(UT-=e,qw=t)}function mse(){for(var t,e=Zw,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Zw=n);Ix=t,mD(i)}function mD(t){if(!q0){zx&&(zx=clearTimeout(zx));var e=t-nm;e>24?(t<1/0&&(zx=setTimeout(VP,t-Q1.now()-UT)),ex&&(ex=clearInterval(ex))):(ex||(qw=Q1.now(),ex=setInterval(pse,MV)),q0=1,CV(VP))}}const gse=1664525,vse=1013904223,HP=4294967296;function yse(){let t=1;return()=>(t=(gse*t+vse)%HP)/HP}var jP=3;function f3(t){return t.x}function WP(t){return t.y}function xse(t){return t.z}var _se=10,bse=Math.PI*(3-Math.sqrt(5)),Sse=Math.PI*20/(9+Math.sqrt(221));function OV(t,e){e=e||2;var n=Math.min(jP,Math.max(1,Math.round(e))),i,r=1,s=.001,a=1-Math.pow(s,1/300),o=0,l=.6,u=new Map,c=DV(m),h=TV("tick","end"),d=yse();t==null&&(t=[]);function m(){v(),h.call("tick",i),r<s&&(c.stop(),h.call("end",i))}function v(g){var x,S=t.length,E;g===void 0&&(g=1);for(var A=0;A<g;++A)for(r+=(o-r)*a,u.forEach(function(T){T(r)}),x=0;x<S;++x)E=t[x],E.fx==null?E.x+=E.vx*=l:(E.x=E.fx,E.vx=0),n>1&&(E.fy==null?E.y+=E.vy*=l:(E.y=E.fy,E.vy=0)),n>2&&(E.fz==null?E.z+=E.vz*=l:(E.z=E.fz,E.vz=0));return i}function _(){for(var g=0,x=t.length,S;g<x;++g){if(S=t[g],S.index=g,S.fx!=null&&(S.x=S.fx),S.fy!=null&&(S.y=S.fy),S.fz!=null&&(S.z=S.fz),isNaN(S.x)||n>1&&isNaN(S.y)||n>2&&isNaN(S.z)){var E=_se*(n>2?Math.cbrt(.5+g):n>1?Math.sqrt(.5+g):g),A=g*bse,T=g*Sse;n===1?S.x=E:n===2?(S.x=E*Math.cos(A),S.y=E*Math.sin(A)):(S.x=E*Math.sin(A)*Math.cos(T),S.y=E*Math.cos(A),S.z=E*Math.sin(A)*Math.sin(T))}(isNaN(S.vx)||n>1&&isNaN(S.vy)||n>2&&isNaN(S.vz))&&(S.vx=0,n>1&&(S.vy=0),n>2&&(S.vz=0))}}function y(g){return g.initialize&&g.initialize(t,d,n),g}return _(),i={tick:v,restart:function(){return c.restart(m),i},stop:function(){return c.stop(),i},numDimensions:function(g){return arguments.length?(n=Math.min(jP,Math.max(1,Math.round(g))),u.forEach(y),i):n},nodes:function(g){return arguments.length?(t=g,_(),u.forEach(y),i):t},alpha:function(g){return arguments.length?(r=+g,i):r},alphaMin:function(g){return arguments.length?(s=+g,i):s},alphaDecay:function(g){return arguments.length?(a=+g,i):+a},alphaTarget:function(g){return arguments.length?(o=+g,i):o},velocityDecay:function(g){return arguments.length?(l=1-g,i):1-l},randomSource:function(g){return arguments.length?(d=g,u.forEach(y),i):d},force:function(g,x){return arguments.length>1?(x==null?u.delete(g):u.set(g,y(x)),i):u.get(g)},find:function(){var g=Array.prototype.slice.call(arguments),x=g.shift()||0,S=(n>1?g.shift():null)||0,E=(n>2?g.shift():null)||0,A=g.shift()||1/0,T=0,C=t.length,O,M,D,P,F,G;for(A*=A,T=0;T<C;++T)F=t[T],O=x-F.x,M=S-(F.y||0),D=E-(F.z||0),P=O*O+M*M+D*D,P<A&&(G=F,A=P);return G},on:function(g,x){return arguments.length>1?(h.on(g,x),i):h.on(g)}}}function UV(){var t,e,n,i,r,s=Br(-30),a,o=1,l=1/0,u=.81;function c(v){var _,y=t.length,g=(e===1?az(t,f3):e===2?lz(t,f3,WP):e===3?cz(t,f3,WP,xse):null).visitAfter(d);for(r=v,_=0;_<y;++_)n=t[_],g.visit(m)}function h(){if(t){var v,_=t.length,y;for(a=new Array(_),v=0;v<_;++v)y=t[v],a[y.index]=+s(y,v,t)}}function d(v){var _=0,y,g,x=0,S,E,A,T,C=v.length;if(C){for(S=E=A=T=0;T<C;++T)(y=v[T])&&(g=Math.abs(y.value))&&(_+=y.value,x+=g,S+=g*(y.x||0),E+=g*(y.y||0),A+=g*(y.z||0));_*=Math.sqrt(4/C),v.x=S/x,e>1&&(v.y=E/x),e>2&&(v.z=A/x)}else{y=v,y.x=y.data.x,e>1&&(y.y=y.data.y),e>2&&(y.z=y.data.z);do _+=a[y.data.index];while(y=y.next)}v.value=_}function m(v,_,y,g,x){if(!v.value)return!0;var S=[y,g,x][e-1],E=v.x-n.x,A=e>1?v.y-n.y:0,T=e>2?v.z-n.z:0,C=S-_,O=E*E+A*A+T*T;if(C*C/u<O)return O<l&&(E===0&&(E=il(i),O+=E*E),e>1&&A===0&&(A=il(i),O+=A*A),e>2&&T===0&&(T=il(i),O+=T*T),O<o&&(O=Math.sqrt(o*O)),n.vx+=E*v.value*r/O,e>1&&(n.vy+=A*v.value*r/O),e>2&&(n.vz+=T*v.value*r/O)),!0;if(v.length||O>=l)return;(v.data!==n||v.next)&&(E===0&&(E=il(i),O+=E*E),e>1&&A===0&&(A=il(i),O+=A*A),e>2&&T===0&&(T=il(i),O+=T*T),O<o&&(O=Math.sqrt(o*O)));do v.data!==n&&(C=a[v.data.index]*r/O,n.vx+=E*C,e>1&&(n.vy+=A*C),e>2&&(n.vz+=T*C));while(v=v.next)}return c.initialize=function(v,..._){t=v,i=_.find(y=>typeof y=="function")||Math.random,e=_.find(y=>[1,2,3].includes(y))||2,h()},c.strength=function(v){return arguments.length?(s=typeof v=="function"?v:Br(+v),h(),c):s},c.distanceMin=function(v){return arguments.length?(o=v*v,c):Math.sqrt(o)},c.distanceMax=function(v){return arguments.length?(l=v*v,c):Math.sqrt(l)},c.theta=function(v){return arguments.length?(u=v*v,c):Math.sqrt(u)},c}function Ese(t,e,n,i){var r,s,a=Br(.1),o,l;typeof t!="function"&&(t=Br(+t)),e==null&&(e=0),n==null&&(n=0),i==null&&(i=0);function u(h){for(var d=0,m=r.length;d<m;++d){var v=r[d],_=v.x-e||1e-6,y=(v.y||0)-n||1e-6,g=(v.z||0)-i||1e-6,x=Math.sqrt(_*_+y*y+g*g),S=(l[d]-x)*o[d]*h/x;v.vx+=_*S,s>1&&(v.vy+=y*S),s>2&&(v.vz+=g*S)}}function c(){if(r){var h,d=r.length;for(o=new Array(d),l=new Array(d),h=0;h<d;++h)l[h]=+t(r[h],h,r),o[h]=isNaN(l[h])?0:+a(r[h],h,r)}}return u.initialize=function(h,...d){r=h,s=d.find(m=>[1,2,3].includes(m))||2,c()},u.strength=function(h){return arguments.length?(a=typeof h=="function"?h:Br(+h),c(),u):a},u.radius=function(h){return arguments.length?(t=typeof h=="function"?h:Br(+h),c(),u):t},u.x=function(h){return arguments.length?(e=+h,u):e},u.y=function(h){return arguments.length?(n=+h,u):n},u.z=function(h){return arguments.length?(i=+h,u):i},u}function gD(t){var e=Br(.1),n,i,r;typeof t!="function"&&(t=Br(t==null?0:+t));function s(o){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vx+=(r[l]-c.x)*i[l]*o}function a(){if(n){var o,l=n.length;for(i=new Array(l),r=new Array(l),o=0;o<l;++o)i[o]=isNaN(r[o]=+t(n[o],o,n))?0:+e(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(e=typeof o=="function"?o:Br(+o),a(),s):e},s.x=function(o){return arguments.length?(t=typeof o=="function"?o:Br(+o),a(),s):t},s}function vD(t){var e=Br(.1),n,i,r;typeof t!="function"&&(t=Br(t==null?0:+t));function s(o){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vy+=(r[l]-c.y)*i[l]*o}function a(){if(n){var o,l=n.length;for(i=new Array(l),r=new Array(l),o=0;o<l;++o)i[o]=isNaN(r[o]=+t(n[o],o,n))?0:+e(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(e=typeof o=="function"?o:Br(+o),a(),s):e},s.y=function(o){return arguments.length?(t=typeof o=="function"?o:Br(+o),a(),s):t},s}function wse(t){var e=Br(.1),n,i,r;typeof t!="function"&&(t=Br(t==null?0:+t));function s(o){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vz+=(r[l]-c.z)*i[l]*o}function a(){if(n){var o,l=n.length;for(i=new Array(l),r=new Array(l),o=0;o<l;++o)i[o]=isNaN(r[o]=+t(n[o],o,n))?0:+e(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(e=typeof o=="function"?o:Br(+o),a(),s):e},s.z=function(o){return arguments.length?(t=typeof o=="function"?o:Br(+o),a(),s):t},s}function zV(t,e=[]){const n=e.length;for(const i of t){const r=e.indexOf(i);if(r>-1){const s=[...e.slice(r),i].map(a=>a.data.id);throw new Error(`Invalid Graph: Circular node path detected: ${s.join(" -> ")}.`)}n>i.depth&&(i.depth=n,zV(i.out,[...e,i]))}}function IV(t,e){let n=!1;const i=t.reduce((a,o)=>({...a,[o.id]:{data:o,out:[],depth:-1,ins:[]}}),{});try{for(const a of e){const o=a.source,l=a.target;if(!i.hasOwnProperty(o))throw new Error(`Missing source Node ${o}`);if(!i.hasOwnProperty(l))throw new Error(`Missing target Node ${l}`);const u=i[o],c=i[l];c.ins.push(u),u.out.push(c)}zV(Object.values(i))}catch{n=!0}const r=Object.keys(i).map(a=>i[a].depth),s=Math.max(...r);return{invalid:n,depths:i,maxDepth:s||1}}const XP=["radialin","radialout"];function Ase({nodes:t,edges:e,mode:n="lr",nodeLevelRatio:i=2}){const{depths:r,maxDepth:s,invalid:a}=IV(t,e);if(a)return null;const o=XP.includes(n)?1:5,l=t.length/s*i*o;if(n){const u=(m,v)=>_=>m?(r[_.id].depth-s/2)*l*(v?-1:1):void 0,c=u(["lr","rl"].includes(n),n==="rl"),h=u(["td","bu"].includes(n),n==="td"),d=u(["zin","zout"].includes(n),n==="zout");t.forEach(m=>{m.fx=c(m),m.fy=h(m),m.fz=d(m)})}return XP.includes(n)?Ese(u=>{const c=r[u.id];return(n==="radialin"?s-c.depth:c.depth)*l}).strength(1):null}function Tse(t){return new Promise((e,n)=>{let i;function r(){i?e(i):(i=t.step(),r())}r()})}function mm(t){const e=[],n=[];return t.forEachNode((i,r)=>{e.push({...r,id:i,radius:r.size||1})}),t.forEachEdge((i,r)=>{n.push({...r,id:i})}),{nodes:e,edges:n}}function Mse(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else for(;--i>=0;)e+=n[i].value;t.value=e}function Cse(){return this.eachAfter(Mse)}function Rse(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this}function Dse(t,e){for(var n=this,i=[n],r,s,a=-1;n=i.pop();)if(t.call(e,n,++a,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this}function Ose(t,e){for(var n=this,i=[n],r=[],s,a,o,l=-1;n=i.pop();)if(r.push(n),s=n.children)for(a=0,o=s.length;a<o;++a)i.push(s[a]);for(;n=r.pop();)t.call(e,n,++l,this);return this}function Use(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i}function zse(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n})}function Ise(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Lse(t){for(var e=this,n=Pse(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i}function Pse(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}function Nse(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function Bse(){return Array.from(this)}function kse(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Fse(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*Gse(){var t=this,e,n=[t],i,r,s;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,i=t.children)for(r=0,s=i.length;r<s;++r)n.push(i[r]);while(n.length)}function zT(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=jse)):e===void 0&&(e=Hse);for(var n=new K0(t),i,r=[n],s,a,o,l;i=r.pop();)if((a=e(i.data))&&(l=(a=Array.from(a)).length))for(i.children=a,o=l-1;o>=0;--o)r.push(s=a[o]=new K0(a[o])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(LV)}function Vse(){return zT(this).eachBefore(Wse)}function Hse(t){return t.children}function jse(t){return Array.isArray(t)?t[1]:null}function Wse(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function LV(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function K0(t){this.data=t,this.depth=this.height=0,this.parent=null}K0.prototype=zT.prototype={constructor:K0,count:Cse,each:Rse,eachAfter:Ose,eachBefore:Dse,find:Use,sum:zse,sort:Ise,path:Lse,ancestors:Nse,descendants:Bse,leaves:kse,links:Fse,copy:Vse,[Symbol.iterator]:Gse};function h3(t){return t==null?null:PV(t)}function PV(t){if(typeof t!="function")throw new Error;return t}function tx(){return 0}function nx(t){return function(){return t}}function Xse(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Yse(t,e,n,i,r){for(var s=t.children,a,o=-1,l=s.length,u=t.value&&(i-e)/t.value;++o<l;)a=s[o],a.y0=n,a.y1=r,a.x0=e,a.x1=e+=a.value*u}var Zse={depth:-1},YP={},d3={};function qse(t){return t.id}function Kse(t){return t.parentId}function Qse(){var t=qse,e=Kse,n;function i(r){var s=Array.from(r),a=t,o=e,l,u,c,h,d,m,v,_,y=new Map;if(n!=null){const g=s.map((E,A)=>Jse(n(E,A,r))),x=g.map(ZP),S=new Set(g).add("");for(const E of x)S.has(E)||(S.add(E),g.push(E),x.push(ZP(E)),s.push(d3));a=(E,A)=>g[A],o=(E,A)=>x[A]}for(c=0,l=s.length;c<l;++c)u=s[c],m=s[c]=new K0(u),(v=a(u,c,r))!=null&&(v+="")&&(_=m.id=v,y.set(_,y.has(_)?YP:m)),(v=o(u,c,r))!=null&&(v+="")&&(m.parent=v);for(c=0;c<l;++c)if(m=s[c],v=m.parent){if(d=y.get(v),!d)throw new Error("missing: "+v);if(d===YP)throw new Error("ambiguous: "+v);d.children?d.children.push(m):d.children=[m],m.parent=d}else{if(h)throw new Error("multiple roots");h=m}if(!h)throw new Error("no root");if(n!=null){for(;h.data===d3&&h.children.length===1;)h=h.children[0],--l;for(let g=s.length-1;g>=0&&(m=s[g],m.data===d3);--g)m.data=null}if(h.parent=Zse,h.eachBefore(function(g){g.depth=g.parent.depth+1,--l}).eachBefore(LV),h.parent=null,l>0)throw new Error("cycle");return h}return i.id=function(r){return arguments.length?(t=h3(r),i):t},i.parentId=function(r){return arguments.length?(e=h3(r),i):e},i.path=function(r){return arguments.length?(n=h3(r),i):n},i}function Jse(t){t=`${t}`;let e=t.length;return yD(t,e-1)&&!yD(t,e-2)&&(t=t.slice(0,-1)),t[0]==="/"?t:`/${t}`}function ZP(t){let e=t.length;if(e<2)return"";for(;--e>1&&!yD(t,e););return t.slice(0,e)}function yD(t,e){if(t[e]==="/"){let n=0;for(;e>0&&t[--e]==="\\";)++n;if(!(n&1))return!0}return!1}function $se(t,e){return t.parent===e.parent?1:2}function p3(t){var e=t.children;return e?e[0]:t.t}function m3(t){var e=t.children;return e?e[e.length-1]:t.t}function eae(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function tae(t){for(var e=0,n=0,i=t.children,r=i.length,s;--r>=0;)s=i[r],s.z+=e,s.m+=e,e+=s.s+(n+=s.c)}function nae(t,e,n){return t.a.parent===e.parent?t.a:n}function mE(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}mE.prototype=Object.create(K0.prototype);function iae(t){for(var e=new mE(t,0),n,i=[e],r,s,a,o;n=i.pop();)if(s=n._.children)for(n.children=new Array(o=s.length),a=o-1;a>=0;--a)i.push(r=n.children[a]=new mE(s[a],a)),r.parent=n;return(e.parent=new mE(null,0)).children=[e],e}function rae(){var t=$se,e=1,n=1,i=null;function r(u){var c=iae(u);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(a),i)u.eachBefore(l);else{var h=u,d=u,m=u;u.eachBefore(function(x){x.x<h.x&&(h=x),x.x>d.x&&(d=x),x.depth>m.depth&&(m=x)});var v=h===d?1:t(h,d)/2,_=v-h.x,y=e/(d.x+v+_),g=n/(m.depth||1);u.eachBefore(function(x){x.x=(x.x+_)*y,x.y=x.depth*g})}return u}function s(u){var c=u.children,h=u.parent.children,d=u.i?h[u.i-1]:null;if(c){tae(u);var m=(c[0].z+c[c.length-1].z)/2;d?(u.z=d.z+t(u._,d._),u.m=u.z-m):u.z=m}else d&&(u.z=d.z+t(u._,d._));u.parent.A=o(u,d,u.parent.A||h[0])}function a(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function o(u,c,h){if(c){for(var d=u,m=u,v=c,_=d.parent.children[0],y=d.m,g=m.m,x=v.m,S=_.m,E;v=m3(v),d=p3(d),v&&d;)_=p3(_),m=m3(m),m.a=u,E=v.z+x-d.z-y+t(v._,d._),E>0&&(eae(nae(v,u,h),u,E),y+=E,g+=E),x+=v.m,y+=d.m,S+=_.m,g+=m.m;v&&!m3(m)&&(m.t=v,m.m+=x-g),d&&!p3(_)&&(_.t=d,_.m+=y-S,h=u)}return h}function l(u){u.x*=e,u.y=u.depth*n}return r.separation=function(u){return arguments.length?(t=u,r):t},r.size=function(u){return arguments.length?(i=!1,e=+u[0],n=+u[1],r):i?null:[e,n]},r.nodeSize=function(u){return arguments.length?(i=!0,e=+u[0],n=+u[1],r):i?[e,n]:null},r}function sae(t,e,n,i,r){for(var s=t.children,a,o=-1,l=s.length,u=t.value&&(r-n)/t.value;++o<l;)a=s[o],a.x0=e,a.x1=i,a.y0=n,a.y1=n+=a.value*u}var aae=(1+Math.sqrt(5))/2;function oae(t,e,n,i,r,s){for(var a=[],o=e.children,l,u,c=0,h=0,d=o.length,m,v,_=e.value,y,g,x,S,E,A,T;c<d;){m=r-n,v=s-i;do y=o[h++].value;while(!y&&h<d);for(g=x=y,A=Math.max(v/m,m/v)/(_*t),T=y*y*A,E=Math.max(x/T,T/g);h<d;++h){if(y+=u=o[h].value,u<g&&(g=u),u>x&&(x=u),T=y*y*A,S=Math.max(x/T,T/g),S>E){y-=u;break}E=S}a.push(l={value:y,dice:m<v,children:o.slice(c,h)}),l.dice?Yse(l,n,i,r,_?i+=v*y/_:s):sae(l,n,i,_?n+=m*y/_:r,s),_-=y,c=h}return a}const lae=function t(e){function n(i,r,s,a,o){oae(e,i,r,s,a,o)}return n.ratio=function(i){return t((i=+i)>1?i:1)},n}(aae);function uae(){var t=lae,e=!1,n=1,i=1,r=[0],s=tx,a=tx,o=tx,l=tx,u=tx;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(h),r=[0],e&&d.eachBefore(Xse),d}function h(d){var m=r[d.depth],v=d.x0+m,_=d.y0+m,y=d.x1-m,g=d.y1-m;y<v&&(v=y=(v+y)/2),g<_&&(_=g=(_+g)/2),d.x0=v,d.y0=_,d.x1=y,d.y1=g,d.children&&(m=r[d.depth+1]=s(d)/2,v+=u(d)-m,_+=a(d)-m,y-=o(d)-m,g-=l(d)-m,y<v&&(v=y=(v+y)/2),g<_&&(_=g=(_+g)/2),t(d,v,_,y,g))}return c.round=function(d){return arguments.length?(e=!!d,c):e},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(t=PV(d),c):t},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s=typeof d=="function"?d:nx(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(a=typeof d=="function"?d:nx(+d),c):a},c.paddingRight=function(d){return arguments.length?(o=typeof d=="function"?d:nx(+d),c):o},c.paddingBottom=function(d){return arguments.length?(l=typeof d=="function"?d:nx(+d),c):l},c.paddingLeft=function(d){return arguments.length?(u=typeof d=="function"?d:nx(+d),c):u},c}function cae(){const t=k=>()=>k;let n=k=>k.index,i=[],r=[],s,a,o=[100,100],l=t(1),u=t(-1),c=t(100),h=t(.1),d={},m=.1,v=.001,_=[],y=[0,0],g,x=k=>k.cluster,S="treemap",E=!0,A=.1;function T(k){if(!E)return T;S==="force"&&(g.tick(),G());for(let j=0,X=i.length,Q,H=k*A;j<X;++j)Q=i[j],Q.vx+=(d[x(Q)].x-Q.x)*H,Q.vy+=(d[x(Q)].y-Q.y)*H}function C(){i&&(S==="treemap"?z():N())}T.initialize=function(k){i=k,C()};function O(k){let j=x(k.source),X=x(k.target);return j<=X?j+"~"+X:X+"~"+j}function M(k){let j=new Map,X={};return k.forEach(function(Q){j.has(x(Q))||j.set(x(Q),{count:0,sumforceNodeSize:0})}),k.forEach(function(Q){X=j.get(x(Q)),X.count=X.count+1,X.sumforceNodeSize=X.sumforceNodeSize+Math.PI*(l(Q)*l(Q))*1.3,j.set(x(Q),X)}),j}function D(k){let j=new Map,X=[];return k.forEach(function(Q){let H=O(Q),$;j.has(H)?$=j.get(H):$=0,$+=1,j.set(H,$)}),j.forEach(function(Q,H){let $,ne;$=H.split("~")[0],ne=H.split("~")[1],$!==void 0&&ne!==void 0&&X.push({source:$,target:ne,count:Q})}),X}function P(){let k=[],j=[],X=new Map,Q,H,$,ne,q;ne=M(i),q=D(r);for(Q of ne.keys())$=ne.get(Q),k.push({id:Q,size:$.count,r:Math.sqrt($.sumforceNodeSize/Math.PI)}),X.set(Q,H);return q.forEach(function(se){let ve=X.get(se.source),pe=X.get(se.target);ve!==void 0&&pe!==void 0&&j.push({source:ve,target:pe,count:se.count})}),{nodes:k,links:j}}function F(){let k=[],j,X,Q;Q=M(T.nodes());for(j of Q.keys())X=Q.get(j),k.push({id:j,size:X.count});return{id:"clustersTree",children:k}}function G(){return d.none={x:0,y:0},_.forEach(function(k){S==="treemap"?d[k.data.id]={x:k.x0+(k.x1-k.x0)/2-y[0],y:k.y0+(k.y1-k.y0)/2-y[1]}:d[k.id]={x:k.x-y[0],y:k.y-y[1]}}),d}function z(){let k=uae().size(T.size());a=zT(F()).sum(j=>j.radius).sort(function(j,X){return X.height-j.height||X.value-j.value}),_=k(a).leaves(),G()}function Y(){let k=0;i.length!==0&&r.forEach(function(j){let X,Q;if(i){if(X=j.source,Q=j.target,typeof j.source!="object"&&(X=i.find(H=>H.id===j.source)),typeof j.target!="object"&&(Q=i.find(H=>H.id===j.target)),X===void 0||Q===void 0)throw Error("Error setting links, couldnt find nodes for a link (see it on the console)");j.source=X,j.target=Q,j.index=k++}})}function N(){let k;!i||!i.length||(Y(),k=P(),s.size>0&&k.nodes.forEach(j=>{var X,Q,H,$;j.fx=(Q=(X=s.get(j.id))==null?void 0:X.position)==null?void 0:Q.x,j.fy=($=(H=s.get(j.id))==null?void 0:H.position)==null?void 0:$.y}),g=OV(k.nodes).force("x",gD(o[0]/2).strength(.1)).force("y",vD(o[1]/2).strength(.1)).force("collide",wV(j=>j.r).iterations(4)).force("charge",UV().strength(u)).force("links",AV(k.nodes.length?k.links:[]).distance(c).strength(h)),_=g.nodes(),G())}return T.template=function(k){return arguments.length?(S=k,C(),T):S},T.groupBy=function(k){return arguments.length?typeof k=="string"?(x=function(j){return j[k]},T):(x=k,T):x},T.enableGrouping=function(k){return arguments.length?(E=k,T):E},T.strength=function(k){return arguments.length?(A=k,T):A},T.getLinkStrength=function(k){return E?x(k.source)===x(k.target)?typeof m=="function"?m(k):m:typeof v=="function"?v(k):v:typeof m=="function"?m(k):m},T.id=function(k){return arguments.length?(n=k,T):n},T.size=function(k){return arguments.length?(o=k,T):o},T.linkStrengthInterCluster=function(k){return arguments.length?(v=k,T):v},T.linkStrengthIntraCluster=function(k){return arguments.length?(m=k,T):m},T.nodes=function(k){return arguments.length?(i=k,T):i},T.links=function(k){return arguments.length?(k===null?r=[]:r=k,C(),T):r},T.template=function(k){return arguments.length?(S=k,C(),T):S},T.forceNodeSize=function(k){return arguments.length?(l=typeof k=="function"?k:t(+k),C(),T):l},T.nodeSize=T.forceNodeSize,T.forceCharge=function(k){return arguments.length?(u=typeof k=="function"?k:t(+k),C(),T):u},T.forceLinkDistance=function(k){return arguments.length?(c=typeof k=="function"?k:t(+k),C(),T):c},T.forceLinkStrength=function(k){return arguments.length?(h=typeof k=="function"?k:t(+k),C(),T):h},T.offset=function(k){return arguments.length?(y=typeof k=="function"?k:t(+k),T):y},T.getFocis=G,T.setClusters=function(k){return s=k,T},T}function Mh({graph:t,nodeLevelRatio:e=2,mode:n=null,dimensions:i=2,nodeStrength:r=-250,linkDistance:s=50,clusterStrength:a=.5,linkStrengthInterCluster:o=.01,linkStrengthIntraCluster:l=.5,forceLinkDistance:u=100,forceLinkStrength:c=.1,clusterType:h="force",forceCharge:d=-700,getNodePosition:m,drags:v,clusters:_,clusterAttribute:y,forceLayout:g}){const{nodes:x,edges:S}=mm(t),A=i===2&&S.length>25?r*2:r;let T,C;g==="forceDirected2d"?(T=gD(),C=vD()):(T=gD(600).strength(.05),C=vD(600).strength(.05));const O=OV().force("center",cre(0,0)).force("link",AV()).force("charge",UV().strength(A)).force("x",T).force("y",C).force("z",wse()).force("collide",wV(F=>F.radius+10)).force("dagRadial",Ase({nodes:x,edges:S,mode:n,nodeLevelRatio:e})).stop();let M;if(y){let F=d;if(x!=null&&x.length){const G=Math.ceil(x.length/200);F=d*G}M=cae().setClusters(_).strength(a).template(h).groupBy(G=>G.data[y]).links(S).size([100,100]).linkStrengthInterCluster(o).linkStrengthIntraCluster(l).forceLinkDistance(u).forceLinkStrength(c).forceCharge(F).forceNodeSize(G=>G.radius)}let D=O.numDimensions(i).nodes(x);if(M&&(D=D.force("group",M)),s){let F=D.force("link");F&&(F.id(G=>G.id).links(S).distance(s),M&&(F=F.strength((M==null?void 0:M.getLinkStrength)??.1)))}const P=new Map(x.map(F=>[F.id,F]));return{step(){for(;O.alpha()>.01;)O.tick();return!0},getNodePosition(F){var G,z;if(m){const Y=m(F,{graph:t,drags:v,nodes:x,edges:S});if(Y)return Y}return(G=v==null?void 0:v[F])!=null&&G.position?(z=v==null?void 0:v[F])==null?void 0:z.position:P.get(F)}}}function fae(t){return!t||typeof t!="object"||typeof t=="function"||Array.isArray(t)||t instanceof Set||t instanceof Map||t instanceof RegExp||t instanceof Date}function NV(t,e){t=t||{};var n={};for(var i in e){var r=t[i],s=e[i];if(!fae(s)){n[i]=NV(r,s);continue}r===void 0?n[i]=s:n[i]=r}return n}var hz=NV,Bf=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"},hae=hz,dae=Bf,pae={dimensions:["x","y"],center:.5,scale:1};function BV(t,e,n){if(!dae(e))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");n=hae(n,pae);var i=n.dimensions;if(!Array.isArray(i)||i.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");var r=n.center,s=n.scale,a=Math.PI*2,o=(r-.5)*s,l=e.order,u=i[0],c=i[1];function h(v,_){return _[u]=s*Math.cos(v*a/l)+o,_[c]=s*Math.sin(v*a/l)+o,_}var d=0;if(!t){var m={};return e.forEachNode(function(v){m[v]=h(d++,{})}),m}e.updateEachNodeAttributes(function(v,_){return h(d++,_),_},{attributes:i})}var kV=BV.bind(null,!1);kV.assign=BV.bind(null,!0);var mae=kV;const gae=Lo(mae);function vae({graph:t,radius:e,drags:n,getNodePosition:i}){const r=gae(t,{scale:e}),{nodes:s,edges:a}=mm(t);return{step(){return!0},getNodePosition(o){var l,u;if(i){const c=i(o,{graph:t,drags:n,nodes:s,edges:a});if(c)return c}return(l=n==null?void 0:n[o])!=null&&l.position?(u=n==null?void 0:n[o])==null?void 0:u.position:r==null?void 0:r[o]}}}const yae={td:{x:"x",y:"y",factor:-1},lr:{x:"y",y:"x",factor:1}};function qP({graph:t,drags:e,mode:n="td",nodeSeparation:i=1,nodeSize:r=[50,50],getNodePosition:s}){const{nodes:a,edges:o}=mm(t),{depths:l}=IV(a,o),u=Object.keys(l).map(_=>l[_]),c=Qse().id(_=>_.data.id).parentId(_=>{var y,g,x;return(x=(g=(y=_.ins)==null?void 0:y[0])==null?void 0:g.data)==null?void 0:x.id})(u),d=rae().separation(()=>i).nodeSize(r)(zT(c)).descendants(),m=yae[n],v=new Map(a.map(_=>{const{x:y,y:g}=d.find(x=>x.data.id===_.id);return[_.id,{..._,[m.x]:y*m.factor,[m.y]:g*m.factor,z:0}]}));return{step(){return!0},getNodePosition(_){var y,g;if(s){const x=s(_,{graph:t,drags:e,nodes:a,edges:o});if(x)return x}return(y=e==null?void 0:e[_])!=null&&y.position?(g=e==null?void 0:e[_])==null?void 0:g.position:v.get(_)}}}var ix=0,rx=1,b2=2,sx=3;function xae(t,e){return t+"§"+e}function KP(){return .01*(.5-Math.random())}var _ae=function(e,n){var i=e.margin,r=e.ratio,s=e.expansion,a=e.gridSize,o=e.speed,l,u,c,h,d,m,v=!0,_=n.length,y=_/sx|0,g=new Float32Array(y),x=new Float32Array(y),S=1/0,E=1/0,A=-1/0,T=-1/0;for(l=0;l<_;l+=sx)c=n[l+ix],h=n[l+rx],m=n[l+b2]*r+i,S=Math.min(S,c-m),A=Math.max(A,c+m),E=Math.min(E,h-m),T=Math.max(T,h+m);var C=A-S,O=T-E,M=(S+A)/2,D=(E+T)/2;S=M-s*C/2,A=M+s*C/2,E=D-s*O/2,T=D+s*O/2;var P=new Array(a*a),F=P.length,G;for(G=0;G<F;G++)P[G]=[];var z,Y,N,k,j,X,Q,H,$,ne;for(l=0;l<_;l+=sx)for(c=n[l+ix],h=n[l+rx],m=n[l+b2]*r+i,z=c-m,Y=c+m,N=h-m,k=h+m,j=Math.floor(a*(z-S)/(A-S)),X=Math.floor(a*(Y-S)/(A-S)),Q=Math.floor(a*(N-E)/(T-E)),H=Math.floor(a*(k-E)/(T-E)),$=j;$<=X;$++)for(ne=Q;ne<=H;ne++)P[$*a+ne].push(l);var q,se=new Set,ve,pe,xe,ot,st,et,Te,Xe,K,Pe,Ne,Ve,_e;for(G=0;G<F;G++)for(q=P[G],l=0,d=q.length;l<d;l++)for(ve=q[l],xe=n[ve+ix],st=n[ve+rx],Te=n[ve+b2],u=l+1;u<d;u++)pe=q[u],K=xae(ve,pe),!(F>1&&se.has(K))&&(F>1&&se.add(K),ot=n[pe+ix],et=n[pe+rx],Xe=n[pe+b2],Pe=ot-xe,Ne=et-st,Ve=Math.sqrt(Pe*Pe+Ne*Ne),_e=Ve<Te*r+i+(Xe*r+i),_e&&(v=!1,pe=pe/sx|0,Ve>0?(g[pe]+=Pe/Ve*(1+Te),x[pe]+=Ne/Ve*(1+Te)):(g[pe]+=C*KP(),x[pe]+=O*KP())));for(l=0,u=0;l<_;l+=sx,u++)n[l+ix]+=g[u]*.1*o,n[l+rx]+=x[u]*.1*o;return{converged:v}},xv={},Kw=3;xv.validateSettings=function(t){return"gridSize"in t&&typeof t.gridSize!="number"||t.gridSize<=0?{message:"the `gridSize` setting should be a positive number."}:"margin"in t&&typeof t.margin!="number"||t.margin<0?{message:"the `margin` setting should be 0 or a positive number."}:"expansion"in t&&typeof t.expansion!="number"||t.expansion<=0?{message:"the `expansion` setting should be a positive number."}:"ratio"in t&&typeof t.ratio!="number"||t.ratio<=0?{message:"the `ratio` setting should be a positive number."}:"speed"in t&&typeof t.speed!="number"||t.speed<=0?{message:"the `speed` setting should be a positive number."}:null};xv.graphToByteArray=function(t,e){var n=t.order,i=new Float32Array(n*Kw),r=0;return t.forEachNode(function(s,a){typeof e=="function"&&(a=e(s,a)),i[r]=a.x,i[r+1]=a.y,i[r+2]=a.size||1,r+=Kw}),i};xv.assignLayoutChanges=function(t,e,n){var i=0;t.forEachNode(function(r){var s={x:e[i],y:e[i+1]};typeof n=="function"&&(s=n(r,s)),t.mergeNodeAttributes(r,s),i+=Kw})};xv.collectLayoutChanges=function(t,e,n){var i={},r=0;return t.forEachNode(function(s){var a={x:e[r],y:e[r+1]};typeof n=="function"&&(a=n(s,a)),i[s]=a,r+=Kw}),i};xv.createWorker=function(e){var n=window.URL||window.webkitURL,i=e.toString(),r=n.createObjectURL(new Blob(["("+i+").call(this);"],{type:"text/javascript"})),s=new Worker(r);return n.revokeObjectURL(r),s};var bae={gridSize:20,margin:5,expansion:1.1,ratio:1,speed:3},Sae=Bf,Eae=_ae,S2=xv,wae=bae,Aae=500;function FV(t,e,n){if(!Sae(e))throw new Error("graphology-layout-noverlap: the given graph is not a valid graphology instance.");typeof n=="number"?n={maxIterations:n}:n=n||{};var i=n.maxIterations||Aae;if(typeof i!="number"||i<=0)throw new Error("graphology-layout-force: you should provide a positive number of maximum iterations.");var r=Object.assign({},wae,n.settings),s=S2.validateSettings(r);if(s)throw new Error("graphology-layout-noverlap: "+s.message);var a=S2.graphToByteArray(e,n.inputReducer),o=!1,l;for(l=0;l<i&&!o;l++)o=Eae(r,a).converged;if(t){S2.assignLayoutChanges(e,a,n.outputReducer);return}return S2.collectLayoutChanges(e,a,n.outputReducer)}var GV=FV.bind(null,!1);GV.assign=FV.bind(null,!0);var Tae=GV;const Mae=Lo(Tae);function Cae({graph:t,margin:e,drags:n,getNodePosition:i,ratio:r,gridSize:s,maxIterations:a}){const{nodes:o,edges:l}=mm(t),u=Mae(t,{maxIterations:a,inputReducer:(c,h)=>({...h,x:h.x||0,y:h.y||0}),settings:{ratio:r,margin:e,gridSize:s}});return{step(){return!0},getNodePosition(c){var h,d;if(i){const m=i(c,{graph:t,drags:n,nodes:o,edges:l});if(m)return m}return(h=n==null?void 0:n[c])!=null&&h.position?(d=n==null?void 0:n[c])==null?void 0:d.position:u==null?void 0:u[c]}}}var gm={};function Rae(t){return typeof t!="number"||isNaN(t)?1:t}function Dae(t,e){var n={},i=function(a){return typeof a>"u"?e:a};typeof e=="function"&&(i=e);var r=function(a){return i(a[t])},s=function(){return i(void 0)};return typeof t=="string"?(n.fromAttributes=r,n.fromGraph=function(a,o){return r(a.getNodeAttributes(o))},n.fromEntry=function(a,o){return r(o)}):typeof t=="function"?(n.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},n.fromGraph=function(a,o){return i(t(o,a.getNodeAttributes(o)))},n.fromEntry=function(a,o){return i(t(a,o))}):(n.fromAttributes=s,n.fromGraph=s,n.fromEntry=s),n}function VV(t,e){var n={},i=function(a){return typeof a>"u"?e:a};typeof e=="function"&&(i=e);var r=function(a){return i(a[t])},s=function(){return i(void 0)};return typeof t=="string"?(n.fromAttributes=r,n.fromGraph=function(a,o){return r(a.getEdgeAttributes(o))},n.fromEntry=function(a,o){return r(o)},n.fromPartialEntry=n.fromEntry,n.fromMinimalEntry=n.fromEntry):typeof t=="function"?(n.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},n.fromGraph=function(a,o){var l=a.extremities(o);return i(t(o,a.getEdgeAttributes(o),l[0],l[1],a.getNodeAttributes(l[0]),a.getNodeAttributes(l[1]),a.isUndirected(o)))},n.fromEntry=function(a,o,l,u,c,h,d){return i(t(a,o,l,u,c,h,d))},n.fromPartialEntry=function(a,o,l,u){return i(t(a,o,l,u))},n.fromMinimalEntry=function(a,o){return i(t(a,o))}):(n.fromAttributes=s,n.fromGraph=s,n.fromEntry=s,n.fromMinimalEntry=s),n}gm.createNodeValueGetter=Dae;gm.createEdgeValueGetter=VV;gm.createEdgeWeightGetter=function(t){return VV(t,Rae)};var ps=0,Ir=1,ki=2,Fi=3,Xc=4,Yc=5,ji=6,QP=7,E2=8,JP=9,Oae=0,Uae=1,zae=2,Vs=0,qo=1,Ra=2,dp=3,Ch=4,Qr=5,qa=6,Pu=7,Nu=8,$P=3,Hl=10,Iae=3,ya=9,g3=10,Lae=function(e,n,i){var r,s,a,o,l,u,c,h,d,m,v=n.length,_=i.length,y=e.adjustSizes,g=e.barnesHutTheta*e.barnesHutTheta,x,S,E,A,T,C,O,M=[];for(a=0;a<v;a+=Hl)n[a+Xc]=n[a+ki],n[a+Yc]=n[a+Fi],n[a+ki]=0,n[a+Fi]=0;if(e.outboundAttractionDistribution){for(x=0,a=0;a<v;a+=Hl)x+=n[a+ji];x/=v/Hl}if(e.barnesHutOptimize){var D=1/0,P=-1/0,F=1/0,G=-1/0,z,Y,N;for(a=0;a<v;a+=Hl)D=Math.min(D,n[a+ps]),P=Math.max(P,n[a+ps]),F=Math.min(F,n[a+Ir]),G=Math.max(G,n[a+Ir]);var k=P-D,j=G-F;for(k>j?(F-=(k-j)/2,G=F+k):(D-=(j-k)/2,P=D+j),M[0+Vs]=-1,M[0+qo]=(D+P)/2,M[0+Ra]=(F+G)/2,M[0+dp]=Math.max(P-D,G-F),M[0+Ch]=-1,M[0+Qr]=-1,M[0+qa]=0,M[0+Pu]=0,M[0+Nu]=0,r=1,a=0;a<v;a+=Hl)for(s=0,N=$P;;)if(M[s+Qr]>=0){n[a+ps]<M[s+qo]?n[a+Ir]<M[s+Ra]?z=M[s+Qr]:z=M[s+Qr]+ya:n[a+Ir]<M[s+Ra]?z=M[s+Qr]+ya*2:z=M[s+Qr]+ya*3,M[s+Pu]=(M[s+Pu]*M[s+qa]+n[a+ps]*n[a+ji])/(M[s+qa]+n[a+ji]),M[s+Nu]=(M[s+Nu]*M[s+qa]+n[a+Ir]*n[a+ji])/(M[s+qa]+n[a+ji]),M[s+qa]+=n[a+ji],s=z;continue}else if(M[s+Vs]<0){M[s+Vs]=a;break}else{if(M[s+Qr]=r*ya,h=M[s+dp]/2,d=M[s+Qr],M[d+Vs]=-1,M[d+qo]=M[s+qo]-h,M[d+Ra]=M[s+Ra]-h,M[d+dp]=h,M[d+Ch]=d+ya,M[d+Qr]=-1,M[d+qa]=0,M[d+Pu]=0,M[d+Nu]=0,d+=ya,M[d+Vs]=-1,M[d+qo]=M[s+qo]-h,M[d+Ra]=M[s+Ra]+h,M[d+dp]=h,M[d+Ch]=d+ya,M[d+Qr]=-1,M[d+qa]=0,M[d+Pu]=0,M[d+Nu]=0,d+=ya,M[d+Vs]=-1,M[d+qo]=M[s+qo]+h,M[d+Ra]=M[s+Ra]-h,M[d+dp]=h,M[d+Ch]=d+ya,M[d+Qr]=-1,M[d+qa]=0,M[d+Pu]=0,M[d+Nu]=0,d+=ya,M[d+Vs]=-1,M[d+qo]=M[s+qo]+h,M[d+Ra]=M[s+Ra]+h,M[d+dp]=h,M[d+Ch]=M[s+Ch],M[d+Qr]=-1,M[d+qa]=0,M[d+Pu]=0,M[d+Nu]=0,r+=4,n[M[s+Vs]+ps]<M[s+qo]?n[M[s+Vs]+Ir]<M[s+Ra]?z=M[s+Qr]:z=M[s+Qr]+ya:n[M[s+Vs]+Ir]<M[s+Ra]?z=M[s+Qr]+ya*2:z=M[s+Qr]+ya*3,M[s+qa]=n[M[s+Vs]+ji],M[s+Pu]=n[M[s+Vs]+ps],M[s+Nu]=n[M[s+Vs]+Ir],M[z+Vs]=M[s+Vs],M[s+Vs]=-1,n[a+ps]<M[s+qo]?n[a+Ir]<M[s+Ra]?Y=M[s+Qr]:Y=M[s+Qr]+ya:n[a+Ir]<M[s+Ra]?Y=M[s+Qr]+ya*2:Y=M[s+Qr]+ya*3,z===Y)if(N--){s=z;continue}else{N=$P;break}M[Y+Vs]=a;break}}if(e.barnesHutOptimize)for(S=e.scalingRatio,a=0;a<v;a+=Hl)for(s=0;;)if(M[s+Qr]>=0)if(C=Math.pow(n[a+ps]-M[s+Pu],2)+Math.pow(n[a+Ir]-M[s+Nu],2),m=M[s+dp],4*m*m/C<g){if(E=n[a+ps]-M[s+Pu],A=n[a+Ir]-M[s+Nu],y===!0?C>0?(O=S*n[a+ji]*M[s+qa]/C,n[a+ki]+=E*O,n[a+Fi]+=A*O):C<0&&(O=-S*n[a+ji]*M[s+qa]/Math.sqrt(C),n[a+ki]+=E*O,n[a+Fi]+=A*O):C>0&&(O=S*n[a+ji]*M[s+qa]/C,n[a+ki]+=E*O,n[a+Fi]+=A*O),s=M[s+Ch],s<0)break;continue}else{s=M[s+Qr];continue}else{if(u=M[s+Vs],u>=0&&u!==a&&(E=n[a+ps]-n[u+ps],A=n[a+Ir]-n[u+Ir],C=E*E+A*A,y===!0?C>0?(O=S*n[a+ji]*n[u+ji]/C,n[a+ki]+=E*O,n[a+Fi]+=A*O):C<0&&(O=-S*n[a+ji]*n[u+ji]/Math.sqrt(C),n[a+ki]+=E*O,n[a+Fi]+=A*O):C>0&&(O=S*n[a+ji]*n[u+ji]/C,n[a+ki]+=E*O,n[a+Fi]+=A*O)),s=M[s+Ch],s<0)break;continue}else for(S=e.scalingRatio,o=0;o<v;o+=Hl)for(l=0;l<o;l+=Hl)E=n[o+ps]-n[l+ps],A=n[o+Ir]-n[l+Ir],y===!0?(C=Math.sqrt(E*E+A*A)-n[o+E2]-n[l+E2],C>0?(O=S*n[o+ji]*n[l+ji]/C/C,n[o+ki]+=E*O,n[o+Fi]+=A*O,n[l+ki]-=E*O,n[l+Fi]-=A*O):C<0&&(O=100*S*n[o+ji]*n[l+ji],n[o+ki]+=E*O,n[o+Fi]+=A*O,n[l+ki]-=E*O,n[l+Fi]-=A*O)):(C=Math.sqrt(E*E+A*A),C>0&&(O=S*n[o+ji]*n[l+ji]/C/C,n[o+ki]+=E*O,n[o+Fi]+=A*O,n[l+ki]-=E*O,n[l+Fi]-=A*O));for(d=e.gravity/e.scalingRatio,S=e.scalingRatio,a=0;a<v;a+=Hl)O=0,E=n[a+ps],A=n[a+Ir],C=Math.sqrt(Math.pow(E,2)+Math.pow(A,2)),e.strongGravityMode?C>0&&(O=S*n[a+ji]*d):C>0&&(O=S*n[a+ji]*d/C),n[a+ki]-=E*O,n[a+Fi]-=A*O;for(S=1*(e.outboundAttractionDistribution?x:1),c=0;c<_;c+=Iae)o=i[c+Oae],l=i[c+Uae],h=i[c+zae],T=Math.pow(h,e.edgeWeightInfluence),E=n[o+ps]-n[l+ps],A=n[o+Ir]-n[l+Ir],y===!0?(C=Math.sqrt(E*E+A*A)-n[o+E2]-n[l+E2],e.linLogMode?e.outboundAttractionDistribution?C>0&&(O=-S*T*Math.log(1+C)/C/n[o+ji]):C>0&&(O=-S*T*Math.log(1+C)/C):e.outboundAttractionDistribution?C>0&&(O=-S*T/n[o+ji]):C>0&&(O=-S*T)):(C=Math.sqrt(Math.pow(E,2)+Math.pow(A,2)),e.linLogMode?e.outboundAttractionDistribution?C>0&&(O=-S*T*Math.log(1+C)/C/n[o+ji]):C>0&&(O=-S*T*Math.log(1+C)/C):e.outboundAttractionDistribution?(C=1,O=-S*T/n[o+ji]):(C=1,O=-S*T)),C>0&&(n[o+ki]+=E*O,n[o+Fi]+=A*O,n[l+ki]-=E*O,n[l+Fi]-=A*O);var X,Q,H,$,ne,q;if(y===!0)for(a=0;a<v;a+=Hl)n[a+JP]!==1&&(X=Math.sqrt(Math.pow(n[a+ki],2)+Math.pow(n[a+Fi],2)),X>g3&&(n[a+ki]=n[a+ki]*g3/X,n[a+Fi]=n[a+Fi]*g3/X),Q=n[a+ji]*Math.sqrt((n[a+Xc]-n[a+ki])*(n[a+Xc]-n[a+ki])+(n[a+Yc]-n[a+Fi])*(n[a+Yc]-n[a+Fi])),H=Math.sqrt((n[a+Xc]+n[a+ki])*(n[a+Xc]+n[a+ki])+(n[a+Yc]+n[a+Fi])*(n[a+Yc]+n[a+Fi]))/2,$=.1*Math.log(1+H)/(1+Math.sqrt(Q)),ne=n[a+ps]+n[a+ki]*($/e.slowDown),n[a+ps]=ne,q=n[a+Ir]+n[a+Fi]*($/e.slowDown),n[a+Ir]=q);else for(a=0;a<v;a+=Hl)n[a+JP]!==1&&(Q=n[a+ji]*Math.sqrt((n[a+Xc]-n[a+ki])*(n[a+Xc]-n[a+ki])+(n[a+Yc]-n[a+Fi])*(n[a+Yc]-n[a+Fi])),H=Math.sqrt((n[a+Xc]+n[a+ki])*(n[a+Xc]+n[a+ki])+(n[a+Yc]+n[a+Fi])*(n[a+Yc]+n[a+Fi]))/2,$=n[a+QP]*Math.log(1+H)/(1+Math.sqrt(Q)),n[a+QP]=Math.min(1,Math.sqrt($*(Math.pow(n[a+ki],2)+Math.pow(n[a+Fi],2))/(1+Math.sqrt(Q)))),ne=n[a+ps]+n[a+ki]*($/e.slowDown),n[a+ps]=ne,q=n[a+Ir]+n[a+Fi]*($/e.slowDown),n[a+Ir]=q);return{}},vd={},J1=10,eN=3;vd.assign=function(t){t=t||{};var e=Array.prototype.slice.call(arguments).slice(1),n,i,r;for(n=0,r=e.length;n<r;n++)if(e[n])for(i in e[n])t[i]=e[n][i];return t};vd.validateSettings=function(t){return"linLogMode"in t&&typeof t.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in t&&typeof t.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in t&&typeof t.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in t&&typeof t.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in t&&!(typeof t.scalingRatio=="number"&&t.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in t&&typeof t.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in t&&!(typeof t.gravity=="number"&&t.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in t&&!(typeof t.slowDown=="number"||t.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in t&&typeof t.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in t&&!(typeof t.barnesHutTheta=="number"&&t.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null};vd.graphToByteArrays=function(t,e){var n=t.order,i=t.size,r={},s,a=new Float32Array(n*J1),o=new Float32Array(i*eN);return s=0,t.forEachNode(function(l,u){r[l]=s,a[s]=u.x,a[s+1]=u.y,a[s+2]=0,a[s+3]=0,a[s+4]=0,a[s+5]=0,a[s+6]=1,a[s+7]=1,a[s+8]=u.size||1,a[s+9]=u.fixed?1:0,s+=J1}),s=0,t.forEachEdge(function(l,u,c,h,d,m,v){var _=r[c],y=r[h],g=e(l,u,c,h,d,m,v);a[_+6]+=g,a[y+6]+=g,o[s]=_,o[s+1]=y,o[s+2]=g,s+=eN}),{nodes:a,edges:o}};vd.assignLayoutChanges=function(t,e,n){var i=0;t.updateEachNodeAttributes(function(r,s){return s.x=e[i],s.y=e[i+1],i+=J1,n?n(r,s):s})};vd.readGraphPositions=function(t,e){var n=0;t.forEachNode(function(i,r){e[n]=r.x,e[n+1]=r.y,n+=J1})};vd.collectLayoutChanges=function(t,e,n){for(var i=t.nodes(),r={},s=0,a=0,o=e.length;s<o;s+=J1){if(n){var l=Object.assign({},t.getNodeAttributes(i[a]));l.x=e[s],l.y=e[s+1],l=n(i[a],l),r[i[a]]={x:l.x,y:l.y}}else r[i[a]]={x:e[s],y:e[s+1]};a++}return r};vd.createWorker=function(e){var n=window.URL||window.webkitURL,i=e.toString(),r=n.createObjectURL(new Blob(["("+i+").call(this);"],{type:"text/javascript"})),s=new Worker(r);return n.revokeObjectURL(r),s};var Pae={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5},Nae=Bf,Bae=gm.createEdgeWeightGetter,kae=Lae,ax=vd,Fae=Pae;function HV(t,e,n){if(!Nae(e))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof n=="number"&&(n={iterations:n});var i=n.iterations;if(typeof i!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(i<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var r=Bae("getEdgeWeight"in n?n.getEdgeWeight:"weight").fromEntry,s=typeof n.outputReducer=="function"?n.outputReducer:null,a=ax.assign({},Fae,n.settings),o=ax.validateSettings(a);if(o)throw new Error("graphology-layout-forceatlas2: "+o.message);var l=ax.graphToByteArrays(e,r),u;for(u=0;u<i;u++)kae(a,l.nodes,l.edges);if(t){ax.assignLayoutChanges(e,l.nodes,s);return}return ax.collectLayoutChanges(e,l.nodes)}function Gae(t){var e=typeof t=="number"?t:t.order;return{barnesHutOptimize:e>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(e)}}var dz=HV.bind(null,!1);dz.assign=HV.bind(null,!0);dz.inferSettings=Gae;var Vae=dz;const Hae=Lo(Vae);var jae=hz,Wae=Bf,Xae={dimensions:["x","y"],center:.5,rng:Math.random,scale:1};function jV(t,e,n){if(!Wae(e))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");n=jae(n,Xae);var i=n.dimensions;if(!Array.isArray(i)||i.length<1)throw new Error("graphology-layout/random: given dimensions are invalid.");var r=i.length,s=n.center,a=n.rng,o=n.scale,l=(s-.5)*o;function u(h){for(var d=0;d<r;d++)h[i[d]]=a()*o+l;return h}if(!t){var c={};return e.forEachNode(function(h){c[h]=u({})}),c}e.updateEachNodeAttributes(function(h,d){return u(d),d},{attributes:i})}var WV=jV.bind(null,!1);WV.assign=jV.bind(null,!0);var Yae=WV;const Zae=Lo(Yae);function qae({graph:t,drags:e,iterations:n,...i}){Zae.assign(t);const r=Hae(t,{iterations:n,settings:i});return{step(){return!0},getNodePosition(s){var a;return((a=e==null?void 0:e[s])==null?void 0:a.position)||(r==null?void 0:r[s])}}}function Kae({graph:t,drags:e,getNodePosition:n}){const{nodes:i,edges:r}=mm(t);return{step(){return!0},getNodePosition(s){return n(s,{graph:t,drags:e,nodes:i,edges:r})}}}const Qae=["forceDirected2d","treeTd2d","treeLr2d","radialOut2d","treeTd3d","treeLr3d","radialOut3d","forceDirected3d"];function pz({type:t,...e}){if(Qae.includes(t)){const{nodeStrength:n,linkDistance:i,nodeLevelRatio:r}=e;if(t==="forceDirected2d")return Mh({...e,dimensions:2,nodeLevelRatio:r||2,nodeStrength:n||-250,linkDistance:i,forceLayout:t});if(t==="treeTd2d")return Mh({...e,mode:"td",dimensions:2,nodeLevelRatio:r||5,nodeStrength:n||-250,linkDistance:i||50,forceLayout:t});if(t==="treeLr2d")return Mh({...e,mode:"lr",dimensions:2,nodeLevelRatio:r||5,nodeStrength:n||-250,linkDistance:i||50,forceLayout:t});if(t==="radialOut2d")return Mh({...e,mode:"radialout",dimensions:2,nodeLevelRatio:r||5,nodeStrength:n||-500,linkDistance:i||100,forceLayout:t});if(t==="treeTd3d")return Mh({...e,mode:"td",dimensions:3,nodeLevelRatio:r||2,nodeStrength:n||-500,linkDistance:i||50});if(t==="treeLr3d")return Mh({...e,mode:"lr",dimensions:3,nodeLevelRatio:r||2,nodeStrength:n||-500,linkDistance:i||50,forceLayout:t});if(t==="radialOut3d")return Mh({...e,mode:"radialout",dimensions:3,nodeLevelRatio:r||2,nodeStrength:n||-500,linkDistance:i||100,forceLayout:t});if(t==="forceDirected3d")return Mh({...e,dimensions:3,nodeLevelRatio:r||2,nodeStrength:n||-250,linkDistance:i,forceLayout:t})}else if(t==="circular2d"){const{radius:n}=e;return vae({...e,radius:n||300})}else{if(t==="hierarchicalTd")return qP({...e,mode:"td"});if(t==="hierarchicalLr")return qP({...e,mode:"lr"});if(t==="nooverlap"){const{graph:n,maxIterations:i,ratio:r,margin:s,gridSize:a,...o}=e;return Cae({graph:n,margin:s||10,maxIterations:i||50,ratio:r||10,gridSize:a||20,...o})}else if(t==="forceatlas2"){const{graph:n,iterations:i,gravity:r,scalingRatio:s,...a}=e;return qae({type:"forceatlas2",graph:n,...a,scalingRatio:s||100,gravity:r||10,iterations:i||50})}else if(t==="custom")return Kae({...e})}throw new Error(`Layout ${t} not found.`)}function XV({nodeCount:t,nodePosition:e,labelType:n,camera:i}){return(r,s)=>{var a;if(i&&e&&((a=i==null?void 0:i.position)==null?void 0:a.z)/(i==null?void 0:i.zoom)-(e==null?void 0:e.z)>6e3)return!1;if(n==="all")return!0;if(n==="nodes"&&r==="node")return!0;if(n==="edges"&&r==="edge")return!0;if(n==="auto"&&r==="node"){if(s>7)return!0;if(i&&e&&i.position.z/i.zoom-e.z<3e3)return!0}return!1}}function YV(t,e){switch(e){case"above":return t;case"below":return-t;case"inline":case"natural":default:return 0}}const mz=typeof window>"u";var gz={},vz={};(function(t){var e=Math.pow(2,8)-1,n=Math.pow(2,16)-1,i=Math.pow(2,32)-1,r=Math.pow(2,7)-1,s=Math.pow(2,15)-1,a=Math.pow(2,31)-1;t.getPointerArray=function(l){var u=l-1;if(u<=e)return Uint8Array;if(u<=n)return Uint16Array;if(u<=i)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")},t.getSignedPointerArray=function(l){var u=l-1;return u<=r?Int8Array:u<=s?Int16Array:u<=a?Int32Array:Float64Array},t.getNumberType=function(l){return l===(l|0)?Math.sign(l)===-1?l<=127&&l>=-128?Int8Array:l<=32767&&l>=-32768?Int16Array:Int32Array:l<=255?Uint8Array:l<=65535?Uint16Array:Uint32Array:Float64Array};var o={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};t.getMinimalRepresentation=function(l,u){var c=null,h=0,d,m,v,_,y;for(_=0,y=l.length;_<y;_++)v=u?u(l[_]):l[_],m=t.getNumberType(v),d=o[m.name],d>h&&(h=d,c=m);return c},t.isTypedArray=function(l){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(l)},t.concat=function(){var l=0,u,c,h;for(u=0,h=arguments.length;u<h;u++)l+=arguments[u].length;var d=new arguments[0].constructor(l);for(u=0,c=0;u<h;u++)d.set(arguments[u],c),c+=arguments[u].length;return d},t.indices=function(l){for(var u=t.getPointerArray(l),c=new u(l),h=0;h<l;h++)c[h]=h;return c}})(vz);var Qw=vz,Jae=gm.createEdgeWeightGetter;function ZV(t,e){return t==="outbound"||t==="inbound"?e.directedSize+e.undirectedSize*2:t==="in"||t==="out"||t==="directed"?e.directedSize:e.undirectedSize*2}function kf(t,e){e=e||"outbound";var n=t[e+"Neighbors"].bind(t),i=ZV(e,t),r=Qw.getPointerArray(i),s=Qw.getPointerArray(t.order);this.graph=t,this.neighborhood=new s(i),this.starts=new r(t.order+1),this.nodes=t.nodes();var a={},o,l,u,c,h,d,m=0;for(o=0,l=t.order;o<l;o++)a[this.nodes[o]]=o;for(o=0,l=t.order;o<l;o++)for(h=this.nodes[o],d=n(h),this.starts[o]=m,u=0,c=d.length;u<c;u++)this.neighborhood[m++]=a[d[u]];this.starts[o]=i}kf.prototype.bounds=function(t){return[this.starts[t],this.starts[t+1]]};kf.prototype.project=function(){var t=this,e={};return t.nodes.forEach(function(n,i){e[n]=Array.from(t.neighborhood.slice(t.starts[i],t.starts[i+1])).map(function(r){return t.nodes[r]})}),e};kf.prototype.collect=function(t){var e,n,i={};for(e=0,n=t.length;e<n;e++)i[this.nodes[e]]=t[e];return i};kf.prototype.assign=function(t,e){var n=0;this.graph.updateEachNodeAttributes(function(i,r){return r[t]=e[n++],r},{attributes:[t]})};gz.NeighborhoodIndex=kf;function Z_(t,e,n){n=n||"outbound";var i=t[n+"Edges"].bind(t),r=ZV(n,t),s=Qw.getPointerArray(r),a=Qw.getPointerArray(t.order),o=Jae(e).fromMinimalEntry;this.graph=t,this.neighborhood=new a(r),this.weights=new Float64Array(r),this.outDegrees=new Float64Array(t.order),this.starts=new s(t.order+1),this.nodes=t.nodes();var l={},u,c,h,d,m,v,_,y,g,x=0;for(u=0,c=t.order;u<c;u++)l[this.nodes[u]]=u;for(u=0,c=t.order;u<c;u++)for(m=this.nodes[u],_=i(m),this.starts[u]=x,h=0,d=_.length;h<d;h++)y=_[h],v=t.opposite(m,y),g=o(y,t.getEdgeAttributes(y)),this.neighborhood[x]=l[v],this.weights[x++]=g,this.outDegrees[u]+=g;this.starts[u]=r}Z_.prototype.bounds=kf.prototype.bounds;Z_.prototype.project=kf.prototype.project;Z_.prototype.collect=kf.prototype.collect;Z_.prototype.assign=kf.prototype.assign;gz.WeightedNeighborhoodIndex=Z_;var $ae=Bf,eoe=hz,toe=gz.WeightedNeighborhoodIndex,noe={nodePagerankAttribute:"pagerank",getEdgeWeight:"weight",alpha:.85,maxIterations:100,tolerance:1e-6};function qV(t,e,n){if(!$ae(e))throw new Error("graphology-metrics/centrality/pagerank: the given graph is not a valid graphology instance.");n=eoe(n,noe);var i=n.alpha,r=n.maxIterations,s=n.tolerance,a=n.nodePagerankAttribute,o=e.order,l=1/o,u=new toe(e,n.getEdgeWeight),c,h,d,m,v=new Float64Array(e.order),_=new Float64Array(u.weights.length),y=[];for(c=0;c<o;c++)for(v[c]=l,d=u.starts[c+1],m=u.outDegrees[c],m===0&&y.push(c),h=u.starts[c];h<d;h++)_[h]=u.weights[h]/m;for(var g=0,x=0,S,E,A,T=!1;g<r;){for(A=v,v=new Float64Array(e.order),S=0,c=0,d=y.length;c<d;c++)S+=A[y[c]];for(S*=i,c=0;c<o;c++){for(d=u.starts[c+1],h=u.starts[c];h<d;h++)E=u.neighborhood[h],v[E]+=i*A[c]*_[h];v[c]+=S*l+(1-i)*l}for(x=0,c=0;c<o;c++)x+=Math.abs(v[c]-A[c]);if(x<o*s){T=!0;break}g++}if(!T)throw Error("graphology-metrics/centrality/pagerank: failed to converge.");if(t){u.assign(a,v);return}return u.collect(v)}var KV=qV.bind(null,!1);KV.assign=qV.bind(null,!0);var ioe=KV;const roe=Lo(ioe);function soe({graph:t}){const e=roe(t);return{ranks:e,getSizeForNode:n=>e[n]*80}}var aoe=Bf;function _v(t,e,n,i){var r=e+"Centrality";if(!aoe(n))throw new Error("graphology-centrality/"+r+": the given graph is not a valid graphology instance.");if(e!=="degree"&&n.type==="undirected")throw new Error("graphology-centrality/"+r+": cannot compute "+e+" centrality on an undirected graph.");i=i||{};var s=i.nodeCentralityAttribute||r,a=n.order-1,o=n[e].bind(n);if(t){n.updateEachNodeAttributes(function(u,c){return c[s]=o(u)/a,c},{attributes:[s]});return}var l={};return n.forEachNode(function(u){l[u]=o(u)/a}),l}var QV=_v.bind(null,!1,"degree"),ooe=_v.bind(null,!1,"inDegree"),loe=_v.bind(null,!1,"outDegree");QV.assign=_v.bind(null,!0,"degree");ooe.assign=_v.bind(null,!0,"inDegree");loe.assign=_v.bind(null,!0,"outDegree");var uoe=QV;function coe({graph:t}){const e=uoe(t);return{ranks:e,getSizeForNode:n=>e[n]*20}}function foe({graph:t,attribute:e,defaultSize:n}){const i=new Map;return e?t.forEachNode((r,s)=>{var o;const a=(o=s.data)==null?void 0:o[e];isNaN(a)&&console.warn(`Attribute ${a} is not a number for node ${s.id}`),i.set(r,a||0)}):console.warn("Attribute sizing configured but no attribute provided"),{getSizeForNode:r=>!e||!i?n:i.get(r)}}function gE(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function hoe(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function JV(t){let e,n,i;t.length!==2?(e=gE,n=(o,l)=>gE(t(o),l),i=(o,l)=>t(o)-l):(e=t===gE||t===hoe?t:doe,n=t,i=t);function r(o,l,u=0,c=o.length){if(u<c){if(e(l,l)!==0)return c;do{const h=u+c>>>1;n(o[h],l)<0?u=h+1:c=h}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(e(l,l)!==0)return c;do{const h=u+c>>>1;n(o[h],l)<=0?u=h+1:c=h}while(u<c)}return u}function a(o,l,u=0,c=o.length){const h=r(o,l,u,c-1);return h>u&&i(o[h-1],l)>-i(o[h],l)?h-1:h}return{left:r,center:a,right:s}}function doe(){return 0}function poe(t){return t===null?NaN:+t}const moe=JV(gE),goe=moe.right;JV(poe).center;const voe=Math.sqrt(50),yoe=Math.sqrt(10),xoe=Math.sqrt(2);function Jw(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),a=s>=voe?10:s>=yoe?5:s>=xoe?2:1;let o,l,u;return r<0?(u=Math.pow(10,-r)/a,o=Math.round(t*u),l=Math.round(e*u),o/u<t&&++o,l/u>e&&--l,u=-u):(u=Math.pow(10,r)*a,o=Math.round(t/u),l=Math.round(e/u),o*u<t&&++o,l*u>e&&--l),l<o&&.5<=n&&n<2?Jw(t,e,n*2):[o,l,u]}function _oe(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,s,a]=i?Jw(e,t,n):Jw(t,e,n);if(!(s>=r))return[];const o=s-r+1,l=new Array(o);if(i)if(a<0)for(let u=0;u<o;++u)l[u]=(s-u)/-a;else for(let u=0;u<o;++u)l[u]=(s-u)*a;else if(a<0)for(let u=0;u<o;++u)l[u]=(r+u)/-a;else for(let u=0;u<o;++u)l[u]=(r+u)*a;return l}function xD(t,e,n){return e=+e,t=+t,n=+n,Jw(t,e,n)[2]}function boe(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?xD(e,t,n):xD(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function gl(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(r);++i<r;)s[i]=t+i*n;return s}function Soe(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function yz(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function $V(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function q_(){}var $1=.7,$w=1/$1,S0="\\s*([+-]?\\d+)\\s*",e_="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ec="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Eoe=/^#([0-9a-f]{3,8})$/,woe=new RegExp(`^rgb\\(${S0},${S0},${S0}\\)$`),Aoe=new RegExp(`^rgb\\(${ec},${ec},${ec}\\)$`),Toe=new RegExp(`^rgba\\(${S0},${S0},${S0},${e_}\\)$`),Moe=new RegExp(`^rgba\\(${ec},${ec},${ec},${e_}\\)$`),Coe=new RegExp(`^hsl\\(${e_},${ec},${ec}\\)$`),Roe=new RegExp(`^hsla\\(${e_},${ec},${ec},${e_}\\)$`),tN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yz(q_,t_,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:nN,formatHex:nN,formatHex8:Doe,formatHsl:Ooe,formatRgb:iN,toString:iN});function nN(){return this.rgb().formatHex()}function Doe(){return this.rgb().formatHex8()}function Ooe(){return eH(this).formatHsl()}function iN(){return this.rgb().formatRgb()}function t_(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Eoe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?rN(e):n===3?new ro(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?w2(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?w2(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=woe.exec(t))?new ro(e[1],e[2],e[3],1):(e=Aoe.exec(t))?new ro(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Toe.exec(t))?w2(e[1],e[2],e[3],e[4]):(e=Moe.exec(t))?w2(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Coe.exec(t))?oN(e[1],e[2]/100,e[3]/100,1):(e=Roe.exec(t))?oN(e[1],e[2]/100,e[3]/100,e[4]):tN.hasOwnProperty(t)?rN(tN[t]):t==="transparent"?new ro(NaN,NaN,NaN,0):null}function rN(t){return new ro(t>>16&255,t>>8&255,t&255,1)}function w2(t,e,n,i){return i<=0&&(t=e=n=NaN),new ro(t,e,n,i)}function Uoe(t){return t instanceof q_||(t=t_(t)),t?(t=t.rgb(),new ro(t.r,t.g,t.b,t.opacity)):new ro}function _D(t,e,n,i){return arguments.length===1?Uoe(t):new ro(t,e,n,i??1)}function ro(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}yz(ro,_D,$V(q_,{brighter(t){return t=t==null?$w:Math.pow($w,t),new ro(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?$1:Math.pow($1,t),new ro(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ro(Fp(this.r),Fp(this.g),Fp(this.b),eA(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:sN,formatHex:sN,formatHex8:zoe,formatRgb:aN,toString:aN}));function sN(){return`#${Cp(this.r)}${Cp(this.g)}${Cp(this.b)}`}function zoe(){return`#${Cp(this.r)}${Cp(this.g)}${Cp(this.b)}${Cp((isNaN(this.opacity)?1:this.opacity)*255)}`}function aN(){const t=eA(this.opacity);return`${t===1?"rgb(":"rgba("}${Fp(this.r)}, ${Fp(this.g)}, ${Fp(this.b)}${t===1?")":`, ${t})`}`}function eA(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Fp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Cp(t){return t=Fp(t),(t<16?"0":"")+t.toString(16)}function oN(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new $l(t,e,n,i)}function eH(t){if(t instanceof $l)return new $l(t.h,t.s,t.l,t.opacity);if(t instanceof q_||(t=t_(t)),!t)return new $l;if(t instanceof $l)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),a=NaN,o=s-r,l=(s+r)/2;return o?(e===s?a=(n-i)/o+(n<i)*6:n===s?a=(i-e)/o+2:a=(e-n)/o+4,o/=l<.5?s+r:2-s-r,a*=60):o=l>0&&l<1?0:a,new $l(a,o,l,t.opacity)}function Ioe(t,e,n,i){return arguments.length===1?eH(t):new $l(t,e,n,i??1)}function $l(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}yz($l,Ioe,$V(q_,{brighter(t){return t=t==null?$w:Math.pow($w,t),new $l(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?$1:Math.pow($1,t),new $l(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new ro(v3(t>=240?t-240:t+120,r,i),v3(t,r,i),v3(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new $l(lN(this.h),A2(this.s),A2(this.l),eA(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=eA(this.opacity);return`${t===1?"hsl(":"hsla("}${lN(this.h)}, ${A2(this.s)*100}%, ${A2(this.l)*100}%${t===1?")":`, ${t})`}`}}));function lN(t){return t=(t||0)%360,t<0?t+360:t}function A2(t){return Math.max(0,Math.min(1,t||0))}function v3(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const xz=t=>()=>t;function Loe(t,e){return function(n){return t+n*e}}function Poe(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function Noe(t){return(t=+t)==1?tH:function(e,n){return n-e?Poe(e,n,t):xz(isNaN(e)?n:e)}}function tH(t,e){var n=e-t;return n?Loe(t,n):xz(isNaN(t)?e:t)}const uN=function t(e){var n=Noe(e);function i(r,s){var a=n((r=_D(r)).r,(s=_D(s)).r),o=n(r.g,s.g),l=n(r.b,s.b),u=tH(r.opacity,s.opacity);return function(c){return r.r=a(c),r.g=o(c),r.b=l(c),r.opacity=u(c),r+""}}return i.gamma=t,i}(1);function Boe(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function koe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Foe(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),s=new Array(n),a;for(a=0;a<i;++a)r[a]=_z(t[a],e[a]);for(;a<n;++a)s[a]=e[a];return function(o){for(a=0;a<i;++a)s[a]=r[a](o);return s}}function Goe(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function tA(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Voe(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=_z(t[r],e[r]):i[r]=e[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var bD=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,y3=new RegExp(bD.source,"g");function Hoe(t){return function(){return t}}function joe(t){return function(e){return t(e)+""}}function Woe(t,e){var n=bD.lastIndex=y3.lastIndex=0,i,r,s,a=-1,o=[],l=[];for(t=t+"",e=e+"";(i=bD.exec(t))&&(r=y3.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(i=i[0])===(r=r[0])?o[a]?o[a]+=r:o[++a]=r:(o[++a]=null,l.push({i:a,x:tA(i,r)})),n=y3.lastIndex;return n<e.length&&(s=e.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?joe(l[0].x):Hoe(e):(e=l.length,function(u){for(var c=0,h;c<e;++c)o[(h=l[c]).i]=h.x(u);return o.join("")})}function _z(t,e){var n=typeof e,i;return e==null||n==="boolean"?xz(e):(n==="number"?tA:n==="string"?(i=t_(e))?(e=i,uN):Woe:e instanceof t_?uN:e instanceof Date?Goe:koe(e)?Boe:Array.isArray(e)?Foe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Voe:tA)(t,e)}function Xoe(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Yoe(t){return function(){return t}}function Zoe(t){return+t}var cN=[0,1];function h0(t){return t}function SD(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Yoe(isNaN(e)?NaN:.5)}function qoe(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function Koe(t,e,n){var i=t[0],r=t[1],s=e[0],a=e[1];return r<i?(i=SD(r,i),s=n(a,s)):(i=SD(i,r),s=n(s,a)),function(o){return s(i(o))}}function Qoe(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),a=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<i;)r[a]=SD(t[a],t[a+1]),s[a]=n(e[a],e[a+1]);return function(o){var l=goe(t,o,1,i)-1;return s[l](r[l](o))}}function Joe(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function $oe(){var t=cN,e=cN,n=_z,i,r,s,a=h0,o,l,u;function c(){var d=Math.min(t.length,e.length);return a!==h0&&(a=qoe(t[0],t[d-1])),o=d>2?Qoe:Koe,l=u=null,h}function h(d){return d==null||isNaN(d=+d)?s:(l||(l=o(t.map(i),e,n)))(i(a(d)))}return h.invert=function(d){return a(r((u||(u=o(e,t.map(i),tA)))(d)))},h.domain=function(d){return arguments.length?(t=Array.from(d,Zoe),c()):t.slice()},h.range=function(d){return arguments.length?(e=Array.from(d),c()):e.slice()},h.rangeRound=function(d){return e=Array.from(d),n=Xoe,c()},h.clamp=function(d){return arguments.length?(a=d?!0:h0,c()):a!==h0},h.interpolate=function(d){return arguments.length?(n=d,c()):n},h.unknown=function(d){return arguments.length?(s=d,h):s},function(d,m){return i=d,r=m,c()}}function ele(){return $oe()(h0,h0)}function tle(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function nA(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Q0(t){return t=nA(Math.abs(t)),t?t[1]:NaN}function nle(t,e){return function(n,i){for(var r=n.length,s=[],a=0,o=t[0],l=0;r>0&&o>0&&(l+o+1>i&&(o=Math.max(1,i-l)),s.push(n.substring(r-=o,r+o)),!((l+=o+1)>i));)o=t[a=(a+1)%t.length];return s.reverse().join(e)}}function ile(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var rle=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function iA(t){if(!(e=rle.exec(t)))throw new Error("invalid format: "+t);var e;return new bz({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}iA.prototype=bz.prototype;function bz(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}bz.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function sle(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var nH;function ale(t,e){var n=nA(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(nH=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=i.length;return s===a?i:s>a?i+new Array(s-a+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+nA(t,Math.max(0,e+s-1))[0]}function fN(t,e){var n=nA(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const hN={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:tle,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>fN(t*100,e),r:fN,s:ale,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function dN(t){return t}var pN=Array.prototype.map,mN=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function ole(t){var e=t.grouping===void 0||t.thousands===void 0?dN:nle(pN.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?dN:ile(pN.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(h){h=iA(h);var d=h.fill,m=h.align,v=h.sign,_=h.symbol,y=h.zero,g=h.width,x=h.comma,S=h.precision,E=h.trim,A=h.type;A==="n"?(x=!0,A="g"):hN[A]||(S===void 0&&(S=12),E=!0,A="g"),(y||d==="0"&&m==="=")&&(y=!0,d="0",m="=");var T=_==="$"?n:_==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",C=_==="$"?i:/[%p]/.test(A)?a:"",O=hN[A],M=/[defgprs%]/.test(A);S=S===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function D(P){var F=T,G=C,z,Y,N;if(A==="c")G=O(P)+G,P="";else{P=+P;var k=P<0||1/P<0;if(P=isNaN(P)?l:O(Math.abs(P),S),E&&(P=sle(P)),k&&+P==0&&v!=="+"&&(k=!1),F=(k?v==="("?v:o:v==="-"||v==="("?"":v)+F,G=(A==="s"?mN[8+nH/3]:"")+G+(k&&v==="("?")":""),M){for(z=-1,Y=P.length;++z<Y;)if(N=P.charCodeAt(z),48>N||N>57){G=(N===46?r+P.slice(z+1):P.slice(z))+G,P=P.slice(0,z);break}}}x&&!y&&(P=e(P,1/0));var j=F.length+P.length+G.length,X=j<g?new Array(g-j+1).join(d):"";switch(x&&y&&(P=e(X+P,X.length?g-G.length:1/0),X=""),m){case"<":P=F+P+G+X;break;case"=":P=F+X+P+G;break;case"^":P=X.slice(0,j=X.length>>1)+F+P+G+X.slice(j);break;default:P=X+F+P+G;break}return s(P)}return D.toString=function(){return h+""},D}function c(h,d){var m=u((h=iA(h),h.type="f",h)),v=Math.max(-8,Math.min(8,Math.floor(Q0(d)/3)))*3,_=Math.pow(10,-v),y=mN[8+v/3];return function(g){return m(_*g)+y}}return{format:u,formatPrefix:c}}var T2,iH,rH;lle({thousands:",",grouping:[3],currency:["$",""]});function lle(t){return T2=ole(t),iH=T2.format,rH=T2.formatPrefix,T2}function ule(t){return Math.max(0,-Q0(Math.abs(t)))}function cle(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Q0(e)/3)))*3-Q0(Math.abs(t)))}function fle(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Q0(e)-Q0(t))+1}function hle(t,e,n,i){var r=boe(t,e,n),s;switch(i=iA(i??",f"),i.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(s=cle(r,a))&&(i.precision=s),rH(i,a)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=fle(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=ule(r))&&(i.precision=s-(i.type==="%")*2);break}}return iH(i)}function dle(t){var e=t.domain;return t.ticks=function(n){var i=e();return _oe(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return hle(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,s=i.length-1,a=i[r],o=i[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=r,r=s,s=u);c-- >0;){if(u=xD(a,o,n),u===l)return i[r]=a,i[s]=o,e(i);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return t},t}function sH(){var t=ele();return t.copy=function(){return Joe(t,sH())},Soe.apply(t,arguments),dle(t)}const x3={pagerank:soe,centrality:coe,attribute:foe,none:({defaultSize:t})=>({getSizeForNode:e=>t})};function ple({type:t,...e}){var u;const n=(u=x3[t])==null?void 0:u.call(x3,e);if(!n&&t!=="default")throw new Error(`Unknown sizing strategy: ${t}`);const{graph:i,minSize:r,maxSize:s}=e,a=new Map;let o,l;if(i.forEachNode((c,h)=>{let d;t==="default"?d=h.size||e.defaultSize:d=n.getSizeForNode(c),(o===void 0||d<o)&&(o=d),(l===void 0||d>l)&&(l=d),a.set(c,d)}),t!=="none"){const c=sH().domain([o,l]).rangeRound([r,s]);for(const[h,d]of a)a.set(h,c(d))}return a}function mle(t,e,n){t.clear();const i=new Set;for(const r of e)try{i.has(r.id)||(t.addNode(r.id,r),i.add(r.id))}catch(s){console.error(`[Graph] Error adding node '${r.id}`,s)}for(const r of n)if(!(!i.has(r.source)||!i.has(r.target)))try{t.addEdge(r.source,r.target,r)}catch(s){console.error(`[Graph] Error adding edge '${r.source} -> ${r.target}`,s)}return t}function gle({graph:t,layout:e,sizingType:n,labelType:i,sizingAttribute:r,defaultNodeSize:s,minNodeSize:a,maxNodeSize:o,clusterAttribute:l}){const u=[],c=[],h=new Map,d=ple({graph:t,type:n,attribute:r,minSize:a,maxSize:o,defaultSize:s}),m=t.nodes().length,v=XV({nodeCount:m,labelType:i});return t.forEachNode((_,y)=>{const g=e.getNodePosition(_),{data:x,fill:S,icon:E,label:A,size:T,...C}=y,O=d.get(y.id),M=v("node",O),P=(t.inboundNeighbors(y.id)||[]).map(G=>t.getNodeAttributes(G)),F={...y,size:O,labelVisible:M,label:A,icon:E,fill:S,cluster:l?x[l]:void 0,parents:P,data:{...C,...x??{}},position:{...g,x:g.x||0,y:g.y||0,z:g.z||1}};h.set(y.id,F),u.push(F)}),t.forEachEdge((_,y)=>{const g=h.get(y.source),x=h.get(y.target);if(g&&x){const{data:S,id:E,label:A,size:T,...C}=y,O=v("edge",T);c.push({...y,id:E,label:A,labelVisible:O,size:T,data:{...C,id:E,...S||{}}})}}),{nodes:u,edges:c}}const vle=t=>t;function aH(t,e=vle){const n=iu.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return iu.useDebugValue(n),n}const gN=t=>{const e=q8(t),n=i=>aH(e,i);return Object.assign(n,e),n},yle=t=>t?gN(t):gN,vN=t=>Symbol.iterator in t,yN=t=>"entries"in t,xN=(t,e)=>{const n=t instanceof Map?t:new Map(t.entries()),i=e instanceof Map?e:new Map(e.entries());if(n.size!==i.size)return!1;for(const[r,s]of n)if(!Object.is(s,i.get(r)))return!1;return!0},xle=(t,e)=>{const n=t[Symbol.iterator](),i=e[Symbol.iterator]();let r=n.next(),s=i.next();for(;!r.done&&!s.done;){if(!Object.is(r.value,s.value))return!1;r=n.next(),s=i.next()}return!!r.done&&!!s.done};function _le(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null||Object.getPrototypeOf(t)!==Object.getPrototypeOf(e)?!1:vN(t)&&vN(e)?yN(t)&&yN(e)?xN(t,e):xle(t,e):xN({entries:()=>Object.entries(t)},{entries:()=>Object.entries(e)})}function ble(t){const e=iu.useRef(void 0);return n=>{const i=t(n);return _le(e.current,i)?e.current:e.current=i}}const Uo={mass:10,tension:1e3,friction:300,precision:1};function oH(t,e,n){const i=e.getLength(),r=t==="end"?i:i/2,s=t==="end"?n/2:0,a=(r-s)/i,o=e.getPointAt(a),l=e.getTangentAt(a);return[o,l]}function lH(t){return[t+6,2+t/1.5]}const _N=.7;function uH(t,e,n=0){const i=new re(t.x,t.y||0,t.z||0),r=new re(e.x,e.y||0,e.z||0),s=new re().addVectors(i,r).divideScalar(2);return s.setLength(s.length()+n)}function Sle(t,e,n=-1){const i=t.clone(),r=e.clone(),s=new re().subVectors(r,i),a=s.length(),o=s.clone().normalize(),l=new re().subVectors(r,i).divideScalar(2),u=Math.abs(o.x)%1,c=new re(-o.y,o.x-u*o.z,u*o.y).normalize(),h=new re().add(i).add(l).add(c.multiplyScalar(a/4).multiplyScalar(n));return[t,h,e]}function n_(t,e,n,i,r,s){const a=bN(t,n,e),o=bN(n,t,i);return r?new gT(...Sle(a,o,s)):new kU(a,o)}function i_(t){return new re(t.position.x,t.position.y,t.position.z||0)}function bN(t,e,n){const i=t.distanceTo(e);return t.clone().add(e.clone().sub(t).multiplyScalar(n/i))}function SN(t,e){return{...t,position:{...t.position,x:t.position.x+e.x,y:t.position.y+e.y,z:t.position.z+e.z}}}function Ele({edge:t,edges:e,curved:n}){let i=n,r;const s=e.filter(a=>a.target===t.target&&a.source===t.source).map(a=>a.id);if(s.length>1){i=!0;const a=s.indexOf(t.id);s.length===2?r=a===0?_N:-.7:r=(a-Math.floor(s.length/2))*_N}return{curved:i,curveOffset:r}}function r_(t){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let o of t)e=Math.min(e,o.position.x),n=Math.max(n,o.position.x),i=Math.min(i,o.position.y),r=Math.max(r,o.position.y),s=Math.min(s,o.position.z),a=Math.max(a,o.position.z);return{height:r-i,width:n-e,minX:e,maxX:n,minY:i,maxY:r,minZ:s,maxZ:a,x:(n+e)/2,y:(r+i)/2,z:(a+s)/2}}function wle(t,e){return e?t.reduce((n,i)=>{const r=i.data[e];return r&&n.set(r,[...n.get(r)||[],i]),n},new Map):new Map}function Ale({nodes:t,clusterAttribute:e}){const n=new Map;if(e){const i=wle(t,e);for(const[r,s]of i){const a=r_(s);n.set(r,{label:r,nodes:s,position:a})}}return n}var bv={};function ac(t){if(typeof t!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=t}typeof Symbol<"u"&&(ac.prototype[Symbol.iterator]=function(){return this});ac.of=function(){var t=arguments,e=t.length,n=0;return new ac(function(){return n>=e?{done:!0}:{done:!1,value:t[n++]}})};ac.empty=function(){var t=new ac(function(){return{done:!0}});return t};ac.fromSequence=function(t){var e=0,n=t.length;return new ac(function(){return e>=n?{done:!0}:{done:!1,value:t[e++]}})};ac.is=function(t){return t instanceof ac?!0:typeof t=="object"&&t!==null&&typeof t.next=="function"};var IT=ac;const vl=Lo(IT);var LT={};LT.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";LT.SYMBOL_SUPPORT=typeof Symbol<"u";var cH=LT,Tle=cH.ARRAY_BUFFER_SUPPORT,Mle=cH.SYMBOL_SUPPORT,Sz=function(e,n){var i,r,s,a,o;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof n!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||Tle&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(s=0,a=e.length;s<a;s++)n(e[s],s);return}if(typeof e.forEach=="function"){e.forEach(n);return}if(Mle&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(i=e,s=0;o=i.next(),o.done!==!0;)n(o.value,s),s++;return}for(r in e)e.hasOwnProperty(r)&&n(e[r],r)},fH=IT,Cle=Sz;function ls(){this.clear()}ls.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};ls.prototype.enqueue=function(t){return this.items.push(t),++this.size};ls.prototype.dequeue=function(){if(this.size){var t=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,t}};ls.prototype.peek=function(){if(this.size)return this.items[this.offset]};ls.prototype.forEach=function(t,e){e=arguments.length>1?e:this;for(var n=this.offset,i=0,r=this.items.length;n<r;n++,i++)t.call(e,this.items[n],i,this)};ls.prototype.toArray=function(){return this.items.slice(this.offset)};ls.prototype.values=function(){var t=this.items,e=this.offset;return new fH(function(){if(e>=t.length)return{done:!0};var n=t[e];return e++,{value:n,done:!1}})};ls.prototype.entries=function(){var t=this.items,e=this.offset,n=0;return new fH(function(){if(e>=t.length)return{done:!0};var i=t[e];return e++,{value:[n++,i],done:!1}})};typeof Symbol<"u"&&(ls.prototype[Symbol.iterator]=ls.prototype.values);ls.prototype.toString=function(){return this.toArray().join(",")};ls.prototype.toJSON=function(){return this.toArray()};ls.prototype.inspect=function(){var t=this.toArray();return Object.defineProperty(t,"constructor",{value:ls,enumerable:!1}),t};typeof Symbol<"u"&&(ls.prototype[Symbol.for("nodejs.util.inspect.custom")]=ls.prototype.inspect);ls.from=function(t){var e=new ls;return Cle(t,function(n){e.enqueue(n)}),e};ls.of=function(){return ls.from(arguments)};var Rle=ls,Dle=function(e,n){var i=n.length;if(i!==0){var r=e.length;e.length+=i;for(var s=0;s<i;s++)e[r+s]=n[s]}},Ez=Bf,Ole=Rle,Ule=Dle;function zle(t,e,n){if(!Ez(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');if(!t.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" target node does not exist in the given graph.');if(e=""+e,n=""+n,e===n)return[e];var i=t.inboundNeighbors.bind(t),r=t.outboundNeighbors.bind(t),s={},a={};s[e]=null,a[n]=null;var o=[e],l=[n],u,c,h,d,m,v,_,y,g=!1;e:for(;o.length&&l.length;)if(o.length<=l.length){for(u=o,o=[],m=0,_=u.length;m<_;m++)for(c=u[m],h=r(c),v=0,y=h.length;v<y;v++)if(d=h[v],d in s||(o.push(d),s[d]=c),d in a){g=!0;break e}}else for(u=l,l=[],m=0,_=u.length;m<_;m++)for(c=u[m],h=i(c),v=0,y=h.length;v<y;v++)if(d=h[v],d in a||(l.push(d),a[d]=c),d in s){g=!0;break e}if(!g)return null;for(var x=[];d;)x.unshift(d),d=s[d];for(d=a[x[x.length-1]];d;)x.push(d),d=a[d];return x.length?x:null}function Ile(t,e){if(!Ez(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');e=""+e;var n={},i={},r,s,a,o,l,u;for(n[e]=!0,i[e]=[e];Object.keys(n).length;){r=n,n={};for(a in r)for(s=t.outboundNeighbors(a),l=0,u=s.length;l<u;l++)o=s[l],i[o]||(i[o]=i[a].concat(o),n[o]=!0)}return i}function hH(t,e,n){if(!Ez(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!e.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" source node does not exist in the given graph.');n=""+n;var i=new Set,r={},s=0;r[n]=0;for(var a=[n],o,l,u;a.length!==0;){var c=[];for(o=0,l=a.length;o<l;o++)u=a[o],!i.has(u)&&(i.add(u),Ule(c,e[t](u)),r[u]=s);s++,a=c}return r}var Lle=hH.bind(null,"outboundNeighbors"),Ple=hH.bind(null,"neighbors");function Nle(t,e){e=""+e;var n=[],i={},r={},s=t.nodes(),a,o,l,u,c,h,d,m,v;for(h=0,m=s.length;h<m;h++)u=s[h],i[u]=[],r[u]=0;var _={};r[e]=1,_[e]=0;for(var y=Ole.of(e);y.size;)for(u=y.dequeue(),n.push(u),a=_[u],o=r[u],l=t.outboundNeighbors(u),d=0,v=l.length;d<v;d++)c=l[d],c in _||(y.enqueue(c),_[c]=a+1),_[c]===a+1&&(r[c]+=o,i[c].push(u));return[n,i,r]}bv.bidirectional=zle;bv.singleSource=Ile;bv.singleSourceLength=Lle;bv.undirectedSingleSourceLength=Ple;bv.brandes=Nle;var wz={},K_={},Ble=function(t,e){return t<e?-1:t>e?1:0},kle=function(t,e){return t<e?1:t>e?-1:0};function Fle(t){return function(e,n){return t(n,e)}}function Gle(t){return t===2?function(e,n){return e[0]<n[0]?-1:e[0]>n[0]?1:e[1]<n[1]?-1:e[1]>n[1]?1:0}:function(e,n){for(var i=0;i<t;){if(e[i]<n[i])return-1;if(e[i]>n[i])return 1;i++}return 0}}K_.DEFAULT_COMPARATOR=Ble;K_.DEFAULT_REVERSE_COMPARATOR=kle;K_.reverseComparator=Fle;K_.createTupleComparator=Gle;var Q_={},dH=Sz,pH=vz;function Vle(t){return Array.isArray(t)||pH.isTypedArray(t)}function Az(t){if(typeof t.length=="number")return t.length;if(typeof t.size=="number")return t.size}function Hle(t){var e=Az(t),n=typeof e=="number"?new Array(e):[],i=0;return dH(t,function(r){n[i++]=r}),n}function jle(t){var e=Az(t),n=typeof e=="number"?pH.getPointerArray(e):Array,i=typeof e=="number"?new Array(e):[],r=typeof e=="number"?new n(e):[],s=0;return dH(t,function(a){i[s]=a,r[s]=s++}),[i,r]}Q_.isArrayLike=Vle;Q_.guessLength=Az;Q_.toArray=Hle;Q_.toArrayWithIndices=jle;var rA=Sz,mH=K_,tc=Q_,PT=mH.DEFAULT_COMPARATOR,Tz=mH.reverseComparator;function Mz(t,e,n,i){for(var r=e[i],s,a;i>n;){if(s=i-1>>1,a=e[s],t(r,a)<0){e[i]=a,i=s;continue}break}e[i]=r}function J_(t,e,n){for(var i=e.length,r=n,s=e[n],a=2*n+1,o;a<i;)o=a+1,o<i&&t(e[a],e[o])>=0&&(a=o),e[n]=e[a],n=a,a=2*n+1;e[n]=s,Mz(t,e,r,n)}function gH(t,e,n){e.push(n),Mz(t,e,0,e.length-1)}function Cz(t,e){var n=e.pop();if(e.length!==0){var i=e[0];return e[0]=n,J_(t,e,0),i}return n}function J0(t,e,n){if(e.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var i=e[0];return e[0]=n,J_(t,e,0),i}function vH(t,e,n){var i;return e.length!==0&&t(e[0],n)<0&&(i=e[0],e[0]=n,n=i,J_(t,e,0)),n}function im(t,e){for(var n=e.length,i=n>>1,r=i;--r>=0;)J_(t,e,r)}function Rz(t,e){for(var n=e.length,i=0,r=new Array(n);i<n;)r[i++]=Cz(t,e);return r}function Wle(t,e,n){arguments.length===2&&(n=e,e=t,t=PT);var i=Tz(t),r,s,a,o=1/0,l;if(e===1){if(tc.isArrayLike(n)){for(r=0,s=n.length;r<s;r++)a=n[r],(o===1/0||t(a,o)<0)&&(o=a);return l=new n.constructor(1),l[0]=o,l}return rA(n,function(c){(o===1/0||t(c,o)<0)&&(o=c)}),[o]}if(tc.isArrayLike(n)){if(e>=n.length)return n.slice().sort(t);for(l=n.slice(0,e),im(i,l),r=e,s=n.length;r<s;r++)i(n[r],l[0])>0&&J0(i,l,n[r]);return l.sort(t)}var u=tc.guessLength(n);return u!==null&&u<e&&(e=u),l=new Array(e),r=0,rA(n,function(c){r<e?l[r]=c:(r===e&&im(i,l),i(c,l[0])>0&&J0(i,l,c)),r++}),l.length>r&&(l.length=r),l.sort(t)}function Xle(t,e,n){arguments.length===2&&(n=e,e=t,t=PT);var i=Tz(t),r,s,a,o=-1/0,l;if(e===1){if(tc.isArrayLike(n)){for(r=0,s=n.length;r<s;r++)a=n[r],(o===-1/0||t(a,o)>0)&&(o=a);return l=new n.constructor(1),l[0]=o,l}return rA(n,function(c){(o===-1/0||t(c,o)>0)&&(o=c)}),[o]}if(tc.isArrayLike(n)){if(e>=n.length)return n.slice().sort(i);for(l=n.slice(0,e),im(t,l),r=e,s=n.length;r<s;r++)t(n[r],l[0])>0&&J0(t,l,n[r]);return l.sort(i)}var u=tc.guessLength(n);return u!==null&&u<e&&(e=u),l=new Array(e),r=0,rA(n,function(c){r<e?l[r]=c:(r===e&&im(t,l),t(c,l[0])>0&&J0(t,l,c)),r++}),l.length>r&&(l.length=r),l.sort(i)}function $i(t){if(this.clear(),this.comparator=t||PT,typeof this.comparator!="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")}$i.prototype.clear=function(){this.items=[],this.size=0};$i.prototype.push=function(t){return gH(this.comparator,this.items,t),++this.size};$i.prototype.peek=function(){return this.items[0]};$i.prototype.pop=function(){return this.size!==0&&this.size--,Cz(this.comparator,this.items)};$i.prototype.replace=function(t){return J0(this.comparator,this.items,t)};$i.prototype.pushpop=function(t){return vH(this.comparator,this.items,t)};$i.prototype.consume=function(){return this.size=0,Rz(this.comparator,this.items)};$i.prototype.toArray=function(){return Rz(this.comparator,this.items.slice())};$i.prototype.inspect=function(){var t=this.toArray();return Object.defineProperty(t,"constructor",{value:$i,enumerable:!1}),t};typeof Symbol<"u"&&($i.prototype[Symbol.for("nodejs.util.inspect.custom")]=$i.prototype.inspect);function sA(t){if(this.clear(),this.comparator=t||PT,typeof this.comparator!="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=Tz(this.comparator)}sA.prototype=$i.prototype;$i.from=function(t,e){var n=new $i(e),i;return tc.isArrayLike(t)?i=t.slice():i=tc.toArray(t),im(n.comparator,i),n.items=i,n.size=i.length,n};sA.from=function(t,e){var n=new sA(e),i;return tc.isArrayLike(t)?i=t.slice():i=tc.toArray(t),im(n.comparator,i),n.items=i,n.size=i.length,n};$i.siftUp=J_;$i.siftDown=Mz;$i.push=gH;$i.pop=Cz;$i.replace=J0;$i.pushpop=vH;$i.heapify=im;$i.consume=Rz;$i.nsmallest=Wle;$i.nlargest=Xle;$i.MinHeap=$i;$i.MaxHeap=sA;var yH=$i,xH=Bf,Dz=gm.createEdgeWeightGetter,aA=yH,Oz="weight";function ED(t,e){return t[0]>e[0]?1:t[0]<e[0]?-1:t[1]>e[1]?1:t[1]<e[1]?-1:t[2]>e[2]?1:t[2]<e[2]?-1:0}function Yle(t,e){return t[0]>e[0]?1:t[0]<e[0]?-1:t[1]>e[1]?1:t[1]<e[1]?-1:t[2]>e[2]?1:t[2]<e[2]?-1:t[3]>e[3]?1:t[3]<e[3]?-1:0}function Zle(t,e,n,i){if(e=""+e,n=""+n,!xH(t))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(e&&!t.hasNode(e))throw new Error('graphology-shortest-path/dijkstra: the "'+e+'" source node does not exist in the given graph.');if(n&&!t.hasNode(n))throw new Error('graphology-shortest-path/dijkstra: the "'+n+'" target node does not exist in the given graph.');if(i=Dz(i||Oz).fromMinimalEntry,e===n)return[0,[e]];var r=[{},{}],s=[{},{}],a=[new aA(ED),new aA(ED)],o=[{},{}];s[0][e]=[e],s[1][n]=[n],o[0][e]=0,o[1][n]=0;var l=[],u=1/0,c=0,h=1,d,m,v,_,y,g,x,S,E;for(a[0].push([0,c++,e]),a[1].push([0,c++,n]);a[0].size&&a[1].size;)if(h=1-h,d=a[h].pop(),_=d[0],y=d[2],!(y in r[h])){if(r[h][y]=_,y in r[1-h])return[u,l];for(m=h===1?t.inboundEdges(y):t.outboundEdges(y),S=0,E=m.length;S<E;S++){if(x=m[S],g=t.opposite(y,x),v=r[h][y]+i(x,t.getEdgeAttributes(x)),g in r[h]&&v<r[h][g])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(g in o[h])||v<o[h][g])&&(o[h][g]=v,a[h].push([v,c++,g]),s[h][g]=s[h][y].concat(g),g in o[0]&&g in o[1]&&(_=o[0][g]+o[1][g],(l.length===0||u>_)&&(u=_,l=s[0][g].concat(s[1][g].slice(0,-1).reverse()))))}}return[1/0,null]}function qle(t,e,n,i,r,s){if(!xH(t))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");n=Dz(n||Oz).fromMinimalEntry;var a={},o={},l=new aA(ED),u=0,c,h,d,m,v,_,y,g,x,S,E;for(g=0,S=e.length;g<S;g++)m=e[g],o[m]=0,l.push([0,u++,m]),s&&(s[m]=[m]);for(;l.size;)if(h=l.pop(),y=h[0],m=h[2],!(m in a)){if(a[m]=y,m===r)break;for(c=t.outboundEdges(m),x=0,E=c.length;x<E;x++){if(_=c[x],v=t.opposite(m,_),d=n(_,t.getEdgeAttributes(_))+a[m],v in a&&d<a[v])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(v in o)||d<o[v])&&(o[v]=d,l.push([d,u++,v]),s&&(s[v]=s[m].concat(v)))}}return a}function Kle(t,e,n){var i={};return qle(t,[e],n,0,null,i),i}function Qle(t,e,n,i){return Zle(t,e,n,i)[1]}function Jle(t,e,n){e=""+e,n=Dz(n||Oz).fromMinimalEntry;var i=[],r={},s={},a=t.nodes(),o,l,u,c,h,d,m,v,_,y;for(_=0,y=a.length;_<y;_++)d=a[_],r[d]=[],s[d]=0;var g={};s[e]=1;var x={};x[e]=0;var S=0,E=new aA(Yle);for(E.push([0,S++,e,e]);E.size;)if(l=E.pop(),c=l[0],u=l[2],d=l[3],!(d in g))for(s[d]+=s[u],i.push(d),g[d]=c,o=t.outboundEdges(d),_=0,y=o.length;_<y;_++)v=o[_],m=t.opposite(d,v),h=c+n(v,t.getEdgeAttributes(v)),!(m in g)&&(!(m in x)||h<x[m])?(x[m]=h,E.push([h,S++,d,m]),s[m]=0,r[m]=[d]):h===x[m]&&(s[m]+=s[d],r[m].push(d));return[i,r,s]}wz.bidirectional=Qle;wz.singleSource=Kle;wz.brandes=Jle;var $le={},eue=Bf,tue=gm.createEdgeWeightGetter,nue=yH,iue="weight";function rue(t,e){return t[0]>e[0]?1:t[0]<e[0]?-1:t[1]>e[1]?1:t[1]<e[1]?-1:0}function sue(t,e,n,i,r,s){if(!eue(t))throw new Error("graphology-shortest-path/astar: invalid graphology instance.");if(e&&!t.hasNode(e))throw new Error('graphology-shortest-path/astar: the "'+e+'" source node does not exist in the given graph.');if(n&&!t.hasNode(n))throw new Error('graphology-shortest-path/astar: the "'+n+'" target node does not exist in the given graph.');if(i=tue(i||iue).fromMinimalEntry,e===n)return[e];r=r||function(){return 0},s=s||{};var a=0,o=new nue(rue);o.push([0,a++,e,0,null]);var l={},u={},c,h,d,m,v,_,y,g,x,S,E,A;function T(C,O,M,D){if(A=h===M?D:M,S=i(C,O),S!==null){if(E=m+S,l.hasOwnProperty(A)){if(d=l[A],g=d[0],x=d[1],g<=E)return}else x=r(A,n);s.cutoff&&E+x>s.cutoff||(l[A]=[E,x],o.push([E+x,a++,A,E,h]))}}for(;o.size!==0;){if(c=o.pop(),h=c[2],m=c[3],v=c[4],h===n){for(_=[h],y=v;y!==null;)_.push(y),y=u[y];return _.reverse(),_}u.hasOwnProperty(h)&&(u[h]===null||(g=l[h][0],g<m))||(u[h]=v,t.forEachOutboundEdge(h,T))}return null}$le.bidirectional=sue;var $_=bv;$_.bidirectional;$_.singleSource;$_.singleSourceLength;$_.undirectedSingleSourceLength;$_.brandes;var Uz={exports:{}},E0=typeof Reflect=="object"?Reflect:null,EN=E0&&typeof E0.apply=="function"?E0.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},vE;E0&&typeof E0.ownKeys=="function"?vE=E0.ownKeys:Object.getOwnPropertySymbols?vE=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:vE=function(e){return Object.getOwnPropertyNames(e)};function aue(t){console&&console.warn&&console.warn(t)}var _H=Number.isNaN||function(e){return e!==e};function ar(){ar.init.call(this)}Uz.exports=ar;Uz.exports.once=cue;ar.EventEmitter=ar;ar.prototype._events=void 0;ar.prototype._eventsCount=0;ar.prototype._maxListeners=void 0;var wN=10;function NT(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ar,"defaultMaxListeners",{enumerable:!0,get:function(){return wN},set:function(t){if(typeof t!="number"||t<0||_H(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");wN=t}});ar.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ar.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||_H(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function bH(t){return t._maxListeners===void 0?ar.defaultMaxListeners:t._maxListeners}ar.prototype.getMaxListeners=function(){return bH(this)};ar.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")EN(l,this,n);else for(var u=l.length,c=TH(l,u),i=0;i<u;++i)EN(c[i],this,n);return!0};function SH(t,e,n,i){var r,s,a;if(NT(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),a=s[e]),a===void 0)a=s[e]=n,++t._eventsCount;else if(typeof a=="function"?a=s[e]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),r=bH(t),r>0&&a.length>r&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=t,o.type=e,o.count=a.length,aue(o)}return t}ar.prototype.addListener=function(e,n){return SH(this,e,n,!1)};ar.prototype.on=ar.prototype.addListener;ar.prototype.prependListener=function(e,n){return SH(this,e,n,!0)};function oue(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function EH(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=oue.bind(i);return r.listener=n,i.wrapFn=r,r}ar.prototype.once=function(e,n){return NT(n),this.on(e,EH(this,e,n)),this};ar.prototype.prependOnceListener=function(e,n){return NT(n),this.prependListener(e,EH(this,e,n)),this};ar.prototype.removeListener=function(e,n){var i,r,s,a,o;if(NT(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,a=i.length-1;a>=0;a--)if(i[a]===n||i[a].listener===n){o=i[a].listener,s=a;break}if(s<0)return this;s===0?i.shift():lue(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,o||n)}return this};ar.prototype.off=ar.prototype.removeListener;ar.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),a;for(r=0;r<s.length;++r)a=s[r],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function wH(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?uue(r):TH(r,r.length)}ar.prototype.listeners=function(e){return wH(this,e,!0)};ar.prototype.rawListeners=function(e){return wH(this,e,!1)};ar.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):AH.call(t,e)};ar.prototype.listenerCount=AH;function AH(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}ar.prototype.eventNames=function(){return this._eventsCount>0?vE(this._events):[]};function TH(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function lue(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function uue(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function cue(t,e){return new Promise(function(n,i){function r(a){t.removeListener(e,s),i(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}MH(t,e,s,{once:!0}),e!=="error"&&fue(t,r,{once:!0})})}function fue(t,e,n){typeof t.on=="function"&&MH(t,"error",e,n)}function MH(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var hue=Uz.exports,due=IT,CH=LT,pue=CH.ARRAY_BUFFER_SUPPORT,mue=CH.SYMBOL_SUPPORT;function gue(t){return typeof t=="string"||Array.isArray(t)||pue&&ArrayBuffer.isView(t)?due.fromSequence(t):typeof t!="object"||t===null?null:mue&&typeof t[Symbol.iterator]=="function"?t[Symbol.iterator]():typeof t.next=="function"?t:null}var RH=function(e){var n=gue(e);if(!n)throw new Error("obliterator: target is not iterable nor a valid iterator.");return n},vue=RH,yue=function(e,n){for(var i=arguments.length>1?n:1/0,r=i!==1/0?new Array(i):[],s,a=0,o=vue(e);;){if(a===i)return r;if(s=o.next(),s.done)return a!==n&&(r.length=a),r;r[a++]=s.value}};const DH=Lo(yue);var xue=IT,_ue=RH,bue=function(){var e=arguments,n=null,i=-1;return new xue(function(){var s=null;do{if(n===null){if(i++,i>=e.length)return{done:!0};n=_ue(e[i])}if(s=n.next(),s.done===!0){n=null;continue}break}while(!0);return s})};const xf=Lo(bue);function Sue(){const t=arguments[0];for(let e=1,n=arguments.length;e<n;e++)if(arguments[e])for(const i in arguments[e])t[i]=arguments[e][i];return t}let Ds=Sue;typeof Object.assign=="function"&&(Ds=Object.assign);function hl(t,e,n,i){const r=t._nodes.get(e);let s=null;return r&&(i==="mixed"?s=r.out&&r.out[n]||r.undirected&&r.undirected[n]:i==="directed"?s=r.out&&r.out[n]:s=r.undirected&&r.undirected[n]),s}function ta(t){return typeof t=="object"&&t!==null}function OH(t){let e;for(e in t)return!1;return!0}function Ko(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,writable:!0,value:n})}function jl(t,e,n){const i={enumerable:!0,configurable:!0};typeof n=="function"?i.get=n:(i.value=n,i.writable=!1),Object.defineProperty(t,e,i)}function AN(t){return!(!ta(t)||t.attributes&&!Array.isArray(t.attributes))}function Eue(){let t=Math.floor(Math.random()*256)&255;return()=>t++}class zz extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class mn extends zz{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,mn.prototype.constructor)}}class tn extends zz{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,tn.prototype.constructor)}}class Bn extends zz{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Bn.prototype.constructor)}}function UH(t,e){this.key=t,this.attributes=e,this.clear()}UH.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function zH(t,e){this.key=t,this.attributes=e,this.clear()}zH.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function IH(t,e){this.key=t,this.attributes=e,this.clear()}IH.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Sv(t,e,n,i,r){this.key=e,this.attributes=r,this.undirected=t,this.source=n,this.target=i}Sv.prototype.attach=function(){let t="out",e="in";this.undirected&&(t=e="undirected");const n=this.source.key,i=this.target.key;this.source[t][i]=this,!(this.undirected&&n===i)&&(this.target[e][n]=this)};Sv.prototype.attachMulti=function(){let t="out",e="in";const n=this.source.key,i=this.target.key;this.undirected&&(t=e="undirected");const r=this.source[t],s=r[i];if(typeof s>"u"){r[i]=this,this.undirected&&n===i||(this.target[e][n]=this);return}s.previous=this,this.next=s,r[i]=this,this.target[e][n]=this};Sv.prototype.detach=function(){const t=this.source.key,e=this.target.key;let n="out",i="in";this.undirected&&(n=i="undirected"),delete this.source[n][e],delete this.target[i][t]};Sv.prototype.detachMulti=function(){const t=this.source.key,e=this.target.key;let n="out",i="in";this.undirected&&(n=i="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[n][e],delete this.target[i][t]):(this.next.previous=void 0,this.source[n][e]=this.next,this.target[i][t]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const LH=0,PH=1,wue=2,NH=3;function Ff(t,e,n,i,r,s,a){let o,l,u,c;if(i=""+i,n===LH){if(o=t._nodes.get(i),!o)throw new tn(`Graph.${e}: could not find the "${i}" node in the graph.`);u=r,c=s}else if(n===NH){if(r=""+r,l=t._edges.get(r),!l)throw new tn(`Graph.${e}: could not find the "${r}" edge in the graph.`);const h=l.source.key,d=l.target.key;if(i===h)o=l.target;else if(i===d)o=l.source;else throw new tn(`Graph.${e}: the "${i}" node is not attached to the "${r}" edge (${h}, ${d}).`);u=s,c=a}else{if(l=t._edges.get(i),!l)throw new tn(`Graph.${e}: could not find the "${i}" edge in the graph.`);n===PH?o=l.source:o=l.target,u=r,c=s}return[o,u,c]}function Aue(t,e,n){t.prototype[e]=function(i,r,s){const[a,o]=Ff(this,e,n,i,r,s);return a.attributes[o]}}function Tue(t,e,n){t.prototype[e]=function(i,r){const[s]=Ff(this,e,n,i,r);return s.attributes}}function Mue(t,e,n){t.prototype[e]=function(i,r,s){const[a,o]=Ff(this,e,n,i,r,s);return a.attributes.hasOwnProperty(o)}}function Cue(t,e,n){t.prototype[e]=function(i,r,s,a){const[o,l,u]=Ff(this,e,n,i,r,s,a);return o.attributes[l]=u,this.emit("nodeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:l}),this}}function Rue(t,e,n){t.prototype[e]=function(i,r,s,a){const[o,l,u]=Ff(this,e,n,i,r,s,a);if(typeof u!="function")throw new mn(`Graph.${e}: updater should be a function.`);const c=o.attributes,h=u(c[l]);return c[l]=h,this.emit("nodeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:l}),this}}function Due(t,e,n){t.prototype[e]=function(i,r,s){const[a,o]=Ff(this,e,n,i,r,s);return delete a.attributes[o],this.emit("nodeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:o}),this}}function Oue(t,e,n){t.prototype[e]=function(i,r,s){const[a,o]=Ff(this,e,n,i,r,s);if(!ta(o))throw new mn(`Graph.${e}: provided attributes are not a plain object.`);return a.attributes=o,this.emit("nodeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function Uue(t,e,n){t.prototype[e]=function(i,r,s){const[a,o]=Ff(this,e,n,i,r,s);if(!ta(o))throw new mn(`Graph.${e}: provided attributes are not a plain object.`);return Ds(a.attributes,o),this.emit("nodeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:o}),this}}function zue(t,e,n){t.prototype[e]=function(i,r,s){const[a,o]=Ff(this,e,n,i,r,s);if(typeof o!="function")throw new mn(`Graph.${e}: provided updater is not a function.`);return a.attributes=o(a.attributes),this.emit("nodeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const Iue=[{name:t=>`get${t}Attribute`,attacher:Aue},{name:t=>`get${t}Attributes`,attacher:Tue},{name:t=>`has${t}Attribute`,attacher:Mue},{name:t=>`set${t}Attribute`,attacher:Cue},{name:t=>`update${t}Attribute`,attacher:Rue},{name:t=>`remove${t}Attribute`,attacher:Due},{name:t=>`replace${t}Attributes`,attacher:Oue},{name:t=>`merge${t}Attributes`,attacher:Uue},{name:t=>`update${t}Attributes`,attacher:zue}];function Lue(t){Iue.forEach(function({name:e,attacher:n}){n(t,e("Node"),LH),n(t,e("Source"),PH),n(t,e("Target"),wue),n(t,e("Opposite"),NH)})}function Pue(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Bn(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Bn(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,o=""+r;if(r=arguments[2],s=hl(this,a,o,n),!s)throw new tn(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Bn(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new tn(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return s.attributes[r]}}function Nue(t,e,n){t.prototype[e]=function(i){let r;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Bn(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new Bn(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+i,a=""+arguments[1];if(r=hl(this,s,a,n),!r)throw new tn(`Graph.${e}: could not find an edge for the given path ("${s}" - "${a}").`)}else{if(n!=="mixed")throw new Bn(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,r=this._edges.get(i),!r)throw new tn(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return r.attributes}}function Bue(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Bn(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Bn(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,o=""+r;if(r=arguments[2],s=hl(this,a,o,n),!s)throw new tn(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Bn(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new tn(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return s.attributes.hasOwnProperty(r)}}function kue(t,e,n){t.prototype[e]=function(i,r,s){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Bn(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Bn(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,l=""+r;if(r=arguments[2],s=arguments[3],a=hl(this,o,l,n),!a)throw new tn(`Graph.${e}: could not find an edge for the given path ("${o}" - "${l}").`)}else{if(n!=="mixed")throw new Bn(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,a=this._edges.get(i),!a)throw new tn(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return a.attributes[r]=s,this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:r}),this}}function Fue(t,e,n){t.prototype[e]=function(i,r,s){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Bn(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Bn(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,l=""+r;if(r=arguments[2],s=arguments[3],a=hl(this,o,l,n),!a)throw new tn(`Graph.${e}: could not find an edge for the given path ("${o}" - "${l}").`)}else{if(n!=="mixed")throw new Bn(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,a=this._edges.get(i),!a)throw new tn(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(typeof s!="function")throw new mn(`Graph.${e}: updater should be a function.`);return a.attributes[r]=s(a.attributes[r]),this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:r}),this}}function Gue(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Bn(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Bn(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,o=""+r;if(r=arguments[2],s=hl(this,a,o,n),!s)throw new tn(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Bn(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new tn(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return delete s.attributes[r],this.emit("edgeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:r}),this}}function Vue(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Bn(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Bn(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,o=""+r;if(r=arguments[2],s=hl(this,a,o,n),!s)throw new tn(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Bn(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new tn(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(!ta(r))throw new mn(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=r,this.emit("edgeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function Hue(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Bn(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Bn(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,o=""+r;if(r=arguments[2],s=hl(this,a,o,n),!s)throw new tn(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Bn(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new tn(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(!ta(r))throw new mn(`Graph.${e}: provided attributes are not a plain object.`);return Ds(s.attributes,r),this.emit("edgeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:r}),this}}function jue(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Bn(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Bn(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,o=""+r;if(r=arguments[2],s=hl(this,a,o,n),!s)throw new tn(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new Bn(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new tn(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(typeof r!="function")throw new mn(`Graph.${e}: provided updater is not a function.`);return s.attributes=r(s.attributes),this.emit("edgeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const Wue=[{name:t=>`get${t}Attribute`,attacher:Pue},{name:t=>`get${t}Attributes`,attacher:Nue},{name:t=>`has${t}Attribute`,attacher:Bue},{name:t=>`set${t}Attribute`,attacher:kue},{name:t=>`update${t}Attribute`,attacher:Fue},{name:t=>`remove${t}Attribute`,attacher:Gue},{name:t=>`replace${t}Attributes`,attacher:Vue},{name:t=>`merge${t}Attributes`,attacher:Hue},{name:t=>`update${t}Attributes`,attacher:jue}];function Xue(t){Wue.forEach(function({name:e,attacher:n}){n(t,e("Edge"),"mixed"),n(t,e("DirectedEdge"),"directed"),n(t,e("UndirectedEdge"),"undirected")})}const Yue=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Zue(t,e,n,i){let r=!1;for(const s in e){if(s===i)continue;const a=e[s];if(r=n(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),t&&r)return a.key}}function que(t,e,n,i){let r,s,a,o=!1;for(const l in e)if(l!==i){r=e[l];do{if(s=r.source,a=r.target,o=n(r.key,r.attributes,s.key,a.key,s.attributes,a.attributes,r.undirected),t&&o)return r.key;r=r.next}while(r!==void 0)}}function _3(t,e){const n=Object.keys(t),i=n.length;let r,s=0;return new vl(function(){do if(r)r=r.next;else{if(s>=i)return{done:!0};const o=n[s++];if(o===e){r=void 0;continue}r=t[o]}while(!r);return{done:!1,value:{edge:r.key,attributes:r.attributes,source:r.source.key,target:r.target.key,sourceAttributes:r.source.attributes,targetAttributes:r.target.attributes,undirected:r.undirected}}})}function Kue(t,e,n,i){const r=e[n];if(!r)return;const s=r.source,a=r.target;if(i(r.key,r.attributes,s.key,a.key,s.attributes,a.attributes,r.undirected)&&t)return r.key}function Que(t,e,n,i){let r=e[n];if(!r)return;let s=!1;do{if(s=i(r.key,r.attributes,r.source.key,r.target.key,r.source.attributes,r.target.attributes,r.undirected),t&&s)return r.key;r=r.next}while(r!==void 0)}function b3(t,e){let n=t[e];return n.next!==void 0?new vl(function(){if(!n)return{done:!0};const i={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:i}}):vl.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function Jue(t,e){if(t.size===0)return[];if(e==="mixed"||e===t.type)return typeof Array.from=="function"?Array.from(t._edges.keys()):DH(t._edges.keys(),t._edges.size);const n=e==="undirected"?t.undirectedSize:t.directedSize,i=new Array(n),r=e==="undirected",s=t._edges.values();let a=0,o,l;for(;o=s.next(),o.done!==!0;)l=o.value,l.undirected===r&&(i[a++]=l.key);return i}function BH(t,e,n,i){if(e.size===0)return;const r=n!=="mixed"&&n!==e.type,s=n==="undirected";let a,o,l=!1;const u=e._edges.values();for(;a=u.next(),a.done!==!0;){if(o=a.value,r&&o.undirected!==s)continue;const{key:c,attributes:h,source:d,target:m}=o;if(l=i(c,h,d.key,m.key,d.attributes,m.attributes,o.undirected),t&&l)return c}}function $ue(t,e){if(t.size===0)return vl.empty();const n=e!=="mixed"&&e!==t.type,i=e==="undirected",r=t._edges.values();return new vl(function(){let a,o;for(;;){if(a=r.next(),a.done)return a;if(o=a.value,!(n&&o.undirected!==i))break}return{value:{edge:o.key,attributes:o.attributes,source:o.source.key,target:o.target.key,sourceAttributes:o.source.attributes,targetAttributes:o.target.attributes,undirected:o.undirected},done:!1}})}function Iz(t,e,n,i,r,s){const a=e?que:Zue;let o;if(n!=="undirected"&&(i!=="out"&&(o=a(t,r.in,s),t&&o)||i!=="in"&&(o=a(t,r.out,s,i?void 0:r.key),t&&o))||n!=="directed"&&(o=a(t,r.undirected,s),t&&o))return o}function ece(t,e,n,i){const r=[];return Iz(!1,t,e,n,i,function(s){r.push(s)}),r}function tce(t,e,n){let i=vl.empty();return t!=="undirected"&&(e!=="out"&&typeof n.in<"u"&&(i=xf(i,_3(n.in))),e!=="in"&&typeof n.out<"u"&&(i=xf(i,_3(n.out,e?void 0:n.key)))),t!=="directed"&&typeof n.undirected<"u"&&(i=xf(i,_3(n.undirected))),i}function Lz(t,e,n,i,r,s,a){const o=n?Que:Kue;let l;if(e!=="undirected"&&(typeof r.in<"u"&&i!=="out"&&(l=o(t,r.in,s,a),t&&l)||typeof r.out<"u"&&i!=="in"&&(i||r.key!==s)&&(l=o(t,r.out,s,a),t&&l))||e!=="directed"&&typeof r.undirected<"u"&&(l=o(t,r.undirected,s,a),t&&l))return l}function nce(t,e,n,i,r){const s=[];return Lz(!1,t,e,n,i,r,function(a){s.push(a)}),s}function ice(t,e,n,i){let r=vl.empty();return t!=="undirected"&&(typeof n.in<"u"&&e!=="out"&&i in n.in&&(r=xf(r,b3(n.in,i))),typeof n.out<"u"&&e!=="in"&&i in n.out&&(e||n.key!==i)&&(r=xf(r,b3(n.out,i)))),t!=="directed"&&typeof n.undirected<"u"&&i in n.undirected&&(r=xf(r,b3(n.undirected,i))),r}function rce(t,e){const{name:n,type:i,direction:r}=e;t.prototype[n]=function(s,a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];if(!arguments.length)return Jue(this,i);if(arguments.length===1){s=""+s;const o=this._nodes.get(s);if(typeof o>"u")throw new tn(`Graph.${n}: could not find the "${s}" node in the graph.`);return ece(this.multi,i==="mixed"?this.type:i,r,o)}if(arguments.length===2){s=""+s,a=""+a;const o=this._nodes.get(s);if(!o)throw new tn(`Graph.${n}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(a))throw new tn(`Graph.${n}:  could not find the "${a}" target node in the graph.`);return nce(i,this.multi,r,o,a)}throw new mn(`Graph.${n}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function sce(t,e){const{name:n,type:i,direction:r}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,c,h){if(!(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)){if(arguments.length===1)return h=u,BH(!1,this,i,h);if(arguments.length===2){u=""+u,h=c;const d=this._nodes.get(u);if(typeof d>"u")throw new tn(`Graph.${s}: could not find the "${u}" node in the graph.`);return Iz(!1,this.multi,i==="mixed"?this.type:i,r,d,h)}if(arguments.length===3){u=""+u,c=""+c;const d=this._nodes.get(u);if(!d)throw new tn(`Graph.${s}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(c))throw new tn(`Graph.${s}:  could not find the "${c}" target node in the graph.`);return Lz(!1,i,this.multi,r,d,c,h)}throw new mn(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const a="map"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop();let h;if(u.length===0){let d=0;i!=="directed"&&(d+=this.undirectedSize),i!=="undirected"&&(d+=this.directedSize),h=new Array(d);let m=0;u.push((v,_,y,g,x,S,E)=>{h[m++]=c(v,_,y,g,x,S,E)})}else h=[],u.push((d,m,v,_,y,g,x)=>{h.push(c(d,m,v,_,y,g,x))});return this[s].apply(this,u),h};const o="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop(),h=[];return u.push((d,m,v,_,y,g,x)=>{c(d,m,v,_,y,g,x)&&h.push(d)}),this[s].apply(this,u),h};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(){let u=Array.prototype.slice.call(arguments);if(u.length<2||u.length>4)throw new mn(`Graph.${l}: invalid number of arguments (expecting 2, 3 or 4 and got ${u.length}).`);if(typeof u[u.length-1]=="function"&&typeof u[u.length-2]!="function")throw new mn(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let c,h;u.length===2?(c=u[0],h=u[1],u=[]):u.length===3?(c=u[1],h=u[2],u=[u[0]]):u.length===4&&(c=u[2],h=u[3],u=[u[0],u[1]]);let d=h;return u.push((m,v,_,y,g,x,S)=>{d=c(d,m,v,_,y,g,x,S)}),this[s].apply(this,u),d}}function ace(t,e){const{name:n,type:i,direction:r}=e,s="find"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(l,u,c){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return!1;if(arguments.length===1)return c=l,BH(!0,this,i,c);if(arguments.length===2){l=""+l,c=u;const h=this._nodes.get(l);if(typeof h>"u")throw new tn(`Graph.${s}: could not find the "${l}" node in the graph.`);return Iz(!0,this.multi,i==="mixed"?this.type:i,r,h,c)}if(arguments.length===3){l=""+l,u=""+u;const h=this._nodes.get(l);if(!h)throw new tn(`Graph.${s}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(u))throw new tn(`Graph.${s}:  could not find the "${u}" target node in the graph.`);return Lz(!0,i,this.multi,r,h,u,c)}throw new mn(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const a="some"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[a]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((h,d,m,v,_,y,g)=>u(h,d,m,v,_,y,g)),!!this[s].apply(this,l)};const o="every"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[o]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((h,d,m,v,_,y,g)=>!u(h,d,m,v,_,y,g)),!this[s].apply(this,l)}}function oce(t,e){const{name:n,type:i,direction:r}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(a,o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return vl.empty();if(!arguments.length)return $ue(this,i);if(arguments.length===1){a=""+a;const l=this._nodes.get(a);if(!l)throw new tn(`Graph.${s}: could not find the "${a}" node in the graph.`);return tce(i,r,l)}if(arguments.length===2){a=""+a,o=""+o;const l=this._nodes.get(a);if(!l)throw new tn(`Graph.${s}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(o))throw new tn(`Graph.${s}:  could not find the "${o}" target node in the graph.`);return ice(i,r,l,o)}throw new mn(`Graph.${s}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function lce(t){Yue.forEach(e=>{rce(t,e),sce(t,e),ace(t,e),oce(t,e)})}const uce=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function BT(){this.A=null,this.B=null}BT.prototype.wrap=function(t){this.A===null?this.A=t:this.B===null&&(this.B=t)};BT.prototype.has=function(t){return this.A!==null&&t in this.A||this.B!==null&&t in this.B};function ox(t,e,n,i,r){for(const s in i){const a=i[s],o=a.source,l=a.target,u=o===n?l:o;if(e&&e.has(u.key))continue;const c=r(u.key,u.attributes);if(t&&c)return u.key}}function Pz(t,e,n,i,r){if(e!=="mixed"){if(e==="undirected")return ox(t,null,i,i.undirected,r);if(typeof n=="string")return ox(t,null,i,i[n],r)}const s=new BT;let a;if(e!=="undirected"){if(n!=="out"){if(a=ox(t,null,i,i.in,r),t&&a)return a;s.wrap(i.in)}if(n!=="in"){if(a=ox(t,s,i,i.out,r),t&&a)return a;s.wrap(i.out)}}if(e!=="directed"&&(a=ox(t,s,i,i.undirected,r),t&&a))return a}function cce(t,e,n){if(t!=="mixed"){if(t==="undirected")return Object.keys(n.undirected);if(typeof e=="string")return Object.keys(n[e])}const i=[];return Pz(!1,t,e,n,function(r){i.push(r)}),i}function lx(t,e,n){const i=Object.keys(n),r=i.length;let s=0;return new vl(function(){let o=null;do{if(s>=r)return t&&t.wrap(n),{done:!0};const l=n[i[s++]],u=l.source,c=l.target;if(o=u===e?c:u,t&&t.has(o.key)){o=null;continue}}while(o===null);return{done:!1,value:{neighbor:o.key,attributes:o.attributes}}})}function fce(t,e,n){if(t!=="mixed"){if(t==="undirected")return lx(null,n,n.undirected);if(typeof e=="string")return lx(null,n,n[e])}let i=vl.empty();const r=new BT;return t!=="undirected"&&(e!=="out"&&(i=xf(i,lx(r,n,n.in))),e!=="in"&&(i=xf(i,lx(r,n,n.out)))),t!=="directed"&&(i=xf(i,lx(r,n,n.undirected))),i}function hce(t,e){const{name:n,type:i,direction:r}=e;t.prototype[n]=function(s){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];s=""+s;const a=this._nodes.get(s);if(typeof a>"u")throw new tn(`Graph.${n}: could not find the "${s}" node in the graph.`);return cce(i==="mixed"?this.type:i,r,a)}}function dce(t,e){const{name:n,type:i,direction:r}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,c){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;u=""+u;const h=this._nodes.get(u);if(typeof h>"u")throw new tn(`Graph.${s}: could not find the "${u}" node in the graph.`);Pz(!1,i==="mixed"?this.type:i,r,h,c)};const a="map"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(u,c){const h=[];return this[s](u,(d,m)=>{h.push(c(d,m))}),h};const o="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(u,c){const h=[];return this[s](u,(d,m)=>{c(d,m)&&h.push(d)}),h};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(u,c,h){if(arguments.length<3)throw new mn(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let d=h;return this[s](u,(m,v)=>{d=c(d,m,v)}),d}}function pce(t,e){const{name:n,type:i,direction:r}=e,s=n[0].toUpperCase()+n.slice(1,-1),a="find"+s;t.prototype[a]=function(u,c){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;u=""+u;const h=this._nodes.get(u);if(typeof h>"u")throw new tn(`Graph.${a}: could not find the "${u}" node in the graph.`);return Pz(!0,i==="mixed"?this.type:i,r,h,c)};const o="some"+s;t.prototype[o]=function(u,c){return!!this[a](u,c)};const l="every"+s;t.prototype[l]=function(u,c){return!this[a](u,(d,m)=>!c(d,m))}}function mce(t,e){const{name:n,type:i,direction:r}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return vl.empty();a=""+a;const o=this._nodes.get(a);if(typeof o>"u")throw new tn(`Graph.${s}: could not find the "${a}" node in the graph.`);return fce(i==="mixed"?this.type:i,r,o)}}function gce(t){uce.forEach(e=>{hce(t,e),dce(t,e),pce(t,e),mce(t,e)})}function M2(t,e,n,i,r){const s=i._nodes.values(),a=i.type;let o,l,u,c,h,d;for(;o=s.next(),o.done!==!0;){let m=!1;if(l=o.value,a!=="undirected"){c=l.out;for(u in c){h=c[u];do d=h.target,m=!0,r(l.key,d.key,l.attributes,d.attributes,h.key,h.attributes,h.undirected),h=h.next;while(h)}}if(a!=="directed"){c=l.undirected;for(u in c)if(!(e&&l.key>u)){h=c[u];do d=h.target,d.key!==u&&(d=h.source),m=!0,r(l.key,d.key,l.attributes,d.attributes,h.key,h.attributes,h.undirected),h=h.next;while(h)}}n&&!m&&r(l.key,null,l.attributes,null,null,null,null)}}function vce(t,e){const n={key:t};return OH(e.attributes)||(n.attributes=Ds({},e.attributes)),n}function yce(t,e,n){const i={key:e,source:n.source.key,target:n.target.key};return OH(n.attributes)||(i.attributes=Ds({},n.attributes)),t==="mixed"&&n.undirected&&(i.undirected=!0),i}function xce(t){if(!ta(t))throw new mn('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in t))throw new mn("Graph.import: serialized node is missing its key.");if("attributes"in t&&(!ta(t.attributes)||t.attributes===null))throw new mn("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function _ce(t){if(!ta(t))throw new mn('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in t))throw new mn("Graph.import: serialized edge is missing its source.");if(!("target"in t))throw new mn("Graph.import: serialized edge is missing its target.");if("attributes"in t&&(!ta(t.attributes)||t.attributes===null))throw new mn("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in t&&typeof t.undirected!="boolean")throw new mn("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const bce=Eue(),Sce=new Set(["directed","undirected","mixed"]),TN=new Set(["domain","_events","_eventsCount","_maxListeners"]),Ece=[{name:t=>`${t}Edge`,generateKey:!0},{name:t=>`${t}DirectedEdge`,generateKey:!0,type:"directed"},{name:t=>`${t}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:t=>`${t}EdgeWithKey`},{name:t=>`${t}DirectedEdgeWithKey`,type:"directed"},{name:t=>`${t}UndirectedEdgeWithKey`,type:"undirected"}],wce={allowSelfLoops:!0,multi:!1,type:"mixed"};function Ace(t,e,n){if(n&&!ta(n))throw new mn(`Graph.addNode: invalid attributes. Expecting an object but got "${n}"`);if(e=""+e,n=n||{},t._nodes.has(e))throw new Bn(`Graph.addNode: the "${e}" node already exist in the graph.`);const i=new t.NodeDataClass(e,n);return t._nodes.set(e,i),t.emit("nodeAdded",{key:e,attributes:n}),i}function MN(t,e,n){const i=new t.NodeDataClass(e,n);return t._nodes.set(e,i),t.emit("nodeAdded",{key:e,attributes:n}),i}function kH(t,e,n,i,r,s,a,o){if(!i&&t.type==="undirected")throw new Bn(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(i&&t.type==="directed")throw new Bn(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(o&&!ta(o))throw new mn(`Graph.${e}: invalid attributes. Expecting an object but got "${o}"`);if(s=""+s,a=""+a,o=o||{},!t.allowSelfLoops&&s===a)throw new Bn(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const l=t._nodes.get(s),u=t._nodes.get(a);if(!l)throw new tn(`Graph.${e}: source node "${s}" not found.`);if(!u)throw new tn(`Graph.${e}: target node "${a}" not found.`);const c={key:null,undirected:i,source:s,target:a,attributes:o};if(n)r=t._edgeKeyGenerator();else if(r=""+r,t._edges.has(r))throw new Bn(`Graph.${e}: the "${r}" edge already exists in the graph.`);if(!t.multi&&(i?typeof l.undirected[a]<"u":typeof l.out[a]<"u"))throw new Bn(`Graph.${e}: an edge linking "${s}" to "${a}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const h=new Sv(i,r,l,u,o);t._edges.set(r,h);const d=s===a;return i?(l.undirectedDegree++,u.undirectedDegree++,d&&(l.undirectedLoops++,t._undirectedSelfLoopCount++)):(l.outDegree++,u.inDegree++,d&&(l.directedLoops++,t._directedSelfLoopCount++)),t.multi?h.attachMulti():h.attach(),i?t._undirectedSize++:t._directedSize++,c.key=r,t.emit("edgeAdded",c),r}function Tce(t,e,n,i,r,s,a,o,l){if(!i&&t.type==="undirected")throw new Bn(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(i&&t.type==="directed")throw new Bn(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(o){if(l){if(typeof o!="function")throw new mn(`Graph.${e}: invalid updater function. Expecting a function but got "${o}"`)}else if(!ta(o))throw new mn(`Graph.${e}: invalid attributes. Expecting an object but got "${o}"`)}s=""+s,a=""+a;let u;if(l&&(u=o,o=void 0),!t.allowSelfLoops&&s===a)throw new Bn(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let c=t._nodes.get(s),h=t._nodes.get(a),d,m;if(!n&&(d=t._edges.get(r),d)){if((d.source.key!==s||d.target.key!==a)&&(!i||d.source.key!==a||d.target.key!==s))throw new Bn(`Graph.${e}: inconsistency detected when attempting to merge the "${r}" edge with "${s}" source & "${a}" target vs. ("${d.source.key}", "${d.target.key}").`);m=d}if(!m&&!t.multi&&c&&(m=i?c.undirected[a]:c.out[a]),m){const x=[m.key,!1,!1,!1];if(l?!u:!o)return x;if(l){const S=m.attributes;m.attributes=u(S),t.emit("edgeAttributesUpdated",{type:"replace",key:m.key,attributes:m.attributes})}else Ds(m.attributes,o),t.emit("edgeAttributesUpdated",{type:"merge",key:m.key,attributes:m.attributes,data:o});return x}o=o||{},l&&u&&(o=u(o));const v={key:null,undirected:i,source:s,target:a,attributes:o};if(n)r=t._edgeKeyGenerator();else if(r=""+r,t._edges.has(r))throw new Bn(`Graph.${e}: the "${r}" edge already exists in the graph.`);let _=!1,y=!1;c||(c=MN(t,s,{}),_=!0,s===a&&(h=c,y=!0)),h||(h=MN(t,a,{}),y=!0),d=new Sv(i,r,c,h,o),t._edges.set(r,d);const g=s===a;return i?(c.undirectedDegree++,h.undirectedDegree++,g&&(c.undirectedLoops++,t._undirectedSelfLoopCount++)):(c.outDegree++,h.inDegree++,g&&(c.directedLoops++,t._directedSelfLoopCount++)),t.multi?d.attachMulti():d.attach(),i?t._undirectedSize++:t._directedSize++,v.key=r,t.emit("edgeAdded",v),[r,!0,_,y]}function Lg(t,e){t._edges.delete(e.key);const{source:n,target:i,attributes:r}=e,s=e.undirected,a=n===i;s?(n.undirectedDegree--,i.undirectedDegree--,a&&(n.undirectedLoops--,t._undirectedSelfLoopCount--)):(n.outDegree--,i.inDegree--,a&&(n.directedLoops--,t._directedSelfLoopCount--)),t.multi?e.detachMulti():e.detach(),s?t._undirectedSize--:t._directedSize--,t.emit("edgeDropped",{key:e.key,attributes:r,source:n.key,target:i.key,undirected:s})}class or extends hue.EventEmitter{constructor(e){if(super(),e=Ds({},wce,e),typeof e.multi!="boolean")throw new mn(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!Sce.has(e.type))throw new mn(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new mn(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const n=e.type==="mixed"?UH:e.type==="directed"?zH:IH;Ko(this,"NodeDataClass",n);const i="geid_"+bce()+"_";let r=0;const s=()=>{let a;do a=i+r++;while(this._edges.has(a));return a};Ko(this,"_attributes",{}),Ko(this,"_nodes",new Map),Ko(this,"_edges",new Map),Ko(this,"_directedSize",0),Ko(this,"_undirectedSize",0),Ko(this,"_directedSelfLoopCount",0),Ko(this,"_undirectedSelfLoopCount",0),Ko(this,"_edgeKeyGenerator",s),Ko(this,"_options",e),TN.forEach(a=>Ko(this,a,this[a])),jl(this,"order",()=>this._nodes.size),jl(this,"size",()=>this._edges.size),jl(this,"directedSize",()=>this._directedSize),jl(this,"undirectedSize",()=>this._undirectedSize),jl(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),jl(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),jl(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),jl(this,"multi",this._options.multi),jl(this,"type",this._options.type),jl(this,"allowSelfLoops",this._options.allowSelfLoops),jl(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,n){if(this.type==="undirected")return!1;if(arguments.length===1){const i=""+e,r=this._edges.get(i);return!!r&&!r.undirected}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?i.out.hasOwnProperty(n):!1}throw new mn(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,n){if(this.type==="directed")return!1;if(arguments.length===1){const i=""+e,r=this._edges.get(i);return!!r&&r.undirected}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?i.undirected.hasOwnProperty(n):!1}throw new mn(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,n){if(arguments.length===1){const i=""+e;return this._edges.has(i)}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?typeof i.out<"u"&&i.out.hasOwnProperty(n)||typeof i.undirected<"u"&&i.undirected.hasOwnProperty(n):!1}throw new mn(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,n){if(this.type==="undirected")return;if(e=""+e,n=""+n,this.multi)throw new Bn("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const i=this._nodes.get(e);if(!i)throw new tn(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new tn(`Graph.directedEdge: could not find the "${n}" target node in the graph.`);const r=i.out&&i.out[n]||void 0;if(r)return r.key}undirectedEdge(e,n){if(this.type==="directed")return;if(e=""+e,n=""+n,this.multi)throw new Bn("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const i=this._nodes.get(e);if(!i)throw new tn(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new tn(`Graph.undirectedEdge: could not find the "${n}" target node in the graph.`);const r=i.undirected&&i.undirected[n]||void 0;if(r)return r.key}edge(e,n){if(this.multi)throw new Bn("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new tn(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new tn(`Graph.edge: could not find the "${n}" target node in the graph.`);const r=i.out&&i.out[n]||i.undirected&&i.undirected[n]||void 0;if(r)return r.key}areDirectedNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new tn(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.in||n in i.out}areOutNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new tn(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.out}areInNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new tn(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.in}areUndirectedNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new tn(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:n in i.undirected}areNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new tn(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(n in i.in||n in i.out)||this.type!=="directed"&&n in i.undirected}areInboundNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new tn(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in i.in||this.type!=="directed"&&n in i.undirected}areOutboundNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new tn(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in i.out||this.type!=="directed"&&n in i.undirected}inDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree}outDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree}directedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree}undirectedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree}inboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.inDegree),i}outboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.outDegree),i}degree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.degree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.inDegree+n.outDegree),i}inDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree-n.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree-n.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree-n.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree-n.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.inDegree,r+=n.directedLoops),i-r}outboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.outDegree,r+=n.directedLoops),i-r}degreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.inDegree+n.outDegree,r+=n.directedLoops*2),i-r}source(e){e=""+e;const n=this._edges.get(e);if(!n)throw new tn(`Graph.source: could not find the "${e}" edge in the graph.`);return n.source.key}target(e){e=""+e;const n=this._edges.get(e);if(!n)throw new tn(`Graph.target: could not find the "${e}" edge in the graph.`);return n.target.key}extremities(e){e=""+e;const n=this._edges.get(e);if(!n)throw new tn(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[n.source.key,n.target.key]}opposite(e,n){e=""+e,n=""+n;const i=this._edges.get(n);if(!i)throw new tn(`Graph.opposite: could not find the "${n}" edge in the graph.`);const r=i.source.key,s=i.target.key;if(e===r)return s;if(e===s)return r;throw new tn(`Graph.opposite: the "${e}" node is not attached to the "${n}" edge (${r}, ${s}).`)}hasExtremity(e,n){e=""+e,n=""+n;const i=this._edges.get(e);if(!i)throw new tn(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return i.source.key===n||i.target.key===n}isUndirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new tn(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return n.undirected}isDirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new tn(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!n.undirected}isSelfLoop(e){e=""+e;const n=this._edges.get(e);if(!n)throw new tn(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return n.source===n.target}addNode(e,n){return Ace(this,e,n).key}mergeNode(e,n){if(n&&!ta(n))throw new mn(`Graph.mergeNode: invalid attributes. Expecting an object but got "${n}"`);e=""+e,n=n||{};let i=this._nodes.get(e);return i?(n&&(Ds(i.attributes,n),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:i.attributes,data:n})),[e,!1]):(i=new this.NodeDataClass(e,n),this._nodes.set(e,i),this.emit("nodeAdded",{key:e,attributes:n}),[e,!0])}updateNode(e,n){if(n&&typeof n!="function")throw new mn(`Graph.updateNode: invalid updater function. Expecting a function but got "${n}"`);e=""+e;let i=this._nodes.get(e);if(i){if(n){const s=i.attributes;i.attributes=n(s),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:i.attributes})}return[e,!1]}const r=n?n({}):{};return i=new this.NodeDataClass(e,r),this._nodes.set(e,i),this.emit("nodeAdded",{key:e,attributes:r}),[e,!0]}dropNode(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new tn(`Graph.dropNode: could not find the "${e}" node in the graph.`);let i;if(this.type!=="undirected"){for(const r in n.out){i=n.out[r];do Lg(this,i),i=i.next;while(i)}for(const r in n.in){i=n.in[r];do Lg(this,i),i=i.next;while(i)}}if(this.type!=="directed")for(const r in n.undirected){i=n.undirected[r];do Lg(this,i),i=i.next;while(i)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:n.attributes})}dropEdge(e){let n;if(arguments.length>1){const i=""+arguments[0],r=""+arguments[1];if(n=hl(this,i,r,this.type),!n)throw new tn(`Graph.dropEdge: could not find the "${i}" -> "${r}" edge in the graph.`)}else if(e=""+e,n=this._edges.get(e),!n)throw new tn(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return Lg(this,n),this}dropDirectedEdge(e,n){if(arguments.length<2)throw new Bn("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Bn("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,n=""+n;const i=hl(this,e,n,"directed");if(!i)throw new tn(`Graph.dropDirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return Lg(this,i),this}dropUndirectedEdge(e,n){if(arguments.length<2)throw new Bn("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Bn("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const i=hl(this,e,n,"undirected");if(!i)throw new tn(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return Lg(this,i),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let n;for(;n=e.next(),n.done!==!0;)n.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,n){return this._attributes[e]=n,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,n){if(typeof n!="function")throw new mn("Graph.updateAttribute: updater should be a function.");const i=this._attributes[e];return this._attributes[e]=n(i),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!ta(e))throw new mn("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!ta(e))throw new mn("Graph.mergeAttributes: provided attributes are not a plain object.");return Ds(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new mn("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,n){if(typeof e!="function")throw new mn("Graph.updateEachNodeAttributes: expecting an updater function.");if(n&&!AN(n))throw new mn("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._nodes.values();let r,s;for(;r=i.next(),r.done!==!0;)s=r.value,s.attributes=e(s.key,s.attributes);this.emit("eachNodeAttributesUpdated",{hints:n||null})}updateEachEdgeAttributes(e,n){if(typeof e!="function")throw new mn("Graph.updateEachEdgeAttributes: expecting an updater function.");if(n&&!AN(n))throw new mn("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._edges.values();let r,s,a,o;for(;r=i.next(),r.done!==!0;)s=r.value,a=s.source,o=s.target,s.attributes=e(s.key,s.attributes,a.key,o.key,a.attributes,o.attributes,s.undirected);this.emit("eachEdgeAttributesUpdated",{hints:n||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new mn("Graph.forEachAdjacencyEntry: expecting a callback.");M2(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new mn("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");M2(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new mn("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");M2(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new mn("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");M2(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):DH(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new mn("Graph.forEachNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)r=i.value,e(r.key,r.attributes)}findNode(e){if(typeof e!="function")throw new mn("Graph.findNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,e(r.key,r.attributes))return r.key}mapNodes(e){if(typeof e!="function")throw new mn("Graph.mapNode: expecting a callback.");const n=this._nodes.values();let i,r;const s=new Array(this.order);let a=0;for(;i=n.next(),i.done!==!0;)r=i.value,s[a++]=e(r.key,r.attributes);return s}someNode(e){if(typeof e!="function")throw new mn("Graph.someNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,e(r.key,r.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new mn("Graph.everyNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,!e(r.key,r.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new mn("Graph.filterNodes: expecting a callback.");const n=this._nodes.values();let i,r;const s=[];for(;i=n.next(),i.done!==!0;)r=i.value,e(r.key,r.attributes)&&s.push(r.key);return s}reduceNodes(e,n){if(typeof e!="function")throw new mn("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new mn("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let i=n;const r=this._nodes.values();let s,a;for(;s=r.next(),s.done!==!0;)a=s.value,i=e(i,a.key,a.attributes);return i}nodeEntries(){const e=this._nodes.values();return new vl(()=>{const n=e.next();if(n.done)return n;const i=n.value;return{value:{node:i.key,attributes:i.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let n=0;this._nodes.forEach((r,s)=>{e[n++]=vce(s,r)});const i=new Array(this._edges.size);return n=0,this._edges.forEach((r,s)=>{i[n++]=yce(this.type,s,r)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:i}}import(e,n=!1){if(e instanceof or)return e.forEachNode((l,u)=>{n?this.mergeNode(l,u):this.addNode(l,u)}),e.forEachEdge((l,u,c,h,d,m,v)=>{n?v?this.mergeUndirectedEdgeWithKey(l,c,h,u):this.mergeDirectedEdgeWithKey(l,c,h,u):v?this.addUndirectedEdgeWithKey(l,c,h,u):this.addDirectedEdgeWithKey(l,c,h,u)}),this;if(!ta(e))throw new mn("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!ta(e.attributes))throw new mn("Graph.import: invalid attributes. Expecting a plain object.");n?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let i,r,s,a,o;if(e.nodes){if(s=e.nodes,!Array.isArray(s))throw new mn("Graph.import: invalid nodes. Expecting an array.");for(i=0,r=s.length;i<r;i++){a=s[i],xce(a);const{key:l,attributes:u}=a;n?this.mergeNode(l,u):this.addNode(l,u)}}if(e.edges){let l=!1;if(this.type==="undirected"&&(l=!0),s=e.edges,!Array.isArray(s))throw new mn("Graph.import: invalid edges. Expecting an array.");for(i=0,r=s.length;i<r;i++){o=s[i],_ce(o);const{source:u,target:c,attributes:h,undirected:d=l}=o;let m;"key"in o?(m=n?d?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:d?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,m.call(this,o.key,u,c,h)):(m=n?d?this.mergeUndirectedEdge:this.mergeDirectedEdge:d?this.addUndirectedEdge:this.addDirectedEdge,m.call(this,u,c,h))}}return this}nullCopy(e){const n=new or(Ds({},this._options,e));return n.replaceAttributes(Ds({},this.getAttributes())),n}emptyCopy(e){const n=this.nullCopy(e);return this._nodes.forEach((i,r)=>{const s=Ds({},i.attributes);i=new n.NodeDataClass(r,s),n._nodes.set(r,i)}),n}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new Bn(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new Bn("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new Bn("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const n=this.emptyCopy(e),i=this._edges.values();let r,s;for(;r=i.next(),r.done!==!0;)s=r.value,kH(n,"copy",!1,s.undirected,s.key,s.source.key,s.target.key,Ds({},s.attributes));return n}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((s,a)=>{e[a]=s.attributes});const n={},i={};this._edges.forEach((s,a)=>{const o=s.undirected?"--":"->";let l="",u=s.source.key,c=s.target.key,h;s.undirected&&u>c&&(h=u,u=c,c=h);const d=`(${u})${o}(${c})`;a.startsWith("geid_")?this.multi&&(typeof i[d]>"u"?i[d]=0:i[d]++,l+=`${i[d]}. `):l+=`[${a}]: `,l+=d,n[l]=s.attributes});const r={};for(const s in this)this.hasOwnProperty(s)&&!TN.has(s)&&typeof this[s]!="function"&&typeof s!="symbol"&&(r[s]=this[s]);return r.attributes=this._attributes,r.nodes=e,r.edges=n,Ko(r,"constructor",this.constructor),r}}typeof Symbol<"u"&&(or.prototype[Symbol.for("nodejs.util.inspect.custom")]=or.prototype.inspect);Ece.forEach(t=>{["add","merge","update"].forEach(e=>{const n=t.name(e),i=e==="add"?kH:Tce;t.generateKey?or.prototype[n]=function(r,s,a){return i(this,n,!0,(t.type||this.type)==="undirected",null,r,s,a,e==="update")}:or.prototype[n]=function(r,s,a,o){return i(this,n,!1,(t.type||this.type)==="undirected",r,s,a,o,e==="update")}})});Lue(or);Xue(or);lce(or);gce(or);class FH extends or{constructor(e){const n=Ds({type:"directed"},e);if("multi"in n&&n.multi!==!1)throw new mn("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="directed")throw new mn('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class GH extends or{constructor(e){const n=Ds({type:"undirected"},e);if("multi"in n&&n.multi!==!1)throw new mn("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="undirected")throw new mn('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class VH extends or{constructor(e){const n=Ds({multi:!0},e);if("multi"in n&&n.multi!==!0)throw new mn("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(n)}}class HH extends or{constructor(e){const n=Ds({type:"directed",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new mn("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="directed")throw new mn('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class jH extends or{constructor(e){const n=Ds({type:"undirected",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new mn("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="undirected")throw new mn('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}function Ev(t){t.from=function(e,n){const i=Ds({},e.options,n),r=new t(i);return r.import(e),r}}Ev(or);Ev(FH);Ev(GH);Ev(VH);Ev(HH);Ev(jH);or.Graph=or;or.DirectedGraph=FH;or.UndirectedGraph=GH;or.MultiGraph=VH;or.MultiDirectedGraph=HH;or.MultiUndirectedGraph=jH;or.InvalidArgumentsGraphError=mn;or.NotFoundGraphError=tn;or.UsageGraphError=Bn;const Nz=({actives:t=[],selections:e=[],collapsedNodeIds:n=[],theme:i})=>yle(r=>{var s,a,o;return{theme:{...i,edge:{...i==null?void 0:i.edge,label:{...(s=i==null?void 0:i.edge)==null?void 0:s.label,fontSize:((o=(a=i==null?void 0:i.edge)==null?void 0:a.label)==null?void 0:o.fontSize)??6}}},edges:[],nodes:[],collapsedNodeIds:n,clusters:new Map,panning:!1,draggingIds:[],actives:t,edgeContextMenus:new Set,edgeMeshes:[],selections:e,hoveredNodeId:null,drags:{},graph:new or({multi:!0}),setTheme:l=>r(u=>({...u,theme:l})),setClusters:l=>r(u=>({...u,clusters:l})),setEdgeContextMenus:l=>r(u=>({...u,edgeContextMenus:l})),setEdgeMeshes:l=>r(u=>({...u,edgeMeshes:l})),setPanning:l=>r(u=>({...u,panning:l})),setDrags:l=>r(u=>({...u,drags:l})),addDraggingId:l=>r(u=>({...u,draggingIds:[...u.draggingIds,l]})),removeDraggingId:l=>r(u=>({...u,draggingIds:u.draggingIds.filter(c=>c!==l)})),setActives:l=>r(u=>({...u,actives:l})),setSelections:l=>r(u=>({...u,selections:l})),setHoveredNodeId:l=>r(u=>({...u,hoveredNodeId:l})),setNodes:l=>r(u=>({...u,nodes:l,centerPosition:r_(l)})),setEdges:l=>r(u=>({...u,edges:l})),setNodePosition:(l,u)=>r(c=>{var y,g;const h=c.nodes.find(x=>x.id===l),d=i_(h),v=new re(u.x,u.y,u.z).sub(d),_=[...c.nodes];if((y=c.selections)!=null&&y.includes(l))(g=c.selections)==null||g.forEach(x=>{const S=c.nodes.find(E=>E.id===x);if(S){const E=c.nodes.indexOf(S);_[E]=SN(S,v)}});else{const x=c.nodes.indexOf(h);_[x]=SN(h,v)}return{...c,drags:{...c.drags,[l]:h},nodes:_}}),setCollapsedNodeIds:(l=[])=>r(u=>({...u,collapsedNodeIds:l})),setClusterPosition:(l,u)=>r(c=>{const h=new Map(c.clusters),d=h.get(l);if(d){const m=d.position,v=new re(u.x-m.x,u.y-m.y,u.z-(m.z??0)),_=[...c.nodes],y={...c.drags};_.forEach((S,E)=>{S.cluster===l&&(_[E]={...S,position:{...S.position,x:S.position.x+v.x,y:S.position.y+v.y,z:S.position.z+(v.z??0)}},y[S.id]=S)});const g=_.filter(S=>S.cluster===l),x=r_(g);return h.set(l,{...d,position:x}),{...c,drags:{...y,[l]:d},clusters:h,nodes:_}}return c})}}),WH=Nz({}),XH=mz?null:V.createContext(WH),YH=({children:t,store:e=WH})=>mz?t:iu.createElement(XH.Provider,{value:e},t),sn=t=>{const e=V.useContext(XH);return aH(e,ble(t))};function ZH({nodeId:t,nodes:e,edges:n,currentHiddenNodes:i,currentHiddenEdges:r}){const s=[],a=[],o=i.map(m=>m.id),l=r.map(m=>m.id),u=n.filter(m=>m.source===t),c=u.map(m=>m.target);a.push(...u);for(const m of c){const v=n.filter(y=>y.target===m&&y.source!==t);let _=!1;if((v.length===0||v.length>0&&!o.includes(m)&&v.map(g=>g.id).every(g=>l.includes(g)))&&(_=!0),_){const y=e.find(x=>x.id===m);y&&s.push(y);const g=ZH({nodeId:m,nodes:e,edges:n,currentHiddenEdges:a,currentHiddenNodes:s});a.push(...g.hiddenEdges),s.push(...g.hiddenNodes)}}const h=Object.values(a.reduce((m,v)=>({...m,[v.id]:v}),{})),d=Object.values(s.reduce((m,v)=>({...m,[v.id]:v}),{}));return{hiddenEdges:h,hiddenNodes:d}}const Mce=({collapsedIds:t,nodes:e,edges:n})=>{const i=[],r=[];for(const u of t){const{hiddenEdges:c,hiddenNodes:h}=ZH({nodeId:u,nodes:e,edges:n,currentHiddenEdges:r,currentHiddenNodes:i});i.push(...h),r.push(...c)}const s=i.map(u=>u.id),a=r.map(u=>u.id),o=e.filter(u=>!s.includes(u.id)),l=n.filter(u=>!a.includes(u.id));return{visibleNodes:o,visibleEdges:l}},Cce=({layoutType:t,sizingType:e,labelType:n,sizingAttribute:i,clusterAttribute:r,selections:s,nodes:a,edges:o,actives:l,collapsedNodeIds:u,defaultNodeSize:c,maxNodeSize:h,minNodeSize:d,layoutOverrides:m,constrainDragging:v})=>{const _=sn(H=>H.graph),y=sn(H=>H.clusters),g=sn(H=>H.nodes),x=sn(H=>H.setClusters),S=sn(H=>H.collapsedNodeIds),E=sn(H=>H.setEdges),A=sn(H=>H.nodes),T=sn(H=>H.setNodes),C=sn(H=>H.setSelections),O=sn(H=>H.setActives),M=sn(H=>H.drags),D=sn(H=>H.setDrags),P=sn(H=>H.setCollapsedNodeIds),F=V.useRef(!1),G=V.useRef(null),z=xs(H=>H.camera),Y=V.useRef(M),N=V.useRef([]);V.useEffect(()=>{var ne;if(!r)return;const H=g.map(q=>q.id),$=a.find(q=>!H.includes(q.id));if($){const q=$.data[r],se=y.get(q),ve={...Y.current};(ne=se==null?void 0:se.nodes)==null||ne.forEach(pe=>ve[pe.id]=void 0),Y.current=ve,D(ve)}},[g,a,r,y,D]);const{visibleEdges:k,visibleNodes:j}=V.useMemo(()=>Mce({collapsedIds:S,nodes:a,edges:o}),[S,a,o]),X=V.useCallback(H=>{const $={...Y.current};H.forEach(ne=>$[ne.id]=ne),Y.current=$,D($)},[D]),Q=V.useCallback(async H=>{G.current=H||pz({...m,type:t,graph:_,drags:Y.current,clusters:N==null?void 0:N.current,clusterAttribute:r}),await Tse(G.current);const $=gle({graph:_,layout:G.current,sizingType:e,labelType:n,sizingAttribute:i,maxNodeSize:h,minNodeSize:d,defaultNodeSize:c,clusterAttribute:r}),ne=Ale({nodes:$.nodes,clusterAttribute:r});v&&ne.forEach(q=>{var ve,pe;const se=N.current.get(q.label);(se==null?void 0:se.nodes.length)===q.nodes.length&&(q.position=((pe=(ve=N.current)==null?void 0:ve.get(q.label))==null?void 0:pe.position)??q.position)}),E($.edges),T($.nodes),x(ne),r&&X($.nodes)},[m,t,r,e,n,i,h,d,c,E,T,x]);return V.useEffect(()=>{Y.current=M},[M,r,Q]),V.useEffect(()=>{N.current=y},[y]),V.useEffect(()=>{const H=A.map(ne=>({...ne,labelVisible:XV({nodeCount:A==null?void 0:A.length,labelType:n,camera:z,nodePosition:ne==null?void 0:ne.position})("node",ne==null?void 0:ne.size)}));H.some((ne,q)=>ne.labelVisible!==A[q].labelVisible)&&T(H)},[z,z.zoom,z.position.z,T,A,n]),V.useEffect(()=>{F.current&&C(s)},[s,C]),V.useEffect(()=>{F.current&&O(l)},[l,O]),V.useEffect(()=>{async function H(){F.current=!1,mle(_,j,k),await Q(),requestAnimationFrame(()=>F.current=!0)}H()},[j,k]),V.useEffect(()=>{F.current&&P(u)},[u,P]),V.useEffect(()=>{F.current&&(Y.current={},D({}),Q())},[t,Q,D]),V.useEffect(()=>{F.current&&Q(G.current)},[e,i,n,Q]),{updateLayout:Q}};var Bz=tb(),$n=t=>eb(t,Bz),kz=tb();$n.write=t=>eb(t,kz);var kT=tb();$n.onStart=t=>eb(t,kT);var Fz=tb();$n.onFrame=t=>eb(t,Fz);var Gz=tb();$n.onFinish=t=>eb(t,Gz);var w0=[];$n.setTimeout=(t,e)=>{const n=$n.now()+e,i=()=>{const s=w0.findIndex(a=>a.cancel==i);~s&&w0.splice(s,1),Yh-=~s?1:0},r={time:n,handler:t,cancel:i};return w0.splice(qH(n),0,r),Yh+=1,KH(),r};var qH=t=>~(~w0.findIndex(e=>e.time>t)||~w0.length);$n.cancel=t=>{kT.delete(t),Fz.delete(t),Gz.delete(t),Bz.delete(t),kz.delete(t)};$n.sync=t=>{wD=!0,$n.batchedUpdates(t),wD=!1};$n.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function i(...r){e=r,$n.onStart(n)}return i.handler=t,i.cancel=()=>{kT.delete(n),e=null},i};var Vz=typeof window<"u"?window.requestAnimationFrame:()=>{};$n.use=t=>Vz=t;$n.now=typeof performance<"u"?()=>performance.now():Date.now;$n.batchedUpdates=t=>t();$n.catch=console.error;$n.frameLoop="always";$n.advance=()=>{$n.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):JH()};var Xh=-1,Yh=0,wD=!1;function eb(t,e){wD?(e.delete(t),t(0)):(e.add(t),KH())}function KH(){Xh<0&&(Xh=0,$n.frameLoop!=="demand"&&Vz(QH))}function Rce(){Xh=-1}function QH(){~Xh&&(Vz(QH),$n.batchedUpdates(JH))}function JH(){const t=Xh;Xh=$n.now();const e=qH(Xh);if(e&&($H(w0.splice(0,e),n=>n.handler()),Yh-=e),!Yh){Rce();return}kT.flush(),Bz.flush(t?Math.min(64,Xh-t):16.667),Fz.flush(),kz.flush(),Gz.flush()}function tb(){let t=new Set,e=t;return{add(n){Yh+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return Yh-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,Yh-=e.size,$H(e,i=>i(n)&&t.add(i)),Yh+=t.size,e=t)}}}function $H(t,e){t.forEach(n=>{try{e(n)}catch(i){$n.catch(i)}})}var Dce=Object.defineProperty,Oce=(t,e)=>{for(var n in e)Dce(t,n,{get:e[n],enumerable:!0})},au={};Oce(au,{assign:()=>zce,colors:()=>nd,createStringInterpolator:()=>jz,skipAnimation:()=>t9,to:()=>e9,willAdvance:()=>Wz});function AD(){}var Uce=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),rn={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function Jc(t,e){if(rn.arr(t)){if(!rn.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}var Xi=(t,e)=>t.forEach(e);function Rf(t,e,n){if(rn.arr(t)){for(let i=0;i<t.length;i++)e.call(n,t[i],`${i}`);return}for(const i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i)}var fl=t=>rn.und(t)?[]:rn.arr(t)?t:[t];function f1(t,e){if(t.size){const n=Array.from(t);t.clear(),Xi(n,e)}}var Lx=(t,...e)=>f1(t,n=>n(...e)),Hz=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),jz,e9,nd=null,t9=!1,Wz=AD,zce=t=>{t.to&&(e9=t.to),t.now&&($n.now=t.now),t.colors!==void 0&&(nd=t.colors),t.skipAnimation!=null&&(t9=t.skipAnimation),t.createStringInterpolator&&(jz=t.createStringInterpolator),t.requestAnimationFrame&&$n.use(t.requestAnimationFrame),t.batchedUpdates&&($n.batchedUpdates=t.batchedUpdates),t.willAdvance&&(Wz=t.willAdvance),t.frameLoop&&($n.frameLoop=t.frameLoop)},h1=new Set,ol=[],S3=[],oA=0,FT={get idle(){return!h1.size&&!ol.length},start(t){oA>t.priority?(h1.add(t),$n.onStart(Ice)):(n9(t),$n(TD))},advance:TD,sort(t){if(oA)$n.onFrame(()=>FT.sort(t));else{const e=ol.indexOf(t);~e&&(ol.splice(e,1),i9(t))}},clear(){ol=[],h1.clear()}};function Ice(){h1.forEach(n9),h1.clear(),$n(TD)}function n9(t){ol.includes(t)||i9(t)}function i9(t){ol.splice(Lce(ol,e=>e.priority>t.priority),0,t)}function TD(t){const e=S3;for(let n=0;n<ol.length;n++){const i=ol[n];oA=i.priority,i.idle||(Wz(i),i.advance(t),i.idle||e.push(i))}return oA=0,S3=ol,S3.length=0,ol=e,ol.length>0}function Lce(t,e){const n=t.findIndex(e);return n<0?t.length:n}var Pce={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},nu="[-+]?\\d*\\.?\\d+",lA=nu+"%";function GT(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var Nce=new RegExp("rgb"+GT(nu,nu,nu)),Bce=new RegExp("rgba"+GT(nu,nu,nu,nu)),kce=new RegExp("hsl"+GT(nu,lA,lA)),Fce=new RegExp("hsla"+GT(nu,lA,lA,nu)),Gce=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Vce=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Hce=/^#([0-9a-fA-F]{6})$/,jce=/^#([0-9a-fA-F]{8})$/;function Wce(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=Hce.exec(t))?parseInt(e[1]+"ff",16)>>>0:nd&&nd[t]!==void 0?nd[t]:(e=Nce.exec(t))?(Pg(e[1])<<24|Pg(e[2])<<16|Pg(e[3])<<8|255)>>>0:(e=Bce.exec(t))?(Pg(e[1])<<24|Pg(e[2])<<16|Pg(e[3])<<8|DN(e[4]))>>>0:(e=Gce.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=jce.exec(t))?parseInt(e[1],16)>>>0:(e=Vce.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=kce.exec(t))?(CN(RN(e[1]),C2(e[2]),C2(e[3]))|255)>>>0:(e=Fce.exec(t))?(CN(RN(e[1]),C2(e[2]),C2(e[3]))|DN(e[4]))>>>0:null}function E3(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function CN(t,e,n){const i=n<.5?n*(1+e):n+e-n*e,r=2*n-i,s=E3(r,i,t+1/3),a=E3(r,i,t),o=E3(r,i,t-1/3);return Math.round(s*255)<<24|Math.round(a*255)<<16|Math.round(o*255)<<8}function Pg(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function RN(t){return(parseFloat(t)%360+360)%360/360}function DN(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function C2(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function ON(t){let e=Wce(t);if(e===null)return t;e=e||0;const n=(e&4278190080)>>>24,i=(e&16711680)>>>16,r=(e&65280)>>>8,s=(e&255)/255;return`rgba(${n}, ${i}, ${r}, ${s})`}var s_=(t,e,n)=>{if(rn.fun(t))return t;if(rn.arr(t))return s_({range:t,output:e,extrapolate:n});if(rn.str(t.output[0]))return jz(t);const i=t,r=i.output,s=i.range||[0,1],a=i.extrapolateLeft||i.extrapolate||"extend",o=i.extrapolateRight||i.extrapolate||"extend",l=i.easing||(u=>u);return u=>{const c=Yce(u,s);return Xce(u,s[c],s[c+1],r[c],r[c+1],l,a,o,i.map)}};function Xce(t,e,n,i,r,s,a,o,l){let u=l?l(t):t;if(u<e){if(a==="identity")return u;a==="clamp"&&(u=e)}if(u>n){if(o==="identity")return u;o==="clamp"&&(u=n)}return i===r?i:e===n?t<=e?i:r:(e===-1/0?u=-u:n===1/0?u=u-e:u=(u-e)/(n-e),u=s(u),i===-1/0?u=-u:r===1/0?u=u+i:u=u*(r-i)+i,u)}function Yce(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}var Zce={linear:t=>t},a_=Symbol.for("FluidValue.get"),$0=Symbol.for("FluidValue.observers"),ju=t=>!!(t&&t[a_]),$o=t=>t&&t[a_]?t[a_]():t,UN=t=>t[$0]||null;function qce(t,e){t.eventObserved?t.eventObserved(e):t(e)}function uA(t,e){const n=t[$0];n&&n.forEach(i=>{qce(i,e)})}var Kce=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");Qce(this,t)}},Qce=(t,e)=>r9(t,a_,e);function nb(t,e){if(t[a_]){let n=t[$0];n||r9(t,$0,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function cA(t,e){const n=t[$0];if(n&&n.has(e)){const i=n.size-1;i?n.delete(e):t[$0]=null,t.observerRemoved&&t.observerRemoved(i,e)}}var r9=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),yE=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Jce=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,zN=new RegExp(`(${yE.source})(%|[a-z]+)`,"i"),$ce=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,VT=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,s9=t=>{const[e,n]=efe(t);if(!e||Hz())return t;const i=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(i)return i.trim();if(n&&n.startsWith("--")){const r=window.getComputedStyle(document.documentElement).getPropertyValue(n);return r||t}else{if(n&&VT.test(n))return s9(n);if(n)return n}return t},efe=t=>{const e=VT.exec(t);if(!e)return[,];const[,n,i]=e;return[n,i]},w3,tfe=(t,e,n,i,r)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(i)}, ${r})`,a9=t=>{w3||(w3=nd?new RegExp(`(${Object.keys(nd).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(s=>$o(s).replace(VT,s9).replace(Jce,ON).replace(w3,ON)),n=e.map(s=>s.match(yE).map(Number)),r=n[0].map((s,a)=>n.map(o=>{if(!(a in o))throw Error('The arity of each "output" value must be equal');return o[a]})).map(s=>s_({...t,output:s}));return s=>{var l;const a=!zN.test(e[0])&&((l=e.find(u=>zN.test(u)))==null?void 0:l.replace(yE,""));let o=0;return e[0].replace(yE,()=>`${r[o++](s)}${a||""}`).replace($ce,tfe)}},Xz="react-spring: ",o9=t=>{const e=t;let n=!1;if(typeof e!="function")throw new TypeError(`${Xz}once requires a function parameter`);return(...i)=>{n||(e(...i),n=!0)}},nfe=o9(console.warn);function ife(){nfe(`${Xz}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var rfe=o9(console.warn);function sfe(){rfe(`${Xz}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function HT(t){return rn.str(t)&&(t[0]=="#"||/\d/.test(t)||!Hz()&&VT.test(t)||t in(nd||{}))}var Yz=Hz()?V.useEffect:V.useLayoutEffect,afe=()=>{const t=V.useRef(!1);return Yz(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function l9(){const t=V.useState()[1],e=afe();return()=>{e.current&&t(Math.random())}}var u9=t=>V.useEffect(t,ofe),ofe=[];function IN(t){const e=V.useRef(void 0);return V.useEffect(()=>{e.current=t}),e.current}var o_=Symbol.for("Animated:node"),lfe=t=>!!t&&t[o_]===t,Hu=t=>t&&t[o_],Zz=(t,e)=>Uce(t,o_,e),jT=t=>t&&t[o_]&&t[o_].getPayload(),c9=class{constructor(){Zz(this,this)}getPayload(){return this.payload||[]}},WT=class f9 extends c9{constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,rn.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new f9(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,n){return rn.num(e)&&(this.lastPosition=e,n&&(e=Math.round(e/n)*n,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,rn.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},fA=class h9 extends WT{constructor(e){super(0),this._string=null,this._toString=s_({output:[e,e]})}static create(e){return new h9(e)}getValue(){const e=this._string;return e??(this._string=this._toString(this._value))}setValue(e){if(rn.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=s_({output:[this.getValue(),e]})),this._value=0,super.reset()}},hA={dependencies:null},qz=class extends c9{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return Rf(this.source,(n,i)=>{lfe(n)?e[i]=n.getValue(t):ju(n)?e[i]=$o(n):t||(e[i]=n)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&Xi(this.payload,t=>t.reset())}_makePayload(t){if(t){const e=new Set;return Rf(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){hA.dependencies&&ju(t)&&hA.dependencies.add(t);const e=jT(t);e&&Xi(e,n=>this.add(n))}},ufe=class d9 extends qz{constructor(e){super(e)}static create(e){return new d9(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const n=this.getPayload();return e.length==n.length?n.map((i,r)=>i.setValue(e[r])).some(Boolean):(super.setValue(e.map(cfe)),!0)}};function cfe(t){return(HT(t)?fA:WT).create(t)}function MD(t){const e=Hu(t);return e?e.constructor:rn.arr(t)?ufe:HT(t)?fA:WT}var LN=(t,e)=>{const n=!rn.fun(t)||t.prototype&&t.prototype.isReactComponent;return V.forwardRef((i,r)=>{const s=V.useRef(null),a=n&&V.useCallback(v=>{s.current=dfe(r,v)},[r]),[o,l]=hfe(i,e),u=l9(),c=()=>{const v=s.current;if(n&&!v)return;(v?e.applyAnimatedValues(v,o.getValue(!0)):!1)===!1&&u()},h=new ffe(c,l),d=V.useRef(void 0);Yz(()=>(d.current=h,Xi(l,v=>nb(v,h)),()=>{d.current&&(Xi(d.current.deps,v=>cA(v,d.current)),$n.cancel(d.current.update))})),V.useEffect(c,[]),u9(()=>()=>{const v=d.current;Xi(v.deps,_=>cA(_,v))});const m=e.getComponentProps(o.getValue());return V.createElement(t,{...m,ref:a})})},ffe=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){t.type=="change"&&$n.write(this.update)}};function hfe(t,e){const n=new Set;return hA.dependencies=n,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new qz(t),hA.dependencies=null,[t,n]}function dfe(t,e){return t&&(rn.fun(t)?t(e):t.current=e),e}var PN=Symbol.for("AnimatedComponent"),pfe=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=r=>new qz(r),getComponentProps:i=r=>r}={})=>{const r={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:i},s=a=>{const o=NN(a)||"Anonymous";return rn.str(a)?a=s[a]||(s[a]=LN(a,r)):a=a[PN]||(a[PN]=LN(a,r)),a.displayName=`Animated(${o})`,a};return Rf(t,(a,o)=>{rn.arr(t)&&(o=NN(a)),s[o]=s(a)}),{animated:s}},NN=t=>rn.str(t)?t:t&&rn.str(t.displayName)?t.displayName:rn.fun(t)&&t.name||null;function wp(t,...e){return rn.fun(t)?t(...e):t}var d1=(t,e)=>t===!0||!!(e&&t&&(rn.fun(t)?t(e):fl(t).includes(e))),p9=(t,e)=>rn.obj(t)?e&&t[e]:t,m9=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,mfe=t=>t,Kz=(t,e=mfe)=>{let n=gfe;t.default&&t.default!==!0&&(t=t.default,n=Object.keys(t));const i={};for(const r of n){const s=e(t[r],r);rn.und(s)||(i[r]=s)}return i},gfe=["config","onProps","onStart","onChange","onPause","onResume","onRest"],vfe={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function yfe(t){const e={};let n=0;if(Rf(t,(i,r)=>{vfe[r]||(e[r]=i,n++)}),n)return e}function g9(t){const e=yfe(t);if(e){const n={to:e};return Rf(t,(i,r)=>r in e||(n[r]=i)),n}return{...t}}function l_(t){return t=$o(t),rn.arr(t)?t.map(l_):HT(t)?au.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function xfe(t){for(const e in t)return!0;return!1}function CD(t){return rn.fun(t)||rn.arr(t)&&rn.obj(t[0])}function _fe(t,e){var n;(n=t.ref)==null||n.delete(t),e==null||e.delete(t)}function bfe(t,e){var n;e&&t.ref!==e&&((n=t.ref)==null||n.delete(t),e.add(t),t.ref=e)}var Sfe={default:{tension:170,friction:26}},RD={...Sfe.default,mass:1,damping:1,easing:Zce.linear,clamp:!1},Efe=class{constructor(){this.velocity=0,Object.assign(this,RD)}};function wfe(t,e,n){n&&(n={...n},BN(n,e),e={...n,...e}),BN(t,e),Object.assign(t,e);for(const a in RD)t[a]==null&&(t[a]=RD[a]);let{frequency:i,damping:r}=t;const{mass:s}=t;return rn.und(i)||(i<.01&&(i=.01),r<0&&(r=0),t.tension=Math.pow(2*Math.PI/i,2)*s,t.friction=4*Math.PI*r*s/i),t}function BN(t,e){if(!rn.und(e.decay))t.duration=void 0;else{const n=!rn.und(e.tension)||!rn.und(e.friction);(n||!rn.und(e.frequency)||!rn.und(e.damping)||!rn.und(e.mass))&&(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}}var kN=[],Afe=class{constructor(){this.changed=!1,this.values=kN,this.toValues=null,this.fromValues=kN,this.config=new Efe,this.immediate=!1}};function v9(t,{key:e,props:n,defaultProps:i,state:r,actions:s}){return new Promise((a,o)=>{let l,u,c=d1(n.cancel??(i==null?void 0:i.cancel),e);if(c)m();else{rn.und(n.pause)||(r.paused=d1(n.pause,e));let v=i==null?void 0:i.pause;v!==!0&&(v=r.paused||d1(v,e)),l=wp(n.delay||0,e),v?(r.resumeQueue.add(d),s.pause()):(s.resume(),d())}function h(){r.resumeQueue.add(d),r.timeouts.delete(u),u.cancel(),l=u.time-$n.now()}function d(){l>0&&!au.skipAnimation?(r.delayed=!0,u=$n.setTimeout(m,l),r.pauseQueue.add(h),r.timeouts.add(u)):m()}function m(){r.delayed&&(r.delayed=!1),r.pauseQueue.delete(h),r.timeouts.delete(u),t<=(r.cancelId||0)&&(c=!0);try{s.start({...n,callId:t,cancel:c},a)}catch(v){o(v)}}})}var Qz=(t,e)=>e.length==1?e[0]:e.some(n=>n.cancelled)?A0(t.get()):e.every(n=>n.noop)?y9(t.get()):Ql(t.get(),e.every(n=>n.finished)),y9=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),Ql=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),A0=t=>({value:t,cancelled:!0,finished:!1});function x9(t,e,n,i){const{callId:r,parentId:s,onRest:a}=e,{asyncTo:o,promise:l}=n;return!s&&t===o&&!e.reset?l:n.promise=(async()=>{n.asyncId=r,n.asyncTo=t;const u=Kz(e,(y,g)=>g==="onRest"?void 0:y);let c,h;const d=new Promise((y,g)=>(c=y,h=g)),m=y=>{const g=r<=(n.cancelId||0)&&A0(i)||r!==n.asyncId&&Ql(i,!1);if(g)throw y.result=g,h(y),y},v=(y,g)=>{const x=new FN,S=new GN;return(async()=>{if(au.skipAnimation)throw u_(n),S.result=Ql(i,!1),h(S),S;m(x);const E=rn.obj(y)?{...y}:{...g,to:y};E.parentId=r,Rf(u,(T,C)=>{rn.und(E[C])&&(E[C]=T)});const A=await i.start(E);return m(x),n.paused&&await new Promise(T=>{n.resumeQueue.add(T)}),A})()};let _;if(au.skipAnimation)return u_(n),Ql(i,!1);try{let y;rn.arr(t)?y=(async g=>{for(const x of g)await v(x)})(t):y=Promise.resolve(t(v,i.stop.bind(i))),await Promise.all([y.then(c),d]),_=Ql(i.get(),!0,!1)}catch(y){if(y instanceof FN)_=y.result;else if(y instanceof GN)_=y.result;else throw y}finally{r==n.asyncId&&(n.asyncId=s,n.asyncTo=s?o:void 0,n.promise=s?l:void 0)}return rn.fun(a)&&$n.batchedUpdates(()=>{a(_,i,i.item)}),_})()}function u_(t,e){f1(t.timeouts,n=>n.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}var FN=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},GN=class extends Error{constructor(){super("SkipAnimationSignal")}},DD=t=>t instanceof Jz,Tfe=1,Jz=class extends Kce{constructor(){super(...arguments),this.id=Tfe++,this._priority=0}get priority(){return this._priority}set priority(t){this._priority!=t&&(this._priority=t,this._onPriorityChange(t))}get(){const t=Hu(this);return t&&t.getValue()}to(...t){return au.to(this,t)}interpolate(...t){return ife(),au.to(this,t)}toJSON(){return this.get()}observerAdded(t){t==1&&this._attach()}observerRemoved(t){t==0&&this._detach()}_attach(){}_detach(){}_onChange(t,e=!1){uA(this,{type:"change",parent:this,value:t,idle:e})}_onPriorityChange(t){this.idle||FT.sort(this),uA(this,{type:"priority",parent:this,priority:t})}},rm=Symbol.for("SpringPhase"),_9=1,b9=2,S9=4,A3=t=>(t[rm]&_9)>0,Rh=t=>(t[rm]&b9)>0,ux=t=>(t[rm]&S9)>0,VN=(t,e)=>e?t[rm]|=b9|_9:t[rm]&=-3,HN=(t,e)=>e?t[rm]|=S9:t[rm]&=-5,Mfe=class extends Jz{constructor(t,e){if(super(),this.animation=new Afe,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!rn.und(t)||!rn.und(e)){const n=rn.obj(t)?{...t}:{...e,from:t};rn.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(Rh(this)||this._state.asyncTo)||ux(this)}get goal(){return $o(this.animation.to)}get velocity(){const t=Hu(this);return t instanceof WT?t.lastVelocity||0:t.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return A3(this)}get isAnimating(){return Rh(this)}get isPaused(){return ux(this)}get isDelayed(){return this._state.delayed}advance(t){let e=!0,n=!1;const i=this.animation;let{toValues:r}=i;const{config:s}=i,a=jT(i.to);!a&&ju(i.to)&&(r=fl($o(i.to))),i.values.forEach((u,c)=>{if(u.done)return;const h=u.constructor==fA?1:a?a[c].lastPosition:r[c];let d=i.immediate,m=h;if(!d){if(m=u.lastPosition,s.tension<=0){u.done=!0;return}let v=u.elapsedTime+=t;const _=i.fromValues[c],y=u.v0!=null?u.v0:u.v0=rn.arr(s.velocity)?s.velocity[c]:s.velocity;let g;const x=s.precision||(_==h?.005:Math.min(1,Math.abs(h-_)*.001));if(rn.und(s.duration))if(s.decay){const S=s.decay===!0?.998:s.decay,E=Math.exp(-(1-S)*v);m=_+y/(1-S)*(1-E),d=Math.abs(u.lastPosition-m)<=x,g=y*E}else{g=u.lastVelocity==null?y:u.lastVelocity;const S=s.restVelocity||x/10,E=s.clamp?0:s.bounce,A=!rn.und(E),T=_==h?u.v0>0:_<h;let C,O=!1;const M=1,D=Math.ceil(t/M);for(let P=0;P<D&&(C=Math.abs(g)>S,!(!C&&(d=Math.abs(h-m)<=x,d)));++P){A&&(O=m==h||m>h==T,O&&(g=-g*E,m=h));const F=-s.tension*1e-6*(m-h),G=-s.friction*.001*g,z=(F+G)/s.mass;g=g+z*M,m=m+g*M}}else{let S=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,u.durationProgress>0&&(u.elapsedTime=s.duration*u.durationProgress,v=u.elapsedTime+=t)),S=(s.progress||0)+v/this._memoizedDuration,S=S>1?1:S<0?0:S,u.durationProgress=S),m=_+s.easing(S)*(h-_),g=(m-u.lastPosition)/t,d=S==1}u.lastVelocity=g,Number.isNaN(m)&&(console.warn("Got NaN while animating:",this),d=!0)}a&&!a[c].done&&(d=!1),d?u.done=!0:e=!1,u.setValue(m,s.round)&&(n=!0)});const o=Hu(this),l=o.getValue();if(e){const u=$o(i.to);(l!==u||n)&&!s.decay?(o.setValue(u),this._onChange(u)):n&&s.decay&&this._onChange(l),this._stop()}else n&&this._onChange(l)}set(t){return $n.batchedUpdates(()=>{this._stop(),this._focus(t),this._set(t)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Rh(this)){const{to:t,config:e}=this.animation;$n.batchedUpdates(()=>{this._onStart(),e.decay||this._set(t,!1),this._stop()})}return this}update(t){return(this.queue||(this.queue=[])).push(t),this}start(t,e){let n;return rn.und(t)?(n=this.queue||[],this.queue=[]):n=[rn.obj(t)?t:{...e,to:t}],Promise.all(n.map(i=>this._update(i))).then(i=>Qz(this,i))}stop(t){const{to:e}=this.animation;return this._focus(this.get()),u_(this._state,t&&this._lastCallId),$n.batchedUpdates(()=>this._stop(e,t)),this}reset(){this._update({reset:!0})}eventObserved(t){t.type=="change"?this._start():t.type=="priority"&&(this.priority=t.priority+1)}_prepareNode(t){const e=this.key||"";let{to:n,from:i}=t;n=rn.obj(n)?n[e]:n,(n==null||CD(n))&&(n=void 0),i=rn.obj(i)?i[e]:i,i==null&&(i=void 0);const r={to:n,from:i};return A3(this)||(t.reverse&&([n,i]=[i,n]),i=$o(i),rn.und(i)?Hu(this)||this._set(n):this._set(i)),r}_update({...t},e){const{key:n,defaultProps:i}=this;t.default&&Object.assign(i,Kz(t,(a,o)=>/^on/.test(o)?p9(a,n):a)),WN(this,t,"onProps"),fx(this,"onProps",t,this);const r=this._prepareNode(t);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return v9(++this._lastCallId,{key:n,props:t,defaultProps:i,state:s,actions:{pause:()=>{ux(this)||(HN(this,!0),Lx(s.pauseQueue),fx(this,"onPause",Ql(this,cx(this,this.animation.to)),this))},resume:()=>{ux(this)&&(HN(this,!1),Rh(this)&&this._resume(),Lx(s.resumeQueue),fx(this,"onResume",Ql(this,cx(this,this.animation.to)),this))},start:this._merge.bind(this,r)}}).then(a=>{if(t.loop&&a.finished&&!(e&&a.noop)){const o=E9(t);if(o)return this._update(o,!0)}return a})}_merge(t,e,n){if(e.cancel)return this.stop(!0),n(A0(this));const i=!rn.und(t.to),r=!rn.und(t.from);if(i||r)if(e.callId>this._lastToId)this._lastToId=e.callId;else return n(A0(this));const{key:s,defaultProps:a,animation:o}=this,{to:l,from:u}=o;let{to:c=l,from:h=u}=t;r&&!i&&(!e.default||rn.und(c))&&(c=h),e.reverse&&([c,h]=[h,c]);const d=!Jc(h,u);d&&(o.from=h),h=$o(h);const m=!Jc(c,l);m&&this._focus(c);const v=CD(e.to),{config:_}=o,{decay:y,velocity:g}=_;(i||r)&&(_.velocity=0),e.config&&!v&&wfe(_,wp(e.config,s),e.config!==a.config?wp(a.config,s):void 0);let x=Hu(this);if(!x||rn.und(c))return n(Ql(this,!0));const S=rn.und(e.reset)?r&&!e.default:!rn.und(h)&&d1(e.reset,s),E=S?h:this.get(),A=l_(c),T=rn.num(A)||rn.arr(A)||HT(A),C=!v&&(!T||d1(a.immediate||e.immediate,s));if(m){const P=MD(c);if(P!==x.constructor)if(C)x=this._set(A);else throw Error(`Cannot animate between ${x.constructor.name} and ${P.name}, as the "to" prop suggests`)}const O=x.constructor;let M=ju(c),D=!1;if(!M){const P=S||!A3(this)&&d;(m||P)&&(D=Jc(l_(E),A),M=!D),(!Jc(o.immediate,C)&&!C||!Jc(_.decay,y)||!Jc(_.velocity,g))&&(M=!0)}if(D&&Rh(this)&&(o.changed&&!S?M=!0:M||this._stop(l)),!v&&((M||ju(l))&&(o.values=x.getPayload(),o.toValues=ju(c)?null:O==fA?[1]:fl(A)),o.immediate!=C&&(o.immediate=C,!C&&!S&&this._set(l)),M)){const{onRest:P}=o;Xi(Rfe,G=>WN(this,e,G));const F=Ql(this,cx(this,l));Lx(this._pendingCalls,F),this._pendingCalls.add(n),o.changed&&$n.batchedUpdates(()=>{var G;o.changed=!S,P==null||P(F,this),S?wp(a.onRest,F):(G=o.onStart)==null||G.call(o,F,this)})}S&&this._set(E),v?n(x9(e.to,e,this._state,this)):M?this._start():Rh(this)&&!m?this._pendingCalls.add(n):n(y9(E))}_focus(t){const e=this.animation;t!==e.to&&(UN(this)&&this._detach(),e.to=t,UN(this)&&this._attach())}_attach(){let t=0;const{to:e}=this.animation;ju(e)&&(nb(e,this),DD(e)&&(t=e.priority+1)),this.priority=t}_detach(){const{to:t}=this.animation;ju(t)&&cA(t,this)}_set(t,e=!0){const n=$o(t);if(!rn.und(n)){const i=Hu(this);if(!i||!Jc(n,i.getValue())){const r=MD(n);!i||i.constructor!=r?Zz(this,r.create(n)):i.setValue(n),i&&$n.batchedUpdates(()=>{this._onChange(n,e)})}}return Hu(this)}_onStart(){const t=this.animation;t.changed||(t.changed=!0,fx(this,"onStart",Ql(this,cx(this,t.to)),this))}_onChange(t,e){e||(this._onStart(),wp(this.animation.onChange,t,this)),wp(this.defaultProps.onChange,t,this),super._onChange(t,e)}_start(){const t=this.animation;Hu(this).reset($o(t.to)),t.immediate||(t.fromValues=t.values.map(e=>e.lastPosition)),Rh(this)||(VN(this,!0),ux(this)||this._resume())}_resume(){au.skipAnimation?this.finish():FT.start(this)}_stop(t,e){if(Rh(this)){VN(this,!1);const n=this.animation;Xi(n.values,r=>{r.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),uA(this,{type:"idle",parent:this});const i=e?A0(this.get()):Ql(this.get(),cx(this,t??n.to));Lx(this._pendingCalls,i),n.changed&&(n.changed=!1,fx(this,"onRest",i,this))}}};function cx(t,e){const n=l_(e),i=l_(t.get());return Jc(i,n)}function E9(t,e=t.loop,n=t.to){const i=wp(e);if(i){const r=i!==!0&&g9(i),s=(r||t).reverse,a=!r||r.reset;return c_({...t,loop:e,default:!1,pause:void 0,to:!s||CD(n)?n:void 0,from:a?t.from:void 0,reset:a,...r})}}function c_(t){const{to:e,from:n}=t=g9(t),i=new Set;return rn.obj(e)&&jN(e,i),rn.obj(n)&&jN(n,i),t.keys=i.size?Array.from(i):null,t}function Cfe(t){const e=c_(t);return rn.und(e.default)&&(e.default=Kz(e)),e}function jN(t,e){Rf(t,(n,i)=>n!=null&&e.add(i))}var Rfe=["onStart","onRest","onChange","onPause","onResume"];function WN(t,e,n){t.animation[n]=e[n]!==m9(e,n)?p9(e[n],t.key):void 0}function fx(t,e,...n){var i,r,s,a;(r=(i=t.animation)[e])==null||r.call(i,...n),(a=(s=t.defaultProps)[e])==null||a.call(s,...n)}var Dfe=["onStart","onChange","onRest"],Ofe=1,Ufe=class{constructor(e,n){this.id=Ofe++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),n&&(this._flush=n),e&&this.start({default:!0,...e})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each((n,i)=>e[i]=n.get()),e}set(e){for(const n in e){const i=e[n];rn.und(i)||this.springs[n].set(i)}}update(e){return e&&this.queue.push(c_(e)),this}start(e){let{queue:n}=this;return e?n=fl(e).map(c_):this.queue=[],this._flush?this._flush(this,n):(C9(this,n),OD(this,n))}stop(e,n){if(e!==!!e&&(n=e),n){const i=this.springs;Xi(fl(n),r=>i[r].stop(!!e))}else u_(this._state,this._lastAsyncId),this.each(i=>i.stop(!!e));return this}pause(e){if(rn.und(e))this.start({pause:!0});else{const n=this.springs;Xi(fl(e),i=>n[i].pause())}return this}resume(e){if(rn.und(e))this.start({pause:!1});else{const n=this.springs;Xi(fl(e),i=>n[i].resume())}return this}each(e){Rf(this.springs,e)}_onFrame(){const{onStart:e,onChange:n,onRest:i}=this._events,r=this._active.size>0,s=this._changed.size>0;(r&&!this._started||s&&!this._started)&&(this._started=!0,f1(e,([l,u])=>{u.value=this.get(),l(u,this,this._item)}));const a=!r&&this._started,o=s||a&&i.size?this.get():null;s&&n.size&&f1(n,([l,u])=>{u.value=o,l(u,this,this._item)}),a&&(this._started=!1,f1(i,([l,u])=>{u.value=o,l(u,this,this._item)}))}eventObserved(e){if(e.type=="change")this._changed.add(e.parent),e.idle||this._active.add(e.parent);else if(e.type=="idle")this._active.delete(e.parent);else return;$n.onFrame(this._onFrame)}};function OD(t,e){return Promise.all(e.map(n=>w9(t,n))).then(n=>Qz(t,n))}async function w9(t,e,n){const{keys:i,to:r,from:s,loop:a,onRest:o,onResolve:l}=e,u=rn.obj(e.default)&&e.default;a&&(e.loop=!1),r===!1&&(e.to=null),s===!1&&(e.from=null);const c=rn.arr(r)||rn.fun(r)?r:void 0;c?(e.to=void 0,e.onRest=void 0,u&&(u.onRest=void 0)):Xi(Dfe,_=>{const y=e[_];if(rn.fun(y)){const g=t._events[_];e[_]=({finished:x,cancelled:S})=>{const E=g.get(y);E?(x||(E.finished=!1),S&&(E.cancelled=!0)):g.set(y,{value:null,finished:x||!1,cancelled:S||!1})},u&&(u[_]=e[_])}});const h=t._state;e.pause===!h.paused?(h.paused=e.pause,Lx(e.pause?h.pauseQueue:h.resumeQueue)):h.paused&&(e.pause=!0);const d=(i||Object.keys(t.springs)).map(_=>t.springs[_].start(e)),m=e.cancel===!0||m9(e,"cancel")===!0;(c||m&&h.asyncId)&&d.push(v9(++t._lastAsyncId,{props:e,state:h,actions:{pause:AD,resume:AD,start(_,y){m?(u_(h,t._lastAsyncId),y(A0(t))):(_.onRest=o,y(x9(c,_,h,t)))}}})),h.paused&&await new Promise(_=>{h.resumeQueue.add(_)});const v=Qz(t,await Promise.all(d));if(a&&v.finished&&!(n&&v.noop)){const _=E9(e,a,r);if(_)return C9(t,[_]),w9(t,_,!0)}return l&&$n.batchedUpdates(()=>l(v,t,t.item)),v}function XN(t,e){const n={...t.springs};return e&&Xi(fl(e),i=>{rn.und(i.keys)&&(i=c_(i)),rn.obj(i.to)||(i={...i,to:void 0}),M9(n,i,r=>T9(r))}),A9(t,n),n}function A9(t,e){Rf(e,(n,i)=>{t.springs[i]||(t.springs[i]=n,nb(n,t))})}function T9(t,e){const n=new Mfe;return n.key=t,e&&nb(n,e),n}function M9(t,e,n){e.keys&&Xi(e.keys,i=>{(t[i]||(t[i]=n(i)))._prepareNode(e)})}function C9(t,e){Xi(e,n=>{M9(t.springs,n,i=>T9(i,t))})}var zfe=V.createContext({pause:!1,immediate:!1}),Ife=()=>{const t=[],e=function(i){sfe();const r=[];return Xi(t,(s,a)=>{if(rn.und(i))r.push(s.start());else{const o=n(i,s,a);o&&r.push(s.start(o))}}),r};e.current=t,e.add=function(i){t.includes(i)||t.push(i)},e.delete=function(i){const r=t.indexOf(i);~r&&t.splice(r,1)},e.pause=function(){return Xi(t,i=>i.pause(...arguments)),this},e.resume=function(){return Xi(t,i=>i.resume(...arguments)),this},e.set=function(i){Xi(t,(r,s)=>{const a=rn.fun(i)?i(s,r):i;a&&r.set(a)})},e.start=function(i){const r=[];return Xi(t,(s,a)=>{if(rn.und(i))r.push(s.start());else{const o=this._getProps(i,s,a);o&&r.push(s.start(o))}}),r},e.stop=function(){return Xi(t,i=>i.stop(...arguments)),this},e.update=function(i){return Xi(t,(r,s)=>r.update(this._getProps(i,r,s))),this};const n=function(i,r,s){return rn.fun(i)?i(s,r):i};return e._getProps=n,e};function Lfe(t,e,n){const i=rn.fun(e)&&e;i&&!n&&(n=[]);const r=V.useMemo(()=>i||arguments.length==3?Ife():void 0,[]),s=V.useRef(0),a=l9(),o=V.useMemo(()=>({ctrls:[],queue:[],flush(g,x){const S=XN(g,x);return s.current>0&&!o.queue.length&&!Object.keys(S).some(A=>!g.springs[A])?OD(g,x):new Promise(A=>{A9(g,S),o.queue.push(()=>{A(OD(g,x))}),a()})}}),[]),l=V.useRef([...o.ctrls]),u=V.useRef([]),c=IN(t)||0;V.useMemo(()=>{Xi(l.current.slice(t,c),g=>{_fe(g,r),g.stop(!0)}),l.current.length=t,h(c,t)},[t]),V.useMemo(()=>{h(0,Math.min(c,t))},n);function h(g,x){for(let S=g;S<x;S++){const E=l.current[S]||(l.current[S]=new Ufe(null,o.flush)),A=i?i(S,E):e[S];A&&(u.current[S]=Cfe(A))}}const d=l.current.map((g,x)=>XN(g,u.current[x])),m=V.useContext(zfe),v=IN(m),_=m!==v&&xfe(m);Yz(()=>{s.current++,o.ctrls=l.current;const{queue:g}=o;g.length&&(o.queue=[],Xi(g,x=>x())),Xi(l.current,(x,S)=>{r==null||r.add(x),_&&x.start({default:m});const E=u.current[S];E&&(bfe(x,E.ref),x.ref?x.queue.push(E):x.start(E))})}),u9(()=>()=>{Xi(o.ctrls,g=>g.stop(!0))});const y=d.map(g=>({...g}));return r?[y,r]:y}function zo(t,e){const n=rn.fun(t),[[i],r]=Lfe(1,n?t:[t],n?e||[]:e);return n||arguments.length==2?[i,r]:i}var Pfe=class extends Jz{constructor(t,e){super(),this.source=t,this.idle=!0,this._active=new Set,this.calc=s_(...e);const n=this._get(),i=MD(n);Zz(this,i.create(n))}advance(t){const e=this._get(),n=this.get();Jc(e,n)||(Hu(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&YN(this._active)&&T3(this)}_get(){const t=rn.arr(this.source)?this.source.map($o):fl($o(this.source));return this.calc(...t)}_start(){this.idle&&!YN(this._active)&&(this.idle=!1,Xi(jT(this),t=>{t.done=!1}),au.skipAnimation?($n.batchedUpdates(()=>this.advance()),T3(this)):FT.start(this))}_attach(){let t=1;Xi(fl(this.source),e=>{ju(e)&&nb(e,this),DD(e)&&(e.idle||this._active.add(e),t=Math.max(t,e.priority+1))}),this.priority=t,this._start()}_detach(){Xi(fl(this.source),t=>{ju(t)&&cA(t,this)}),this._active.clear(),T3(this)}eventObserved(t){t.type=="change"?t.idle?this.advance():(this._active.add(t.parent),this._start()):t.type=="idle"?this._active.delete(t.parent):t.type=="priority"&&(this.priority=fl(this.source).reduce((e,n)=>Math.max(e,(DD(n)?n.priority:0)+1),0))}};function Nfe(t){return t.idle!==!1}function YN(t){return!t.size||Array.from(t).every(Nfe)}function T3(t){t.idle||(t.idle=!0,Xi(jT(t),e=>{e.done=!0}),uA(t,{type:"idle",parent:t}))}au.assign({createStringInterpolator:a9,to:(t,e)=>new Pfe(t,e)});var Bfe=["primitive"].concat(Object.keys(H8).filter(t=>/^[A-Z]/.test(t)).map(t=>t[0].toLowerCase()+t.slice(1)));au.assign({createStringInterpolator:a9,colors:Pce,frameLoop:"demand"});nre(()=>{$n.advance()});var kfe=pfe(Bfe,{applyAnimatedValues:sf}),ns=kfe.animated;function f_(){return f_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},f_.apply(null,arguments)}const ib=new re,$z=new re,Ffe=new re,ZN=new Tt;function Gfe(t,e,n){const i=ib.setFromMatrixPosition(t.matrixWorld);i.project(e);const r=n.width/2,s=n.height/2;return[i.x*r+r,-(i.y*s)+s]}function Vfe(t,e){const n=ib.setFromMatrixPosition(t.matrixWorld),i=$z.setFromMatrixPosition(e.matrixWorld),r=n.sub(i),s=e.getWorldDirection(Ffe);return r.angleTo(s)>Math.PI/2}function Hfe(t,e,n,i){const r=ib.setFromMatrixPosition(t.matrixWorld),s=r.clone();s.project(e),ZN.set(s.x,s.y),n.setFromCamera(ZN,e);const a=n.intersectObjects(i,!0);if(a.length){const o=a[0].distance;return r.distanceTo(n.ray.origin)<o}return!0}function jfe(t,e){if(e instanceof pm)return e.zoom;if(e instanceof ys){const n=ib.setFromMatrixPosition(t.matrixWorld),i=$z.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=n.distanceTo(i);return 1/(2*Math.tan(r/2)*s)}else return 1}function Wfe(t,e,n){if(e instanceof ys||e instanceof pm){const i=ib.setFromMatrixPosition(t.matrixWorld),r=$z.setFromMatrixPosition(e.matrixWorld),s=i.distanceTo(r),a=(n[1]-n[0])/(e.far-e.near),o=n[1]-a*e.far;return Math.round(a*s+o)}}const UD=t=>Math.abs(t)<1e-10?0:t;function R9(t,e,n=""){let i="matrix3d(";for(let r=0;r!==16;r++)i+=UD(e[r]*t.elements[r])+(r!==15?",":")");return n+i}const Xfe=(t=>e=>R9(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Yfe=(t=>(e,n)=>R9(e,t(n),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function Zfe(t){return t&&typeof t=="object"&&"current"in t}const eI=V.forwardRef(({children:t,eps:e=.001,style:n,className:i,prepend:r,center:s,fullscreen:a,portal:o,distanceFactor:l,sprite:u=!1,transform:c=!1,occlude:h,onOcclude:d,castShadow:m,receiveShadow:v,material:_,geometry:y,zIndexRange:g=[16777271,0],calculatePosition:x=Gfe,as:S="div",wrapperClass:E,pointerEvents:A="auto",...T},C)=>{const{gl:O,camera:M,scene:D,size:P,raycaster:F,events:G,viewport:z}=xs(),[Y]=V.useState(()=>document.createElement(S)),N=V.useRef(null),k=V.useRef(null),j=V.useRef(0),X=V.useRef([0,0]),Q=V.useRef(null),H=V.useRef(null),$=(o==null?void 0:o.current)||G.connected||O.domElement.parentNode,ne=V.useRef(null),q=V.useRef(!1),se=V.useMemo(()=>h&&h!=="blending"||Array.isArray(h)&&h.length&&Zfe(h[0]),[h]);V.useLayoutEffect(()=>{const st=O.domElement;h&&h==="blending"?(st.style.zIndex=`${Math.floor(g[0]/2)}`,st.style.position="absolute",st.style.pointerEvents="none"):(st.style.zIndex=null,st.style.position=null,st.style.pointerEvents=null)},[h]),V.useLayoutEffect(()=>{if(k.current){const st=N.current=M6.createRoot(Y);if(D.updateMatrixWorld(),c)Y.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const et=x(k.current,M,P);Y.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${et[0]}px,${et[1]}px,0);transform-origin:0 0;`}return $&&(r?$.prepend(Y):$.appendChild(Y)),()=>{$&&$.removeChild(Y),st.unmount()}}},[$,c]),V.useLayoutEffect(()=>{E&&(Y.className=E)},[E]);const ve=V.useMemo(()=>c?{position:"absolute",top:0,left:0,width:P.width,height:P.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...a&&{top:-P.height/2,left:-P.width/2,width:P.width,height:P.height},...n},[n,s,a,P,c]),pe=V.useMemo(()=>({position:"absolute",pointerEvents:A}),[A]);V.useLayoutEffect(()=>{if(q.current=!1,c){var st;(st=N.current)==null||st.render(V.createElement("div",{ref:Q,style:ve},V.createElement("div",{ref:H,style:pe},V.createElement("div",{ref:C,className:i,style:n,children:t}))))}else{var et;(et=N.current)==null||et.render(V.createElement("div",{ref:C,style:ve,className:i,children:t}))}});const xe=V.useRef(!0);DT(st=>{if(k.current){M.updateMatrixWorld(),k.current.updateWorldMatrix(!0,!1);const et=c?X.current:x(k.current,M,P);if(c||Math.abs(j.current-M.zoom)>e||Math.abs(X.current[0]-et[0])>e||Math.abs(X.current[1]-et[1])>e){const Te=Vfe(k.current,M);let Xe=!1;se&&(Array.isArray(h)?Xe=h.map(Ve=>Ve.current):h!=="blending"&&(Xe=[D]));const K=xe.current;if(Xe){const Ve=Hfe(k.current,M,F,Xe);xe.current=Ve&&!Te}else xe.current=!Te;K!==xe.current&&(d?d(!xe.current):Y.style.display=xe.current?"block":"none");const Pe=Math.floor(g[0]/2),Ne=h?se?[g[0],Pe]:[Pe-1,0]:g;if(Y.style.zIndex=`${Wfe(k.current,M,Ne)}`,c){const[Ve,_e]=[P.width/2,P.height/2],ft=M.projectionMatrix.elements[5]*_e,{isOrthographicCamera:ke,top:Z,left:W,bottom:I,right:De}=M,ge=Xfe(M.matrixWorldInverse),ze=ke?`scale(${ft})translate(${UD(-(De+W)/2)}px,${UD((Z+I)/2)}px)`:`translateZ(${ft}px)`;let ct=k.current.matrixWorld;u&&(ct=M.matrixWorldInverse.clone().transpose().copyPosition(ct).scale(k.current.scale),ct.elements[3]=ct.elements[7]=ct.elements[11]=0,ct.elements[15]=1),Y.style.width=P.width+"px",Y.style.height=P.height+"px",Y.style.perspective=ke?"":`${ft}px`,Q.current&&H.current&&(Q.current.style.transform=`${ze}${ge}translate(${Ve}px,${_e}px)`,H.current.style.transform=Yfe(ct,1/((l||10)/400)))}else{const Ve=l===void 0?1:jfe(k.current,M)*l;Y.style.transform=`translate3d(${et[0]}px,${et[1]}px,0) scale(${Ve})`}X.current=et,j.current=M.zoom}}if(!se&&ne.current&&!q.current)if(c){if(Q.current){const et=Q.current.children[0];if(et!=null&&et.clientWidth&&et!=null&&et.clientHeight){const{isOrthographicCamera:Te}=M;if(Te||y)T.scale&&(Array.isArray(T.scale)?T.scale instanceof re?ne.current.scale.copy(T.scale.clone().divideScalar(1)):ne.current.scale.set(1/T.scale[0],1/T.scale[1],1/T.scale[2]):ne.current.scale.setScalar(1/T.scale));else{const Xe=(l||10)/400,K=et.clientWidth*Xe,Pe=et.clientHeight*Xe;ne.current.scale.set(K,Pe,1)}q.current=!0}}}else{const et=Y.children[0];if(et!=null&&et.clientWidth&&et!=null&&et.clientHeight){const Te=1/z.factor,Xe=et.clientWidth*Te,K=et.clientHeight*Te;ne.current.scale.set(Xe,K,1),q.current=!0}ne.current.lookAt(st.camera.position)}});const ot=V.useMemo(()=>({vertexShader:c?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[c]);return V.createElement("group",f_({},T,{ref:k}),h&&!se&&V.createElement("mesh",{castShadow:m,receiveShadow:v,ref:ne},y||V.createElement("planeGeometry",null),_||V.createElement("shaderMaterial",{side:es,vertexShader:ot.vertexShader,fragmentShader:ot.fragmentShader})))});function Gp(t,e="pointer",n="auto",i=document.body){V.useEffect(()=>{if(t)return i.style.cursor=e,()=>void(i.style.cursor=n)},[t])}function qfe(t,e,n){return Math.max(e,Math.min(t,n))}const _r={toVector(t,e){return t===void 0&&(t=e),Array.isArray(t)?t:[t,t]},add(t,e){return[t[0]+e[0],t[1]+e[1]]},sub(t,e){return[t[0]-e[0],t[1]-e[1]]},addTo(t,e){t[0]+=e[0],t[1]+=e[1]},subTo(t,e){t[0]-=e[0],t[1]-=e[1]}};function qN(t,e,n){return e===0||Math.abs(e)===1/0?Math.pow(t,n*5):t*e*n/(e+n*t)}function KN(t,e,n,i=.15){return i===0?qfe(t,e,n):t<e?-qN(e-t,n-e,i)+e:t>n?+qN(t-n,n-e,i)+n:t}function Kfe(t,[e,n],[i,r]){const[[s,a],[o,l]]=t;return[KN(e,s,a,i),KN(n,o,l,r)]}function Qfe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jfe(t){var e=Qfe(t,"string");return typeof e=="symbol"?e:String(e)}function ms(t,e,n){return e=Jfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function kr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?QN(Object(n),!0).forEach(function(i){ms(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QN(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}const D9={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function JN(t){return t?t[0].toUpperCase()+t.slice(1):""}const $fe=["enter","leave"];function ehe(t=!1,e){return t&&!$fe.includes(e)}function the(t,e="",n=!1){const i=D9[t],r=i&&i[e]||e;return"on"+JN(t)+JN(r)+(ehe(n,r)?"Capture":"")}const nhe=["gotpointercapture","lostpointercapture"];function ihe(t){let e=t.substring(2).toLowerCase();const n=!!~e.indexOf("passive");n&&(e=e.replace("passive",""));const i=nhe.includes(e)?"capturecapture":"capture",r=!!~e.indexOf(i);return r&&(e=e.replace("capture","")),{device:e,capture:r,passive:n}}function rhe(t,e=""){const n=D9[t],i=n&&n[e]||e;return t+i}function XT(t){return"touches"in t}function O9(t){return XT(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function she(t){return Array.from(t.touches).filter(e=>{var n,i;return e.target===t.currentTarget||((n=t.currentTarget)===null||n===void 0||(i=n.contains)===null||i===void 0?void 0:i.call(n,e.target))})}function ahe(t){return t.type==="touchend"||t.type==="touchcancel"?t.changedTouches:t.targetTouches}function U9(t){return XT(t)?ahe(t)[0]:t}function zD(t,e){try{const n=e.clientX-t.clientX,i=e.clientY-t.clientY,r=(e.clientX+t.clientX)/2,s=(e.clientY+t.clientY)/2,a=Math.hypot(n,i);return{angle:-(Math.atan2(n,i)*180)/Math.PI,distance:a,origin:[r,s]}}catch{}return null}function ohe(t){return she(t).map(e=>e.identifier)}function $N(t,e){const[n,i]=Array.from(t.touches).filter(r=>e.includes(r.identifier));return zD(n,i)}function M3(t){const e=U9(t);return XT(t)?e.identifier:e.pointerId}function ev(t){const e=U9(t);return[e.clientX,e.clientY]}const e5=40,t5=800;function z9(t){let{deltaX:e,deltaY:n,deltaMode:i}=t;return i===1?(e*=e5,n*=e5):i===2&&(e*=t5,n*=t5),[e,n]}function lhe(t){var e,n;const{scrollX:i,scrollY:r,scrollLeft:s,scrollTop:a}=t.currentTarget;return[(e=i??s)!==null&&e!==void 0?e:0,(n=r??a)!==null&&n!==void 0?n:0]}function uhe(t){const e={};if("buttons"in t&&(e.buttons=t.buttons),"shiftKey"in t){const{shiftKey:n,altKey:i,metaKey:r,ctrlKey:s}=t;Object.assign(e,{shiftKey:n,altKey:i,metaKey:r,ctrlKey:s})}return e}function dA(t,...e){return typeof t=="function"?t(...e):t}function che(){}function fhe(...t){return t.length===0?che:t.length===1?t[0]:function(){let e;for(const n of t)e=n.apply(this,arguments)||e;return e}}function n5(t,e){return Object.assign({},e,t||{})}const hhe=32;class I9{constructor(e,n,i){this.ctrl=e,this.args=n,this.key=i,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:n,ingKey:i,args:r}=this;n[i]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const n=this.state,i=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=e.target,n.currentTarget=e.currentTarget,n.lastOffset=i.from?dA(i.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=e.timeStamp)}computeValues(e){const n=this.state;n._values=e,n.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:n,config:i,shared:r}=this;n.args=this.args;let s=0;if(e&&(n.event=e,i.preventDefault&&e.cancelable&&n.event.preventDefault(),n.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,uhe(e)),r.down=r.pressed=r.buttons%2===1||r.touches>0,s=e.timeStamp-n.timeStamp,n.timeStamp=e.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const T=n._delta.map(Math.abs);_r.addTo(n._distance,T)}this.axisIntent&&this.axisIntent(e);const[a,o]=n._movement,[l,u]=i.threshold,{_step:c,values:h}=n;if(i.hasCustomTransform?(c[0]===!1&&(c[0]=Math.abs(a)>=l&&h[0]),c[1]===!1&&(c[1]=Math.abs(o)>=u&&h[1])):(c[0]===!1&&(c[0]=Math.abs(a)>=l&&Math.sign(a)*l),c[1]===!1&&(c[1]=Math.abs(o)>=u&&Math.sign(o)*u)),n.intentional=c[0]!==!1||c[1]!==!1,!n.intentional)return;const d=[0,0];if(i.hasCustomTransform){const[T,C]=h;d[0]=c[0]!==!1?T-c[0]:0,d[1]=c[1]!==!1?C-c[1]:0}else d[0]=c[0]!==!1?a-c[0]:0,d[1]=c[1]!==!1?o-c[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(d);const m=n.offset,v=n._active&&!n._blocked||n.active;v&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=r[this.ingKey]=n._active,e&&(n.first&&("bounds"in i&&(n._bounds=dA(i.bounds,n)),this.setup&&this.setup()),n.movement=d,this.computeOffset()));const[_,y]=n.offset,[[g,x],[S,E]]=n._bounds;n.overflow=[_<g?-1:_>x?1:0,y<S?-1:y>E?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const A=n._active?i.rubberband||[0,0]:[0,0];if(n.offset=Kfe(n._bounds,n.offset,A),n.delta=_r.sub(n.offset,m),this.computeMovement(),v&&(!n.last||s>hhe)){n.delta=_r.sub(n.offset,m);const T=n.delta.map(Math.abs);_r.addTo(n.distance,T),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&s>0&&(n.velocity=[T[0]/s,T[1]/s],n.timeDelta=s)}}emit(){const e=this.state,n=this.shared,i=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!i.triggerAllEvents)return;const r=this.handler(kr(kr(kr({},n),e),{},{[this.aliasKey]:e.values}));r!==void 0&&(e.memo=r)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function dhe([t,e],n){const i=Math.abs(t),r=Math.abs(e);if(i>r&&i>n)return"x";if(r>i&&r>n)return"y"}class rb extends I9{constructor(...e){super(...e),ms(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=_r.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=_r.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const n=this.state,i=this.config;if(!n.axis&&e){const r=typeof i.axisThreshold=="object"?i.axisThreshold[O9(e)]:i.axisThreshold;n.axis=dhe(n._movement,r)}n._blocked=(i.lockDirection||!!i.axis)&&!n.axis||!!i.axis&&i.axis!==n.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const phe=t=>t,i5=.15,L9={enabled(t=!0){return t},eventOptions(t,e,n){return kr(kr({},n.shared.eventOptions),t)},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[i5,i5];case!1:return[0,0];default:return _r.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return _r.toVector(t)},transform(t,e,n){const i=t||n.shared.transform;return this.hasCustomTransform=!!i,i||phe},threshold(t){return _r.toVector(t,0)}},mhe=0,vm=kr(kr({},L9),{},{axis(t,e,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(t=mhe){return t},bounds(t={}){if(typeof t=="function")return s=>vm.bounds(t(s));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:e=-1/0,right:n=1/0,top:i=-1/0,bottom:r=1/0}=t;return[[e,n],[i,r]]}}),r5={ArrowRight:(t,e=1)=>[t*e,0],ArrowLeft:(t,e=1)=>[-1*t*e,0],ArrowUp:(t,e=1)=>[0,-1*t*e],ArrowDown:(t,e=1)=>[0,t*e]};class ghe extends rb{constructor(...e){super(...e),ms(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const n=e._bounds.getBoundingClientRect(),i=e.currentTarget.getBoundingClientRect(),r={left:n.left-i.left+e.offset[0],right:n.right-i.right+e.offset[0],top:n.top-i.top+e.offset[1],bottom:n.bottom-i.bottom+e.offset[1]};e._bounds=vm.bounds(r)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const n=this.config,i=this.state;if(e.buttons!=null&&(Array.isArray(n.pointerButtons)?!n.pointerButtons.includes(e.buttons):n.pointerButtons!==-1&&n.pointerButtons!==e.buttons))return;const r=this.ctrl.setEventIds(e);n.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(r&&r.size>1&&i._pointerActive)&&(this.start(e),this.setupPointer(e),i._pointerId=M3(e),i._pointerActive=!0,this.computeValues(ev(e)),this.computeInitial(),n.preventScrollAxis&&O9(e)!=="mouse"?(i._active=!1,this.setupScrollPrevention(e)):n.delay>0?(this.setupDelayTrigger(e),n.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const n=this.state;n._active=!0,n._preventScroll=!0,n._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const n=this.state,i=this.config;if(!n._pointerActive)return;const r=M3(e);if(n._pointerId!==void 0&&r!==n._pointerId)return;const s=ev(e);if(document.pointerLockElement===e.target?n._delta=[e.movementX,e.movementY]:(n._delta=_r.sub(s,n._values),this.computeValues(s)),_r.addTo(n._movement,n._delta),this.compute(e),n._delayed&&n.intentional){this.timeoutStore.remove("dragDelay"),n.active=!1,this.startPointerDrag(e);return}if(i.preventScrollAxis&&!n._preventScroll)if(n.axis)if(n.axis===i.preventScrollAxis||i.preventScrollAxis==="xy"){n._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const n=this.state,i=this.config;if(!n._active||!n._pointerActive)return;const r=M3(e);if(n._pointerId!==void 0&&r!==n._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[s,a]=n._distance;if(n.tap=s<=i.tapsThreshold&&a<=i.tapsThreshold,n.tap&&i.filterTaps)n._force=!0;else{const[o,l]=n._delta,[u,c]=n._movement,[h,d]=i.swipe.velocity,[m,v]=i.swipe.distance,_=i.swipe.duration;if(n.elapsedTime<_){const y=Math.abs(o/n.timeDelta),g=Math.abs(l/n.timeDelta);y>h&&Math.abs(u)>m&&(n.swipe[0]=Math.sign(o)),g>d&&Math.abs(c)>v&&(n.swipe[1]=Math.sign(l))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const n=this.config,i=n.device;n.pointerLock&&e.currentTarget.requestPointerLock(),n.pointerCapture||(this.eventStore.add(this.sharedConfig.window,i,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,vhe(e);const n=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",n),this.eventStore.add(this.sharedConfig.window,"touch","cancel",n),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const n=r5[e.key];if(n){const i=this.state,r=e.shiftKey?10:e.altKey?.1:1;this.start(e),i._delta=n(this.config.keyboardDisplacement,r),i._keyboardActive=!0,_r.addTo(i._movement,i._delta),this.compute(e),this.emit()}}keyUp(e){e.key in r5&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const n=this.config.device;e(n,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(n,"change",this.pointerMove.bind(this)),e(n,"end",this.pointerUp.bind(this)),e(n,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function vhe(t){"persist"in t&&typeof t.persist=="function"&&t.persist()}const sb=typeof window<"u"&&window.document&&window.document.createElement;function P9(){return sb&&"ontouchstart"in window}function yhe(){return P9()||sb&&window.navigator.maxTouchPoints>1}function xhe(){return sb&&"onpointerdown"in window}function _he(){return sb&&"exitPointerLock"in window.document}function bhe(){try{return"constructor"in GestureEvent}catch{return!1}}const rl={isBrowser:sb,gesture:bhe(),touch:P9(),touchscreen:yhe(),pointer:xhe(),pointerLock:_he()},She=250,Ehe=180,whe=.5,Ahe=50,The=250,Mhe=10,s5={mouse:0,touch:0,pen:8},Che=kr(kr({},vm),{},{device(t,e,{pointer:{touch:n=!1,lock:i=!1,mouse:r=!1}={}}){return this.pointerLock=i&&rl.pointerLock,rl.touch&&n?"touch":this.pointerLock?"mouse":rl.pointer&&!r?"pointer":rl.touch?"touch":"mouse"},preventScrollAxis(t,e,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&t?She:void 0,!(!rl.touchscreen||n===!1))return t||(n!==void 0?"y":void 0)},pointerCapture(t,e,{pointer:{capture:n=!0,buttons:i=1,keys:r=!0}={}}){return this.pointerButtons=i,this.keys=r,!this.pointerLock&&this.device==="pointer"&&n},threshold(t,e,{filterTaps:n=!1,tapsThreshold:i=3,axis:r=void 0}){const s=_r.toVector(t,n?i:r?1:0);return this.filterTaps=n,this.tapsThreshold=i,s},swipe({velocity:t=whe,distance:e=Ahe,duration:n=The}={}){return{velocity:this.transform(_r.toVector(t)),distance:this.transform(_r.toVector(e)),duration:n}},delay(t=0){switch(t){case!0:return Ehe;case!1:return 0;default:return t}},axisThreshold(t){return t?kr(kr({},s5),t):s5},keyboardDisplacement(t=Mhe){return t}});function N9(t){const[e,n]=t.overflow,[i,r]=t._delta,[s,a]=t._direction;(e<0&&i>0&&s<0||e>0&&i<0&&s>0)&&(t._movement[0]=t._movementBound[0]),(n<0&&r>0&&a<0||n>0&&r<0&&a>0)&&(t._movement[1]=t._movementBound[1])}const Rhe=30,Dhe=100;class Ohe extends I9{constructor(...e){super(...e),ms(this,"ingKey","pinching"),ms(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){const{type:e,movement:n,lastOffset:i}=this.state;e==="wheel"?this.state.offset=_r.add(n,i):this.state.offset=[(1+n[0])*i[0],n[1]+i[1]]}computeMovement(){const{offset:e,lastOffset:n}=this.state;this.state.movement=[e[0]/n[0],e[1]-n[1]]}axisIntent(){const e=this.state,[n,i]=e._movement;if(!e.axis){const r=Math.abs(n)*Rhe-Math.abs(i);r<0?e.axis="angle":r>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&(this.state.axis==="scale"?e[1]=0:this.state.axis==="angle"&&(e[0]=0))}cancel(){const e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);const n=this.state,i=this.ctrl.touchIds;if(n._active&&n._touchIds.every(s=>i.has(s))||i.size<2)return;this.start(e),n._touchIds=Array.from(i).slice(0,2);const r=$N(e,n._touchIds);r&&this.pinchStart(e,r)}pointerStart(e){if(e.buttons!=null&&e.buttons%2!==1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);const n=this.state,i=n._pointerEvents,r=this.ctrl.pointerIds;if(n._active&&Array.from(i.keys()).every(a=>r.has(a))||(i.size<2&&i.set(e.pointerId,e),n._pointerEvents.size<2))return;this.start(e);const s=zD(...Array.from(i.values()));s&&this.pinchStart(e,s)}pinchStart(e,n){const i=this.state;i.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;const n=$N(e,this.state._touchIds);n&&this.pinchMove(e,n)}pointerMove(e){const n=this.state._pointerEvents;if(n.has(e.pointerId)&&n.set(e.pointerId,e),!this.state._active)return;const i=zD(...Array.from(n.values()));i&&this.pinchMove(e,i)}pinchMove(e,n){const i=this.state,r=i._values[1],s=n.angle-r;let a=0;Math.abs(s)>270&&(a+=Math.sign(s)),this.computeValues([n.distance,n.angle-360*a]),i.origin=n.origin,i.turns=a,i._movement=[i._values[0]/i._initial[0]-1,i._values[1]-i._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){const n=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch{}n._pointerEvents.has(e.pointerId)&&n._pointerEvents.delete(e.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();const n=this.state;n._active||(this.start(e),this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY];const i=n._movement;n._movement=[e.scale-1,e.rotation],n._delta=_r.sub(n._movement,i),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){const n=this.config.modifierKey;n&&(Array.isArray(n)?!n.find(i=>e[i]):!e[n])||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||e.cancelable&&e.preventDefault();const i=this.state;i._delta=[-z9(e)[1]/Dhe*i.offset[0],0],_r.addTo(i._movement,i._delta),N9(i),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){const n=this.config.device;n&&(e(n,"start",this[n+"Start"].bind(this)),e(n,"change",this[n+"Move"].bind(this)),e(n,"end",this[n+"End"].bind(this)),e(n,"cancel",this[n+"End"].bind(this)),e("lostPointerCapture","",this[n+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}const Uhe=kr(kr({},L9),{},{device(t,e,{shared:n,pointer:{touch:i=!1}={}}){if(n.target&&!rl.touch&&rl.gesture)return"gesture";if(rl.touch&&i)return"touch";if(rl.touchscreen){if(rl.pointer)return"pointer";if(rl.touch)return"touch"}},bounds(t,e,{scaleBounds:n={},angleBounds:i={}}){const r=a=>{const o=n5(dA(n,a),{min:-1/0,max:1/0});return[o.min,o.max]},s=a=>{const o=n5(dA(i,a),{min:-1/0,max:1/0});return[o.min,o.max]};return typeof n!="function"&&typeof i!="function"?[r(),s()]:a=>[r(a),s(a)]},threshold(t,e,n){return this.lockDirection=n.axis==="lock",_r.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey(t){return t===void 0?"ctrlKey":t},pinchOnWheel(t=!0){return t}});class zhe extends rb{constructor(...e){super(...e),ms(this,"ingKey","moving")}move(e){this.config.mouseOnly&&e.pointerType!=="mouse"||(this.state._active?this.moveChange(e):this.moveStart(e),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(e){this.start(e),this.computeValues(ev(e)),this.compute(e),this.computeInitial(),this.emit()}moveChange(e){if(!this.state._active)return;const n=ev(e),i=this.state;i._delta=_r.sub(n,i._values),_r.addTo(i._movement,i._delta),this.computeValues(n),this.compute(e),this.emit()}moveEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}bind(e){e("pointer","change",this.move.bind(this)),e("pointer","leave",this.moveEnd.bind(this))}}const Ihe=kr(kr({},vm),{},{mouseOnly:(t=!0)=>t});class Lhe extends rb{constructor(...e){super(...e),ms(this,"ingKey","scrolling")}scroll(e){this.state._active||this.start(e),this.scrollChange(e),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(e){e.cancelable&&e.preventDefault();const n=this.state,i=lhe(e);n._delta=_r.sub(i,n._values),_r.addTo(n._movement,n._delta),this.computeValues(i),this.compute(e),this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("scroll","",this.scroll.bind(this))}}const Phe=vm;class Nhe extends rb{constructor(...e){super(...e),ms(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){const n=this.state;n._delta=z9(e),_r.addTo(n._movement,n._delta),N9(n),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}}const Bhe=vm;class khe extends rb{constructor(...e){super(...e),ms(this,"ingKey","hovering")}enter(e){this.config.mouseOnly&&e.pointerType!=="mouse"||(this.start(e),this.computeValues(ev(e)),this.compute(e),this.emit())}leave(e){if(this.config.mouseOnly&&e.pointerType!=="mouse")return;const n=this.state;if(!n._active)return;n._active=!1;const i=ev(e);n._movement=n._delta=_r.sub(i,n._values),this.computeValues(i),this.compute(e),n.delta=n.movement,this.emit()}bind(e){e("pointer","enter",this.enter.bind(this)),e("pointer","leave",this.leave.bind(this))}}const Fhe=kr(kr({},vm),{},{mouseOnly:(t=!0)=>t}),tI=new Map,ID=new Map;function Ghe(t){tI.set(t.key,t.engine),ID.set(t.key,t.resolver)}const Vhe={key:"drag",engine:ghe,resolver:Che},Hhe={key:"hover",engine:khe,resolver:Fhe},jhe={key:"move",engine:zhe,resolver:Ihe},Whe={key:"pinch",engine:Ohe,resolver:Uhe},Xhe={key:"scroll",engine:Lhe,resolver:Phe},Yhe={key:"wheel",engine:Nhe,resolver:Bhe};function Zhe(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function qhe(t,e){if(t==null)return{};var n=Zhe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}const Khe={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=rl.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:e=!1}={}){return{passive:t,capture:e}},transform(t){return t}},Qhe=["target","eventOptions","window","enabled","transform"];function xE(t={},e){const n={};for(const[i,r]of Object.entries(e))switch(typeof r){case"function":n[i]=r.call(n,t[i],i,t);break;case"object":n[i]=xE(t[i],r);break;case"boolean":r&&(n[i]=t[i]);break}return n}function Jhe(t,e,n={}){const i=t,{target:r,eventOptions:s,window:a,enabled:o,transform:l}=i,u=qhe(i,Qhe);if(n.shared=xE({target:r,eventOptions:s,window:a,enabled:o,transform:l},Khe),e){const c=ID.get(e);n[e]=xE(kr({shared:n.shared},u),c)}else for(const c in u){const h=ID.get(c);h&&(n[c]=xE(kr({shared:n.shared},u[c]),h))}return n}class B9{constructor(e,n){ms(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=n}add(e,n,i,r,s){const a=this._listeners,o=rhe(n,i),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},u=kr(kr({},l),s);e.addEventListener(o,r,u);const c=()=>{e.removeEventListener(o,r,u),a.delete(c)};return a.add(c),c}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class $he{constructor(){ms(this,"_timeouts",new Map)}add(e,n,i=140,...r){this.remove(e),this._timeouts.set(e,window.setTimeout(n,i,...r))}remove(e){const n=this._timeouts.get(e);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class ede{constructor(e){ms(this,"gestures",new Set),ms(this,"_targetEventStore",new B9(this)),ms(this,"gestureEventStores",{}),ms(this,"gestureTimeoutStores",{}),ms(this,"handlers",{}),ms(this,"config",{}),ms(this,"pointerIds",new Set),ms(this,"touchIds",new Set),ms(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),tde(this,e)}setEventIds(e){if(XT(e))return this.touchIds=new Set(ohe(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,n){this.handlers=e,this.nativeHandlers=n}applyConfig(e,n){this.config=Jhe(e,n,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const n=this.config.shared,i={};let r;if(!(n.target&&(r=n.target(),!r))){if(n.enabled){for(const a of this.gestures){const o=this.config[a],l=a5(i,o.eventOptions,!!r);if(o.enabled){const u=tI.get(a);new u(this,e,a).bind(l)}}const s=a5(i,n.eventOptions,!!r);for(const a in this.nativeHandlers)s(a,"",o=>this.nativeHandlers[a](kr(kr({},this.state.shared),{},{event:o,args:e})),void 0,!0)}for(const s in i)i[s]=fhe(...i[s]);if(!r)return i;for(const s in i){const{device:a,capture:o,passive:l}=ihe(s);this._targetEventStore.add(r,a,"",i[s],{capture:o,passive:l})}}}}function Ng(t,e){t.gestures.add(e),t.gestureEventStores[e]=new B9(t,e),t.gestureTimeoutStores[e]=new $he}function tde(t,e){e.drag&&Ng(t,"drag"),e.wheel&&Ng(t,"wheel"),e.scroll&&Ng(t,"scroll"),e.move&&Ng(t,"move"),e.pinch&&Ng(t,"pinch"),e.hover&&Ng(t,"hover")}const a5=(t,e,n)=>(i,r,s,a={},o=!1)=>{var l,u;const c=(l=a.capture)!==null&&l!==void 0?l:e.capture,h=(u=a.passive)!==null&&u!==void 0?u:e.passive;let d=o?i:the(i,r,c);n&&h&&(d+="Passive"),t[d]=t[d]||[],t[d].push(s)},nde=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function ide(t){const e={},n={},i=new Set;for(let r in t)nde.test(r)?(i.add(RegExp.lastMatch),n[r]=t[r]):e[r]=t[r];return[n,e,i]}function Bg(t,e,n,i,r,s){if(!t.has(n)||!tI.has(i))return;const a=n+"Start",o=n+"End",l=u=>{let c;return u.first&&a in e&&e[a](u),n in e&&(c=e[n](u)),u.last&&o in e&&e[o](u),c};r[i]=l,s[i]=s[i]||{}}function rde(t,e){const[n,i,r]=ide(t),s={};return Bg(r,n,"onDrag","drag",s,e),Bg(r,n,"onWheel","wheel",s,e),Bg(r,n,"onScroll","scroll",s,e),Bg(r,n,"onPinch","pinch",s,e),Bg(r,n,"onMove","move",s,e),Bg(r,n,"onHover","hover",s,e),{handlers:s,config:e,nativeHandlers:i}}function sde(t,e={},n,i){const r=iu.useMemo(()=>new ede(t),[]);if(r.applyHandlers(t,i),r.applyConfig(e,n),iu.useEffect(r.effect.bind(r)),iu.useEffect(()=>r.clean.bind(r),[]),e.target===void 0)return r.bind.bind(r)}function ade(t){return t.forEach(Ghe),function(n,i){const{handlers:r,nativeHandlers:s,config:a}=rde(n,i||{});return sde(r,a,void 0,s)}}function ode(t,e){return ade([Vhe,Whe,Xhe,Yhe,jhe,Hhe])(t,e||{})}const R2=(t,e)=>{const n=t[0].index!==null,i=new Set(Object.keys(t[0].attributes)),r=new Set(Object.keys(t[0].morphAttributes)),s={},a={},o=t[0].morphTargetsRelative,l=new ni;let u=0;if(t.forEach((c,h)=>{let d=0;if(n!==(c.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let m in c.attributes){if(!i.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;s[m]===void 0&&(s[m]=[]),s[m].push(c.attributes[m]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(o!==c.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let m in c.morphAttributes){if(!r.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;a[m]===void 0&&(a[m]=[]),a[m].push(c.morphAttributes[m])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(c.userData),e){let m;if(c.index)m=c.index.count;else if(c.attributes.position!==void 0)m=c.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,m,h),u+=m}}),n){let c=0;const h=[];t.forEach(d=>{const m=d.index;for(let v=0;v<m.count;++v)h.push(m.getX(v)+c);c+=d.attributes.position.count}),l.setIndex(h)}for(let c in s){const h=o5(s[c]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" attribute."),null;l.setAttribute(c,h)}for(let c in a){const h=a[c][0].length;if(h===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let d=0;d<h;++d){const m=[];for(let _=0;_<a[c].length;++_)m.push(a[c][_][d]);const v=o5(m);if(!v)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" morphAttribute."),null;l.morphAttributes[c].push(v)}}return l},o5=t=>{let e,n,i,r=0;if(t.forEach(s=>{if(e===void 0&&(e=s.array.constructor),e!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(n===void 0&&(n=s.itemSize),n!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=s.normalized),i!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=s.array.length}),e&&n){const s=new e(r);let a=0;return t.forEach(o=>{s.set(o.array,a),a+=o.array.length}),new Yi(s,n,i)}},C3=new fm,R3=new re,kg=new re,Wl=new re,Zc=new re,Bu=new re,qc=new re,Kc=new re,hx=new re,dx=new re,px=new re,D2=new re,mx=new re,gx=new re,vx=new re;class l5{constructor(e,n,i){this.camera=e,this.scene=n,this.startPoint=new re,this.endPoint=new re,this.collection=[],this.deep=i||Number.MAX_VALUE}select(e,n){return this.startPoint=e||this.startPoint,this.endPoint=n||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(C3,this.scene),this.collection}updateFrustum(e,n){if(e=e||this.startPoint,n=n||this.endPoint,e.x===n.x&&(n.x+=Number.EPSILON),e.y===n.y&&(n.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){kg.copy(e),kg.x=Math.min(e.x,n.x),kg.y=Math.max(e.y,n.y),n.x=Math.max(e.x,n.x),n.y=Math.min(e.y,n.y),Wl.setFromMatrixPosition(this.camera.matrixWorld),Zc.copy(kg),Bu.set(n.x,kg.y,0),qc.copy(n),Kc.set(kg.x,n.y,0),Zc.unproject(this.camera),Bu.unproject(this.camera),qc.unproject(this.camera),Kc.unproject(this.camera),mx.copy(Zc).sub(Wl),gx.copy(Bu).sub(Wl),vx.copy(qc).sub(Wl),mx.normalize(),gx.normalize(),vx.normalize(),mx.multiplyScalar(this.deep),gx.multiplyScalar(this.deep),vx.multiplyScalar(this.deep),mx.add(Wl),gx.add(Wl),vx.add(Wl);var i=C3.planes;i[0].setFromCoplanarPoints(Wl,Zc,Bu),i[1].setFromCoplanarPoints(Wl,Bu,qc),i[2].setFromCoplanarPoints(qc,Kc,Wl),i[3].setFromCoplanarPoints(Kc,Zc,Wl),i[4].setFromCoplanarPoints(Bu,qc,Kc),i[5].setFromCoplanarPoints(vx,gx,mx),i[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){const r=Math.min(e.x,n.x),s=Math.max(e.y,n.y),a=Math.max(e.x,n.x),o=Math.min(e.y,n.y);Zc.set(r,s,-1),Bu.set(a,s,-1),qc.set(a,o,-1),Kc.set(r,o,-1),hx.set(r,s,1),dx.set(a,s,1),px.set(a,o,1),D2.set(r,o,1),Zc.unproject(this.camera),Bu.unproject(this.camera),qc.unproject(this.camera),Kc.unproject(this.camera),hx.unproject(this.camera),dx.unproject(this.camera),px.unproject(this.camera),D2.unproject(this.camera);var i=C3.planes;i[0].setFromCoplanarPoints(Zc,hx,dx),i[1].setFromCoplanarPoints(Bu,dx,px),i[2].setFromCoplanarPoints(px,D2,Kc),i[3].setFromCoplanarPoints(D2,hx,Zc),i[4].setFromCoplanarPoints(Bu,qc,Kc),i[5].setFromCoplanarPoints(px,dx,hx),i[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(e,n){if((n.isMesh||n.isLine||n.isPoints)&&n.material!==void 0&&(n.geometry.boundingSphere===null&&n.geometry.computeBoundingSphere(),R3.copy(n.geometry.boundingSphere.center),R3.applyMatrix4(n.matrixWorld),e.containsPoint(R3)&&this.collection.push(n)),n.children.length>0)for(let i=0;i<n.children.length;i++)this.searchChildInFrustum(e,n.children[i])}}const k9=V.forwardRef(function({children:e,follow:n=!0,lockX:i=!1,lockY:r=!1,lockZ:s=!1,...a},o){const l=V.useRef(null),u=V.useRef(null),c=new ra;return DT(({camera:h})=>{if(!n||!u.current)return;const d=l.current.rotation.clone();u.current.updateMatrix(),u.current.updateWorldMatrix(!1,!1),u.current.getWorldQuaternion(c),h.getWorldQuaternion(l.current.quaternion).premultiply(c.invert()),i&&(l.current.rotation.x=d.x),r&&(l.current.rotation.y=d.y),s&&(l.current.rotation.z=d.z)}),V.useImperativeHandle(o,()=>u.current,[]),V.createElement("group",f_({ref:u},a),V.createElement("group",{ref:l},e))});function lde(){var t=Object.create(null);function e(r,s){var a=r.id,o=r.name,l=r.dependencies;l===void 0&&(l=[]);var u=r.init;u===void 0&&(u=function(){});var c=r.getTransferables;if(c===void 0&&(c=null),!t[a])try{l=l.map(function(d){return d&&d.isWorkerModule&&(e(d,function(m){if(m instanceof Error)throw m}),d=t[d.id].value),d}),u=i("<"+o+">.init",u),c&&(c=i("<"+o+">.getTransferables",c));var h=null;typeof u=="function"?h=u.apply(void 0,l):console.error("worker module init function failed to rehydrate"),t[a]={id:a,value:h,getTransferables:c},s(h)}catch(d){d&&d.noLog||console.error(d),s(d)}}function n(r,s){var a,o=r.id,l=r.args;(!t[o]||typeof t[o].value!="function")&&s(new Error("Worker module "+o+": not found or its 'init' did not return a function"));try{var u=(a=t[o]).value.apply(a,l);u&&typeof u.then=="function"?u.then(c,function(h){return s(h instanceof Error?h:new Error(""+h))}):c(u)}catch(h){s(h)}function c(h){try{var d=t[o].getTransferables&&t[o].getTransferables(h);(!d||!Array.isArray(d)||!d.length)&&(d=void 0),s(h,d)}catch(m){console.error(m),s(m)}}}function i(r,s){var a=void 0;self.troikaDefine=function(l){return a=l};var o=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+s+`
)`],{type:"application/javascript"}));try{importScripts(o)}catch(l){console.error(l)}return URL.revokeObjectURL(o),delete self.troikaDefine,a}self.addEventListener("message",function(r){var s=r.data,a=s.messageId,o=s.action,l=s.data;try{o==="registerModule"&&e(l,function(u){u instanceof Error?postMessage({messageId:a,success:!1,error:u.message}):postMessage({messageId:a,success:!0,result:{isCallable:typeof u=="function"}})}),o==="callModule"&&n(l,function(u,c){u instanceof Error?postMessage({messageId:a,success:!1,error:u.message}):postMessage({messageId:a,success:!0,result:u},c||void 0)})}catch(u){postMessage({messageId:a,success:!1,error:u.stack})}})}function ude(t){var e=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return e._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,n);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var n=t.dependencies,i=t.init;n=Array.isArray(n)?n.map(function(s){return s&&(s=s.onMainThread||s,s._getInitResult&&(s=s._getInitResult())),s}):[];var r=Promise.all(n).then(function(s){return i.apply(null,s)});return e._getInitResult=function(){return r},r},e}var F9=function(){var t=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),t=!0}catch(n){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+n.message+"]")}return F9=function(){return t},t},cde=0,fde=0,D3=!1,p1=Object.create(null),m1=Object.create(null),LD=Object.create(null);function wv(t){if((!t||typeof t.init!="function")&&!D3)throw new Error("requires `options.init` function");var e=t.dependencies,n=t.init,i=t.getTransferables,r=t.workerId,s=ude(t);r==null&&(r="#default");var a="workerModule"+ ++cde,o=t.name||a,l=null;e=e&&e.map(function(c){return typeof c=="function"&&!c.workerModuleData&&(D3=!0,c=wv({workerId:r,name:"<"+o+"> function dependency: "+c.name,init:`function(){return (
`+_E(c)+`
)}`}),D3=!1),c&&c.workerModuleData&&(c=c.workerModuleData),c});function u(){for(var c=[],h=arguments.length;h--;)c[h]=arguments[h];if(!F9())return s.apply(void 0,c);if(!l){l=u5(r,"registerModule",u.workerModuleData);var d=function(){l=null,m1[r].delete(d)};(m1[r]||(m1[r]=new Set)).add(d)}return l.then(function(m){var v=m.isCallable;if(v)return u5(r,"callModule",{id:a,args:c});throw new Error("Worker module function was called but `init` did not return a callable function")})}return u.workerModuleData={isWorkerModule:!0,id:a,name:o,dependencies:e,init:_E(n),getTransferables:i&&_E(i)},u.onMainThread=s,u}function hde(t){m1[t]&&m1[t].forEach(function(e){e()}),p1[t]&&(p1[t].terminate(),delete p1[t])}function _E(t){var e=t.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function dde(t){var e=p1[t];if(!e){var n=_E(lde);e=p1[t]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+t.replace(/\*/g,"")+` **/

;(`+n+")()"],{type:"application/javascript"}))),e.onmessage=function(i){var r=i.data,s=r.messageId,a=LD[s];if(!a)throw new Error("WorkerModule response with empty or unknown messageId");delete LD[s],a(r)}}return e}function u5(t,e,n){return new Promise(function(i,r){var s=++fde;LD[s]=function(a){a.success?i(a.result):r(new Error("Error in worker "+e+" call: "+a.error))},dde(t).postMessage({messageId:s,action:e,data:n})})}function G9(){var t=function(e){function n(X,Q,H,$,ne,q,se,ve){var pe=1-se;ve.x=pe*pe*X+2*pe*se*H+se*se*ne,ve.y=pe*pe*Q+2*pe*se*$+se*se*q}function i(X,Q,H,$,ne,q,se,ve,pe,xe){var ot=1-pe;xe.x=ot*ot*ot*X+3*ot*ot*pe*H+3*ot*pe*pe*ne+pe*pe*pe*se,xe.y=ot*ot*ot*Q+3*ot*ot*pe*$+3*ot*pe*pe*q+pe*pe*pe*ve}function r(X,Q){for(var H=/([MLQCZ])([^MLQCZ]*)/g,$,ne,q,se,ve;$=H.exec(X);){var pe=$[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(xe){return parseFloat(xe)});switch($[1]){case"M":se=ne=pe[0],ve=q=pe[1];break;case"L":(pe[0]!==se||pe[1]!==ve)&&Q("L",se,ve,se=pe[0],ve=pe[1]);break;case"Q":{Q("Q",se,ve,se=pe[2],ve=pe[3],pe[0],pe[1]);break}case"C":{Q("C",se,ve,se=pe[4],ve=pe[5],pe[0],pe[1],pe[2],pe[3]);break}case"Z":(se!==ne||ve!==q)&&Q("L",se,ve,ne,q);break}}}function s(X,Q,H){H===void 0&&(H=16);var $={x:0,y:0};r(X,function(ne,q,se,ve,pe,xe,ot,st,et){switch(ne){case"L":Q(q,se,ve,pe);break;case"Q":{for(var Te=q,Xe=se,K=1;K<H;K++)n(q,se,xe,ot,ve,pe,K/(H-1),$),Q(Te,Xe,$.x,$.y),Te=$.x,Xe=$.y;break}case"C":{for(var Pe=q,Ne=se,Ve=1;Ve<H;Ve++)i(q,se,xe,ot,st,et,ve,pe,Ve/(H-1),$),Q(Pe,Ne,$.x,$.y),Pe=$.x,Ne=$.y;break}}})}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",o="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,u={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function c(X,Q){var H=X.getContext?X.getContext("webgl",u):X,$=l.get(H);if(!$){let ot=function(Pe){var Ne=q[Pe];if(!Ne&&(Ne=q[Pe]=H.getExtension(Pe),!Ne))throw new Error(Pe+" not supported");return Ne},st=function(Pe,Ne){var Ve=H.createShader(Ne);return H.shaderSource(Ve,Pe),H.compileShader(Ve),Ve},et=function(Pe,Ne,Ve,_e){if(!se[Pe]){var ft={},ke={},Z=H.createProgram();H.attachShader(Z,st(Ne,H.VERTEX_SHADER)),H.attachShader(Z,st(Ve,H.FRAGMENT_SHADER)),H.linkProgram(Z),se[Pe]={program:Z,transaction:function(I){H.useProgram(Z),I({setUniform:function(ge,ze){for(var ct=[],at=arguments.length-2;at-- >0;)ct[at]=arguments[at+2];var Rt=ke[ze]||(ke[ze]=H.getUniformLocation(Z,ze));H["uniform"+ge].apply(H,[Rt].concat(ct))},setAttribute:function(ge,ze,ct,at,Rt){var Nt=ft[ge];Nt||(Nt=ft[ge]={buf:H.createBuffer(),loc:H.getAttribLocation(Z,ge),data:null}),H.bindBuffer(H.ARRAY_BUFFER,Nt.buf),H.vertexAttribPointer(Nt.loc,ze,H.FLOAT,!1,0,0),H.enableVertexAttribArray(Nt.loc),ne?H.vertexAttribDivisor(Nt.loc,at):ot("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Nt.loc,at),Rt!==Nt.data&&(H.bufferData(H.ARRAY_BUFFER,Rt,ct),Nt.data=Rt)}})}}}se[Pe].transaction(_e)},Te=function(Pe,Ne){pe++;try{H.activeTexture(H.TEXTURE0+pe);var Ve=ve[Pe];Ve||(Ve=ve[Pe]=H.createTexture(),H.bindTexture(H.TEXTURE_2D,Ve),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.NEAREST),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.NEAREST)),H.bindTexture(H.TEXTURE_2D,Ve),Ne(Ve,pe)}finally{pe--}},Xe=function(Pe,Ne,Ve){var _e=H.createFramebuffer();xe.push(_e),H.bindFramebuffer(H.FRAMEBUFFER,_e),H.activeTexture(H.TEXTURE0+Ne),H.bindTexture(H.TEXTURE_2D,Pe),H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,Pe,0);try{Ve(_e)}finally{H.deleteFramebuffer(_e),H.bindFramebuffer(H.FRAMEBUFFER,xe[--xe.length-1]||null)}},K=function(){q={},se={},ve={},pe=-1,xe.length=0};var ne=typeof WebGL2RenderingContext<"u"&&H instanceof WebGL2RenderingContext,q={},se={},ve={},pe=-1,xe=[];H.canvas.addEventListener("webglcontextlost",function(Pe){K(),Pe.preventDefault()},!1),l.set(H,$={gl:H,isWebGL2:ne,getExtension:ot,withProgram:et,withTexture:Te,withTextureFramebuffer:Xe,handleContextLoss:K})}Q($)}function h(X,Q,H,$,ne,q,se,ve){se===void 0&&(se=15),ve===void 0&&(ve=null),c(X,function(pe){var xe=pe.gl,ot=pe.withProgram,st=pe.withTexture;st("copy",function(et,Te){xe.texImage2D(xe.TEXTURE_2D,0,xe.RGBA,ne,q,0,xe.RGBA,xe.UNSIGNED_BYTE,Q),ot("copy",a,o,function(Xe){var K=Xe.setUniform,Pe=Xe.setAttribute;Pe("aUV",2,xe.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),K("1i","image",Te),xe.bindFramebuffer(xe.FRAMEBUFFER,ve||null),xe.disable(xe.BLEND),xe.colorMask(se&8,se&4,se&2,se&1),xe.viewport(H,$,ne,q),xe.scissor(H,$,ne,q),xe.drawArrays(xe.TRIANGLES,0,3)})})})}function d(X,Q,H){var $=X.width,ne=X.height;c(X,function(q){var se=q.gl,ve=new Uint8Array($*ne*4);se.readPixels(0,0,$,ne,se.RGBA,se.UNSIGNED_BYTE,ve),X.width=Q,X.height=H,h(se,ve,0,0,$,ne)})}var m=Object.freeze({__proto__:null,withWebGLContext:c,renderImageData:h,resizeWebGLCanvasWithoutClearing:d});function v(X,Q,H,$,ne,q){q===void 0&&(q=1);var se=new Uint8Array(X*Q),ve=$[2]-$[0],pe=$[3]-$[1],xe=[];s(H,function(Pe,Ne,Ve,_e){xe.push({x1:Pe,y1:Ne,x2:Ve,y2:_e,minX:Math.min(Pe,Ve),minY:Math.min(Ne,_e),maxX:Math.max(Pe,Ve),maxY:Math.max(Ne,_e)})}),xe.sort(function(Pe,Ne){return Pe.maxX-Ne.maxX});for(var ot=0;ot<X;ot++)for(var st=0;st<Q;st++){var et=Xe($[0]+ve*(ot+.5)/X,$[1]+pe*(st+.5)/Q),Te=Math.pow(1-Math.abs(et)/ne,q)/2;et<0&&(Te=1-Te),Te=Math.max(0,Math.min(255,Math.round(Te*255))),se[st*X+ot]=Te}return se;function Xe(Pe,Ne){for(var Ve=1/0,_e=1/0,ft=xe.length;ft--;){var ke=xe[ft];if(ke.maxX+_e<=Pe)break;if(Pe+_e>ke.minX&&Ne-_e<ke.maxY&&Ne+_e>ke.minY){var Z=g(Pe,Ne,ke.x1,ke.y1,ke.x2,ke.y2);Z<Ve&&(Ve=Z,_e=Math.sqrt(Ve))}}return K(Pe,Ne)&&(_e=-_e),_e}function K(Pe,Ne){for(var Ve=0,_e=xe.length;_e--;){var ft=xe[_e];if(ft.maxX<=Pe)break;var ke=ft.y1>Ne!=ft.y2>Ne&&Pe<(ft.x2-ft.x1)*(Ne-ft.y1)/(ft.y2-ft.y1)+ft.x1;ke&&(Ve+=ft.y1<ft.y2?1:-1)}return Ve!==0}}function _(X,Q,H,$,ne,q,se,ve,pe,xe){q===void 0&&(q=1),ve===void 0&&(ve=0),pe===void 0&&(pe=0),xe===void 0&&(xe=0),y(X,Q,H,$,ne,q,se,null,ve,pe,xe)}function y(X,Q,H,$,ne,q,se,ve,pe,xe,ot){q===void 0&&(q=1),pe===void 0&&(pe=0),xe===void 0&&(xe=0),ot===void 0&&(ot=0);for(var st=v(X,Q,H,$,ne,q),et=new Uint8Array(st.length*4),Te=0;Te<st.length;Te++)et[Te*4+ot]=st[Te];h(se,et,pe,xe,X,Q,1<<3-ot,ve)}function g(X,Q,H,$,ne,q){var se=ne-H,ve=q-$,pe=se*se+ve*ve,xe=pe?Math.max(0,Math.min(1,((X-H)*se+(Q-$)*ve)/pe)):0,ot=X-(H+xe*se),st=Q-($+xe*ve);return ot*ot+st*st}var x=Object.freeze({__proto__:null,generate:v,generateIntoCanvas:_,generateIntoFramebuffer:y}),S="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",E="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",A="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",T=new Float32Array([0,0,2,0,0,2]),C=null,O=!1,M={},D=new WeakMap;function P(X){if(!O&&!Y(X))throw new Error("WebGL generation not supported")}function F(X,Q,H,$,ne,q,se){if(q===void 0&&(q=1),se===void 0&&(se=null),!se&&(se=C,!se)){var ve=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!ve)throw new Error("OffscreenCanvas or DOM canvas not supported");se=C=ve.getContext("webgl",{depth:!1})}P(se);var pe=new Uint8Array(X*Q*4);c(se,function(et){var Te=et.gl,Xe=et.withTexture,K=et.withTextureFramebuffer;Xe("readable",function(Pe,Ne){Te.texImage2D(Te.TEXTURE_2D,0,Te.RGBA,X,Q,0,Te.RGBA,Te.UNSIGNED_BYTE,null),K(Pe,Ne,function(Ve){z(X,Q,H,$,ne,q,Te,Ve,0,0,0),Te.readPixels(0,0,X,Q,Te.RGBA,Te.UNSIGNED_BYTE,pe)})})});for(var xe=new Uint8Array(X*Q),ot=0,st=0;ot<pe.length;ot+=4)xe[st++]=pe[ot];return xe}function G(X,Q,H,$,ne,q,se,ve,pe,xe){q===void 0&&(q=1),ve===void 0&&(ve=0),pe===void 0&&(pe=0),xe===void 0&&(xe=0),z(X,Q,H,$,ne,q,se,null,ve,pe,xe)}function z(X,Q,H,$,ne,q,se,ve,pe,xe,ot){q===void 0&&(q=1),pe===void 0&&(pe=0),xe===void 0&&(xe=0),ot===void 0&&(ot=0),P(se);var st=[];s(H,function(et,Te,Xe,K){st.push(et,Te,Xe,K)}),st=new Float32Array(st),c(se,function(et){var Te=et.gl,Xe=et.isWebGL2,K=et.getExtension,Pe=et.withProgram,Ne=et.withTexture,Ve=et.withTextureFramebuffer,_e=et.handleContextLoss;if(Ne("rawDistances",function(ft,ke){(X!==ft._lastWidth||Q!==ft._lastHeight)&&Te.texImage2D(Te.TEXTURE_2D,0,Te.RGBA,ft._lastWidth=X,ft._lastHeight=Q,0,Te.RGBA,Te.UNSIGNED_BYTE,null),Pe("main",S,E,function(Z){var W=Z.setAttribute,I=Z.setUniform,De=!Xe&&K("ANGLE_instanced_arrays"),ge=!Xe&&K("EXT_blend_minmax");W("aUV",2,Te.STATIC_DRAW,0,T),W("aLineSegment",4,Te.DYNAMIC_DRAW,1,st),I.apply(void 0,["4f","uGlyphBounds"].concat($)),I("1f","uMaxDistance",ne),I("1f","uExponent",q),Ve(ft,ke,function(ze){Te.enable(Te.BLEND),Te.colorMask(!0,!0,!0,!0),Te.viewport(0,0,X,Q),Te.scissor(0,0,X,Q),Te.blendFunc(Te.ONE,Te.ONE),Te.blendEquationSeparate(Te.FUNC_ADD,Xe?Te.MAX:ge.MAX_EXT),Te.clear(Te.COLOR_BUFFER_BIT),Xe?Te.drawArraysInstanced(Te.TRIANGLES,0,3,st.length/4):De.drawArraysInstancedANGLE(Te.TRIANGLES,0,3,st.length/4)})}),Pe("post",a,A,function(Z){Z.setAttribute("aUV",2,Te.STATIC_DRAW,0,T),Z.setUniform("1i","tex",ke),Te.bindFramebuffer(Te.FRAMEBUFFER,ve),Te.disable(Te.BLEND),Te.colorMask(ot===0,ot===1,ot===2,ot===3),Te.viewport(pe,xe,X,Q),Te.scissor(pe,xe,X,Q),Te.drawArrays(Te.TRIANGLES,0,3)})}),Te.isContextLost())throw _e(),new Error("webgl context lost")})}function Y(X){var Q=!X||X===C?M:X.canvas||X,H=D.get(Q);if(H===void 0){O=!0;var $=null;try{var ne=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],q=F(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,X);H=q&&ne.length===q.length&&q.every(function(se,ve){return se===ne[ve]}),H||($="bad trial run results",console.info(ne,q))}catch(se){H=!1,$=se.message}$&&console.warn("WebGL SDF generation not supported:",$),O=!1,D.set(Q,H)}return H}var N=Object.freeze({__proto__:null,generate:F,generateIntoCanvas:G,generateIntoFramebuffer:z,isSupported:Y});function k(X,Q,H,$,ne,q){ne===void 0&&(ne=Math.max($[2]-$[0],$[3]-$[1])/2),q===void 0&&(q=1);try{return F.apply(N,arguments)}catch(se){return console.info("WebGL SDF generation failed, falling back to JS",se),v.apply(x,arguments)}}function j(X,Q,H,$,ne,q,se,ve,pe,xe){ne===void 0&&(ne=Math.max($[2]-$[0],$[3]-$[1])/2),q===void 0&&(q=1),ve===void 0&&(ve=0),pe===void 0&&(pe=0),xe===void 0&&(xe=0);try{return G.apply(N,arguments)}catch(ot){return console.info("WebGL SDF generation failed, falling back to JS",ot),_.apply(x,arguments)}}return e.forEachPathCommand=r,e.generate=k,e.generateIntoCanvas=j,e.javascript=x,e.pathToLineSegments=s,e.webgl=N,e.webglUtils=m,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}function pde(){var t=function(e){var n={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},i={},r={};i.L=1,r[1]="L",Object.keys(n).forEach(function(_e,ft){i[_e]=1<<ft+1,r[i[_e]]=_e}),Object.freeze(i);var s=i.LRI|i.RLI|i.FSI,a=i.L|i.R|i.AL,o=i.B|i.S|i.WS|i.ON|i.FSI|i.LRI|i.RLI|i.PDI,l=i.BN|i.RLE|i.LRE|i.RLO|i.LRO|i.PDF,u=i.S|i.WS|i.B|s|i.PDI|l,c=null;function h(){if(!c){c=new Map;var _e=function(ke){if(n.hasOwnProperty(ke)){var Z=0;n[ke].split(",").forEach(function(W){var I=W.split("+"),De=I[0],ge=I[1];De=parseInt(De,36),ge=ge?parseInt(ge,36):0,c.set(Z+=De,i[ke]);for(var ze=0;ze<ge;ze++)c.set(++Z,i[ke])})}};for(var ft in n)_e(ft)}}function d(_e){return h(),c.get(_e.codePointAt(0))||i.L}function m(_e){return r[d(_e)]}var v={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function _(_e,ft){var ke=36,Z=0,W=new Map,I=ft&&new Map,De;return _e.split(",").forEach(function ge(ze){if(ze.indexOf("+")!==-1)for(var ct=+ze;ct--;)ge(De);else{De=ze;var at=ze.split(">"),Rt=at[0],Nt=at[1];Rt=String.fromCodePoint(Z+=parseInt(Rt,ke)),Nt=String.fromCodePoint(Z+=parseInt(Nt,ke)),W.set(Rt,Nt),ft&&I.set(Nt,Rt)}}),{map:W,reverseMap:I}}var y,g,x;function S(){if(!y){var _e=_(v.pairs,!0),ft=_e.map,ke=_e.reverseMap;y=ft,g=ke,x=_(v.canonical,!1).map}}function E(_e){return S(),y.get(_e)||null}function A(_e){return S(),g.get(_e)||null}function T(_e){return S(),x.get(_e)||null}var C=i.L,O=i.R,M=i.EN,D=i.ES,P=i.ET,F=i.AN,G=i.CS,z=i.B,Y=i.S,N=i.ON,k=i.BN,j=i.NSM,X=i.AL,Q=i.LRO,H=i.RLO,$=i.LRE,ne=i.RLE,q=i.PDF,se=i.LRI,ve=i.RLI,pe=i.FSI,xe=i.PDI;function ot(_e,ft){for(var ke=125,Z=new Uint32Array(_e.length),W=0;W<_e.length;W++)Z[W]=d(_e[W]);var I=new Map;function De(Ss,fs){var Xr=Z[Ss];Z[Ss]=fs,I.set(Xr,I.get(Xr)-1),Xr&o&&I.set(o,I.get(o)-1),I.set(fs,(I.get(fs)||0)+1),fs&o&&I.set(o,(I.get(o)||0)+1)}for(var ge=new Uint8Array(_e.length),ze=new Map,ct=[],at=null,Rt=0;Rt<_e.length;Rt++)at||ct.push(at={start:Rt,end:_e.length-1,level:ft==="rtl"?1:ft==="ltr"?0:Ga(Rt,!1)}),Z[Rt]&z&&(at.end=Rt,at=null);for(var Nt=ne|$|H|Q|s|xe|q|z,vt=function(Ss){return Ss+(Ss&1?1:2)},Vt=function(Ss){return Ss+(Ss&1?2:1)},Bt=0;Bt<ct.length;Bt++){at=ct[Bt];var Ht=[{_level:at.level,_override:0,_isolate:0}],ut=void 0,xn=0,un=0,Vn=0;I.clear();for(var be=at.start;be<=at.end;be++){var _t=Z[be];if(ut=Ht[Ht.length-1],I.set(_t,(I.get(_t)||0)+1),_t&o&&I.set(o,(I.get(o)||0)+1),_t&Nt)if(_t&(ne|$)){ge[be]=ut._level;var Ye=(_t===ne?Vt:vt)(ut._level);Ye<=ke&&!xn&&!un?Ht.push({_level:Ye,_override:0,_isolate:0}):xn||un++}else if(_t&(H|Q)){ge[be]=ut._level;var Et=(_t===H?Vt:vt)(ut._level);Et<=ke&&!xn&&!un?Ht.push({_level:Et,_override:_t&H?O:C,_isolate:0}):xn||un++}else if(_t&s){_t&pe&&(_t=Ga(be+1,!0)===1?ve:se),ge[be]=ut._level,ut._override&&De(be,ut._override);var Ot=(_t===ve?Vt:vt)(ut._level);Ot<=ke&&xn===0&&un===0?(Vn++,Ht.push({_level:Ot,_override:0,_isolate:1,_isolInitIndex:be})):xn++}else if(_t&xe){if(xn>0)xn--;else if(Vn>0){for(un=0;!Ht[Ht.length-1]._isolate;)Ht.pop();var Mt=Ht[Ht.length-1]._isolInitIndex;Mt!=null&&(ze.set(Mt,be),ze.set(be,Mt)),Ht.pop(),Vn--}ut=Ht[Ht.length-1],ge[be]=ut._level,ut._override&&De(be,ut._override)}else _t&q?(xn===0&&(un>0?un--:!ut._isolate&&Ht.length>1&&(Ht.pop(),ut=Ht[Ht.length-1])),ge[be]=ut._level):_t&z&&(ge[be]=at.level);else ge[be]=ut._level,ut._override&&_t!==k&&De(be,ut._override)}for(var vn=[],Un=null,an=at.start;an<=at.end;an++){var An=Z[an];if(!(An&l)){var Ri=ge[an],Ni=An&s,lr=An===xe;Un&&Ri===Un._level?(Un._end=an,Un._endsWithIsolInit=Ni):vn.push(Un={_start:an,_end:an,_level:Ri,_startsWithPDI:lr,_endsWithIsolInit:Ni})}}for(var us=[],Vr=0;Vr<vn.length;Vr++){var Sr=vn[Vr];if(!Sr._startsWithPDI||Sr._startsWithPDI&&!ze.has(Sr._start)){for(var aa=[Un=Sr],Hr=void 0;Un&&Un._endsWithIsolInit&&(Hr=ze.get(Un._end))!=null;)for(var ur=Vr+1;ur<vn.length;ur++)if(vn[ur]._start===Hr){aa.push(Un=vn[ur]);break}for(var Zn=[],xi=0;xi<aa.length;xi++)for(var xl=aa[xi],Po=xl._start;Po<=xl._end;Po++)Zn.push(Po);for(var Vf=ge[Zn[0]],dc=at.level,fu=Zn[0]-1;fu>=0;fu--)if(!(Z[fu]&l)){dc=ge[fu];break}var _l=Zn[Zn.length-1],pc=ge[_l],hu=at.level;if(!(Z[_l]&s)){for(var te=_l+1;te<=at.end;te++)if(!(Z[te]&l)){hu=ge[te];break}}us.push({_seqIndices:Zn,_sosType:Math.max(dc,Vf)%2?O:C,_eosType:Math.max(hu,pc)%2?O:C})}}for(var we=0;we<us.length;we++){var Ke=us[we],Ee=Ke._seqIndices,Ue=Ke._sosType,It=Ke._eosType,en=ge[Ee[0]]&1?O:C;if(I.get(j))for(var on=0;on<Ee.length;on++){var fn=Ee[on];if(Z[fn]&j){for(var zn=Ue,Dn=on-1;Dn>=0;Dn--)if(!(Z[Ee[Dn]]&l)){zn=Z[Ee[Dn]];break}De(fn,zn&(s|xe)?N:zn)}}if(I.get(M))for(var En=0;En<Ee.length;En++){var ai=Ee[En];if(Z[ai]&M)for(var ui=En-1;ui>=-1;ui--){var er=ui===-1?Ue:Z[Ee[ui]];if(er&a){er===X&&De(ai,F);break}}}if(I.get(X))for(var Di=0;Di<Ee.length;Di++){var ci=Ee[Di];Z[ci]&X&&De(ci,O)}if(I.get(D)||I.get(G))for(var Tn=1;Tn<Ee.length-1;Tn++){var Zi=Ee[Tn];if(Z[Zi]&(D|G)){for(var ei=0,cs=0,oa=Tn-1;oa>=0&&(ei=Z[Ee[oa]],!!(ei&l));oa--);for(var dr=Tn+1;dr<Ee.length&&(cs=Z[Ee[dr]],!!(cs&l));dr++);ei===cs&&(Z[Zi]===D?ei===M:ei&(M|F))&&De(Zi,ei)}}if(I.get(M))for(var Rr=0;Rr<Ee.length;Rr++){var Oi=Ee[Rr];if(Z[Oi]&M){for(var Er=Rr-1;Er>=0&&Z[Ee[Er]]&(P|l);Er--)De(Ee[Er],M);for(Rr++;Rr<Ee.length&&Z[Ee[Rr]]&(P|l|M);Rr++)Z[Ee[Rr]]!==M&&De(Ee[Rr],M)}}if(I.get(P)||I.get(D)||I.get(G))for(var Dr=0;Dr<Ee.length;Dr++){var jr=Ee[Dr];if(Z[jr]&(P|D|G)){De(jr,N);for(var wr=Dr-1;wr>=0&&Z[Ee[wr]]&l;wr--)De(Ee[wr],N);for(var qs=Dr+1;qs<Ee.length&&Z[Ee[qs]]&l;qs++)De(Ee[qs],N)}}if(I.get(M))for(var pr=0,is=Ue;pr<Ee.length;pr++){var No=Ee[pr],Hf=Z[No];Hf&M?is===C&&De(No,C):Hf&a&&(is=Hf)}if(I.get(o)){var bl=O|M|F,jf=bl|C,du=[];{for(var Sl=[],El=0;El<Ee.length;El++)if(Z[Ee[El]]&o){var co=_e[Ee[El]],yd=void 0;if(E(co)!==null)if(Sl.length<63)Sl.push({char:co,seqIndex:El});else break;else if((yd=A(co))!==null)for(var pu=Sl.length-1;pu>=0;pu--){var mc=Sl[pu].char;if(mc===yd||mc===A(T(co))||E(T(mc))===co){du.push([Sl[pu].seqIndex,El]),Sl.length=pu;break}}}du.sort(function(Ss,fs){return Ss[0]-fs[0]})}for(var Wf=0;Wf<du.length;Wf++){for(var xd=du[Wf],gc=xd[0],vc=xd[1],_d=!1,Wr=0,bd=gc+1;bd<vc;bd++){var _m=Ee[bd];if(Z[_m]&jf){_d=!0;var mu=Z[_m]&bl?O:C;if(mu===en){Wr=mu;break}}}if(_d&&!Wr){Wr=Ue;for(var fo=gc-1;fo>=0;fo--){var yc=Ee[fo];if(Z[yc]&jf){var gu=Z[yc]&bl?O:C;gu!==en?Wr=gu:Wr=en;break}}}if(Wr){if(Z[Ee[gc]]=Z[Ee[vc]]=Wr,Wr!==en){for(var vu=gc+1;vu<Ee.length;vu++)if(!(Z[Ee[vu]]&l)){d(_e[Ee[vu]])&j&&(Z[Ee[vu]]=Wr);break}}if(Wr!==en){for(var Bo=vc+1;Bo<Ee.length;Bo++)if(!(Z[Ee[Bo]]&l)){d(_e[Ee[Bo]])&j&&(Z[Ee[Bo]]=Wr);break}}}}for(var la=0;la<Ee.length;la++)if(Z[Ee[la]]&o){for(var ka=la,wl=la,Fa=Ue,ho=la-1;ho>=0;ho--)if(Z[Ee[ho]]&l)ka=ho;else{Fa=Z[Ee[ho]]&bl?O:C;break}for(var Sd=It,Al=la+1;Al<Ee.length;Al++)if(Z[Ee[Al]]&(o|l))wl=Al;else{Sd=Z[Ee[Al]]&bl?O:C;break}for(var Xf=ka;Xf<=wl;Xf++)Z[Ee[Xf]]=Fa===Sd?Fa:en;la=wl}}}for(var Ps=at.start;Ps<=at.end;Ps++){var Tv=ge[Ps],Ar=Z[Ps];if(Tv&1?Ar&(C|M|F)&&ge[Ps]++:Ar&O?ge[Ps]++:Ar&(F|M)&&(ge[Ps]+=2),Ar&l&&(ge[Ps]=Ps===0?at.level:ge[Ps-1]),Ps===at.end||d(_e[Ps])&(Y|z))for(var xc=Ps;xc>=0&&d(_e[xc])&u;xc--)ge[xc]=at.level}}return{levels:ge,paragraphs:ct};function Ga(Ss,fs){for(var Xr=Ss;Xr<_e.length;Xr++){var Es=Z[Xr];if(Es&(O|X))return 1;if(Es&(z|C)||fs&&Es===xe)return 0;if(Es&s){var Yf=bm(Xr);Xr=Yf===-1?_e.length:Yf}}return 0}function bm(Ss){for(var fs=1,Xr=Ss+1;Xr<_e.length;Xr++){var Es=Z[Xr];if(Es&z)break;if(Es&xe){if(--fs===0)return Xr}else Es&s&&fs++}return-1}}var st="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",et;function Te(){if(!et){var _e=_(st,!0),ft=_e.map,ke=_e.reverseMap;ke.forEach(function(Z,W){ft.set(W,Z)}),et=ft}}function Xe(_e){return Te(),et.get(_e)||null}function K(_e,ft,ke,Z){var W=_e.length;ke=Math.max(0,ke==null?0:+ke),Z=Math.min(W-1,Z==null?W-1:+Z);for(var I=new Map,De=ke;De<=Z;De++)if(ft[De]&1){var ge=Xe(_e[De]);ge!==null&&I.set(De,ge)}return I}function Pe(_e,ft,ke,Z){var W=_e.length;ke=Math.max(0,ke==null?0:+ke),Z=Math.min(W-1,Z==null?W-1:+Z);var I=[];return ft.paragraphs.forEach(function(De){var ge=Math.max(ke,De.start),ze=Math.min(Z,De.end);if(ge<ze){for(var ct=ft.levels.slice(ge,ze+1),at=ze;at>=ge&&d(_e[at])&u;at--)ct[at]=De.level;for(var Rt=De.level,Nt=1/0,vt=0;vt<ct.length;vt++){var Vt=ct[vt];Vt>Rt&&(Rt=Vt),Vt<Nt&&(Nt=Vt|1)}for(var Bt=Rt;Bt>=Nt;Bt--)for(var Ht=0;Ht<ct.length;Ht++)if(ct[Ht]>=Bt){for(var ut=Ht;Ht+1<ct.length&&ct[Ht+1]>=Bt;)Ht++;Ht>ut&&I.push([ut+ge,Ht+ge])}}}),I}function Ne(_e,ft,ke,Z){var W=Ve(_e,ft,ke,Z),I=[].concat(_e);return W.forEach(function(De,ge){I[ge]=(ft.levels[De]&1?Xe(_e[De]):null)||_e[De]}),I.join("")}function Ve(_e,ft,ke,Z){for(var W=Pe(_e,ft,ke,Z),I=[],De=0;De<_e.length;De++)I[De]=De;return W.forEach(function(ge){for(var ze=ge[0],ct=ge[1],at=I.slice(ze,ct+1),Rt=at.length;Rt--;)I[ct-Rt]=at[Rt]}),I}return e.closingToOpeningBracket=A,e.getBidiCharType=d,e.getBidiCharTypeName=m,e.getCanonicalBracket=T,e.getEmbeddingLevels=ot,e.getMirroredCharacter=Xe,e.getMirroredCharactersMap=K,e.getReorderSegments=Pe,e.getReorderedIndices=Ve,e.getReorderedString=Ne,e.openingToClosingBracket=E,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}const V9=/\bvoid\s+main\s*\(\s*\)\s*{/g;function PD(t){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function n(i,r){let s=ri[r];return s?PD(s):i}return t.replace(e,n)}const Js=[];for(let t=0;t<256;t++)Js[t]=(t<16?"0":"")+t.toString(16);function mde(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Js[t&255]+Js[t>>8&255]+Js[t>>16&255]+Js[t>>24&255]+"-"+Js[e&255]+Js[e>>8&255]+"-"+Js[e>>16&15|64]+Js[e>>24&255]+"-"+Js[n&63|128]+Js[n>>8&255]+"-"+Js[n>>16&255]+Js[n>>24&255]+Js[i&255]+Js[i>>8&255]+Js[i>>16&255]+Js[i>>24&255]).toUpperCase()}const pp=Object.assign||function(){let t=arguments[0];for(let e=1,n=arguments.length;e<n;e++){let i=arguments[e];if(i)for(let r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},gde=Date.now(),c5=new WeakMap,f5=new Map;let vde=1e10;function ND(t,e){const n=bde(e);let i=c5.get(t);if(i||c5.set(t,i=Object.create(null)),i[n])return new i[n];const r=`_onBeforeCompile${n}`,s=function(u,c){t.onBeforeCompile.call(this,u,c);const h=this.customProgramCacheKey()+"|"+u.vertexShader+"|"+u.fragmentShader;let d=f5[h];if(!d){const m=yde(this,u,e,n);d=f5[h]=m}u.vertexShader=d.vertexShader,u.fragmentShader=d.fragmentShader,pp(u.uniforms,this.uniforms),e.timeUniform&&(u.uniforms[e.timeUniform]={get value(){return Date.now()-gde}}),this[r]&&this[r](u)},a=function(){return o(e.chained?t:t.clone())},o=function(u){const c=Object.create(u,l);return Object.defineProperty(c,"baseMaterial",{value:t}),Object.defineProperty(c,"id",{value:vde++}),c.uuid=mde(),c.uniforms=pp({},u.uniforms,e.uniforms),c.defines=pp({},u.defines,e.defines),c.defines[`TROIKA_DERIVED_MATERIAL_${n}`]="",c.extensions=pp({},u.extensions,e.extensions),c._listeners=void 0,c},l={constructor:{value:a},isDerivedMaterial:{value:!0},type:{get:()=>t.type,set:u=>{t.type=u}},isDerivedFrom:{writable:!0,configurable:!0,value:function(u){const c=this.baseMaterial;return u===c||c.isDerivedMaterial&&c.isDerivedFrom(u)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return t.customProgramCacheKey()+"|"+n}},onBeforeCompile:{get(){return s},set(u){this[r]=u}},copy:{writable:!0,configurable:!0,value:function(u){return t.copy.call(this,u),!t.isShaderMaterial&&!t.isDerivedMaterial&&(pp(this.extensions,u.extensions),pp(this.defines,u.defines),pp(this.uniforms,UU.clone(u.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const u=new t.constructor;return o(u).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let u=this._depthMaterial;return u||(u=this._depthMaterial=ND(t.isDerivedMaterial?t.getDepthMaterial():new AT({depthPacking:MU}),e),u.defines.IS_DEPTH_MATERIAL="",u.uniforms=this.uniforms),u}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let u=this._distanceMaterial;return u||(u=this._distanceMaterial=ND(t.isDerivedMaterial?t.getDistanceMaterial():new TT,e),u.defines.IS_DISTANCE_MATERIAL="",u.uniforms=this.uniforms),u}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:u,_distanceMaterial:c}=this;u&&u.dispose(),c&&c.dispose(),t.dispose.call(this)}}};return i[n]=a,new a}function yde(t,{vertexShader:e,fragmentShader:n},i,r){let{vertexDefs:s,vertexMainIntro:a,vertexMainOutro:o,vertexTransform:l,fragmentDefs:u,fragmentMainIntro:c,fragmentMainOutro:h,fragmentColorTransform:d,customRewriter:m,timeUniform:v}=i;if(s=s||"",a=a||"",o=o||"",u=u||"",c=c||"",h=h||"",(l||m)&&(e=PD(e)),(d||m)&&(n=n.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),n=PD(n)),m){let _=m({vertexShader:e,fragmentShader:n});e=_.vertexShader,n=_.fragmentShader}if(d){let _=[];n=n.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,y=>(_.push(y),"")),h=`${d}
${_.join(`
`)}
${h}`}if(v){const _=`
uniform float ${v};
`;s=_+s,u=_+u}return l&&(e=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${e}
`,s=`${s}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,a=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${a}
`,e=e.replace(/\b(position|normal|uv)\b/g,(_,y,g,x)=>/\battribute\s+vec[23]\s+$/.test(x.substr(0,g))?y:`troika_${y}_${r}`),t.map&&t.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),e=h5(e,r,s,a,o),n=h5(n,r,u,c,h),{vertexShader:e,fragmentShader:n}}function h5(t,e,n,i,r){return(i||r||n)&&(t=t.replace(V9,`
${n}
void troikaOrigMain${e}() {`),t+=`
void main() {
  ${i}
  troikaOrigMain${e}();
  ${r}
}`),t}function xde(t,e){return t==="uniforms"?void 0:typeof e=="function"?e.toString():e}let _de=0;const d5=new Map;function bde(t){const e=JSON.stringify(t,xde);let n=d5.get(e);return n==null&&d5.set(e,n=++_de),n}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function Sde(){return typeof window>"u"&&(self.window=self),function(t){var e={parse:function(r){var s=e._bin,a=new Uint8Array(r);if(s.readASCII(a,0,4)=="ttcf"){var o=4;s.readUshort(a,o),o+=2,s.readUshort(a,o),o+=2;var l=s.readUint(a,o);o+=4;for(var u=[],c=0;c<l;c++){var h=s.readUint(a,o);o+=4,u.push(e._readFont(a,h))}return u}return[e._readFont(a,0)]},_readFont:function(r,s){var a=e._bin,o=s;a.readFixed(r,s),s+=4;var l=a.readUshort(r,s);s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2;for(var u=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],c={_data:r,_offset:o},h={},d=0;d<l;d++){var m=a.readASCII(r,s,4);s+=4,a.readUint(r,s),s+=4;var v=a.readUint(r,s);s+=4;var _=a.readUint(r,s);s+=4,h[m]={offset:v,length:_}}for(d=0;d<u.length;d++){var y=u[d];h[y]&&(c[y.trim()]=e[y.trim()].parse(r,h[y].offset,h[y].length,c))}return c},_tabOffset:function(r,s,a){for(var o=e._bin,l=o.readUshort(r,a+4),u=a+12,c=0;c<l;c++){var h=o.readASCII(r,u,4);u+=4,o.readUint(r,u),u+=4;var d=o.readUint(r,u);if(u+=4,o.readUint(r,u),u+=4,h==s)return d}return 0}};e._bin={readFixed:function(r,s){return(r[s]<<8|r[s+1])+(r[s+2]<<8|r[s+3])/65540},readF2dot14:function(r,s){return e._bin.readShort(r,s)/16384},readInt:function(r,s){return e._bin._view(r).getInt32(s)},readInt8:function(r,s){return e._bin._view(r).getInt8(s)},readShort:function(r,s){return e._bin._view(r).getInt16(s)},readUshort:function(r,s){return e._bin._view(r).getUint16(s)},readUshorts:function(r,s,a){for(var o=[],l=0;l<a;l++)o.push(e._bin.readUshort(r,s+2*l));return o},readUint:function(r,s){return e._bin._view(r).getUint32(s)},readUint64:function(r,s){return 4294967296*e._bin.readUint(r,s)+e._bin.readUint(r,s+4)},readASCII:function(r,s,a){for(var o="",l=0;l<a;l++)o+=String.fromCharCode(r[s+l]);return o},readUnicode:function(r,s,a){for(var o="",l=0;l<a;l++){var u=r[s++]<<8|r[s++];o+=String.fromCharCode(u)}return o},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,s,a){var o=e._bin._tdec;return o&&s==0&&a==r.length?o.decode(r):e._bin.readASCII(r,s,a)},readBytes:function(r,s,a){for(var o=[],l=0;l<a;l++)o.push(r[s+l]);return o},readASCIIArray:function(r,s,a){for(var o=[],l=0;l<a;l++)o.push(String.fromCharCode(r[s+l]));return o},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},e._lctf={},e._lctf.parse=function(r,s,a,o,l){var u=e._bin,c={},h=s;u.readFixed(r,s),s+=4;var d=u.readUshort(r,s);s+=2;var m=u.readUshort(r,s);s+=2;var v=u.readUshort(r,s);return s+=2,c.scriptList=e._lctf.readScriptList(r,h+d),c.featureList=e._lctf.readFeatureList(r,h+m),c.lookupList=e._lctf.readLookupList(r,h+v,l),c},e._lctf.readLookupList=function(r,s,a){var o=e._bin,l=s,u=[],c=o.readUshort(r,s);s+=2;for(var h=0;h<c;h++){var d=o.readUshort(r,s);s+=2;var m=e._lctf.readLookupTable(r,l+d,a);u.push(m)}return u},e._lctf.readLookupTable=function(r,s,a){var o=e._bin,l=s,u={tabs:[]};u.ltype=o.readUshort(r,s),s+=2,u.flag=o.readUshort(r,s),s+=2;var c=o.readUshort(r,s);s+=2;for(var h=u.ltype,d=0;d<c;d++){var m=o.readUshort(r,s);s+=2;var v=a(r,h,l+m,u);u.tabs.push(v)}return u},e._lctf.numOfOnes=function(r){for(var s=0,a=0;a<32;a++)r>>>a&1&&s++;return s},e._lctf.readClassDef=function(r,s){var a=e._bin,o=[],l=a.readUshort(r,s);if(s+=2,l==1){var u=a.readUshort(r,s);s+=2;var c=a.readUshort(r,s);s+=2;for(var h=0;h<c;h++)o.push(u+h),o.push(u+h),o.push(a.readUshort(r,s)),s+=2}if(l==2){var d=a.readUshort(r,s);for(s+=2,h=0;h<d;h++)o.push(a.readUshort(r,s)),s+=2,o.push(a.readUshort(r,s)),s+=2,o.push(a.readUshort(r,s)),s+=2}return o},e._lctf.getInterval=function(r,s){for(var a=0;a<r.length;a+=3){var o=r[a],l=r[a+1];if(r[a+2],o<=s&&s<=l)return a}return-1},e._lctf.readCoverage=function(r,s){var a=e._bin,o={};o.fmt=a.readUshort(r,s),s+=2;var l=a.readUshort(r,s);return s+=2,o.fmt==1&&(o.tab=a.readUshorts(r,s,l)),o.fmt==2&&(o.tab=a.readUshorts(r,s,3*l)),o},e._lctf.coverageIndex=function(r,s){var a=r.tab;if(r.fmt==1)return a.indexOf(s);if(r.fmt==2){var o=e._lctf.getInterval(a,s);if(o!=-1)return a[o+2]+(s-a[o])}return-1},e._lctf.readFeatureList=function(r,s){var a=e._bin,o=s,l=[],u=a.readUshort(r,s);s+=2;for(var c=0;c<u;c++){var h=a.readASCII(r,s,4);s+=4;var d=a.readUshort(r,s);s+=2;var m=e._lctf.readFeatureTable(r,o+d);m.tag=h.trim(),l.push(m)}return l},e._lctf.readFeatureTable=function(r,s){var a=e._bin,o=s,l={},u=a.readUshort(r,s);s+=2,u>0&&(l.featureParams=o+u);var c=a.readUshort(r,s);s+=2,l.tab=[];for(var h=0;h<c;h++)l.tab.push(a.readUshort(r,s+2*h));return l},e._lctf.readScriptList=function(r,s){var a=e._bin,o=s,l={},u=a.readUshort(r,s);s+=2;for(var c=0;c<u;c++){var h=a.readASCII(r,s,4);s+=4;var d=a.readUshort(r,s);s+=2,l[h.trim()]=e._lctf.readScriptTable(r,o+d)}return l},e._lctf.readScriptTable=function(r,s){var a=e._bin,o=s,l={},u=a.readUshort(r,s);s+=2,u>0&&(l.default=e._lctf.readLangSysTable(r,o+u));var c=a.readUshort(r,s);s+=2;for(var h=0;h<c;h++){var d=a.readASCII(r,s,4);s+=4;var m=a.readUshort(r,s);s+=2,l[d.trim()]=e._lctf.readLangSysTable(r,o+m)}return l},e._lctf.readLangSysTable=function(r,s){var a=e._bin,o={};a.readUshort(r,s),s+=2,o.reqFeature=a.readUshort(r,s),s+=2;var l=a.readUshort(r,s);return s+=2,o.features=a.readUshorts(r,s,l),o},e.CFF={},e.CFF.parse=function(r,s,a){var o=e._bin;(r=new Uint8Array(r.buffer,s,a))[s=0],r[++s],r[++s],r[++s],s++;var l=[];s=e.CFF.readIndex(r,s,l);for(var u=[],c=0;c<l.length-1;c++)u.push(o.readASCII(r,s+l[c],l[c+1]-l[c]));s+=l[l.length-1];var h=[];s=e.CFF.readIndex(r,s,h);var d=[];for(c=0;c<h.length-1;c++)d.push(e.CFF.readDict(r,s+h[c],s+h[c+1]));s+=h[h.length-1];var m=d[0],v=[];s=e.CFF.readIndex(r,s,v);var _=[];for(c=0;c<v.length-1;c++)_.push(o.readASCII(r,s+v[c],v[c+1]-v[c]));if(s+=v[v.length-1],e.CFF.readSubrs(r,s,m),m.CharStrings){s=m.CharStrings,v=[],s=e.CFF.readIndex(r,s,v);var y=[];for(c=0;c<v.length-1;c++)y.push(o.readBytes(r,s+v[c],v[c+1]-v[c]));m.CharStrings=y}if(m.ROS){s=m.FDArray;var g=[];for(s=e.CFF.readIndex(r,s,g),m.FDArray=[],c=0;c<g.length-1;c++){var x=e.CFF.readDict(r,s+g[c],s+g[c+1]);e.CFF._readFDict(r,x,_),m.FDArray.push(x)}s+=g[g.length-1],s=m.FDSelect,m.FDSelect=[];var S=r[s];if(s++,S!=3)throw S;var E=o.readUshort(r,s);for(s+=2,c=0;c<E+1;c++)m.FDSelect.push(o.readUshort(r,s),r[s+2]),s+=3}return m.Encoding&&(m.Encoding=e.CFF.readEncoding(r,m.Encoding,m.CharStrings.length)),m.charset&&(m.charset=e.CFF.readCharset(r,m.charset,m.CharStrings.length)),e.CFF._readFDict(r,m,_),m},e.CFF._readFDict=function(r,s,a){var o;for(var l in s.Private&&(o=s.Private[1],s.Private=e.CFF.readDict(r,o,o+s.Private[0]),s.Private.Subrs&&e.CFF.readSubrs(r,o+s.Private.Subrs,s.Private)),s)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(s[l]=a[s[l]-426+35])},e.CFF.readSubrs=function(r,s,a){var o=e._bin,l=[];s=e.CFF.readIndex(r,s,l);var u,c=l.length;u=c<1240?107:c<33900?1131:32768,a.Bias=u,a.Subrs=[];for(var h=0;h<l.length-1;h++)a.Subrs.push(o.readBytes(r,s+l[h],l[h+1]-l[h]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(r,s){for(var a=0;a<r.charset.length;a++)if(r.charset[a]==s)return a;return-1},e.CFF.glyphBySE=function(r,s){return s<0||s>255?-1:e.CFF.glyphByUnicode(r,e.CFF.tableSE[s])},e.CFF.readEncoding=function(r,s,a){e._bin;var o=[".notdef"],l=r[s];if(s++,l!=0)throw"error: unknown encoding format: "+l;var u=r[s];s++;for(var c=0;c<u;c++)o.push(r[s+c]);return o},e.CFF.readCharset=function(r,s,a){var o=e._bin,l=[".notdef"],u=r[s];if(s++,u==0)for(var c=0;c<a;c++){var h=o.readUshort(r,s);s+=2,l.push(h)}else{if(u!=1&&u!=2)throw"error: format: "+u;for(;l.length<a;){h=o.readUshort(r,s),s+=2;var d=0;for(u==1?(d=r[s],s++):(d=o.readUshort(r,s),s+=2),c=0;c<=d;c++)l.push(h),h++}}return l},e.CFF.readIndex=function(r,s,a){var o=e._bin,l=o.readUshort(r,s)+1,u=r[s+=2];if(s++,u==1)for(var c=0;c<l;c++)a.push(r[s+c]);else if(u==2)for(c=0;c<l;c++)a.push(o.readUshort(r,s+2*c));else if(u==3)for(c=0;c<l;c++)a.push(16777215&o.readUint(r,s+3*c-1));else if(l!=1)throw"unsupported offset size: "+u+", count: "+l;return(s+=l*u)-1},e.CFF.getCharString=function(r,s,a){var o=e._bin,l=r[s],u=r[s+1];r[s+2],r[s+3],r[s+4];var c=1,h=null,d=null;l<=20&&(h=l,c=1),l==12&&(h=100*l+u,c=2),21<=l&&l<=27&&(h=l,c=1),l==28&&(d=o.readShort(r,s+1),c=3),29<=l&&l<=31&&(h=l,c=1),32<=l&&l<=246&&(d=l-139,c=1),247<=l&&l<=250&&(d=256*(l-247)+u+108,c=2),251<=l&&l<=254&&(d=256*-(l-251)-u-108,c=2),l==255&&(d=o.readInt(r,s+1)/65535,c=5),a.val=d??"o"+h,a.size=c},e.CFF.readCharString=function(r,s,a){for(var o=s+a,l=e._bin,u=[];s<o;){var c=r[s],h=r[s+1];r[s+2],r[s+3],r[s+4];var d=1,m=null,v=null;c<=20&&(m=c,d=1),c==12&&(m=100*c+h,d=2),c!=19&&c!=20||(m=c,d=2),21<=c&&c<=27&&(m=c,d=1),c==28&&(v=l.readShort(r,s+1),d=3),29<=c&&c<=31&&(m=c,d=1),32<=c&&c<=246&&(v=c-139,d=1),247<=c&&c<=250&&(v=256*(c-247)+h+108,d=2),251<=c&&c<=254&&(v=256*-(c-251)-h-108,d=2),c==255&&(v=l.readInt(r,s+1)/65535,d=5),u.push(v??"o"+m),s+=d}return u},e.CFF.readDict=function(r,s,a){for(var o=e._bin,l={},u=[];s<a;){var c=r[s],h=r[s+1];r[s+2],r[s+3],r[s+4];var d=1,m=null,v=null;if(c==28&&(v=o.readShort(r,s+1),d=3),c==29&&(v=o.readInt(r,s+1),d=5),32<=c&&c<=246&&(v=c-139,d=1),247<=c&&c<=250&&(v=256*(c-247)+h+108,d=2),251<=c&&c<=254&&(v=256*-(c-251)-h-108,d=2),c==255)throw v=o.readInt(r,s+1)/65535,d=5,"unknown number";if(c==30){var _=[];for(d=1;;){var y=r[s+d];d++;var g=y>>4,x=15&y;if(g!=15&&_.push(g),x!=15&&_.push(x),x==15)break}for(var S="",E=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],A=0;A<_.length;A++)S+=E[_[A]];v=parseFloat(S)}c<=21&&(m=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][c],d=1,c==12&&(m=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][h],d=2)),m!=null?(l[m]=u.length==1?u[0]:u,u=[]):u.push(v),s+=d}return l},e.cmap={},e.cmap.parse=function(r,s,a){r=new Uint8Array(r.buffer,s,a),s=0;var o=e._bin,l={};o.readUshort(r,s),s+=2;var u=o.readUshort(r,s);s+=2;var c=[];l.tables=[];for(var h=0;h<u;h++){var d=o.readUshort(r,s);s+=2;var m=o.readUshort(r,s);s+=2;var v=o.readUint(r,s);s+=4;var _="p"+d+"e"+m,y=c.indexOf(v);if(y==-1){var g;y=l.tables.length,c.push(v);var x=o.readUshort(r,v);x==0?g=e.cmap.parse0(r,v):x==4?g=e.cmap.parse4(r,v):x==6?g=e.cmap.parse6(r,v):x==12?g=e.cmap.parse12(r,v):console.debug("unknown format: "+x,d,m,v),l.tables.push(g)}if(l[_]!=null)throw"multiple tables for one platform+encoding";l[_]=y}return l},e.cmap.parse0=function(r,s){var a=e._bin,o={};o.format=a.readUshort(r,s),s+=2;var l=a.readUshort(r,s);s+=2,a.readUshort(r,s),s+=2,o.map=[];for(var u=0;u<l-6;u++)o.map.push(r[s+u]);return o},e.cmap.parse4=function(r,s){var a=e._bin,o=s,l={};l.format=a.readUshort(r,s),s+=2;var u=a.readUshort(r,s);s+=2,a.readUshort(r,s),s+=2;var c=a.readUshort(r,s);s+=2;var h=c/2;l.searchRange=a.readUshort(r,s),s+=2,l.entrySelector=a.readUshort(r,s),s+=2,l.rangeShift=a.readUshort(r,s),s+=2,l.endCount=a.readUshorts(r,s,h),s+=2*h,s+=2,l.startCount=a.readUshorts(r,s,h),s+=2*h,l.idDelta=[];for(var d=0;d<h;d++)l.idDelta.push(a.readShort(r,s)),s+=2;for(l.idRangeOffset=a.readUshorts(r,s,h),s+=2*h,l.glyphIdArray=[];s<o+u;)l.glyphIdArray.push(a.readUshort(r,s)),s+=2;return l},e.cmap.parse6=function(r,s){var a=e._bin,o={};o.format=a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2,a.readUshort(r,s),s+=2,o.firstCode=a.readUshort(r,s),s+=2;var l=a.readUshort(r,s);s+=2,o.glyphIdArray=[];for(var u=0;u<l;u++)o.glyphIdArray.push(a.readUshort(r,s)),s+=2;return o},e.cmap.parse12=function(r,s){var a=e._bin,o={};o.format=a.readUshort(r,s),s+=2,s+=2,a.readUint(r,s),s+=4,a.readUint(r,s),s+=4;var l=a.readUint(r,s);s+=4,o.groups=[];for(var u=0;u<l;u++){var c=s+12*u,h=a.readUint(r,c+0),d=a.readUint(r,c+4),m=a.readUint(r,c+8);o.groups.push([h,d,m])}return o},e.glyf={},e.glyf.parse=function(r,s,a,o){for(var l=[],u=0;u<o.maxp.numGlyphs;u++)l.push(null);return l},e.glyf._parseGlyf=function(r,s){var a=e._bin,o=r._data,l=e._tabOffset(o,"glyf",r._offset)+r.loca[s];if(r.loca[s]==r.loca[s+1])return null;var u={};if(u.noc=a.readShort(o,l),l+=2,u.xMin=a.readShort(o,l),l+=2,u.yMin=a.readShort(o,l),l+=2,u.xMax=a.readShort(o,l),l+=2,u.yMax=a.readShort(o,l),l+=2,u.xMin>=u.xMax||u.yMin>=u.yMax)return null;if(u.noc>0){u.endPts=[];for(var c=0;c<u.noc;c++)u.endPts.push(a.readUshort(o,l)),l+=2;var h=a.readUshort(o,l);if(l+=2,o.length-l<h)return null;u.instructions=a.readBytes(o,l,h),l+=h;var d=u.endPts[u.noc-1]+1;for(u.flags=[],c=0;c<d;c++){var m=o[l];if(l++,u.flags.push(m),(8&m)!=0){var v=o[l];l++;for(var _=0;_<v;_++)u.flags.push(m),c++}}for(u.xs=[],c=0;c<d;c++){var y=(2&u.flags[c])!=0,g=(16&u.flags[c])!=0;y?(u.xs.push(g?o[l]:-o[l]),l++):g?u.xs.push(0):(u.xs.push(a.readShort(o,l)),l+=2)}for(u.ys=[],c=0;c<d;c++)y=(4&u.flags[c])!=0,g=(32&u.flags[c])!=0,y?(u.ys.push(g?o[l]:-o[l]),l++):g?u.ys.push(0):(u.ys.push(a.readShort(o,l)),l+=2);var x=0,S=0;for(c=0;c<d;c++)x+=u.xs[c],S+=u.ys[c],u.xs[c]=x,u.ys[c]=S}else{var E;u.parts=[];do{E=a.readUshort(o,l),l+=2;var A={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(u.parts.push(A),A.glyphIndex=a.readUshort(o,l),l+=2,1&E){var T=a.readShort(o,l);l+=2;var C=a.readShort(o,l);l+=2}else T=a.readInt8(o,l),l++,C=a.readInt8(o,l),l++;2&E?(A.m.tx=T,A.m.ty=C):(A.p1=T,A.p2=C),8&E?(A.m.a=A.m.d=a.readF2dot14(o,l),l+=2):64&E?(A.m.a=a.readF2dot14(o,l),l+=2,A.m.d=a.readF2dot14(o,l),l+=2):128&E&&(A.m.a=a.readF2dot14(o,l),l+=2,A.m.b=a.readF2dot14(o,l),l+=2,A.m.c=a.readF2dot14(o,l),l+=2,A.m.d=a.readF2dot14(o,l),l+=2)}while(32&E);if(256&E){var O=a.readUshort(o,l);for(l+=2,u.instr=[],c=0;c<O;c++)u.instr.push(o[l]),l++}}return u},e.GDEF={},e.GDEF.parse=function(r,s,a,o){var l=s;s+=4;var u=e._bin.readUshort(r,s);return{glyphClassDef:u===0?null:e._lctf.readClassDef(r,l+u)}},e.GPOS={},e.GPOS.parse=function(r,s,a,o){return e._lctf.parse(r,s,a,o,e.GPOS.subt)},e.GPOS.subt=function(r,s,a,o){var l=e._bin,u=a,c={};if(c.fmt=l.readUshort(r,a),a+=2,s==1||s==2||s==3||s==7||s==8&&c.fmt<=2){var h=l.readUshort(r,a);a+=2,c.coverage=e._lctf.readCoverage(r,h+u)}if(s==1&&c.fmt==1){var d=l.readUshort(r,a);a+=2,d!=0&&(c.pos=e.GPOS.readValueRecord(r,a,d))}else if(s==2&&c.fmt>=1&&c.fmt<=2){d=l.readUshort(r,a),a+=2;var m=l.readUshort(r,a);a+=2;var v=e._lctf.numOfOnes(d),_=e._lctf.numOfOnes(m);if(c.fmt==1){c.pairsets=[];var y=l.readUshort(r,a);a+=2;for(var g=0;g<y;g++){var x=u+l.readUshort(r,a);a+=2;var S=l.readUshort(r,x);x+=2;for(var E=[],A=0;A<S;A++){var T=l.readUshort(r,x);x+=2,d!=0&&(F=e.GPOS.readValueRecord(r,x,d),x+=2*v),m!=0&&(G=e.GPOS.readValueRecord(r,x,m),x+=2*_),E.push({gid2:T,val1:F,val2:G})}c.pairsets.push(E)}}if(c.fmt==2){var C=l.readUshort(r,a);a+=2;var O=l.readUshort(r,a);a+=2;var M=l.readUshort(r,a);a+=2;var D=l.readUshort(r,a);for(a+=2,c.classDef1=e._lctf.readClassDef(r,u+C),c.classDef2=e._lctf.readClassDef(r,u+O),c.matrix=[],g=0;g<M;g++){var P=[];for(A=0;A<D;A++){var F=null,G=null;d!=0&&(F=e.GPOS.readValueRecord(r,a,d),a+=2*v),m!=0&&(G=e.GPOS.readValueRecord(r,a,m),a+=2*_),P.push({val1:F,val2:G})}c.matrix.push(P)}}}else if(s==4&&c.fmt==1)c.markCoverage=e._lctf.readCoverage(r,l.readUshort(r,a)+u),c.baseCoverage=e._lctf.readCoverage(r,l.readUshort(r,a+2)+u),c.markClassCount=l.readUshort(r,a+4),c.markArray=e.GPOS.readMarkArray(r,l.readUshort(r,a+6)+u),c.baseArray=e.GPOS.readBaseArray(r,l.readUshort(r,a+8)+u,c.markClassCount);else if(s==6&&c.fmt==1)c.mark1Coverage=e._lctf.readCoverage(r,l.readUshort(r,a)+u),c.mark2Coverage=e._lctf.readCoverage(r,l.readUshort(r,a+2)+u),c.markClassCount=l.readUshort(r,a+4),c.mark1Array=e.GPOS.readMarkArray(r,l.readUshort(r,a+6)+u),c.mark2Array=e.GPOS.readBaseArray(r,l.readUshort(r,a+8)+u,c.markClassCount);else{if(s==9&&c.fmt==1){var z=l.readUshort(r,a);a+=2;var Y=l.readUint(r,a);if(a+=4,o.ltype==9)o.ltype=z;else if(o.ltype!=z)throw"invalid extension substitution";return e.GPOS.subt(r,o.ltype,u+Y)}console.debug("unsupported GPOS table LookupType",s,"format",c.fmt)}return c},e.GPOS.readValueRecord=function(r,s,a){var o=e._bin,l=[];return l.push(1&a?o.readShort(r,s):0),s+=1&a?2:0,l.push(2&a?o.readShort(r,s):0),s+=2&a?2:0,l.push(4&a?o.readShort(r,s):0),s+=4&a?2:0,l.push(8&a?o.readShort(r,s):0),s+=8&a?2:0,l},e.GPOS.readBaseArray=function(r,s,a){var o=e._bin,l=[],u=s,c=o.readUshort(r,s);s+=2;for(var h=0;h<c;h++){for(var d=[],m=0;m<a;m++)d.push(e.GPOS.readAnchorRecord(r,u+o.readUshort(r,s))),s+=2;l.push(d)}return l},e.GPOS.readMarkArray=function(r,s){var a=e._bin,o=[],l=s,u=a.readUshort(r,s);s+=2;for(var c=0;c<u;c++){var h=e.GPOS.readAnchorRecord(r,a.readUshort(r,s+2)+l);h.markClass=a.readUshort(r,s),o.push(h),s+=4}return o},e.GPOS.readAnchorRecord=function(r,s){var a=e._bin,o={};return o.fmt=a.readUshort(r,s),o.x=a.readShort(r,s+2),o.y=a.readShort(r,s+4),o},e.GSUB={},e.GSUB.parse=function(r,s,a,o){return e._lctf.parse(r,s,a,o,e.GSUB.subt)},e.GSUB.subt=function(r,s,a,o){var l=e._bin,u=a,c={};if(c.fmt=l.readUshort(r,a),a+=2,s!=1&&s!=2&&s!=4&&s!=5&&s!=6)return null;if(s==1||s==2||s==4||s==5&&c.fmt<=2||s==6&&c.fmt<=2){var h=l.readUshort(r,a);a+=2,c.coverage=e._lctf.readCoverage(r,u+h)}if(s==1&&c.fmt>=1&&c.fmt<=2){if(c.fmt==1)c.delta=l.readShort(r,a),a+=2;else if(c.fmt==2){var d=l.readUshort(r,a);a+=2,c.newg=l.readUshorts(r,a,d),a+=2*c.newg.length}}else if(s==2&&c.fmt==1){d=l.readUshort(r,a),a+=2,c.seqs=[];for(var m=0;m<d;m++){var v=l.readUshort(r,a)+u;a+=2;var _=l.readUshort(r,v);c.seqs.push(l.readUshorts(r,v+2,_))}}else if(s==4)for(c.vals=[],d=l.readUshort(r,a),a+=2,m=0;m<d;m++){var y=l.readUshort(r,a);a+=2,c.vals.push(e.GSUB.readLigatureSet(r,u+y))}else if(s==5&&c.fmt==2){if(c.fmt==2){var g=l.readUshort(r,a);a+=2,c.cDef=e._lctf.readClassDef(r,u+g),c.scset=[];var x=l.readUshort(r,a);for(a+=2,m=0;m<x;m++){var S=l.readUshort(r,a);a+=2,c.scset.push(S==0?null:e.GSUB.readSubClassSet(r,u+S))}}}else if(s==6&&c.fmt==3){if(c.fmt==3){for(m=0;m<3;m++){d=l.readUshort(r,a),a+=2;for(var E=[],A=0;A<d;A++)E.push(e._lctf.readCoverage(r,u+l.readUshort(r,a+2*A)));a+=2*d,m==0&&(c.backCvg=E),m==1&&(c.inptCvg=E),m==2&&(c.ahedCvg=E)}d=l.readUshort(r,a),a+=2,c.lookupRec=e.GSUB.readSubstLookupRecords(r,a,d)}}else{if(s==7&&c.fmt==1){var T=l.readUshort(r,a);a+=2;var C=l.readUint(r,a);if(a+=4,o.ltype==9)o.ltype=T;else if(o.ltype!=T)throw"invalid extension substitution";return e.GSUB.subt(r,o.ltype,u+C)}console.debug("unsupported GSUB table LookupType",s,"format",c.fmt)}return c},e.GSUB.readSubClassSet=function(r,s){var a=e._bin.readUshort,o=s,l=[],u=a(r,s);s+=2;for(var c=0;c<u;c++){var h=a(r,s);s+=2,l.push(e.GSUB.readSubClassRule(r,o+h))}return l},e.GSUB.readSubClassRule=function(r,s){var a=e._bin.readUshort,o={},l=a(r,s),u=a(r,s+=2);s+=2,o.input=[];for(var c=0;c<l-1;c++)o.input.push(a(r,s)),s+=2;return o.substLookupRecords=e.GSUB.readSubstLookupRecords(r,s,u),o},e.GSUB.readSubstLookupRecords=function(r,s,a){for(var o=e._bin.readUshort,l=[],u=0;u<a;u++)l.push(o(r,s),o(r,s+2)),s+=4;return l},e.GSUB.readChainSubClassSet=function(r,s){var a=e._bin,o=s,l=[],u=a.readUshort(r,s);s+=2;for(var c=0;c<u;c++){var h=a.readUshort(r,s);s+=2,l.push(e.GSUB.readChainSubClassRule(r,o+h))}return l},e.GSUB.readChainSubClassRule=function(r,s){for(var a=e._bin,o={},l=["backtrack","input","lookahead"],u=0;u<l.length;u++){var c=a.readUshort(r,s);s+=2,u==1&&c--,o[l[u]]=a.readUshorts(r,s,c),s+=2*o[l[u]].length}return c=a.readUshort(r,s),s+=2,o.subst=a.readUshorts(r,s,2*c),s+=2*o.subst.length,o},e.GSUB.readLigatureSet=function(r,s){var a=e._bin,o=s,l=[],u=a.readUshort(r,s);s+=2;for(var c=0;c<u;c++){var h=a.readUshort(r,s);s+=2,l.push(e.GSUB.readLigature(r,o+h))}return l},e.GSUB.readLigature=function(r,s){var a=e._bin,o={chain:[]};o.nglyph=a.readUshort(r,s),s+=2;var l=a.readUshort(r,s);s+=2;for(var u=0;u<l-1;u++)o.chain.push(a.readUshort(r,s)),s+=2;return o},e.head={},e.head.parse=function(r,s,a){var o=e._bin,l={};return o.readFixed(r,s),s+=4,l.fontRevision=o.readFixed(r,s),s+=4,o.readUint(r,s),s+=4,o.readUint(r,s),s+=4,l.flags=o.readUshort(r,s),s+=2,l.unitsPerEm=o.readUshort(r,s),s+=2,l.created=o.readUint64(r,s),s+=8,l.modified=o.readUint64(r,s),s+=8,l.xMin=o.readShort(r,s),s+=2,l.yMin=o.readShort(r,s),s+=2,l.xMax=o.readShort(r,s),s+=2,l.yMax=o.readShort(r,s),s+=2,l.macStyle=o.readUshort(r,s),s+=2,l.lowestRecPPEM=o.readUshort(r,s),s+=2,l.fontDirectionHint=o.readShort(r,s),s+=2,l.indexToLocFormat=o.readShort(r,s),s+=2,l.glyphDataFormat=o.readShort(r,s),s+=2,l},e.hhea={},e.hhea.parse=function(r,s,a){var o=e._bin,l={};return o.readFixed(r,s),s+=4,l.ascender=o.readShort(r,s),s+=2,l.descender=o.readShort(r,s),s+=2,l.lineGap=o.readShort(r,s),s+=2,l.advanceWidthMax=o.readUshort(r,s),s+=2,l.minLeftSideBearing=o.readShort(r,s),s+=2,l.minRightSideBearing=o.readShort(r,s),s+=2,l.xMaxExtent=o.readShort(r,s),s+=2,l.caretSlopeRise=o.readShort(r,s),s+=2,l.caretSlopeRun=o.readShort(r,s),s+=2,l.caretOffset=o.readShort(r,s),s+=2,s+=8,l.metricDataFormat=o.readShort(r,s),s+=2,l.numberOfHMetrics=o.readUshort(r,s),s+=2,l},e.hmtx={},e.hmtx.parse=function(r,s,a,o){for(var l=e._bin,u={aWidth:[],lsBearing:[]},c=0,h=0,d=0;d<o.maxp.numGlyphs;d++)d<o.hhea.numberOfHMetrics&&(c=l.readUshort(r,s),s+=2,h=l.readShort(r,s),s+=2),u.aWidth.push(c),u.lsBearing.push(h);return u},e.kern={},e.kern.parse=function(r,s,a,o){var l=e._bin,u=l.readUshort(r,s);if(s+=2,u==1)return e.kern.parseV1(r,s-2,a,o);var c=l.readUshort(r,s);s+=2;for(var h={glyph1:[],rval:[]},d=0;d<c;d++){s+=2,a=l.readUshort(r,s),s+=2;var m=l.readUshort(r,s);s+=2;var v=m>>>8;if((v&=15)!=0)throw"unknown kern table format: "+v;s=e.kern.readFormat0(r,s,h)}return h},e.kern.parseV1=function(r,s,a,o){var l=e._bin;l.readFixed(r,s),s+=4;var u=l.readUint(r,s);s+=4;for(var c={glyph1:[],rval:[]},h=0;h<u;h++){l.readUint(r,s),s+=4;var d=l.readUshort(r,s);s+=2,l.readUshort(r,s),s+=2;var m=d>>>8;if((m&=15)!=0)throw"unknown kern table format: "+m;s=e.kern.readFormat0(r,s,c)}return c},e.kern.readFormat0=function(r,s,a){var o=e._bin,l=-1,u=o.readUshort(r,s);s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2,o.readUshort(r,s),s+=2;for(var c=0;c<u;c++){var h=o.readUshort(r,s);s+=2;var d=o.readUshort(r,s);s+=2;var m=o.readShort(r,s);s+=2,h!=l&&(a.glyph1.push(h),a.rval.push({glyph2:[],vals:[]}));var v=a.rval[a.rval.length-1];v.glyph2.push(d),v.vals.push(m),l=h}return s},e.loca={},e.loca.parse=function(r,s,a,o){var l=e._bin,u=[],c=o.head.indexToLocFormat,h=o.maxp.numGlyphs+1;if(c==0)for(var d=0;d<h;d++)u.push(l.readUshort(r,s+(d<<1))<<1);if(c==1)for(d=0;d<h;d++)u.push(l.readUint(r,s+(d<<2)));return u},e.maxp={},e.maxp.parse=function(r,s,a){var o=e._bin,l={},u=o.readUint(r,s);return s+=4,l.numGlyphs=o.readUshort(r,s),s+=2,u==65536&&(l.maxPoints=o.readUshort(r,s),s+=2,l.maxContours=o.readUshort(r,s),s+=2,l.maxCompositePoints=o.readUshort(r,s),s+=2,l.maxCompositeContours=o.readUshort(r,s),s+=2,l.maxZones=o.readUshort(r,s),s+=2,l.maxTwilightPoints=o.readUshort(r,s),s+=2,l.maxStorage=o.readUshort(r,s),s+=2,l.maxFunctionDefs=o.readUshort(r,s),s+=2,l.maxInstructionDefs=o.readUshort(r,s),s+=2,l.maxStackElements=o.readUshort(r,s),s+=2,l.maxSizeOfInstructions=o.readUshort(r,s),s+=2,l.maxComponentElements=o.readUshort(r,s),s+=2,l.maxComponentDepth=o.readUshort(r,s),s+=2),l},e.name={},e.name.parse=function(r,s,a){var o=e._bin,l={};o.readUshort(r,s),s+=2;var u=o.readUshort(r,s);s+=2,o.readUshort(r,s);for(var c,h=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],d=s+=2,m=0;m<u;m++){var v=o.readUshort(r,s);s+=2;var _=o.readUshort(r,s);s+=2;var y=o.readUshort(r,s);s+=2;var g=o.readUshort(r,s);s+=2;var x=o.readUshort(r,s);s+=2;var S=o.readUshort(r,s);s+=2;var E,A=h[g],T=d+12*u+S;if(v==0)E=o.readUnicode(r,T,x/2);else if(v==3&&_==0)E=o.readUnicode(r,T,x/2);else if(_==0)E=o.readASCII(r,T,x);else if(_==1)E=o.readUnicode(r,T,x/2);else if(_==3)E=o.readUnicode(r,T,x/2);else{if(v!=1)throw"unknown encoding "+_+", platformID: "+v;E=o.readASCII(r,T,x),console.debug("reading unknown MAC encoding "+_+" as ASCII")}var C="p"+v+","+y.toString(16);l[C]==null&&(l[C]={}),l[C][A!==void 0?A:g]=E,l[C]._lang=y}for(var O in l)if(l[O].postScriptName!=null&&l[O]._lang==1033)return l[O];for(var O in l)if(l[O].postScriptName!=null&&l[O]._lang==0)return l[O];for(var O in l)if(l[O].postScriptName!=null&&l[O]._lang==3084)return l[O];for(var O in l)if(l[O].postScriptName!=null)return l[O];for(var O in l){c=O;break}return console.debug("returning name table with languageID "+l[c]._lang),l[c]},e["OS/2"]={},e["OS/2"].parse=function(r,s,a){var o=e._bin.readUshort(r,s);s+=2;var l={};if(o==0)e["OS/2"].version0(r,s,l);else if(o==1)e["OS/2"].version1(r,s,l);else if(o==2||o==3||o==4)e["OS/2"].version2(r,s,l);else{if(o!=5)throw"unknown OS/2 table version: "+o;e["OS/2"].version5(r,s,l)}return l},e["OS/2"].version0=function(r,s,a){var o=e._bin;return a.xAvgCharWidth=o.readShort(r,s),s+=2,a.usWeightClass=o.readUshort(r,s),s+=2,a.usWidthClass=o.readUshort(r,s),s+=2,a.fsType=o.readUshort(r,s),s+=2,a.ySubscriptXSize=o.readShort(r,s),s+=2,a.ySubscriptYSize=o.readShort(r,s),s+=2,a.ySubscriptXOffset=o.readShort(r,s),s+=2,a.ySubscriptYOffset=o.readShort(r,s),s+=2,a.ySuperscriptXSize=o.readShort(r,s),s+=2,a.ySuperscriptYSize=o.readShort(r,s),s+=2,a.ySuperscriptXOffset=o.readShort(r,s),s+=2,a.ySuperscriptYOffset=o.readShort(r,s),s+=2,a.yStrikeoutSize=o.readShort(r,s),s+=2,a.yStrikeoutPosition=o.readShort(r,s),s+=2,a.sFamilyClass=o.readShort(r,s),s+=2,a.panose=o.readBytes(r,s,10),s+=10,a.ulUnicodeRange1=o.readUint(r,s),s+=4,a.ulUnicodeRange2=o.readUint(r,s),s+=4,a.ulUnicodeRange3=o.readUint(r,s),s+=4,a.ulUnicodeRange4=o.readUint(r,s),s+=4,a.achVendID=[o.readInt8(r,s),o.readInt8(r,s+1),o.readInt8(r,s+2),o.readInt8(r,s+3)],s+=4,a.fsSelection=o.readUshort(r,s),s+=2,a.usFirstCharIndex=o.readUshort(r,s),s+=2,a.usLastCharIndex=o.readUshort(r,s),s+=2,a.sTypoAscender=o.readShort(r,s),s+=2,a.sTypoDescender=o.readShort(r,s),s+=2,a.sTypoLineGap=o.readShort(r,s),s+=2,a.usWinAscent=o.readUshort(r,s),s+=2,a.usWinDescent=o.readUshort(r,s),s+=2},e["OS/2"].version1=function(r,s,a){var o=e._bin;return s=e["OS/2"].version0(r,s,a),a.ulCodePageRange1=o.readUint(r,s),s+=4,a.ulCodePageRange2=o.readUint(r,s),s+=4},e["OS/2"].version2=function(r,s,a){var o=e._bin;return s=e["OS/2"].version1(r,s,a),a.sxHeight=o.readShort(r,s),s+=2,a.sCapHeight=o.readShort(r,s),s+=2,a.usDefault=o.readUshort(r,s),s+=2,a.usBreak=o.readUshort(r,s),s+=2,a.usMaxContext=o.readUshort(r,s),s+=2},e["OS/2"].version5=function(r,s,a){var o=e._bin;return s=e["OS/2"].version2(r,s,a),a.usLowerOpticalPointSize=o.readUshort(r,s),s+=2,a.usUpperOpticalPointSize=o.readUshort(r,s),s+=2},e.post={},e.post.parse=function(r,s,a){var o=e._bin,l={};return l.version=o.readFixed(r,s),s+=4,l.italicAngle=o.readFixed(r,s),s+=4,l.underlinePosition=o.readShort(r,s),s+=2,l.underlineThickness=o.readShort(r,s),s+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(r,s){var a=r.cmap,o=-1;if(a.p0e4!=null?o=a.p0e4:a.p3e1!=null?o=a.p3e1:a.p1e0!=null?o=a.p1e0:a.p0e3!=null&&(o=a.p0e3),o==-1)throw"no familiar platform and encoding!";var l=a.tables[o];if(l.format==0)return s>=l.map.length?0:l.map[s];if(l.format==4){for(var u=-1,c=0;c<l.endCount.length;c++)if(s<=l.endCount[c]){u=c;break}return u==-1||l.startCount[u]>s?0:65535&(l.idRangeOffset[u]!=0?l.glyphIdArray[s-l.startCount[u]+(l.idRangeOffset[u]>>1)-(l.idRangeOffset.length-u)]:s+l.idDelta[u])}if(l.format==12){if(s>l.groups[l.groups.length-1][1])return 0;for(c=0;c<l.groups.length;c++){var h=l.groups[c];if(h[0]<=s&&s<=h[1])return h[2]+(s-h[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(r,s){var a={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[s]){var o=r.SVG.entries[s];return o==null?a:(typeof o=="string"&&(o=e.SVG.toPath(o),r.SVG.entries[s]=o),o)}if(r.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},u=r.CFF,c=r.CFF.Private;if(u.ROS){for(var h=0;u.FDSelect[h+2]<=s;)h+=2;c=u.FDArray[u.FDSelect[h+1]].Private}e.U._drawCFF(r.CFF.CharStrings[s],l,u,c,a)}else r.glyf&&e.U._drawGlyf(s,r,a);return a},e.U._drawGlyf=function(r,s,a){var o=s.glyf[r];o==null&&(o=s.glyf[r]=e.glyf._parseGlyf(s,r)),o!=null&&(o.noc>-1?e.U._simpleGlyph(o,a):e.U._compoGlyph(o,s,a))},e.U._simpleGlyph=function(r,s){for(var a=0;a<r.noc;a++){for(var o=a==0?0:r.endPts[a-1]+1,l=r.endPts[a],u=o;u<=l;u++){var c=u==o?l:u-1,h=u==l?o:u+1,d=1&r.flags[u],m=1&r.flags[c],v=1&r.flags[h],_=r.xs[u],y=r.ys[u];if(u==o)if(d){if(!m){e.U.P.moveTo(s,_,y);continue}e.U.P.moveTo(s,r.xs[c],r.ys[c])}else m?e.U.P.moveTo(s,r.xs[c],r.ys[c]):e.U.P.moveTo(s,(r.xs[c]+_)/2,(r.ys[c]+y)/2);d?m&&e.U.P.lineTo(s,_,y):v?e.U.P.qcurveTo(s,_,y,r.xs[h],r.ys[h]):e.U.P.qcurveTo(s,_,y,(_+r.xs[h])/2,(y+r.ys[h])/2)}e.U.P.closePath(s)}},e.U._compoGlyph=function(r,s,a){for(var o=0;o<r.parts.length;o++){var l={cmds:[],crds:[]},u=r.parts[o];e.U._drawGlyf(u.glyphIndex,s,l);for(var c=u.m,h=0;h<l.crds.length;h+=2){var d=l.crds[h],m=l.crds[h+1];a.crds.push(d*c.a+m*c.b+c.tx),a.crds.push(d*c.c+m*c.d+c.ty)}for(h=0;h<l.cmds.length;h++)a.cmds.push(l.cmds[h])}},e.U._getGlyphClass=function(r,s){var a=e._lctf.getInterval(s,r);return a==-1?0:s[a+2]},e.U._applySubs=function(r,s,a,o){for(var l=r.length-s-1,u=0;u<a.tabs.length;u++)if(a.tabs[u]!=null){var c,h=a.tabs[u];if(!h.coverage||(c=e._lctf.coverageIndex(h.coverage,r[s]))!=-1){if(a.ltype==1)r[s],h.fmt==1?r[s]=r[s]+h.delta:r[s]=h.newg[c];else if(a.ltype==4)for(var d=h.vals[c],m=0;m<d.length;m++){var v=d[m],_=v.chain.length;if(!(_>l)){for(var y=!0,g=0,x=0;x<_;x++){for(;r[s+g+(1+x)]==-1;)g++;v.chain[x]!=r[s+g+(1+x)]&&(y=!1)}if(y){for(r[s]=v.nglyph,x=0;x<_+g;x++)r[s+x+1]=-1;break}}}else if(a.ltype==5&&h.fmt==2)for(var S=e._lctf.getInterval(h.cDef,r[s]),E=h.cDef[S+2],A=h.scset[E],T=0;T<A.length;T++){var C=A[T],O=C.input;if(!(O.length>l)){for(y=!0,x=0;x<O.length;x++){var M=e._lctf.getInterval(h.cDef,r[s+1+x]);if(S==-1&&h.cDef[M+2]!=O[x]){y=!1;break}}if(y){var D=C.substLookupRecords;for(m=0;m<D.length;m+=2)D[m],D[m+1]}}}else if(a.ltype==6&&h.fmt==3){if(!e.U._glsCovered(r,h.backCvg,s-h.backCvg.length)||!e.U._glsCovered(r,h.inptCvg,s)||!e.U._glsCovered(r,h.ahedCvg,s+h.inptCvg.length))continue;var P=h.lookupRec;for(T=0;T<P.length;T+=2){S=P[T];var F=o[P[T+1]];e.U._applySubs(r,s+S,F,o)}}}}},e.U._glsCovered=function(r,s,a){for(var o=0;o<s.length;o++)if(e._lctf.coverageIndex(s[o],r[a+o])==-1)return!1;return!0},e.U.glyphsToPath=function(r,s,a){for(var o={cmds:[],crds:[]},l=0,u=0;u<s.length;u++){var c=s[u];if(c!=-1){for(var h=u<s.length-1&&s[u+1]!=-1?s[u+1]:0,d=e.U.glyphToPath(r,c),m=0;m<d.crds.length;m+=2)o.crds.push(d.crds[m]+l),o.crds.push(d.crds[m+1]);for(a&&o.cmds.push(a),m=0;m<d.cmds.length;m++)o.cmds.push(d.cmds[m]);a&&o.cmds.push("X"),l+=r.hmtx.aWidth[c],u<s.length-1&&(l+=e.U.getPairAdjustment(r,c,h))}}return o},e.U.P={},e.U.P.moveTo=function(r,s,a){r.cmds.push("M"),r.crds.push(s,a)},e.U.P.lineTo=function(r,s,a){r.cmds.push("L"),r.crds.push(s,a)},e.U.P.curveTo=function(r,s,a,o,l,u,c){r.cmds.push("C"),r.crds.push(s,a,o,l,u,c)},e.U.P.qcurveTo=function(r,s,a,o,l){r.cmds.push("Q"),r.crds.push(s,a,o,l)},e.U.P.closePath=function(r){r.cmds.push("Z")},e.U._drawCFF=function(r,s,a,o,l){for(var u=s.stack,c=s.nStems,h=s.haveWidth,d=s.width,m=s.open,v=0,_=s.x,y=s.y,g=0,x=0,S=0,E=0,A=0,T=0,C=0,O=0,M=0,D=0,P={val:0,size:0};v<r.length;){e.CFF.getCharString(r,v,P);var F=P.val;if(v+=P.size,F=="o1"||F=="o18")u.length%2!=0&&!h&&(d=u.shift()+o.nominalWidthX),c+=u.length>>1,u.length=0,h=!0;else if(F=="o3"||F=="o23")u.length%2!=0&&!h&&(d=u.shift()+o.nominalWidthX),c+=u.length>>1,u.length=0,h=!0;else if(F=="o4")u.length>1&&!h&&(d=u.shift()+o.nominalWidthX,h=!0),m&&e.U.P.closePath(l),y+=u.pop(),e.U.P.moveTo(l,_,y),m=!0;else if(F=="o5")for(;u.length>0;)_+=u.shift(),y+=u.shift(),e.U.P.lineTo(l,_,y);else if(F=="o6"||F=="o7")for(var G=u.length,z=F=="o6",Y=0;Y<G;Y++){var N=u.shift();z?_+=N:y+=N,z=!z,e.U.P.lineTo(l,_,y)}else if(F=="o8"||F=="o24"){G=u.length;for(var k=0;k+6<=G;)g=_+u.shift(),x=y+u.shift(),S=g+u.shift(),E=x+u.shift(),_=S+u.shift(),y=E+u.shift(),e.U.P.curveTo(l,g,x,S,E,_,y),k+=6;F=="o24"&&(_+=u.shift(),y+=u.shift(),e.U.P.lineTo(l,_,y))}else{if(F=="o11")break;if(F=="o1234"||F=="o1235"||F=="o1236"||F=="o1237")F=="o1234"&&(x=y,S=(g=_+u.shift())+u.shift(),D=E=x+u.shift(),T=E,O=y,_=(C=(A=(M=S+u.shift())+u.shift())+u.shift())+u.shift(),e.U.P.curveTo(l,g,x,S,E,M,D),e.U.P.curveTo(l,A,T,C,O,_,y)),F=="o1235"&&(g=_+u.shift(),x=y+u.shift(),S=g+u.shift(),E=x+u.shift(),M=S+u.shift(),D=E+u.shift(),A=M+u.shift(),T=D+u.shift(),C=A+u.shift(),O=T+u.shift(),_=C+u.shift(),y=O+u.shift(),u.shift(),e.U.P.curveTo(l,g,x,S,E,M,D),e.U.P.curveTo(l,A,T,C,O,_,y)),F=="o1236"&&(g=_+u.shift(),x=y+u.shift(),S=g+u.shift(),D=E=x+u.shift(),T=E,C=(A=(M=S+u.shift())+u.shift())+u.shift(),O=T+u.shift(),_=C+u.shift(),e.U.P.curveTo(l,g,x,S,E,M,D),e.U.P.curveTo(l,A,T,C,O,_,y)),F=="o1237"&&(g=_+u.shift(),x=y+u.shift(),S=g+u.shift(),E=x+u.shift(),M=S+u.shift(),D=E+u.shift(),A=M+u.shift(),T=D+u.shift(),C=A+u.shift(),O=T+u.shift(),Math.abs(C-_)>Math.abs(O-y)?_=C+u.shift():y=O+u.shift(),e.U.P.curveTo(l,g,x,S,E,M,D),e.U.P.curveTo(l,A,T,C,O,_,y));else if(F=="o14"){if(u.length>0&&!h&&(d=u.shift()+a.nominalWidthX,h=!0),u.length==4){var j=u.shift(),X=u.shift(),Q=u.shift(),H=u.shift(),$=e.CFF.glyphBySE(a,Q),ne=e.CFF.glyphBySE(a,H);e.U._drawCFF(a.CharStrings[$],s,a,o,l),s.x=j,s.y=X,e.U._drawCFF(a.CharStrings[ne],s,a,o,l)}m&&(e.U.P.closePath(l),m=!1)}else if(F=="o19"||F=="o20")u.length%2!=0&&!h&&(d=u.shift()+o.nominalWidthX),c+=u.length>>1,u.length=0,h=!0,v+=c+7>>3;else if(F=="o21")u.length>2&&!h&&(d=u.shift()+o.nominalWidthX,h=!0),y+=u.pop(),_+=u.pop(),m&&e.U.P.closePath(l),e.U.P.moveTo(l,_,y),m=!0;else if(F=="o22")u.length>1&&!h&&(d=u.shift()+o.nominalWidthX,h=!0),_+=u.pop(),m&&e.U.P.closePath(l),e.U.P.moveTo(l,_,y),m=!0;else if(F=="o25"){for(;u.length>6;)_+=u.shift(),y+=u.shift(),e.U.P.lineTo(l,_,y);g=_+u.shift(),x=y+u.shift(),S=g+u.shift(),E=x+u.shift(),_=S+u.shift(),y=E+u.shift(),e.U.P.curveTo(l,g,x,S,E,_,y)}else if(F=="o26")for(u.length%2&&(_+=u.shift());u.length>0;)g=_,x=y+u.shift(),_=S=g+u.shift(),y=(E=x+u.shift())+u.shift(),e.U.P.curveTo(l,g,x,S,E,_,y);else if(F=="o27")for(u.length%2&&(y+=u.shift());u.length>0;)x=y,S=(g=_+u.shift())+u.shift(),E=x+u.shift(),_=S+u.shift(),y=E,e.U.P.curveTo(l,g,x,S,E,_,y);else if(F=="o10"||F=="o29"){var q=F=="o10"?o:a;if(u.length==0)console.debug("error: empty stack");else{var se=u.pop(),ve=q.Subrs[se+q.Bias];s.x=_,s.y=y,s.nStems=c,s.haveWidth=h,s.width=d,s.open=m,e.U._drawCFF(ve,s,a,o,l),_=s.x,y=s.y,c=s.nStems,h=s.haveWidth,d=s.width,m=s.open}}else if(F=="o30"||F=="o31"){var pe=u.length,xe=(k=0,F=="o31");for(k+=pe-(G=-3&pe);k<G;)xe?(x=y,S=(g=_+u.shift())+u.shift(),y=(E=x+u.shift())+u.shift(),G-k==5?(_=S+u.shift(),k++):_=S,xe=!1):(g=_,x=y+u.shift(),S=g+u.shift(),E=x+u.shift(),_=S+u.shift(),G-k==5?(y=E+u.shift(),k++):y=E,xe=!0),e.U.P.curveTo(l,g,x,S,E,_,y),k+=4}else{if((F+"").charAt(0)=="o")throw console.debug("Unknown operation: "+F,r),F;u.push(F)}}}s.x=_,s.y=y,s.nStems=c,s.haveWidth=h,s.width=d,s.open=m};var n=e,i={Typr:n};return t.Typr=n,t.default=i,Object.defineProperty(t,"__esModule",{value:!0}),t}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Ede(){return function(t){var e=Uint8Array,n=Uint16Array,i=Uint32Array,r=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=function(F,G){for(var z=new n(31),Y=0;Y<31;++Y)z[Y]=G+=1<<F[Y-1];var N=new i(z[30]);for(Y=1;Y<30;++Y)for(var k=z[Y];k<z[Y+1];++k)N[k]=k-z[Y]<<5|Y;return[z,N]},l=o(r,2),u=l[0],c=l[1];u[28]=258,c[258]=28;for(var h=o(s,0)[0],d=new n(32768),m=0;m<32768;++m){var v=(43690&m)>>>1|(21845&m)<<1;v=(61680&(v=(52428&v)>>>2|(13107&v)<<2))>>>4|(3855&v)<<4,d[m]=((65280&v)>>>8|(255&v)<<8)>>>1}var _=function(F,G,z){for(var Y=F.length,N=0,k=new n(G);N<Y;++N)++k[F[N]-1];var j,X=new n(G);for(N=0;N<G;++N)X[N]=X[N-1]+k[N-1]<<1;{j=new n(1<<G);var Q=15-G;for(N=0;N<Y;++N)if(F[N])for(var H=N<<4|F[N],$=G-F[N],ne=X[F[N]-1]++<<$,q=ne|(1<<$)-1;ne<=q;++ne)j[d[ne]>>>Q]=H}return j},y=new e(288);for(m=0;m<144;++m)y[m]=8;for(m=144;m<256;++m)y[m]=9;for(m=256;m<280;++m)y[m]=7;for(m=280;m<288;++m)y[m]=8;var g=new e(32);for(m=0;m<32;++m)g[m]=5;var x=_(y,9),S=_(g,5),E=function(F){for(var G=F[0],z=1;z<F.length;++z)F[z]>G&&(G=F[z]);return G},A=function(F,G,z){var Y=G/8|0;return(F[Y]|F[Y+1]<<8)>>(7&G)&z},T=function(F,G){var z=G/8|0;return(F[z]|F[z+1]<<8|F[z+2]<<16)>>(7&G)},C=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],O=function(F,G,z){var Y=new Error(G||C[F]);if(Y.code=F,Error.captureStackTrace&&Error.captureStackTrace(Y,O),!z)throw Y;return Y},M=function(F,G,z){var Y=F.length;if(!Y||z&&!z.l&&Y<5)return G||new e(0);var N=!G||z,k=!z||z.i;z||(z={}),G||(G=new e(3*Y));var j,X=function(ut){var xn=G.length;if(ut>xn){var un=new e(Math.max(2*xn,ut));un.set(G),G=un}},Q=z.f||0,H=z.p||0,$=z.b||0,ne=z.l,q=z.d,se=z.m,ve=z.n,pe=8*Y;do{if(!ne){z.f=Q=A(F,H,1);var xe=A(F,H+1,3);if(H+=3,!xe){var ot=F[(ke=((j=H)/8|0)+(7&j&&1)+4)-4]|F[ke-3]<<8,st=ke+ot;if(st>Y){k&&O(0);break}N&&X($+ot),G.set(F.subarray(ke,st),$),z.b=$+=ot,z.p=H=8*st;continue}if(xe==1)ne=x,q=S,se=9,ve=5;else if(xe==2){var et=A(F,H,31)+257,Te=A(F,H+10,15)+4,Xe=et+A(F,H+5,31)+1;H+=14;for(var K=new e(Xe),Pe=new e(19),Ne=0;Ne<Te;++Ne)Pe[a[Ne]]=A(F,H+3*Ne,7);H+=3*Te;var Ve=E(Pe),_e=(1<<Ve)-1,ft=_(Pe,Ve);for(Ne=0;Ne<Xe;){var ke,Z=ft[A(F,H,_e)];if(H+=15&Z,(ke=Z>>>4)<16)K[Ne++]=ke;else{var W=0,I=0;for(ke==16?(I=3+A(F,H,3),H+=2,W=K[Ne-1]):ke==17?(I=3+A(F,H,7),H+=3):ke==18&&(I=11+A(F,H,127),H+=7);I--;)K[Ne++]=W}}var De=K.subarray(0,et),ge=K.subarray(et);se=E(De),ve=E(ge),ne=_(De,se),q=_(ge,ve)}else O(1);if(H>pe){k&&O(0);break}}N&&X($+131072);for(var ze=(1<<se)-1,ct=(1<<ve)-1,at=H;;at=H){var Rt=(W=ne[T(F,H)&ze])>>>4;if((H+=15&W)>pe){k&&O(0);break}if(W||O(2),Rt<256)G[$++]=Rt;else{if(Rt==256){at=H,ne=null;break}var Nt=Rt-254;if(Rt>264){var vt=r[Ne=Rt-257];Nt=A(F,H,(1<<vt)-1)+u[Ne],H+=vt}var Vt=q[T(F,H)&ct],Bt=Vt>>>4;if(Vt||O(3),H+=15&Vt,ge=h[Bt],Bt>3&&(vt=s[Bt],ge+=T(F,H)&(1<<vt)-1,H+=vt),H>pe){k&&O(0);break}N&&X($+131072);for(var Ht=$+Nt;$<Ht;$+=4)G[$]=G[$-ge],G[$+1]=G[$+1-ge],G[$+2]=G[$+2-ge],G[$+3]=G[$+3-ge];$=Ht}}z.l=ne,z.p=at,z.b=$,ne&&(Q=1,z.m=se,z.d=q,z.n=ve)}while(!Q);return $==G.length?G:function(ut,xn,un){(un==null||un>ut.length)&&(un=ut.length);var Vn=new(ut instanceof n?n:ut instanceof i?i:e)(un-xn);return Vn.set(ut.subarray(xn,un)),Vn}(G,0,$)},D=new e(0),P=typeof TextDecoder<"u"&&new TextDecoder;try{P.decode(D,{stream:!0})}catch{}return t.convert_streams=function(F){var G=new DataView(F),z=0;function Y(){var et=G.getUint16(z);return z+=2,et}function N(){var et=G.getUint32(z);return z+=4,et}function k(et){ot.setUint16(st,et),st+=2}function j(et){ot.setUint32(st,et),st+=4}for(var X={signature:N(),flavor:N(),length:N(),numTables:Y(),reserved:Y(),totalSfntSize:N(),majorVersion:Y(),minorVersion:Y(),metaOffset:N(),metaLength:N(),metaOrigLength:N(),privOffset:N(),privLength:N()},Q=0;Math.pow(2,Q)<=X.numTables;)Q++;Q--;for(var H=16*Math.pow(2,Q),$=16*X.numTables-H,ne=12,q=[],se=0;se<X.numTables;se++)q.push({tag:N(),offset:N(),compLength:N(),origLength:N(),origChecksum:N()}),ne+=16;var ve,pe=new Uint8Array(12+16*q.length+q.reduce(function(et,Te){return et+Te.origLength+4},0)),xe=pe.buffer,ot=new DataView(xe),st=0;return j(X.flavor),k(X.numTables),k(H),k(Q),k($),q.forEach(function(et){j(et.tag),j(et.origChecksum),j(ne),j(et.origLength),et.outOffset=ne,(ne+=et.origLength)%4!=0&&(ne+=4-ne%4)}),q.forEach(function(et){var Te,Xe=F.slice(et.offset,et.offset+et.compLength);if(et.compLength!=et.origLength){var K=new Uint8Array(et.origLength);Te=new Uint8Array(Xe,2),M(Te,K)}else K=new Uint8Array(Xe);pe.set(K,et.outOffset);var Pe=0;(ne=et.outOffset+et.origLength)%4!=0&&(Pe=4-ne%4),pe.set(new Uint8Array(Pe).buffer,et.outOffset+et.origLength),ve=ne+Pe}),xe.slice(0,ve)},Object.defineProperty(t,"__esModule",{value:!0}),t}({}).convert_streams}function wde(t,e){const n={M:2,L:2,Q:4,C:6,Z:0},i={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,s=2,a=4,o=8,l=16,u=32;let c;function h(C){if(!c){const O={R:s,L:r,D:a,C:l,U:u,T:o};c=new Map;for(let M in i){let D=0;i[M].split(",").forEach(P=>{let[F,G]=P.split("+");F=parseInt(F,36),G=G?parseInt(G,36):0,c.set(D+=F,O[M]);for(let z=G;z--;)c.set(++D,O[M])})}}return c.get(C)||u}const d=1,m=2,v=3,_=4,y=[null,"isol","init","fina","medi"];function g(C){const O=new Uint8Array(C.length);let M=u,D=d,P=-1;for(let F=0;F<C.length;F++){const G=C.codePointAt(F);let z=h(G)|0,Y=d;z&o||(M&(r|a|l)?z&(s|a|l)?(Y=v,(D===d||D===v)&&O[P]++):z&(r|u)&&(D===m||D===_)&&O[P]--:M&(s|u)&&(D===m||D===_)&&O[P]--,D=O[F]=Y,M=z,P=F,G>65535&&F++)}return O}function x(C,O){const M=[];for(let P=0;P<O.length;P++){const F=O.codePointAt(P);F>65535&&P++,M.push(t.U.codeToGlyph(C,F))}const D=C.GSUB;if(D){const{lookupList:P,featureList:F}=D;let G;const z=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,Y=[];F.forEach(N=>{if(z.test(N.tag))for(let k=0;k<N.tab.length;k++){if(Y[N.tab[k]])continue;Y[N.tab[k]]=!0;const j=P[N.tab[k]],X=/^(isol|init|fina|medi)$/.test(N.tag);X&&!G&&(G=g(O));for(let Q=0;Q<M.length;Q++)(!G||!X||y[G[Q]]===N.tag)&&t.U._applySubs(M,Q,j,P)}})}return M}function S(C,O){const M=new Int16Array(O.length*3);let D=0;for(;D<O.length;D++){const z=O[D];if(z===-1)continue;M[D*3+2]=C.hmtx.aWidth[z];const Y=C.GPOS;if(Y){const N=Y.lookupList;for(let k=0;k<N.length;k++){const j=N[k];for(let X=0;X<j.tabs.length;X++){const Q=j.tabs[X];if(j.ltype===1){if(t._lctf.coverageIndex(Q.coverage,z)!==-1&&Q.pos){G(Q.pos,D);break}}else if(j.ltype===2){let H=null,$=P();if($!==-1){const ne=t._lctf.coverageIndex(Q.coverage,O[$]);if(ne!==-1){if(Q.fmt===1){const q=Q.pairsets[ne];for(let se=0;se<q.length;se++)q[se].gid2===z&&(H=q[se])}else if(Q.fmt===2){const q=t.U._getGlyphClass(O[$],Q.classDef1),se=t.U._getGlyphClass(z,Q.classDef2);H=Q.matrix[q][se]}if(H){H.val1&&G(H.val1,$),H.val2&&G(H.val2,D);break}}}}else if(j.ltype===4){const H=t._lctf.coverageIndex(Q.markCoverage,z);if(H!==-1){const $=P(F),ne=$===-1?-1:t._lctf.coverageIndex(Q.baseCoverage,O[$]);if(ne!==-1){const q=Q.markArray[H],se=Q.baseArray[ne][q.markClass];M[D*3]=se.x-q.x+M[$*3]-M[$*3+2],M[D*3+1]=se.y-q.y+M[$*3+1];break}}}else if(j.ltype===6){const H=t._lctf.coverageIndex(Q.mark1Coverage,z);if(H!==-1){const $=P();if($!==-1){const ne=O[$];if(E(C,ne)===3){const q=t._lctf.coverageIndex(Q.mark2Coverage,ne);if(q!==-1){const se=Q.mark1Array[H],ve=Q.mark2Array[q][se.markClass];M[D*3]=ve.x-se.x+M[$*3]-M[$*3+2],M[D*3+1]=ve.y-se.y+M[$*3+1];break}}}}}}}}else if(C.kern&&!C.cff){const N=P();if(N!==-1){const k=C.kern.glyph1.indexOf(O[N]);if(k!==-1){const j=C.kern.rval[k].glyph2.indexOf(z);j!==-1&&(M[N*3+2]+=C.kern.rval[k].vals[j])}}}}return M;function P(z){for(let Y=D-1;Y>=0;Y--)if(O[Y]!==-1&&(!z||z(O[Y])))return Y;return-1}function F(z){return E(C,z)===1}function G(z,Y){for(let N=0;N<3;N++)M[Y*3+N]+=z[N]||0}}function E(C,O){const M=C.GDEF&&C.GDEF.glyphClassDef;return M?t.U._getGlyphClass(O,M):0}function A(...C){for(let O=0;O<C.length;O++)if(typeof C[O]=="number")return C[O]}function T(C){const O=Object.create(null),M=C["OS/2"],D=C.hhea,P=C.head.unitsPerEm,F=A(M&&M.sTypoAscender,D&&D.ascender,P),G={unitsPerEm:P,ascender:F,descender:A(M&&M.sTypoDescender,D&&D.descender,0),capHeight:A(M&&M.sCapHeight,F),xHeight:A(M&&M.sxHeight,F),lineGap:A(M&&M.sTypoLineGap,D&&D.lineGap),supportsCodePoint(z){return t.U.codeToGlyph(C,z)>0},forEachGlyph(z,Y,N,k){let j=0;const X=1/G.unitsPerEm*Y,Q=x(C,z);let H=0;const $=S(C,Q);return Q.forEach((ne,q)=>{if(ne!==-1){let se=O[ne];if(!se){const{cmds:ve,crds:pe}=t.U.glyphToPath(C,ne);let xe="",ot=0;for(let K=0,Pe=ve.length;K<Pe;K++){const Ne=n[ve[K]];xe+=ve[K];for(let Ve=1;Ve<=Ne;Ve++)xe+=(Ve>1?",":"")+pe[ot++]}let st,et,Te,Xe;if(pe.length){st=et=1/0,Te=Xe=-1/0;for(let K=0,Pe=pe.length;K<Pe;K+=2){let Ne=pe[K],Ve=pe[K+1];Ne<st&&(st=Ne),Ve<et&&(et=Ve),Ne>Te&&(Te=Ne),Ve>Xe&&(Xe=Ve)}}else st=Te=et=Xe=0;se=O[ne]={index:ne,advanceWidth:C.hmtx.aWidth[ne],xMin:st,yMin:et,xMax:Te,yMax:Xe,path:xe}}k.call(null,se,j+$[q*3]*X,$[q*3+1]*X,H),j+=$[q*3+2]*X,N&&(j+=N*Y)}H+=z.codePointAt(H)>65535?2:1}),j}};return G}return function(O){const M=new Uint8Array(O,0,4),D=t._bin.readASCII(M,0,4);if(D==="wOFF")O=e(O);else if(D==="wOF2")throw new Error("woff2 fonts not supported");return T(t.parse(O)[0])}}const Ade=wv({name:"Typr Font Parser",dependencies:[Sde,Ede,wde],init(t,e,n){const i=t(),r=e();return n(i,r)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function Tde(){return function(t){var e=function(){this.buckets=new Map};e.prototype.add=function(S){var E=S>>5;this.buckets.set(E,(this.buckets.get(E)||0)|1<<(31&S))},e.prototype.has=function(S){var E=this.buckets.get(S>>5);return E!==void 0&&(E&1<<(31&S))!=0},e.prototype.serialize=function(){var S=[];return this.buckets.forEach(function(E,A){S.push((+A).toString(36)+":"+E.toString(36))}),S.join(",")},e.prototype.deserialize=function(S){var E=this;this.buckets.clear(),S.split(",").forEach(function(A){var T=A.split(":");E.buckets.set(parseInt(T[0],36),parseInt(T[1],36))})};var n=Math.pow(2,8),i=n-1,r=~i;function s(S){var E=function(T){return T&r}(S).toString(16),A=function(T){return(T&r)+n-1}(S).toString(16);return"codepoint-index/plane"+(S>>16)+"/"+E+"-"+A+".json"}function a(S,E){var A=S&i,T=E.codePointAt(A/6|0);return((T=(T||48)-48)&1<<A%6)!=0}function o(S,E){var A;(A=S,A.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(T){return T.split("-").map(function(C){return parseInt(C.trim(),16)})})).forEach(function(T){var C=T[0],O=T[1];O===void 0&&(O=C),E(C,O)})}function l(S,E){o(S,function(A,T){for(var C=A;C<=T;C++)E(C)})}var u={},c={},h=new WeakMap,d="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function m(S){var E=h.get(S);return E||(E=new e,l(S.ranges,function(A){return E.add(A)}),h.set(S,E)),E}var v,_=new Map;function y(S,E,A){return S[E]?E:S[A]?A:function(T){for(var C in T)return C}(S)}function g(S,E){var A=E;if(!S.includes(A)){A=1/0;for(var T=0;T<S.length;T++)Math.abs(S[T]-E)<Math.abs(A-E)&&(A=S[T])}return A}function x(S){return v||(v=new Set,l("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(E){v.add(E)})),v.has(S)}return t.CodePointSet=e,t.clearCache=function(){u={},c={}},t.getFontsForString=function(S,E){E===void 0&&(E={});var A,T=E.lang;T===void 0&&(T=new RegExp("\\p{Script=Hangul}","u").test(A=S)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(A)?"ja":"en");var C=E.category;C===void 0&&(C="sans-serif");var O=E.style;O===void 0&&(O="normal");var M=E.weight;M===void 0&&(M=400);var D=(E.dataUrl||d).replace(/\/$/g,""),P=new Map,F=new Uint8Array(S.length),G={},z={},Y=new Array(S.length),N=new Map,k=!1;function j(H){var $=_.get(H);return $||($=fetch(D+"/"+H).then(function(ne){if(!ne.ok)throw new Error(ne.statusText);return ne.json().then(function(q){if(!Array.isArray(q)||q[0]!==1)throw new Error("Incorrect schema version; need 1, got "+q[0]);return q[1]})}).catch(function(ne){if(D!==d)return k||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+D+'", trying default CDN. '+ne.message),k=!0),D=d,_.delete(H),j(H);throw ne}),_.set(H,$)),$}for(var X=function(H){var $=S.codePointAt(H),ne=s($);Y[H]=ne,u[ne]||N.has(ne)||N.set(ne,j(ne).then(function(q){u[ne]=q})),$>65535&&(H++,Q=H)},Q=0;Q<S.length;Q++)X(Q);return Promise.all(N.values()).then(function(){N.clear();for(var H=function(ne){var q=S.codePointAt(ne),se=null,ve=u[Y[ne]],pe=void 0;for(var xe in ve){var ot=z[xe];if(ot===void 0&&(ot=z[xe]=new RegExp(xe).test(T||"en")),ot){for(var st in pe=xe,ve[xe])if(a(q,ve[xe][st])){se=st;break}break}}if(!se){e:for(var et in ve)if(et!==pe){for(var Te in ve[et])if(a(q,ve[et][Te])){se=Te;break e}}}se||(console.debug("No font coverage for U+"+q.toString(16)),se="latin"),Y[ne]=se,c[se]||N.has(se)||N.set(se,j("font-meta/"+se+".json").then(function(Xe){c[se]=Xe})),q>65535&&(ne++,$=ne)},$=0;$<S.length;$++)H($);return Promise.all(N.values())}).then(function(){for(var H,$=null,ne=0;ne<S.length;ne++){var q=S.codePointAt(ne);if($&&(x(q)||m($).has(q)))F[ne]=F[ne-1];else{$=c[Y[ne]];var se=G[$.id];if(!se){var ve=$.typeforms,pe=y(ve,C,"sans-serif"),xe=y(ve[pe],O,"normal"),ot=g((H=ve[pe])===null||H===void 0?void 0:H[xe],M);se=G[$.id]=D+"/font-files/"+$.id+"/"+pe+"."+xe+"."+ot+".woff"}var st=P.get(se);st==null&&(st=P.size,P.set(se,st)),F[ne]=st}q>65535&&(ne++,F[ne]=F[ne-1])}return{fontUrls:Array.from(P.keys()),chars:F}})},Object.defineProperty(t,"__esModule",{value:!0}),t}({})}function Mde(t,e){const n=Object.create(null),i=Object.create(null);function r(a,o){const l=u=>{console.error(`Failure loading font ${a}`,u)};try{const u=new XMLHttpRequest;u.open("get",a,!0),u.responseType="arraybuffer",u.onload=function(){if(u.status>=400)l(new Error(u.statusText));else if(u.status>0)try{const c=t(u.response);c.src=a,o(c)}catch(c){l(c)}},u.onerror=l,u.send()}catch(u){l(u)}}function s(a,o){let l=n[a];l?o(l):i[a]?i[a].push(o):(i[a]=[o],r(a,u=>{u.src=a,n[a]=u,i[a].forEach(c=>c(u)),delete i[a]}))}return function(a,o,{lang:l,fonts:u=[],style:c="normal",weight:h="normal",unicodeFontsURL:d}={}){const m=new Uint8Array(a.length),v=[];a.length||x();const _=new Map,y=[];if(c!=="italic"&&(c="normal"),typeof h!="number"&&(h=h==="bold"?700:400),u&&!Array.isArray(u)&&(u=[u]),u=u.slice().filter(E=>!E.lang||E.lang.test(l)).reverse(),u.length){let C=0;(function O(M=0){for(let D=M,P=a.length;D<P;D++){const F=a.codePointAt(D);if(C===1&&v[m[D-1]].supportsCodePoint(F)||D>0&&/\s/.test(a[D]))m[D]=m[D-1],C===2&&(y[y.length-1][1]=D);else for(let G=m[D],z=u.length;G<=z;G++)if(G===z){const Y=C===2?y[y.length-1]:y[y.length]=[D,D];Y[1]=D,C=2}else{m[D]=G;const{src:Y,unicodeRange:N}=u[G];if(!N||S(F,N)){const k=n[Y];if(!k){s(Y,()=>{O(D)});return}if(k.supportsCodePoint(F)){let j=_.get(k);typeof j!="number"&&(j=v.length,v.push(k),_.set(k,j)),m[D]=j,C=1;break}}}F>65535&&D+1<P&&(m[D+1]=m[D],D++,C===2&&(y[y.length-1][1]=D))}g()})()}else y.push([0,a.length-1]),g();function g(){if(y.length){const E=y.map(A=>a.substring(A[0],A[1]+1)).join(`
`);e.getFontsForString(E,{lang:l||void 0,style:c,weight:h,dataUrl:d}).then(({fontUrls:A,chars:T})=>{const C=v.length;let O=0;y.forEach(D=>{for(let P=0,F=D[1]-D[0];P<=F;P++)m[D[0]+P]=T[O++]+C;O++});let M=0;A.forEach((D,P)=>{s(D,F=>{v[P+C]=F,++M===A.length&&x()})})})}else x()}function x(){o({chars:m,fonts:v})}function S(E,A){for(let T=0;T<A.length;T++){const[C,O=C]=A[T];if(C<=E&&E<=O)return!0}return!1}}}const Cde=wv({name:"FontResolver",dependencies:[Mde,Ade,Tde],init(t,e,n){return t(e,n())}});function Rde(t,e){const i=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,r="[^\\S\\u00A0]",s=new RegExp(`${r}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function a({text:v,lang:_,fonts:y,style:g,weight:x,preResolvedFonts:S,unicodeFontsURL:E},A){const T=({chars:C,fonts:O})=>{let M,D;const P=[];for(let F=0;F<C.length;F++)C[F]!==D?(D=C[F],P.push(M={start:F,end:F,fontObj:O[C[F]]})):M.end=F;A(P)};S?T(S):t(v,T,{lang:_,fonts:y,style:g,weight:x,unicodeFontsURL:E})}function o({text:v="",font:_,lang:y,sdfGlyphSize:g=64,fontSize:x=400,fontWeight:S=1,fontStyle:E="normal",letterSpacing:A=0,lineHeight:T="normal",maxWidth:C=1/0,direction:O,textAlign:M="left",textIndent:D=0,whiteSpace:P="normal",overflowWrap:F="normal",anchorX:G=0,anchorY:z=0,metricsOnly:Y=!1,unicodeFontsURL:N,preResolvedFonts:k=null,includeCaretPositions:j=!1,chunkedBoundsSize:X=8192,colorRanges:Q=null},H){const $=h(),ne={fontLoad:0,typesetting:0};v.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),v=v.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),x=+x,A=+A,C=+C,T=T||"normal",D=+D,a({text:v,lang:y,style:E,weight:S,fonts:typeof _=="string"?[{src:_}]:_,unicodeFontsURL:N,preResolvedFonts:k},q=>{ne.fontLoad=h()-$;const se=isFinite(C);let ve=null,pe=null,xe=null,ot=null,st=null,et=null,Te=null,Xe=null,K=0,Pe=0,Ne=P!=="nowrap";const Ve=new Map,_e=h();let ft=D,ke=0,Z=new d;const W=[Z];q.forEach(ct=>{const{fontObj:at}=ct,{ascender:Rt,descender:Nt,unitsPerEm:vt,lineGap:Vt,capHeight:Bt,xHeight:Ht}=at;let ut=Ve.get(at);if(!ut){const _t=x/vt,Ye=T==="normal"?(Rt-Nt+Vt)*_t:T*x,Et=(Ye-(Rt-Nt)*_t)/2,Ot=Math.min(Ye,(Rt-Nt)*_t),Mt=(Rt+Nt)/2*_t+Ot/2;ut={index:Ve.size,src:at.src,fontObj:at,fontSizeMult:_t,unitsPerEm:vt,ascender:Rt*_t,descender:Nt*_t,capHeight:Bt*_t,xHeight:Ht*_t,lineHeight:Ye,baseline:-Et-Rt*_t,caretTop:Mt,caretBottom:Mt-Ot},Ve.set(at,ut)}const{fontSizeMult:xn}=ut,un=v.slice(ct.start,ct.end+1);let Vn,be;at.forEachGlyph(un,x,A,(_t,Ye,Et,Ot)=>{Ye+=ke,Ot+=ct.start,Vn=Ye,be=_t;const Mt=v.charAt(Ot),vn=_t.advanceWidth*xn,Un=Z.count;let an;if("isEmpty"in _t||(_t.isWhitespace=!!Mt&&new RegExp(r).test(Mt),_t.canBreakAfter=!!Mt&&s.test(Mt),_t.isEmpty=_t.xMin===_t.xMax||_t.yMin===_t.yMax||i.test(Mt)),!_t.isWhitespace&&!_t.isEmpty&&Pe++,Ne&&se&&!_t.isWhitespace&&Ye+vn+ft>C&&Un){if(Z.glyphAt(Un-1).glyphObj.canBreakAfter)an=new d,ft=-Ye;else for(let Ri=Un;Ri--;)if(Ri===0&&F==="break-word"){an=new d,ft=-Ye;break}else if(Z.glyphAt(Ri).glyphObj.canBreakAfter){an=Z.splitAt(Ri+1);const Ni=an.glyphAt(0).x;ft-=Ni;for(let lr=an.count;lr--;)an.glyphAt(lr).x-=Ni;break}an&&(Z.isSoftWrapped=!0,Z=an,W.push(Z),K=C)}let An=Z.glyphAt(Z.count);An.glyphObj=_t,An.x=Ye+ft,An.y=Et,An.width=vn,An.charIndex=Ot,An.fontData=ut,Mt===`
`&&(Z=new d,W.push(Z),ft=-(Ye+vn+A*x)+D)}),ke=Vn+be.advanceWidth*xn+A*x});let I=0;W.forEach(ct=>{let at=!0;for(let Rt=ct.count;Rt--;){const Nt=ct.glyphAt(Rt);at&&!Nt.glyphObj.isWhitespace&&(ct.width=Nt.x+Nt.width,ct.width>K&&(K=ct.width),at=!1);let{lineHeight:vt,capHeight:Vt,xHeight:Bt,baseline:Ht}=Nt.fontData;vt>ct.lineHeight&&(ct.lineHeight=vt);const ut=Ht-ct.baseline;ut<0&&(ct.baseline+=ut,ct.cap+=ut,ct.ex+=ut),ct.cap=Math.max(ct.cap,ct.baseline+Vt),ct.ex=Math.max(ct.ex,ct.baseline+Bt)}ct.baseline-=I,ct.cap-=I,ct.ex-=I,I+=ct.lineHeight});let De=0,ge=0;if(G&&(typeof G=="number"?De=-G:typeof G=="string"&&(De=-K*(G==="left"?0:G==="center"?.5:G==="right"?1:u(G)))),z&&(typeof z=="number"?ge=-z:typeof z=="string"&&(ge=z==="top"?0:z==="top-baseline"?-W[0].baseline:z==="top-cap"?-W[0].cap:z==="top-ex"?-W[0].ex:z==="middle"?I/2:z==="bottom"?I:z==="bottom-baseline"?-W[W.length-1].baseline:u(z)*I)),!Y){const ct=e.getEmbeddingLevels(v,O);ve=new Uint16Array(Pe),pe=new Uint8Array(Pe),xe=new Float32Array(Pe*2),ot={},Te=[1/0,1/0,-1/0,-1/0],Xe=[],j&&(et=new Float32Array(v.length*4)),Q&&(st=new Uint8Array(Pe*3));let at=0,Rt=-1,Nt=-1,vt,Vt;if(W.forEach((Bt,Ht)=>{let{count:ut,width:xn}=Bt;if(ut>0){let un=0;for(let Ot=ut;Ot--&&Bt.glyphAt(Ot).glyphObj.isWhitespace;)un++;let Vn=0,be=0;if(M==="center")Vn=(K-xn)/2;else if(M==="right")Vn=K-xn;else if(M==="justify"&&Bt.isSoftWrapped){let Ot=0;for(let Mt=ut-un;Mt--;)Bt.glyphAt(Mt).glyphObj.isWhitespace&&Ot++;be=(K-xn)/Ot}if(be||Vn){let Ot=0;for(let Mt=0;Mt<ut;Mt++){let vn=Bt.glyphAt(Mt);const Un=vn.glyphObj;vn.x+=Vn+Ot,be!==0&&Un.isWhitespace&&Mt<ut-un&&(Ot+=be,vn.width+=be)}}const _t=e.getReorderSegments(v,ct,Bt.glyphAt(0).charIndex,Bt.glyphAt(Bt.count-1).charIndex);for(let Ot=0;Ot<_t.length;Ot++){const[Mt,vn]=_t[Ot];let Un=1/0,an=-1/0;for(let An=0;An<ut;An++)if(Bt.glyphAt(An).charIndex>=Mt){let Ri=An,Ni=An;for(;Ni<ut;Ni++){let lr=Bt.glyphAt(Ni);if(lr.charIndex>vn)break;Ni<ut-un&&(Un=Math.min(Un,lr.x),an=Math.max(an,lr.x+lr.width))}for(let lr=Ri;lr<Ni;lr++){const us=Bt.glyphAt(lr);us.x=an-(us.x+us.width-Un)}break}}let Ye;const Et=Ot=>Ye=Ot;for(let Ot=0;Ot<ut;Ot++){const Mt=Bt.glyphAt(Ot);Ye=Mt.glyphObj;const vn=Ye.index,Un=ct.levels[Mt.charIndex]&1;if(Un){const an=e.getMirroredCharacter(v[Mt.charIndex]);an&&Mt.fontData.fontObj.forEachGlyph(an,0,0,Et)}if(j){const{charIndex:an,fontData:An}=Mt,Ri=Mt.x+De,Ni=Mt.x+Mt.width+De;et[an*4]=Un?Ni:Ri,et[an*4+1]=Un?Ri:Ni,et[an*4+2]=Bt.baseline+An.caretBottom+ge,et[an*4+3]=Bt.baseline+An.caretTop+ge;const lr=an-Rt;lr>1&&c(et,Rt,lr),Rt=an}if(Q){const{charIndex:an}=Mt;for(;an>Nt;)Nt++,Q.hasOwnProperty(Nt)&&(Vt=Q[Nt])}if(!Ye.isWhitespace&&!Ye.isEmpty){const an=at++,{fontSizeMult:An,src:Ri,index:Ni}=Mt.fontData,lr=ot[Ri]||(ot[Ri]={});lr[vn]||(lr[vn]={path:Ye.path,pathBounds:[Ye.xMin,Ye.yMin,Ye.xMax,Ye.yMax]});const us=Mt.x+De,Vr=Mt.y+Bt.baseline+ge;xe[an*2]=us,xe[an*2+1]=Vr;const Sr=us+Ye.xMin*An,aa=Vr+Ye.yMin*An,Hr=us+Ye.xMax*An,ur=Vr+Ye.yMax*An;Sr<Te[0]&&(Te[0]=Sr),aa<Te[1]&&(Te[1]=aa),Hr>Te[2]&&(Te[2]=Hr),ur>Te[3]&&(Te[3]=ur),an%X===0&&(vt={start:an,end:an,rect:[1/0,1/0,-1/0,-1/0]},Xe.push(vt)),vt.end++;const Zn=vt.rect;if(Sr<Zn[0]&&(Zn[0]=Sr),aa<Zn[1]&&(Zn[1]=aa),Hr>Zn[2]&&(Zn[2]=Hr),ur>Zn[3]&&(Zn[3]=ur),ve[an]=vn,pe[an]=Ni,Q){const xi=an*3;st[xi]=Vt>>16&255,st[xi+1]=Vt>>8&255,st[xi+2]=Vt&255}}}}}),et){const Bt=v.length-Rt;Bt>1&&c(et,Rt,Bt)}}const ze=[];Ve.forEach(({index:ct,src:at,unitsPerEm:Rt,ascender:Nt,descender:vt,lineHeight:Vt,capHeight:Bt,xHeight:Ht})=>{ze[ct]={src:at,unitsPerEm:Rt,ascender:Nt,descender:vt,lineHeight:Vt,capHeight:Bt,xHeight:Ht}}),ne.typesetting=h()-_e,H({glyphIds:ve,glyphFontIndices:pe,glyphPositions:xe,glyphData:ot,fontData:ze,caretPositions:et,glyphColors:st,chunkedBounds:Xe,fontSize:x,topBaseline:ge+W[0].baseline,blockBounds:[De,ge-I,De+K,ge],visibleBounds:Te,timings:ne})})}function l(v,_){o({...v,metricsOnly:!0},y=>{const[g,x,S,E]=y.blockBounds;_({width:S-g,height:E-x})})}function u(v){let _=v.match(/^([\d.]+)%$/),y=_?parseFloat(_[1]):NaN;return isNaN(y)?0:y/100}function c(v,_,y){const g=v[_*4],x=v[_*4+1],S=v[_*4+2],E=v[_*4+3],A=(x-g)/y;for(let T=0;T<y;T++){const C=(_+T)*4;v[C]=g+A*T,v[C+1]=g+A*(T+1),v[C+2]=S,v[C+3]=E}}function h(){return(self.performance||Date).now()}function d(){this.data=[]}const m=["glyphObj","x","y","width","charIndex","fontData"];return d.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/m.length)},glyphAt(v){let _=d.flyweight;return _.data=this.data,_.index=v,_},splitAt(v){let _=new d;return _.data=this.data.splice(v*m.length),_}},d.flyweight=m.reduce((v,_,y,g)=>(Object.defineProperty(v,_,{get(){return this.data[this.index*m.length+y]},set(x){this.data[this.index*m.length+y]=x}}),v),{data:null,index:0}),{typeset:o,measure:l}}const Vp=()=>(self.performance||Date).now(),YT=G9();let p5;function Dde(t,e,n,i,r,s,a,o,l,u,c=!0){return c?Ude(t,e,n,i,r,s,a,o,l,u).then(null,h=>(p5||(console.warn("WebGL SDF generation failed, falling back to JS",h),p5=!0),g5(t,e,n,i,r,s,a,o,l,u))):g5(t,e,n,i,r,s,a,o,l,u)}const bE=[],Ode=5;let BD=0;function H9(){const t=Vp();for(;bE.length&&Vp()-t<Ode;)bE.shift()();BD=bE.length?setTimeout(H9,0):0}const Ude=(...t)=>new Promise((e,n)=>{bE.push(()=>{const i=Vp();try{YT.webgl.generateIntoCanvas(...t),e({timing:Vp()-i})}catch(r){n(r)}}),BD||(BD=setTimeout(H9,0))}),zde=4,Ide=2e3,m5={};let Lde=0;function g5(t,e,n,i,r,s,a,o,l,u){const c="TroikaTextSDFGenerator_JS_"+Lde++%zde;let h=m5[c];return h||(h=m5[c]={workerModule:wv({name:c,workerId:c,dependencies:[G9,Vp],init(d,m){const v=d().javascript.generate;return function(..._){const y=m();return{textureData:v(..._),timing:m()-y}}},getTransferables(d){return[d.textureData.buffer]}}),requests:0,idleTimer:null}),h.requests++,clearTimeout(h.idleTimer),h.workerModule(t,e,n,i,r,s).then(({textureData:d,timing:m})=>{const v=Vp(),_=new Uint8Array(d.length*4);for(let y=0;y<d.length;y++)_[y*4+u]=d[y];return YT.webglUtils.renderImageData(a,_,o,l,t,e,1<<3-u),m+=Vp()-v,--h.requests===0&&(h.idleTimer=setTimeout(()=>{hde(c)},Ide)),{timing:m}})}function Pde(t){t._warm||(YT.webgl.isSupported(t),t._warm=!0)}const Nde=YT.webglUtils.resizeWebGLCanvasWithoutClearing,Px={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},Bde=new nn;function Fg(){return(self.performance||Date).now()}const v5=Object.create(null);function j9(t,e){t=Gde({},t);const n=Fg(),i=[];if(t.font&&i.push({label:"user",src:Vde(t.font)}),t.font=i,t.text=""+t.text,t.sdfGlyphSize=t.sdfGlyphSize||Px.sdfGlyphSize,t.unicodeFontsURL=t.unicodeFontsURL||Px.unicodeFontsURL,t.colorRanges!=null){let d={};for(let m in t.colorRanges)if(t.colorRanges.hasOwnProperty(m)){let v=t.colorRanges[m];typeof v!="number"&&(v=Bde.set(v).getHex()),d[m]=v}t.colorRanges=d}Object.freeze(t);const{textureWidth:r,sdfExponent:s}=Px,{sdfGlyphSize:a}=t,o=r/a*4;let l=v5[a];if(!l){const d=document.createElement("canvas");d.width=r,d.height=a*256/o,l=v5[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:d,sdfTexture:new Gr(d,void 0,void 0,void 0,ts,ts),contextLost:!1,glyphsByFont:new Map},l.sdfTexture.generateMipmaps=!1,kde(l)}const{sdfTexture:u,sdfCanvas:c}=l;Y9(t).then(d=>{const{glyphIds:m,glyphFontIndices:v,fontData:_,glyphPositions:y,fontSize:g,timings:x}=d,S=[],E=new Float32Array(m.length*4);let A=0,T=0;const C=Fg(),O=_.map(G=>{let z=l.glyphsByFont.get(G.src);return z||l.glyphsByFont.set(G.src,z=new Map),z});m.forEach((G,z)=>{const Y=v[z],{src:N,unitsPerEm:k}=_[Y];let j=O[Y].get(G);if(!j){const{path:ne,pathBounds:q}=d.glyphData[N][G],se=Math.max(q[2]-q[0],q[3]-q[1])/a*(Px.sdfMargin*a+.5),ve=l.glyphCount++,pe=[q[0]-se,q[1]-se,q[2]+se,q[3]+se];O[Y].set(G,j={path:ne,atlasIndex:ve,sdfViewBox:pe}),S.push(j)}const{sdfViewBox:X}=j,Q=y[T++],H=y[T++],$=g/k;E[A++]=Q+X[0]*$,E[A++]=H+X[1]*$,E[A++]=Q+X[2]*$,E[A++]=H+X[3]*$,m[z]=j.atlasIndex}),x.quads=(x.quads||0)+(Fg()-C);const M=Fg();x.sdf={};const D=c.height,P=Math.ceil(l.glyphCount/o),F=Math.pow(2,Math.ceil(Math.log2(P*a)));F>D&&(console.info(`Increasing SDF texture size ${D}->${F}`),Nde(c,r,F),u.dispose()),Promise.all(S.map(G=>W9(G,l,t.gpuAccelerateSDF).then(({timing:z})=>{x.sdf[G.atlasIndex]=z}))).then(()=>{S.length&&!l.contextLost&&(X9(l),u.needsUpdate=!0),x.sdfTotal=Fg()-M,x.total=Fg()-n,e(Object.freeze({parameters:t,sdfTexture:u,sdfGlyphSize:a,sdfExponent:s,glyphBounds:E,glyphAtlasIndices:m,glyphColors:d.glyphColors,caretPositions:d.caretPositions,chunkedBounds:d.chunkedBounds,ascender:d.ascender,descender:d.descender,lineHeight:d.lineHeight,capHeight:d.capHeight,xHeight:d.xHeight,topBaseline:d.topBaseline,blockBounds:d.blockBounds,visibleBounds:d.visibleBounds,timings:d.timings}))})}),Promise.resolve().then(()=>{l.contextLost||Pde(c)})}function W9({path:t,atlasIndex:e,sdfViewBox:n},{sdfGlyphSize:i,sdfCanvas:r,contextLost:s},a){if(s)return Promise.resolve({timing:-1});const{textureWidth:o,sdfExponent:l}=Px,u=Math.max(n[2]-n[0],n[3]-n[1]),c=Math.floor(e/4),h=c%(o/i)*i,d=Math.floor(c/(o/i))*i,m=e%4;return Dde(i,i,t,n,u,l,r,h,d,m,a)}function kde(t){const e=t.sdfCanvas;e.addEventListener("webglcontextlost",n=>{console.log("Context Lost",n),n.preventDefault(),t.contextLost=!0}),e.addEventListener("webglcontextrestored",n=>{console.log("Context Restored",n),t.contextLost=!1;const i=[];t.glyphsByFont.forEach(r=>{r.forEach(s=>{i.push(W9(s,t,!0))})}),Promise.all(i).then(()=>{X9(t),t.sdfTexture.needsUpdate=!0})})}function Fde({font:t,characters:e,sdfGlyphSize:n},i){let r=Array.isArray(e)?e.join(`
`):""+e;j9({font:t,sdfGlyphSize:n,text:r},i)}function Gde(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}let O2;function Vde(t){return O2||(O2=typeof document>"u"?{}:document.createElement("a")),O2.href=t,O2.href}function X9(t){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:n}=t,{width:i,height:r}=e,s=t.sdfCanvas.getContext("webgl");let a=n.image.data;(!a||a.length!==i*r*4)&&(a=new Uint8Array(i*r*4),n.image={width:i,height:r,data:a},n.flipY=!1,n.isDataTexture=!0),s.readPixels(0,0,i,r,s.RGBA,s.UNSIGNED_BYTE,a)}}const Hde=wv({name:"Typesetter",dependencies:[Rde,Cde,pde],init(t,e,n){return t(e,n())}}),Y9=wv({name:"Typesetter",dependencies:[Hde],init(t){return function(e){return new Promise(n=>{t.typeset(e,n)})}},getTransferables(t){const e=[];for(let n in t)t[n]&&t[n].buffer&&e.push(t[n].buffer);return e}});Y9.onMainThread;const y5={};function jde(t){let e=y5[t];return e||(e=y5[t]=new Nf(1,1,t,t).translate(.5,.5,0)),e}const Wde="aTroikaGlyphBounds",x5="aTroikaGlyphIndex",Xde="aTroikaGlyphColor";class Yde extends ZU{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Us,this.boundingBox=new bs}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let n=jde(e);["position","normal","uv"].forEach(i=>{this.attributes[i]=n.attributes[i].clone()}),this.setIndex(n.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,n,i,r,s){this.updateAttributeData(Wde,e,4),this.updateAttributeData(x5,n,1),this.updateAttributeData(Xde,s,3),this._blockBounds=i,this._chunkedBounds=r,this.instanceCount=n.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:n,boundingBox:i}=this;if(n){const{PI:r,floor:s,min:a,max:o,sin:l,cos:u}=Math,c=r/2,h=r*2,d=Math.abs(n),m=e[0]/d,v=e[2]/d,_=s((m+c)/h)!==s((v+c)/h)?-d:a(l(m)*d,l(v)*d),y=s((m-c)/h)!==s((v-c)/h)?d:o(l(m)*d,l(v)*d),g=s((m+r)/h)!==s((v+r)/h)?d*2:o(d-u(m)*d,d-u(v)*d);i.min.set(_,e[1],n<0?-g:0),i.max.set(y,e[3],n<0?0:g)}else i.min.set(e[0],e[1],0),i.max.set(e[2],e[3],0);i.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let n=this.getAttribute(x5).count,i=this._chunkedBounds;if(i)for(let r=i.length;r--;){n=i[r].end;let s=i[r].rect;if(s[1]<e.w&&s[3]>e.y&&s[0]<e.z&&s[2]>e.x)break}this.instanceCount=n}updateAttributeData(e,n,i){const r=this.getAttribute(e);n?r&&r.array.length===n.length?(r.array.set(n),r.needsUpdate=!0):(this.setAttribute(e,new Jp(n,i)),delete this._maxInstanceCount,this.dispose()):r&&this.deleteAttribute(e)}}const Zde=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,qde=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Kde=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,Qde=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function Jde(t){const e=ND(t,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Tt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new bi(0,0,0,0)},uTroikaClipRect:{value:new bi(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Tt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new nn},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Qn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:Zde,vertexTransform:qde,fragmentDefs:Kde,fragmentColorTransform:Qde,customRewriter({vertexShader:n,fragmentShader:i}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(i)&&(i=i.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(n)||(n=n.replace(V9,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:n,fragmentShader:i}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const nI=new Lf({color:16777215,side:es,transparent:!0}),_5=8421504,b5=new kn,U2=new re,O3=new re,yx=[],$de=new re,U3="+x+y";function S5(t){return Array.isArray(t)?t[0]:t}let Z9=()=>{const t=new vr(new Nf(1,1),nI);return Z9=()=>t,t},q9=()=>{const t=new vr(new Nf(1,1,32,1),nI);return q9=()=>t,t};const epe={type:"syncstart"},tpe={type:"synccomplete"},K9=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],npe=K9.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Q9=class extends vr{constructor(){const e=new Yde;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=_5,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=U3,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(epe),j9({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},n=>{this._isSyncing=!1,this._textRenderInfo=n,this.geometry.updateGlyphs(n.glyphBounds,n.glyphAtlasIndices,n.blockBounds,n.chunkedBounds,n.glyphColors);const i=this._queuedSyncs;i&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{i.forEach(r=>r&&r())})),this.dispatchEvent(tpe),e&&e()})))}onBeforeRender(e,n,i,r,s,a){this.sync(),s.isTroikaTextMaterial&&this._prepareForRender(s)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return Jde(e)}get material(){let e=this._derivedMaterial;const n=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=nI.clone());if((!e||!e.isDerivedFrom(n))&&(e=this._derivedMaterial=this.createDerivedMaterial(n),n.addEventListener("dispose",function i(){n.removeEventListener("dispose",i),e.dispose()})),this.hasOutline()){let i=e._outlineMtl;return i||(i=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),i.isTextOutlineMaterial=!0,i.depthWrite=!1,i.map=null,e.addEventListener("dispose",function r(){e.removeEventListener("dispose",r),i.dispose()})),[i,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return S5(this.material).getDepthMaterial()}set customDepthMaterial(e){}get customDistanceMaterial(){return S5(this.material).getDistanceMaterial()}set customDistanceMaterial(e){}_prepareForRender(e){const n=e.isTextOutlineMaterial,i=e.uniforms,r=this.textRenderInfo;if(r){const{sdfTexture:o,blockBounds:l}=r;i.uTroikaSDFTexture.value=o,i.uTroikaSDFTextureSize.value.set(o.image.width,o.image.height),i.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,i.uTroikaSDFExponent.value=r.sdfExponent,i.uTroikaTotalBounds.value.fromArray(l),i.uTroikaUseGlyphColors.value=!n&&!!r.glyphColors;let u=0,c=0,h=0,d,m,v,_=0,y=0;if(n){let{outlineWidth:x,outlineOffsetX:S,outlineOffsetY:E,outlineBlur:A,outlineOpacity:T}=this;u=this._parsePercent(x)||0,c=Math.max(0,this._parsePercent(A)||0),d=T,_=this._parsePercent(S)||0,y=this._parsePercent(E)||0}else h=Math.max(0,this._parsePercent(this.strokeWidth)||0),h&&(v=this.strokeColor,i.uTroikaStrokeColor.value.set(v??_5),m=this.strokeOpacity,m==null&&(m=1)),d=this.fillOpacity;i.uTroikaEdgeOffset.value=u,i.uTroikaPositionOffset.value.set(_,y),i.uTroikaBlurRadius.value=c,i.uTroikaStrokeWidth.value=h,i.uTroikaStrokeOpacity.value=m,i.uTroikaFillOpacity.value=d??1,i.uTroikaCurveRadius.value=this.curveRadius||0;let g=this.clipRect;if(g&&Array.isArray(g)&&g.length===4)i.uTroikaClipRect.value.fromArray(g);else{const x=(this.fontSize||.1)*100;i.uTroikaClipRect.value.set(l[0]-x,l[1]-x,l[2]+x,l[3]+x)}this.geometry.applyClipRect(i.uTroikaClipRect.value)}i.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const s=n?this.outlineColor||0:this.color;if(s==null)delete e.color;else{const o=e.hasOwnProperty("color")?e.color:e.color=new nn;(s!==o._input||typeof s=="object")&&o.set(o._input=s)}let a=this.orientation||U3;if(a!==e._orientation){let o=i.uTroikaOrient.value;a=a.replace(/[^-+xyz]/g,"");let l=a!==U3&&a.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,u,c,h,d]=l;U2.set(0,0,0)[c]=u==="-"?1:-1,O3.set(0,0,0)[d]=h==="-"?-1:1,b5.lookAt($de,U2.cross(O3),O3),o.setFromMatrix4(b5)}else o.identity();e._orientation=a}}_parsePercent(e){if(typeof e=="string"){let n=e.match(/^(-?[\d.]+)%$/),i=n?parseFloat(n[1]):NaN;e=(isNaN(i)?0:i/100)*this.fontSize}return e}localPositionToTextCoords(e,n=new Tt){n.copy(e);const i=this.curveRadius;return i&&(n.x=Math.atan2(e.x,Math.abs(i)-Math.abs(e.z))*Math.abs(i)),n}worldPositionToTextCoords(e,n=new Tt){return U2.copy(e),this.localPositionToTextCoords(this.worldToLocal(U2),n)}raycast(e,n){const{textRenderInfo:i,curveRadius:r}=this;if(i){const s=i.blockBounds,a=r?q9():Z9(),o=a.geometry,{position:l,uv:u}=o.attributes;for(let c=0;c<u.count;c++){let h=s[0]+u.getX(c)*(s[2]-s[0]);const d=s[1]+u.getY(c)*(s[3]-s[1]);let m=0;r&&(m=r-Math.cos(h/r)*r,h=Math.sin(h/r)*r),l.setXYZ(c,h,d,m)}o.boundingSphere=this.geometry.boundingSphere,o.boundingBox=this.geometry.boundingBox,a.matrixWorld=this.matrixWorld,a.material.side=this.material.side,yx.length=0,a.raycast(e,yx);for(let c=0;c<yx.length;c++)yx[c].object=this,n.push(yx[c])}}copy(e){const n=this.geometry;return super.copy(e),this.geometry=n,npe.forEach(i=>{this[i]=e[i]}),this}clone(){return new this.constructor().copy(this)}};K9.forEach(t=>{const e="_private_"+t;Object.defineProperty(Q9.prototype,t,{get(){return this[e]},set(n){n!==this[e]&&(this[e]=n,this._needsSync=!0)}})});new bs;new nn;const ipe=V.forwardRef(({sdfGlyphSize:t=64,anchorX:e="center",anchorY:n="middle",font:i,fontSize:r=1,children:s,characters:a,onSync:o,...l},u)=>{const c=xs(({invalidate:v})=>v),[h]=V.useState(()=>new Q9),[d,m]=V.useMemo(()=>{const v=[];let _="";return V.Children.forEach(s,y=>{typeof y=="string"||typeof y=="number"?_+=y:v.push(y)}),[v,_]},[s]);return _ie(()=>new Promise(v=>Fde({font:i,characters:a},v)),["troika-text",i,a]),V.useLayoutEffect(()=>void h.sync(()=>{c(),o&&o(h)})),V.useEffect(()=>()=>h.dispose(),[h]),V.createElement("primitive",f_({object:h,ref:u,font:i,text:m,anchorX:e,anchorY:n,fontSize:r,sdfGlyphSize:t},l),d)});/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const Lr={LEFT:1,RIGHT:2,MIDDLE:4},$e=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),Gg={NONE:0,IN:1,OUT:-1};function mp(t){return t.isPerspectiveCamera}function Oh(t){return t.isOrthographicCamera}const Vg=Math.PI*2,E5=Math.PI/2,J9=1e-5,xx=Math.PI/180;function Yl(t,e,n){return Math.max(e,Math.min(n,t))}function gr(t,e=J9){return Math.abs(t)<e}function Wi(t,e,n=J9){return gr(t-e,n)}function w5(t,e){return Math.round(t/e)*e}function _x(t){return isFinite(t)?t:t<0?-Number.MAX_VALUE:Number.MAX_VALUE}function bx(t){return Math.abs(t)<Number.MAX_VALUE?t:t*(1/0)}function z2(t,e,n,i,r=1/0,s){i=Math.max(1e-4,i);const a=2/i,o=a*s,l=1/(1+o+.48*o*o+.235*o*o*o);let u=t-e;const c=e,h=r*i;u=Yl(u,-h,h),e=t-u;const d=(n.value+a*u)*s;n.value=(n.value-a*d)*l;let m=e+(u+d)*l;return c-t>0==m>c&&(m=c,n.value=(m-c)/s),m}function A5(t,e,n,i,r=1/0,s,a){i=Math.max(1e-4,i);const o=2/i,l=o*s,u=1/(1+l+.48*l*l+.235*l*l*l);let c=e.x,h=e.y,d=e.z,m=t.x-c,v=t.y-h,_=t.z-d;const y=c,g=h,x=d,S=r*i,E=S*S,A=m*m+v*v+_*_;if(A>E){const Y=Math.sqrt(A);m=m/Y*S,v=v/Y*S,_=_/Y*S}c=t.x-m,h=t.y-v,d=t.z-_;const T=(n.x+o*m)*s,C=(n.y+o*v)*s,O=(n.z+o*_)*s;n.x=(n.x-o*T)*u,n.y=(n.y-o*C)*u,n.z=(n.z-o*O)*u,a.x=c+(m+T)*u,a.y=h+(v+C)*u,a.z=d+(_+O)*u;const M=y-t.x,D=g-t.y,P=x-t.z,F=a.x-y,G=a.y-g,z=a.z-x;return M*F+D*G+P*z>0&&(a.x=y,a.y=g,a.z=x,n.x=(a.x-y)/s,n.y=(a.y-g)/s,n.z=(a.z-x)/s),a}function z3(t,e){e.set(0,0),t.forEach(n=>{e.x+=n.clientX,e.y+=n.clientY}),e.x/=t.length,e.y/=t.length}function I3(t,e){return Oh(t)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}let rpe=class{constructor(){this._listeners={}}addEventListener(e,n){const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e)}}};var L3;const spe="2.10.1",I2=1/8,ape=/Mac/.test((L3=globalThis==null?void 0:globalThis.navigator)===null||L3===void 0?void 0:L3.platform);let Yn,T5,L2,P3,Ka,li,Pi,Hg,Sx,ku,Fu,gp,M5,C5,Qo,Ex,jg,R5,N3,D5,B3,k3,P2,Hs=class kD extends rpe{static install(e){Yn=e.THREE,T5=Object.freeze(new Yn.Vector3(0,0,0)),L2=Object.freeze(new Yn.Vector3(0,1,0)),P3=Object.freeze(new Yn.Vector3(0,0,1)),Ka=new Yn.Vector2,li=new Yn.Vector3,Pi=new Yn.Vector3,Hg=new Yn.Vector3,Sx=new Yn.Vector3,ku=new Yn.Vector3,Fu=new Yn.Vector3,gp=new Yn.Vector3,M5=new Yn.Vector3,C5=new Yn.Vector3,Qo=new Yn.Spherical,Ex=new Yn.Spherical,jg=new Yn.Box3,R5=new Yn.Box3,N3=new Yn.Sphere,D5=new Yn.Quaternion,B3=new Yn.Quaternion,k3=new Yn.Matrix4,P2=new Yn.Raycaster}static get ACTION(){return $e}set verticalDragToForward(e){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(e,n){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=$e.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=Gg.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new Yn.Vector3,this._focalOffsetVelocity=new Yn.Vector3,this._zoomVelocity={value:0},this._truckInternal=(g,x,S,E)=>{let A,T;if(mp(this._camera)){const C=li.copy(this._camera.position).sub(this._target),O=this._camera.getEffectiveFOV()*xx,M=C.length()*Math.tan(O*.5);A=this.truckSpeed*g*M/this._elementRect.height,T=this.truckSpeed*x*M/this._elementRect.height}else if(Oh(this._camera)){const C=this._camera;A=this.truckSpeed*g*(C.right-C.left)/C.zoom/this._elementRect.width,T=this.truckSpeed*x*(C.top-C.bottom)/C.zoom/this._elementRect.height}else return;E?(S?this.setFocalOffset(this._focalOffsetEnd.x+A,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(A,0,!0),this.forward(-T,!0)):S?this.setFocalOffset(this._focalOffsetEnd.x+A,this._focalOffsetEnd.y+T,this._focalOffsetEnd.z,!0):this.truck(A,T,!0)},this._rotateInternal=(g,x)=>{const S=Vg*this.azimuthRotateSpeed*g/this._elementRect.height,E=Vg*this.polarRotateSpeed*x/this._elementRect.height;this.rotate(S,E,!0)},this._dollyInternal=(g,x,S)=>{const E=Math.pow(.95,-g*this.dollySpeed),A=this._sphericalEnd.radius,T=this._sphericalEnd.radius*E,C=Yl(T,this.minDistance,this.maxDistance),O=C-T;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(T,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(O,!0),this._dollyToNoClamp(C,!0)):this._dollyToNoClamp(C,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?T:C)-A,this._dollyControlCoord.set(x,S)),this._lastDollyDirection=Math.sign(-g)},this._zoomInternal=(g,x,S)=>{const E=Math.pow(.95,g*this.dollySpeed),A=this._zoom,T=this._zoom*E;this.zoomTo(T,!0),this.dollyToCursor&&(this._changedZoom+=T-A,this._dollyControlCoord.set(x,S))},typeof Yn>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new Yn.Quaternion().setFromUnitVectors(this._camera.up,L2),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=$e.NONE,this._target=new Yn.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new Yn.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new Yn.Spherical().setFromVector3(li.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new Yn.Vector3,new Yn.Vector3,new Yn.Vector3,new Yn.Vector3],this._updateNearPlaneCorners(),this._boundary=new Yn.Box3(new Yn.Vector3(-1/0,-1/0,-1/0),new Yn.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new Yn.Vector2,this.mouseButtons={left:$e.ROTATE,middle:$e.DOLLY,right:$e.TRUCK,wheel:mp(this._camera)?$e.DOLLY:Oh(this._camera)?$e.ZOOM:$e.NONE},this.touches={one:$e.TOUCH_ROTATE,two:mp(this._camera)?$e.TOUCH_DOLLY_TRUCK:Oh(this._camera)?$e.TOUCH_ZOOM_TRUCK:$e.NONE,three:$e.TOUCH_TRUCK};const i=new Yn.Vector2,r=new Yn.Vector2,s=new Yn.Vector2,a=g=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const E=this._domElement.getBoundingClientRect(),A=g.clientX/E.width,T=g.clientY/E.height;if(A<this._interactiveArea.left||A>this._interactiveArea.right||T<this._interactiveArea.top||T>this._interactiveArea.bottom)return}const x=g.pointerType!=="mouse"?null:(g.buttons&Lr.LEFT)===Lr.LEFT?Lr.LEFT:(g.buttons&Lr.MIDDLE)===Lr.MIDDLE?Lr.MIDDLE:(g.buttons&Lr.RIGHT)===Lr.RIGHT?Lr.RIGHT:null;if(x!==null){const E=this._findPointerByMouseButton(x);E&&this._disposePointer(E)}if((g.buttons&Lr.LEFT)===Lr.LEFT&&this._lockedPointer)return;const S={pointerId:g.pointerId,clientX:g.clientX,clientY:g.clientY,deltaX:0,deltaY:0,mouseButton:x};this._activePointers.push(S),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.addEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),this._isDragging=!0,d(g)},o=g=>{g.cancelable&&g.preventDefault();const x=g.pointerId,S=this._lockedPointer||this._findPointerById(x);if(S){if(S.clientX=g.clientX,S.clientY=g.clientY,S.deltaX=g.movementX,S.deltaY=g.movementY,this._state=0,g.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(g.buttons&Lr.LEFT)===Lr.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(g.buttons&Lr.MIDDLE)===Lr.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(g.buttons&Lr.RIGHT)===Lr.RIGHT&&(this._state=this._state|this.mouseButtons.right);m()}},l=g=>{const x=this._findPointerById(g.pointerId);if(!(x&&x===this._lockedPointer)){if(x&&this._disposePointer(x),g.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=$e.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=$e.NONE;v()}};let u=-1;const c=g=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===$e.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const T=this._domElement.getBoundingClientRect(),C=g.clientX/T.width,O=g.clientY/T.height;if(C<this._interactiveArea.left||C>this._interactiveArea.right||O<this._interactiveArea.top||O>this._interactiveArea.bottom)return}if(g.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===$e.ROTATE||this.mouseButtons.wheel===$e.TRUCK){const T=performance.now();u-T<1e3&&this._getClientRect(this._elementRect),u=T}const x=ape?-1:-3,S=g.deltaMode===1||g.ctrlKey?g.deltaY/x:g.deltaY/(x*10),E=this.dollyToCursor?(g.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,A=this.dollyToCursor?(g.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case $e.ROTATE:{this._rotateInternal(g.deltaX,g.deltaY),this._isUserControllingRotate=!0;break}case $e.TRUCK:{this._truckInternal(g.deltaX,g.deltaY,!1,!1),this._isUserControllingTruck=!0;break}case $e.SCREEN_PAN:{this._truckInternal(g.deltaX,g.deltaY,!1,!0),this._isUserControllingTruck=!0;break}case $e.OFFSET:{this._truckInternal(g.deltaX,g.deltaY,!0,!1),this._isUserControllingOffset=!0;break}case $e.DOLLY:{this._dollyInternal(-S,E,A),this._isUserControllingDolly=!0;break}case $e.ZOOM:{this._zoomInternal(-S,E,A),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},h=g=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===kD.ACTION.NONE){const x=g instanceof PointerEvent?g.pointerId:0,S=this._findPointerById(x);S&&this._disposePointer(S),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l);return}g.preventDefault()}},d=g=>{if(!this._enabled)return;if(z3(this._activePointers,Ka),this._getClientRect(this._elementRect),i.copy(Ka),r.copy(Ka),this._activePointers.length>=2){const S=Ka.x-this._activePointers[1].clientX,E=Ka.y-this._activePointers[1].clientY,A=Math.sqrt(S*S+E*E);s.set(0,A);const T=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,C=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;r.set(T,C)}if(this._state=0,!g)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in g&&g.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(g.buttons&Lr.LEFT)===Lr.LEFT&&(this._state=this._state|this.mouseButtons.left),(g.buttons&Lr.MIDDLE)===Lr.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(g.buttons&Lr.RIGHT)===Lr.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&$e.ROTATE)===$e.ROTATE||(this._state&$e.TOUCH_ROTATE)===$e.TOUCH_ROTATE||(this._state&$e.TOUCH_DOLLY_ROTATE)===$e.TOUCH_DOLLY_ROTATE||(this._state&$e.TOUCH_ZOOM_ROTATE)===$e.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&$e.TRUCK)===$e.TRUCK||(this._state&$e.SCREEN_PAN)===$e.SCREEN_PAN||(this._state&$e.TOUCH_TRUCK)===$e.TOUCH_TRUCK||(this._state&$e.TOUCH_SCREEN_PAN)===$e.TOUCH_SCREEN_PAN||(this._state&$e.TOUCH_DOLLY_TRUCK)===$e.TOUCH_DOLLY_TRUCK||(this._state&$e.TOUCH_DOLLY_SCREEN_PAN)===$e.TOUCH_DOLLY_SCREEN_PAN||(this._state&$e.TOUCH_ZOOM_TRUCK)===$e.TOUCH_ZOOM_TRUCK||(this._state&$e.TOUCH_ZOOM_SCREEN_PAN)===$e.TOUCH_DOLLY_SCREEN_PAN)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&$e.DOLLY)===$e.DOLLY||(this._state&$e.TOUCH_DOLLY)===$e.TOUCH_DOLLY||(this._state&$e.TOUCH_DOLLY_TRUCK)===$e.TOUCH_DOLLY_TRUCK||(this._state&$e.TOUCH_DOLLY_SCREEN_PAN)===$e.TOUCH_DOLLY_SCREEN_PAN||(this._state&$e.TOUCH_DOLLY_OFFSET)===$e.TOUCH_DOLLY_OFFSET||(this._state&$e.TOUCH_DOLLY_ROTATE)===$e.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&$e.ZOOM)===$e.ZOOM||(this._state&$e.TOUCH_ZOOM)===$e.TOUCH_ZOOM||(this._state&$e.TOUCH_ZOOM_TRUCK)===$e.TOUCH_ZOOM_TRUCK||(this._state&$e.TOUCH_ZOOM_SCREEN_PAN)===$e.TOUCH_ZOOM_SCREEN_PAN||(this._state&$e.TOUCH_ZOOM_OFFSET)===$e.TOUCH_ZOOM_OFFSET||(this._state&$e.TOUCH_ZOOM_ROTATE)===$e.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&$e.OFFSET)===$e.OFFSET||(this._state&$e.TOUCH_OFFSET)===$e.TOUCH_OFFSET||(this._state&$e.TOUCH_DOLLY_OFFSET)===$e.TOUCH_DOLLY_OFFSET||(this._state&$e.TOUCH_ZOOM_OFFSET)===$e.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},m=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,z3(this._activePointers,Ka);const x=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,S=x?-x.deltaX:r.x-Ka.x,E=x?-x.deltaY:r.y-Ka.y;if(r.copy(Ka),((this._state&$e.ROTATE)===$e.ROTATE||(this._state&$e.TOUCH_ROTATE)===$e.TOUCH_ROTATE||(this._state&$e.TOUCH_DOLLY_ROTATE)===$e.TOUCH_DOLLY_ROTATE||(this._state&$e.TOUCH_ZOOM_ROTATE)===$e.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(S,E),this._isUserControllingRotate=!0),(this._state&$e.DOLLY)===$e.DOLLY||(this._state&$e.ZOOM)===$e.ZOOM){const A=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,T=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0,C=this.dollyDragInverted?-1:1;(this._state&$e.DOLLY)===$e.DOLLY?(this._dollyInternal(C*E*I2,A,T),this._isUserControllingDolly=!0):(this._zoomInternal(C*E*I2,A,T),this._isUserControllingZoom=!0)}if((this._state&$e.TOUCH_DOLLY)===$e.TOUCH_DOLLY||(this._state&$e.TOUCH_ZOOM)===$e.TOUCH_ZOOM||(this._state&$e.TOUCH_DOLLY_TRUCK)===$e.TOUCH_DOLLY_TRUCK||(this._state&$e.TOUCH_ZOOM_TRUCK)===$e.TOUCH_ZOOM_TRUCK||(this._state&$e.TOUCH_DOLLY_SCREEN_PAN)===$e.TOUCH_DOLLY_SCREEN_PAN||(this._state&$e.TOUCH_ZOOM_SCREEN_PAN)===$e.TOUCH_ZOOM_SCREEN_PAN||(this._state&$e.TOUCH_DOLLY_OFFSET)===$e.TOUCH_DOLLY_OFFSET||(this._state&$e.TOUCH_ZOOM_OFFSET)===$e.TOUCH_ZOOM_OFFSET||(this._state&$e.TOUCH_DOLLY_ROTATE)===$e.TOUCH_DOLLY_ROTATE||(this._state&$e.TOUCH_ZOOM_ROTATE)===$e.TOUCH_ZOOM_ROTATE){const A=Ka.x-this._activePointers[1].clientX,T=Ka.y-this._activePointers[1].clientY,C=Math.sqrt(A*A+T*T),O=s.y-C;s.set(0,C);const M=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,D=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&$e.TOUCH_DOLLY)===$e.TOUCH_DOLLY||(this._state&$e.TOUCH_DOLLY_ROTATE)===$e.TOUCH_DOLLY_ROTATE||(this._state&$e.TOUCH_DOLLY_TRUCK)===$e.TOUCH_DOLLY_TRUCK||(this._state&$e.TOUCH_DOLLY_SCREEN_PAN)===$e.TOUCH_DOLLY_SCREEN_PAN||(this._state&$e.TOUCH_DOLLY_OFFSET)===$e.TOUCH_DOLLY_OFFSET?(this._dollyInternal(O*I2,M,D),this._isUserControllingDolly=!0):(this._zoomInternal(O*I2,M,D),this._isUserControllingZoom=!0)}((this._state&$e.TRUCK)===$e.TRUCK||(this._state&$e.TOUCH_TRUCK)===$e.TOUCH_TRUCK||(this._state&$e.TOUCH_DOLLY_TRUCK)===$e.TOUCH_DOLLY_TRUCK||(this._state&$e.TOUCH_ZOOM_TRUCK)===$e.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(S,E,!1,!1),this._isUserControllingTruck=!0),((this._state&$e.SCREEN_PAN)===$e.SCREEN_PAN||(this._state&$e.TOUCH_SCREEN_PAN)===$e.TOUCH_SCREEN_PAN||(this._state&$e.TOUCH_DOLLY_SCREEN_PAN)===$e.TOUCH_DOLLY_SCREEN_PAN||(this._state&$e.TOUCH_ZOOM_SCREEN_PAN)===$e.TOUCH_ZOOM_SCREEN_PAN)&&(this._truckInternal(S,E,!1,!0),this._isUserControllingTruck=!0),((this._state&$e.OFFSET)===$e.OFFSET||(this._state&$e.TOUCH_OFFSET)===$e.TOUCH_OFFSET||(this._state&$e.TOUCH_DOLLY_OFFSET)===$e.TOUCH_DOLLY_OFFSET||(this._state&$e.TOUCH_ZOOM_OFFSET)===$e.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(S,E,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},v=()=>{z3(this._activePointers,Ka),r.copy(Ka),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",_),this._domElement.ownerDocument.addEventListener("pointerlockerror",y),this._domElement.ownerDocument.addEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),d())},this.unlockPointer=()=>{var g,x,S;this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),(g=this._domElement)===null||g===void 0||g.ownerDocument.exitPointerLock(),(x=this._domElement)===null||x===void 0||x.ownerDocument.removeEventListener("pointerlockchange",_),(S=this._domElement)===null||S===void 0||S.ownerDocument.removeEventListener("pointerlockerror",y),this.cancel()};const _=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},y=()=>{this.unlockPointer()};this._addAllEventListeners=g=>{this._domElement=g,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",a),this._domElement.addEventListener("pointercancel",l),this._domElement.addEventListener("wheel",c,{passive:!1}),this._domElement.addEventListener("contextmenu",h)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",a),this._domElement.removeEventListener("pointercancel",l),this._domElement.removeEventListener("wheel",c,{passive:!1}),this._domElement.removeEventListener("contextmenu",h),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.removeEventListener("pointerlockchange",_),this._domElement.ownerDocument.removeEventListener("pointerlockerror",y))},this.cancel=()=>{this._state!==$e.NONE&&(this._state=$e.NONE,this._activePointers.length=0,v())},n&&this.connect(n),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=Yl(e.width,0,1),this._interactiveArea.height=Yl(e.height,0,1),this._interactiveArea.x=Yl(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=Yl(e.y,0,1-this._interactiveArea.height)}addEventListener(e,n){super.addEventListener(e,n)}removeEventListener(e,n){super.removeEventListener(e,n)}rotate(e,n,i=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+n,i)}rotateAzimuthTo(e,n=!1){return this.rotateTo(e,this._sphericalEnd.phi,n)}rotatePolarTo(e,n=!1){return this.rotateTo(this._sphericalEnd.theta,e,n)}rotateTo(e,n,i=!1){this._isUserControllingRotate=!1;const r=Yl(e,this.minAzimuthAngle,this.maxAzimuthAngle),s=Yl(n,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=s,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,i||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const a=!i||Wi(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Wi(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(a)}dolly(e,n=!1){return this.dollyTo(this._sphericalEnd.radius-e,n)}dollyTo(e,n=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=Gg.NONE,this._changedDolly=0,this._dollyToNoClamp(Yl(e,this.minDistance,this.maxDistance),n)}_dollyToNoClamp(e,n=!1){const i=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const a=this._collisionTest(),o=Wi(a,this._spherical.radius);if(!(i>e)&&o)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,a)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,n||(this._spherical.radius=this._sphericalEnd.radius);const s=!n||Wi(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(s)}dollyInFixed(e,n=!1){this._targetEnd.add(this._getCameraDirection(Sx).multiplyScalar(e)),n||this._target.copy(this._targetEnd);const i=!n||Wi(this._target.x,this._targetEnd.x,this.restThreshold)&&Wi(this._target.y,this._targetEnd.y,this.restThreshold)&&Wi(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}zoom(e,n=!1){return this.zoomTo(this._zoomEnd+e,n)}zoomTo(e,n=!1){this._isUserControllingZoom=!1,this._zoomEnd=Yl(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,n||(this._zoom=this._zoomEnd);const i=!n||Wi(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(i)}pan(e,n,i=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,n,i)}truck(e,n,i=!1){this._camera.updateMatrix(),ku.setFromMatrixColumn(this._camera.matrix,0),Fu.setFromMatrixColumn(this._camera.matrix,1),ku.multiplyScalar(e),Fu.multiplyScalar(-n);const r=li.copy(ku).add(Fu),s=Pi.copy(this._targetEnd).add(r);return this.moveTo(s.x,s.y,s.z,i)}forward(e,n=!1){li.setFromMatrixColumn(this._camera.matrix,0),li.crossVectors(this._camera.up,li),li.multiplyScalar(e);const i=Pi.copy(this._targetEnd).add(li);return this.moveTo(i.x,i.y,i.z,n)}elevate(e,n=!1){return li.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+li.x,this._targetEnd.y+li.y,this._targetEnd.z+li.z,n)}moveTo(e,n,i,r=!1){this._isUserControllingTruck=!1;const s=li.set(e,n,i).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,s,this.boundaryFriction),this._needsUpdate=!0,r||this._target.copy(this._targetEnd);const a=!r||Wi(this._target.x,this._targetEnd.x,this.restThreshold)&&Wi(this._target.y,this._targetEnd.y,this.restThreshold)&&Wi(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(a)}lookInDirectionOf(e,n,i,r=!1){const o=li.set(e,n,i).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(o.x,o.y,o.z,r)}fitToBox(e,n,{cover:i=!1,paddingLeft:r=0,paddingRight:s=0,paddingBottom:a=0,paddingTop:o=0}={}){const l=[],u=e.isBox3?jg.copy(e):jg.setFromObject(e);u.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const c=w5(this._sphericalEnd.theta,E5),h=w5(this._sphericalEnd.phi,E5);l.push(this.rotateTo(c,h,n));const d=li.setFromSpherical(this._sphericalEnd).normalize(),m=D5.setFromUnitVectors(d,P3),v=Wi(Math.abs(d.y),1);v&&m.multiply(B3.setFromAxisAngle(L2,c)),m.multiply(this._yAxisUpSpaceInverse);const _=R5.makeEmpty();Pi.copy(u.min).applyQuaternion(m),_.expandByPoint(Pi),Pi.copy(u.min).setX(u.max.x).applyQuaternion(m),_.expandByPoint(Pi),Pi.copy(u.min).setY(u.max.y).applyQuaternion(m),_.expandByPoint(Pi),Pi.copy(u.max).setZ(u.min.z).applyQuaternion(m),_.expandByPoint(Pi),Pi.copy(u.min).setZ(u.max.z).applyQuaternion(m),_.expandByPoint(Pi),Pi.copy(u.max).setY(u.min.y).applyQuaternion(m),_.expandByPoint(Pi),Pi.copy(u.max).setX(u.min.x).applyQuaternion(m),_.expandByPoint(Pi),Pi.copy(u.max).applyQuaternion(m),_.expandByPoint(Pi),_.min.x-=r,_.min.y-=a,_.max.x+=s,_.max.y+=o,m.setFromUnitVectors(P3,d),v&&m.premultiply(B3.invert()),m.premultiply(this._yAxisUpSpace);const y=_.getSize(li),g=_.getCenter(Pi).applyQuaternion(m);if(mp(this._camera)){const x=this.getDistanceToFitBox(y.x,y.y,y.z,i);l.push(this.moveTo(g.x,g.y,g.z,n)),l.push(this.dollyTo(x,n)),l.push(this.setFocalOffset(0,0,0,n))}else if(Oh(this._camera)){const x=this._camera,S=x.right-x.left,E=x.top-x.bottom,A=i?Math.max(S/y.x,E/y.y):Math.min(S/y.x,E/y.y);l.push(this.moveTo(g.x,g.y,g.z,n)),l.push(this.zoomTo(A,n)),l.push(this.setFocalOffset(0,0,0,n))}return Promise.all(l)}fitToSphere(e,n){const i=[],s="isObject3D"in e?kD.createBoundingSphere(e,N3):N3.copy(e);if(i.push(this.moveTo(s.center.x,s.center.y,s.center.z,n)),mp(this._camera)){const a=this.getDistanceToFitSphere(s.radius);i.push(this.dollyTo(a,n))}else if(Oh(this._camera)){const a=this._camera.right-this._camera.left,o=this._camera.top-this._camera.bottom,l=2*s.radius,u=Math.min(a/l,o/l);i.push(this.zoomTo(u,n))}return i.push(this.setFocalOffset(0,0,0,n)),Promise.all(i)}setLookAt(e,n,i,r,s,a,o=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Gg.NONE,this._changedDolly=0;const l=Pi.set(r,s,a),u=li.set(e,n,i);this._targetEnd.copy(l),this._sphericalEnd.setFromVector3(u.sub(l).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const c=!o||Wi(this._target.x,this._targetEnd.x,this.restThreshold)&&Wi(this._target.y,this._targetEnd.y,this.restThreshold)&&Wi(this._target.z,this._targetEnd.z,this.restThreshold)&&Wi(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Wi(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Wi(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(c)}lerpLookAt(e,n,i,r,s,a,o,l,u,c,h,d,m,v=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Gg.NONE,this._changedDolly=0;const _=li.set(r,s,a),y=Pi.set(e,n,i);Qo.setFromVector3(y.sub(_).applyQuaternion(this._yAxisUpSpace));const g=Hg.set(c,h,d),x=Pi.set(o,l,u);Ex.setFromVector3(x.sub(g).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(_.lerp(g,m));const S=Ex.theta-Qo.theta,E=Ex.phi-Qo.phi,A=Ex.radius-Qo.radius;this._sphericalEnd.set(Qo.radius+A*m,Qo.phi+E*m,Qo.theta+S*m),this.normalizeRotations(),this._needsUpdate=!0,v||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const T=!v||Wi(this._target.x,this._targetEnd.x,this.restThreshold)&&Wi(this._target.y,this._targetEnd.y,this.restThreshold)&&Wi(this._target.z,this._targetEnd.z,this.restThreshold)&&Wi(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Wi(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Wi(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(T)}setPosition(e,n,i,r=!1){return this.setLookAt(e,n,i,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)}setTarget(e,n,i,r=!1){const s=this.getPosition(li),a=this.setLookAt(s.x,s.y,s.z,e,n,i,r);return this._sphericalEnd.phi=Yl(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),a}setFocalOffset(e,n,i,r=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,n,i),this._needsUpdate=!0,r||this._focalOffset.copy(this._focalOffsetEnd);const s=!r||Wi(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Wi(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Wi(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}setOrbitPoint(e,n,i){this._camera.updateMatrixWorld(),ku.setFromMatrixColumn(this._camera.matrixWorldInverse,0),Fu.setFromMatrixColumn(this._camera.matrixWorldInverse,1),gp.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const r=li.set(e,n,i),s=r.distanceTo(this._camera.position),a=r.sub(this._camera.position);ku.multiplyScalar(a.x),Fu.multiplyScalar(a.y),gp.multiplyScalar(a.z),li.copy(ku).add(Fu).add(gp),li.z=li.z+s,this.dollyTo(s,!1),this.setFocalOffset(-li.x,li.y,-li.z,!1),this.moveTo(e,n,i,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,n,i,r){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new Yn.Vector4,typeof e=="number"?this._viewport.set(e,n,i,r):this._viewport.copy(e)}getDistanceToFitBox(e,n,i,r=!1){if(I3(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const s=e/n,a=this._camera.getEffectiveFOV()*xx,o=this._camera.aspect;return((r?s>o:s<o)?n:e/o)*.5/Math.tan(a*.5)+i*.5}getDistanceToFitSphere(e){if(I3(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const n=this._camera.getEffectiveFOV()*xx,i=Math.atan(Math.tan(n*.5)*this._camera.aspect)*2,r=1<this._camera.aspect?n:i;return e/Math.sin(r*.5)}getTarget(e,n=!0){return(e&&e.isVector3?e:new Yn.Vector3).copy(n?this._targetEnd:this._target)}getPosition(e,n=!0){return(e&&e.isVector3?e:new Yn.Vector3).setFromSpherical(n?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(n?this._targetEnd:this._target)}getSpherical(e,n=!0){return(e||new Yn.Spherical).copy(n?this._sphericalEnd:this._spherical)}getFocalOffset(e,n=!0){return(e&&e.isVector3?e:new Yn.Vector3).copy(n?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%Vg,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=Vg),this._spherical.theta+=Vg*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Vg)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!Wi(this._camera.up.x,this._cameraUp0.x)||!Wi(this._camera.up.y,this._cameraUp0.y)||!Wi(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const i=this.getPosition(li);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}const n=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(n)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,L2),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=li.subVectors(this._target,this._camera.position).normalize(),n=Pi.crossVectors(e,this._camera.up);this._camera.up.crossVectors(n,e).normalize(),this._camera.updateMatrixWorld();const i=this.getPosition(li);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}update(e){const n=this._sphericalEnd.theta-this._spherical.theta,i=this._sphericalEnd.phi-this._spherical.phi,r=this._sphericalEnd.radius-this._spherical.radius,s=M5.subVectors(this._targetEnd,this._target),a=C5.subVectors(this._focalOffsetEnd,this._focalOffset),o=this._zoomEnd-this._zoom;if(gr(n))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const h=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=z2(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,h,1/0,e),this._needsUpdate=!0}if(gr(i))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const h=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=z2(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,h,1/0,e),this._needsUpdate=!0}if(gr(r))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const h=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=z2(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,h,this.maxSpeed,e),this._needsUpdate=!0}if(gr(s.x)&&gr(s.y)&&gr(s.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const h=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;A5(this._target,this._targetEnd,this._targetVelocity,h,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(gr(a.x)&&gr(a.y)&&gr(a.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const h=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;A5(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,h,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(gr(o))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const h=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=z2(this._zoom,this._zoomEnd,this._zoomVelocity,h,1/0,e)}if(this.dollyToCursor){if(mp(this._camera)&&this._changedDolly!==0){const h=this._spherical.radius-this._lastDistance,d=this._camera,m=this._getCameraDirection(Sx),v=li.copy(m).cross(d.up).normalize();v.lengthSq()===0&&(v.x=1);const _=Pi.crossVectors(v,m),y=this._sphericalEnd.radius*Math.tan(d.getEffectiveFOV()*xx*.5),x=(this._sphericalEnd.radius-h-this._sphericalEnd.radius)/this._sphericalEnd.radius,S=Hg.copy(this._targetEnd).add(v.multiplyScalar(this._dollyControlCoord.x*y*d.aspect)).add(_.multiplyScalar(this._dollyControlCoord.y*y)),E=li.copy(this._targetEnd).lerp(S,x),A=this._lastDollyDirection===Gg.IN&&this._spherical.radius<=this.minDistance,T=this._lastDollyDirection===Gg.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(A||T)){this._sphericalEnd.radius-=h,this._spherical.radius-=h;const O=Pi.copy(m).multiplyScalar(-h);E.add(O)}this._boundary.clampPoint(E,E);const C=Pi.subVectors(E,this._targetEnd);this._targetEnd.copy(E),this._target.add(C),this._changedDolly-=h,gr(this._changedDolly)&&(this._changedDolly=0)}else if(Oh(this._camera)&&this._changedZoom!==0){const h=this._zoom-this._lastZoom,d=this._camera,m=li.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(d.near+d.far)/(d.near-d.far)).unproject(d),v=Pi.set(0,0,-1).applyQuaternion(d.quaternion),_=Hg.copy(m).add(v.multiplyScalar(-m.dot(d.up))),g=-(this._zoom-h-this._zoom)/this._zoom,x=this._getCameraDirection(Sx),S=this._targetEnd.dot(x),E=li.copy(this._targetEnd).lerp(_,g),A=E.dot(x),T=x.multiplyScalar(A-S);E.sub(T),this._boundary.clampPoint(E,E);const C=Pi.subVectors(E,this._targetEnd);this._targetEnd.copy(E),this._target.add(C),this._changedZoom-=h,gr(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const l=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,l),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!gr(this._focalOffset.x)||!gr(this._focalOffset.y)||!gr(this._focalOffset.z))&&(ku.setFromMatrixColumn(this._camera.matrix,0),Fu.setFromMatrixColumn(this._camera.matrix,1),gp.setFromMatrixColumn(this._camera.matrix,2),ku.multiplyScalar(this._focalOffset.x),Fu.multiplyScalar(-this._focalOffset.y),gp.multiplyScalar(this._focalOffset.z),li.copy(ku).add(Fu).add(gp),this._camera.position.add(li),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),li.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const c=this._needsUpdate;return c&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):c?(this.dispatchEvent({type:"update"}),gr(n,this.restThreshold)&&gr(i,this.restThreshold)&&gr(r,this.restThreshold)&&gr(s.x,this.restThreshold)&&gr(s.y,this.restThreshold)&&gr(s.z,this.restThreshold)&&gr(a.x,this.restThreshold)&&gr(a.y,this.restThreshold)&&gr(a.z,this.restThreshold)&&gr(o,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!c&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=c,this._needsUpdate=!1,c}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:_x(this.maxDistance),minZoom:this.minZoom,maxZoom:_x(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:_x(this.maxPolarAngle),minAzimuthAngle:_x(this.minAzimuthAngle),maxAzimuthAngle:_x(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:li.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,n=!1){const i=JSON.parse(e);this.enabled=i.enabled,this.minDistance=i.minDistance,this.maxDistance=bx(i.maxDistance),this.minZoom=i.minZoom,this.maxZoom=bx(i.maxZoom),this.minPolarAngle=i.minPolarAngle,this.maxPolarAngle=bx(i.maxPolarAngle),this.minAzimuthAngle=bx(i.minAzimuthAngle),this.maxAzimuthAngle=bx(i.maxAzimuthAngle),this.smoothTime=i.smoothTime,this.draggingSmoothTime=i.draggingSmoothTime,this.dollySpeed=i.dollySpeed,this.truckSpeed=i.truckSpeed,this.dollyToCursor=i.dollyToCursor,this._target0.fromArray(i.target0),this._position0.fromArray(i.position0),this._zoom0=i.zoom0,this._focalOffset0.fromArray(i.focalOffset0),this.moveTo(i.target[0],i.target[1],i.target[2],n),Qo.setFromVector3(li.fromArray(i.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Qo.theta,Qo.phi,n),this.dollyTo(Qo.radius,n),this.zoomTo(i.zoom,n),this.setFocalOffset(i.focalOffset[0],i.focalOffset[1],i.focalOffset[2],n),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",spe),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(n=>n.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(n=>n.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,n,i){const r=n.lengthSq();if(r===0)return e;const s=Pi.copy(n).add(e),o=this._boundary.clampPoint(s,Hg).sub(s),l=o.lengthSq();if(l===0)return e.add(n);if(l===r)return e;if(i===0)return e.add(n).add(o);{const u=1+i*l/n.dot(o);return e.add(Pi.copy(n).multiplyScalar(u)).add(o.multiplyScalar(1-i))}}_updateNearPlaneCorners(){if(mp(this._camera)){const e=this._camera,n=e.near,i=e.getEffectiveFOV()*xx,r=Math.tan(i*.5)*n,s=r*e.aspect;this._nearPlaneCorners[0].set(-s,-r,0),this._nearPlaneCorners[1].set(s,-r,0),this._nearPlaneCorners[2].set(s,r,0),this._nearPlaneCorners[3].set(-s,r,0)}else if(Oh(this._camera)){const e=this._camera,n=1/e.zoom,i=e.left*n,r=e.right*n,s=e.top*n,a=e.bottom*n;this._nearPlaneCorners[0].set(i,s,0),this._nearPlaneCorners[1].set(r,s,0),this._nearPlaneCorners[2].set(r,a,0),this._nearPlaneCorners[3].set(i,a,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||I3(this._camera,"_collisionTest"))return e;const i=this._getTargetDirection(Sx);k3.lookAt(T5,i,this._camera.up);for(let r=0;r<4;r++){const s=Pi.copy(this._nearPlaneCorners[r]);s.applyMatrix4(k3);const a=Hg.addVectors(this._target,s);P2.set(a,i),P2.far=this._spherical.radius+1;const o=P2.intersectObjects(this.colliderMeshes);o.length!==0&&o[0].distance<e&&(e=o[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const n=this._domElement.getBoundingClientRect();return e.x=n.left,e.y=n.top,this._viewport?(e.x+=this._viewport.x,e.y+=n.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=n.width,e.height=n.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(n=>{const i=()=>{this.removeEventListener("rest",i),n()};this.addEventListener("rest",i)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,n=new Yn.Sphere){const i=n,r=i.center;jg.makeEmpty(),e.traverseVisible(a=>{a.isMesh&&jg.expandByObject(a)}),jg.getCenter(r);let s=0;return e.traverseVisible(a=>{if(!a.isMesh)return;const o=a;if(!o.geometry)return;const l=o.geometry.clone();l.applyMatrix4(o.matrixWorld);const c=l.attributes.position;for(let h=0,d=c.count;h<d;h++)li.fromBufferAttribute(c,h),s=Math.max(s,r.distanceToSquared(li))}),i.radius=Math.sqrt(s),i}};const ope="modulepreload",lpe=function(t){return"/"+t},O5={},upe=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(n.map(l=>{if(l=lpe(l),l in O5)return;O5[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":ope,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((d,m)=>{h.addEventListener("load",d),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};var ZT={exports:{}},U5={ellipse:"…",chars:[" ","-"],max:140,truncate:!0};function $9(t,e,n,i){if(t<=e)return t;if(e<2)return t.slice(0,e-n.length)+n;for(var r=e-n.length,s=Math.floor(r/2),a=s,o=t.length-s,l=0;l<s;l++){var u=t.charAt(l),c=t.length-l,h=t.charAt(c);i.indexOf(u)!==-1&&(a=l),i.indexOf(h)!==-1&&(o=c)}return t.slice(0,a)+n+t.slice(o)}function e7(t,e,n,i,r){if(t.length<=e)return t;for(var s=e-n.length,a=s,o=0;o<=s;o++){var l=t.charAt(o);i.indexOf(l)!==-1&&(a=o)}return!r&&a==s?"":t.slice(0,a)+n}ZT.exports=function(t,e,n){if(typeof t!="string"||t.length===0||e===0)return"";n=n||{};for(var i in U5)(n[i]===null||typeof n[i]>"u")&&(n[i]=U5[i]);return n.max=e||n.max,n.truncate=="middle"?$9(t,n.max,n.ellipse,n.chars):e7(t,n.max,n.ellipse,n.chars,n.truncate)};ZT.exports.ellipsizeMiddle=$9;ZT.exports.ellipsize=e7;var cpe=ZT.exports;const fpe=Lo(cpe),h_=({text:t,fontSize:e=7,fontUrl:n,color:i="#2A6475",opacity:r=1,stroke:s,active:a,ellipsis:o=75,rotation:l})=>{const u=o&&!a?fpe(t,o):t,c=V.useMemo(()=>new nn(i),[i]),h=V.useMemo(()=>s?new nn(s):void 0,[s]);return B.jsx(k9,{position:[0,0,1],children:B.jsx(ipe,{font:n,fontSize:e,color:c,fillOpacity:r,textAlign:"center",outlineWidth:s?1:0,outlineColor:h,depthOffset:0,maxWidth:100,overflowWrap:"break-word",rotation:l,children:u})})},t7=({draggable:t,set:e,position:n,bounds:i,onDragStart:r,onDragEnd:s})=>{const a=xs(y=>y.camera),o=xs(y=>y.raycaster),l=xs(y=>y.size),u=xs(y=>y.gl),{mouse2D:c,mouse3D:h,offset:d,normal:m,plane:v}=V.useMemo(()=>({mouse2D:new Tt,mouse3D:new re,offset:new re,normal:new re,plane:new ef}),[]),_=V.useMemo(()=>u.domElement.getBoundingClientRect(),[u.domElement]);return ode({onDragStart:({event:y})=>{const{eventObject:g,point:x}=y;g.getWorldPosition(d).sub(x),h.copy(x),r()},onDrag:({xy:y,buttons:g,cancel:x})=>{if(g!==1){x();return}const S=(y[0]-((_==null?void 0:_.left)??0))/l.width*2-1,E=-((y[1]-((_==null?void 0:_.top)??0))/l.height)*2+1;c.set(S,E),o.setFromCamera(c,a),a.getWorldDirection(m).negate(),v.setFromNormalAndCoplanarPoint(m,h),o.ray.intersectPlane(v,h);const A=new re(n.x,n.y,n.z).copy(h).add(d);if(i){const T=new re((i.minX+i.maxX)/2,(i.minY+i.maxY)/2,(i.minZ+i.maxZ)/2),C=(i.maxX-i.minX)/2,O=A.clone().sub(T);O.length()>C&&(O.normalize().multiplyScalar(C),A.copy(T).add(O))}return e(A)},onDragEnd:s},{drag:{enabled:t,threshold:10}})},iI=({sensitivity:t=7,interval:e=50,timeout:n=0,disabled:i,onPointerOver:r,onPointerOut:s})=>{const a=V.useRef(!1),o=V.useRef(null),l=V.useRef(0),u=V.useRef({x:null,y:null,px:null,py:null}),c=V.useCallback(y=>{u.current.x=y.clientX,u.current.y=y.clientY},[]),h=V.useCallback(y=>{o.current=clearTimeout(o.current);const{px:g,x,py:S,y:E}=u.current;Math.abs(g-x)+Math.abs(S-E)<t?(l.current=1,r(y)):(u.current.px=x,u.current.py=E,o.current=setTimeout(()=>h(y),e))},[e,r,t]),d=V.useCallback(()=>{clearTimeout(o.current),typeof window<"u"&&document.removeEventListener("mousemove",c,!1)},[c]),m=V.useCallback(y=>{i||(a.current=!0,d(),l.current!==1&&(u.current.px=y.pointer.x,u.current.py=y.pointer.y,typeof window<"u"&&document.addEventListener("mousemove",c,!1),o.current=setTimeout(()=>h(y),n)))},[d,h,i,c,n]),v=V.useCallback(y=>{o.current=clearTimeout(o.current),l.current=0,s(y)},[s]),_=V.useCallback(y=>{a.current=!1,d(),l.current===1&&(o.current=setTimeout(()=>v(y),n))},[d,v,n]);return{pointerOver:m,pointerOut:_}},n7=V.createContext({controls:null,resetControls:()=>{},zoomIn:()=>{},zoomOut:()=>{},dollyIn:()=>{},dollyOut:()=>{},panLeft:()=>{},panRight:()=>{},panUp:()=>{},panDown:()=>{},freeze:()=>{},unFreeze:()=>{}}),qT=()=>{const t=V.useContext(n7);if(t===void 0)throw new Error("`useCameraControls` hook must be used within a `ControlsProvider` component");return t},hpe=({outerRadius:t,innerRadius:e,padding:n,normalizedFill:i,normalizedStroke:r,opacity:s,animated:a,theme:o})=>{var u;const{opacity:l}=zo({from:{opacity:0},to:{opacity:s},config:{...Uo,duration:a?void 0:0}});return B.jsxs(B.Fragment,{children:[B.jsxs("mesh",{children:[B.jsx("ringGeometry",{attach:"geometry",args:[t,0,128]}),B.jsx(ns.meshBasicMaterial,{attach:"material",color:i,transparent:!0,depthTest:!1,opacity:(u=o.cluster)!=null&&u.fill?l:0,side:es,fog:!0})]}),B.jsxs("mesh",{children:[B.jsx("ringGeometry",{attach:"geometry",args:[t,e+n,128]}),B.jsx(ns.meshBasicMaterial,{attach:"material",color:r,transparent:!0,depthTest:!1,opacity:l,side:es,fog:!0})]})]})},dpe=({animated:t,position:e,padding:n=40,labelFontUrl:i,disabled:r,radius:s=2,nodes:a,label:o,onClick:l,onPointerOver:u,onPointerOut:c,draggable:h=!1,onDragged:d,onRender:m})=>{var se,ve,pe,xe,ot,st,et;const v=sn(Te=>Te.theme),_=Math.max(e.width,e.height)/2,y=_-s+n,[g,x]=V.useState(!1),S=sn(Te=>Te.centerPosition),E=sn(Te=>Te.nodes),A=qT(),T=sn(Te=>Te.draggingIds),C=T.includes(o),O=T.length>0,M=sn(Te=>{var Xe;return(Xe=Te.actives)==null?void 0:Xe.some(K=>a.some(Pe=>Pe.id===K))}),D=sn(Te=>Te.hoveredNodeId),P=sn(Te=>{var Xe;return(Xe=Te.selections)==null?void 0:Xe.some(K=>a.some(Pe=>Pe.id===K))}),G=sn(Te=>{var Xe;return((Xe=Te.selections)==null?void 0:Xe.length)>0})?P||g||M?(se=v.cluster)==null?void 0:se.selectedOpacity:(ve=v.cluster)==null?void 0:ve.inactiveOpacity:(pe=v.cluster)==null?void 0:pe.opacity,z=V.useMemo(()=>{var K,Pe;const Te=[0,-y,2],Xe=(Pe=(K=v.cluster)==null?void 0:K.label)==null?void 0:Pe.offset;return Xe?[Te[0]-Xe[0],Te[1]-Xe[1],Te[2]-Xe[2]]:Te},[y,(ot=(xe=v.cluster)==null?void 0:xe.label)==null?void 0:ot.offset]),{circlePosition:Y}=zo({from:{circlePosition:[S.x,S.y,-1]},to:{circlePosition:e?[e.x,e.y,-1]:[0,0,-1]},config:{...Uo,duration:t&&!O?void 0:0}}),N=V.useMemo(()=>{var Te;return new nn((Te=v.cluster)==null?void 0:Te.stroke)},[(st=v.cluster)==null?void 0:st.stroke]),k=V.useMemo(()=>{var Te;return new nn((Te=v.cluster)==null?void 0:Te.fill)},[(et=v.cluster)==null?void 0:et.fill]),j=sn(Te=>Te.addDraggingId),X=sn(Te=>Te.removeDraggingId),Q=sn(Te=>Te.setClusterPosition),H=t7({draggable:h&&!D,position:{x:e.x,y:e.y,z:-1},set:Te=>Q(o,Te),onDragStart:()=>{j(o),x(!0)},onDragEnd:()=>{X(o),x(!1);const Te=E.filter(Xe=>Xe.cluster===o);d==null||d({nodes:Te,label:o})}});Gp(g&&!O&&l!==void 0,"pointer"),Gp(g&&h&&!C&&l===void 0,"grab"),Gp(C,"grabbing");const{pointerOver:$,pointerOut:ne}=iI({disabled:r,onPointerOver:Te=>{x(!0),A.freeze(),u==null||u({nodes:a,label:o},Te)},onPointerOut:Te=>{x(!1),A.unFreeze(),c==null||c({nodes:a,label:o},Te)}});return V.useMemo(()=>{var Te,Xe,K;return v.cluster&&B.jsx(ns.group,{userData:{id:o,type:"cluster"},position:Y,onPointerOver:$,onPointerOut:ne,onClick:Pe=>{!r&&!C&&(l==null||l({nodes:a,label:o},Pe))},...H(),children:m?m({label:{position:z,text:o,opacity:G,fontUrl:i},opacity:G,outerRadius:y,innerRadius:_,padding:n,theme:v}):B.jsxs(B.Fragment,{children:[B.jsx(hpe,{outerRadius:y,innerRadius:_,padding:n,normalizedFill:k,normalizedStroke:N,opacity:G,animated:t,theme:v}),((Te=v.cluster)==null?void 0:Te.label)&&B.jsx(ns.group,{position:z,children:B.jsx(h_,{text:o,opacity:G,fontUrl:i,stroke:v.cluster.label.stroke,active:!1,color:(Xe=v.cluster)==null?void 0:Xe.label.color,fontSize:((K=v.cluster)==null?void 0:K.label.fontSize)??12})})]})})},[v,Y,$,ne,y,k,_,n,N,z,o,G,i,r,l,a,H,C,m,t])},z5=new Pf(0,0,0);function ppe(t,e){const n=V.useRef(null);sn(l=>l.theme),sn(l=>{n.current=l});const i=V.useRef(new Map);V.useRef(new Pf(0,0,0));const r=V.useRef(null),s=e==="curved",a=V.useCallback(l=>{const u=[],c=i.current,{nodes:h}=n.current,d=new Map(h.map(m=>[m.id,m]));return t!=="none"&&!r.current&&(r.current=new gv(0,1,1,20,1,!0)),l.forEach(m=>{const{target:v,source:_,size:y=1}=m,g=d.get(_),x=d.get(v);if(!g||!x)return;const S=`${g.position.x},${g.position.y},${x.position.x},${x.position.y},${y}`;if(c.has(S)){u.push(c.get(S));return}const E=i_(g),A=g.size,T=i_(x),C=x.size;let O=n_(E,A,T,C,s),M=new em(O,20,y/2,5,!1);if(t==="none"){u.push(M),c.set(S,M);return}const[D,P]=lH(y),F=r.current.clone();F.scale(P,D,P);const[G,z]=oH(t,O,D),Y=new ra;if(Y.setFromUnitVectors(new re(0,1,0),z),F.applyQuaternion(Y),F.translate(G.x,G.y,G.z),t&&t==="end"){const k=n_(E,A,G,0,s);M=new em(k,20,y/2,5,!1)}const N=R2([M,F]);u.push(N),c.set(S,N)}),u},[t,s]),o=V.useCallback((l,u)=>{const c=a(l),h=a(u);return R2([h.length?R2(h):z5,c.length?R2(c):z5],!0)},[a]);return{getGeometries:a,getGeometry:o}}function mpe(t,e,n){const i=V.useRef(t);V.useEffect(()=>{i.current=t},[t]);const r=sn(h=>h.edgeContextMenus),s=sn(V.useCallback(h=>h.setEdgeContextMenus,[])),a=V.useRef(!1),o=V.useCallback(()=>{a.current=!0},[]),l=V.useRef(!1),u=V.useCallback(()=>{l.current=!0},[]),c=V.useCallback((h,d)=>{const{onClick:m,onContextMenu:v,onPointerOver:_,onPointerOut:y}=i.current;if(m&&a.current&&!n){a.current=!1;for(const g of d)m(g)}if((e||v)&&l.current&&!n){l.current=!1;const g=new Set(r);let x=!1;for(const S of d)r.has(S.id)||(g.add(S.id),x=!0,v==null||v(S));x&&s(g)}_&&d.filter(x=>!h.includes(x)).forEach(x=>{_(x)}),y&&h.filter(x=>!d.includes(x)).forEach(x=>{y(x)})},[e,n,r,s]);return{handleClick:o,handleContextMenu:u,handleIntersections:c}}function gpe(t,e){const n=V.useRef(t),i=V.useRef(null);V.useEffect(()=>{n.current=t;const a=t.getAttribute("position");i.current=new Float32Array(a.array.length)},[t]);const r=V.useCallback(()=>{const a=n.current.getAttribute("position");return{from:new Float32Array(a.array.length),to:a.array}},[]),s=V.useCallback(a=>{const o=i.current;o.set(a);const l=new Yi(o,3,!1);n.current.setAttribute("position",l),l.needsUpdate=!0},[]);zo(()=>{if(!e)return null;const a=r();return{from:{positions:a.from},to:{positions:a.to},onChange:o=>{s(o.value.positions)},config:{...Uo,duration:e?void 0:0}}},[e,r,s])}function vpe(t,e,n){const[{activeOpacity:i,inactiveOpacity:r}]=zo(()=>({from:{activeOpacity:0,inactiveOpacity:0},to:{activeOpacity:e?n.edge.selectedOpacity:n.edge.opacity,inactiveOpacity:e?n.edge.inactiveOpacity:n.edge.opacity},config:{...Uo,duration:t?void 0:0}}),[t,e,n]);return{activeOpacity:i,inactiveOpacity:r}}const ype=({animated:t,color:e="#D8E6EA",length:n,opacity:i=.5,position:r,rotation:s,size:a=1,onActive:o,onContextMenu:l})=>{const u=V.useMemo(()=>new nn(e),[e]),c=V.useRef(null),h=sn(y=>y.draggingIds.length>0),d=sn(y=>y.centerPosition),[{pos:m,arrowOpacity:v}]=zo(()=>({from:{pos:d?[d.x,d.y,d.z]:[0,0,0],arrowOpacity:0},to:{pos:[r.x,r.y,r.z],arrowOpacity:i},config:{...Uo,duration:t&&!h?void 0:0}}),[t,h,i,r]),_=V.useCallback(()=>{var g;const y=new re(0,1,0);(g=c.current)==null||g.quaternion.setFromUnitVectors(y,s)},[s,c]);return V.useEffect(()=>_(),[_]),B.jsxs(ns.mesh,{position:m,ref:c,scale:[1,1,1],onPointerOver:()=>o(!0),onPointerOut:()=>o(!1),onPointerDown:y=>{y.nativeEvent.buttons===2&&(y.stopPropagation(),l())},children:[B.jsx("cylinderGeometry",{args:[0,a,n,20,1,!0],attach:"geometry"}),B.jsx(ns.meshBasicMaterial,{attach:"material",color:u,depthTest:!1,opacity:v,transparent:!0,side:es,fog:!0})]})},xpe=({curveOffset:t,animated:e,color:n="#000",curve:i,curved:r=!1,id:s,opacity:a=1,size:o=1,onContextMenu:l,onClick:u,onPointerOver:c,onPointerOut:h})=>{const d=V.useRef(null),m=sn(x=>x.draggingIds.length>0),v=V.useMemo(()=>new nn(n),[n]),_=sn(x=>x.centerPosition),y=V.useRef(!1),{lineOpacity:g}=zo({from:{lineOpacity:0},to:{lineOpacity:a},config:{...Uo,duration:e?void 0:0}});return zo(()=>{const x=i.getPoint(0),S=i.getPoint(1);return{from:{fromVertices:y.current?[S==null?void 0:S.x,S==null?void 0:S.y,(S==null?void 0:S.z)||0]:[_==null?void 0:_.x,_==null?void 0:_.y,(_==null?void 0:_.z)||0],toVertices:[x==null?void 0:x.x,x==null?void 0:x.y,(x==null?void 0:x.z)||0]},to:{fromVertices:[x==null?void 0:x.x,x==null?void 0:x.y,(x==null?void 0:x.z)||0],toVertices:[S==null?void 0:S.x,S==null?void 0:S.y,(S==null?void 0:S.z)||0]},onChange:E=>{const{fromVertices:A,toVertices:T}=E.value,C=new re(...A),O=new re(...T),M=n_(C,0,O,0,r,t);d.current.copy(new em(M,20,o/2,5,!1))},config:{...Uo,duration:e&&!m?void 0:0}}},[e,m,i,o]),V.useEffect(()=>{y.current=!0},[]),B.jsxs("mesh",{userData:{id:s,type:"edge"},onPointerOver:c,onPointerOut:h,onClick:u,onPointerDown:x=>{x.nativeEvent.buttons===2&&(x.stopPropagation(),l())},children:[B.jsx("tubeGeometry",{attach:"geometry",ref:d}),B.jsx(ns.meshBasicMaterial,{attach:"material",opacity:g,fog:!0,transparent:!0,depthTest:!1,color:v})]})},I5=3,_pe=({animated:t,arrowPlacement:e="end",contextMenu:n,disabled:i,labelPlacement:r="inline",id:s,interpolation:a,labelFontUrl:o,onContextMenu:l,onClick:u,onPointerOver:c,onPointerOut:h})=>{const d=sn(Xe=>Xe.theme),m=sn(Xe=>Xe.draggingIds.length>0),[v,_]=V.useState(!1),[y,g]=V.useState(!1),x=sn(Xe=>Xe.edges),S=x.find(Xe=>Xe.id===s),{target:E,source:A,label:T,labelVisible:C=!1,size:O=1,fill:M}=S,D=sn(Xe=>Xe.nodes.find(K=>K.id===A)),P=sn(Xe=>Xe.nodes.find(K=>K.id===E)),F=(O+d.edge.label.fontSize)/2,[G,z]=V.useMemo(()=>lH(O),[O]),{curveOffset:Y,curved:N}=V.useMemo(()=>Ele({edge:S,edges:x,curved:a==="curved"}),[S,x,a]),[k,j,X]=V.useMemo(()=>{const Xe=i_(D),K=D.size,Pe=i_(P),Ne=P.size;let Ve=n_(Xe,K,Pe,Ne,N,Y);const[_e,ft]=oH(e,Ve,G);return e==="end"&&(Ve=n_(Xe,K,_e,0,N,Y)),[Ve,_e,ft]},[D,P,N,Y,e,G]),Q=V.useMemo(()=>{let Xe=uH(D.position,P.position,YV(F,r));if(N){const K=new re().subVectors(Xe,k.getPoint(.5));switch(r){case"above":K.y=K.y-I5;break;case"below":K.y=K.y+I5;break}Xe=Xe.sub(K)}return Xe},[D.position,P.position,F,r,N,k]),H=sn(Xe=>{var K;return(K=Xe.selections)==null?void 0:K.includes(s)}),$=sn(Xe=>{var K;return(K=Xe.selections)==null?void 0:K.length}),ne=sn(Xe=>{var K;return(K=Xe.actives)==null?void 0:K.includes(s)}),q=sn(Xe=>Xe.centerPosition),se=$?H||ne?d.edge.selectedOpacity:d.edge.inactiveOpacity:d.edge.opacity,[{labelPosition:ve}]=zo(()=>({from:{labelPosition:q?[q.x,q.y,q.z]:[0,0,0]},to:{labelPosition:[Q.x,Q.y,Q.z]},config:{...Uo,duration:t&&!m?void 0:0}}),[Q,t,m]),pe=V.useMemo(()=>new Ea(0,0,r==="natural"?0:Math.atan((P.position.y-D.position.y)/(P.position.x-D.position.x))),[P.position.x,P.position.y,D.position.x,D.position.y,r]);Gp(v&&!m&&u!==void 0,"pointer");const{pointerOver:xe,pointerOut:ot}=iI({disabled:i,onPointerOver:Xe=>{_(!0),c==null||c(S,Xe)},onPointerOut:Xe=>{_(!1),h==null||h(S,Xe)}}),st=V.useMemo(()=>e!=="none"&&B.jsx(ype,{animated:t,color:H||v||ne?d.arrow.activeFill:M||d.arrow.fill,length:G,opacity:se,position:j,rotation:X,size:z,onActive:_,onContextMenu:()=>{i||(g(!0),l==null||l(S))}}),[M,v,t,G,e,j,X,z,i,S,ne,H,l,se,d.arrow.activeFill,d.arrow.fill]),et=V.useMemo(()=>C&&T&&B.jsx(ns.group,{position:ve,onContextMenu:()=>{i||(g(!0),l==null||l(S))},onPointerOver:xe,onPointerOut:ot,children:B.jsx(h_,{text:T,ellipsis:15,fontUrl:o,stroke:d.edge.label.stroke,color:H||v||ne?d.edge.label.activeColor:d.edge.label.color,opacity:se,fontSize:d.edge.label.fontSize,rotation:pe})}),[v,i,S,ne,H,T,o,ve,pe,C,l,ot,xe,se,d.edge.label.activeColor,d.edge.label.color,d.edge.label.fontSize,d.edge.label.stroke]),Te=V.useMemo(()=>y&&n&&B.jsx(eI,{prepend:!0,center:!0,position:Q,children:n({data:S,onClose:()=>g(!1)})}),[y,n,Q,S]);return B.jsxs("group",{children:[B.jsx(xpe,{curveOffset:Y,animated:t,color:H||v||ne?d.edge.activeFill:M||d.edge.fill,curve:k,curved:N,id:s,opacity:se,size:O,onClick:Xe=>{i||u==null||u(S,Xe)},onPointerOver:xe,onPointerOut:ot,onContextMenu:()=>{i||(g(!0),l==null||l(S))}}),st,et,Te]})},bpe=({animated:t,color:e,contextMenu:n,edge:i,labelFontUrl:r,labelPlacement:s="inline",opacity:a})=>{const o=sn(D=>D.theme),{target:l,source:u,label:c,labelVisible:h=!1,size:d=1}=i,m=sn(D=>D.nodes),[v,_]=V.useMemo(()=>[m.find(D=>D.id===u),m.find(D=>D.id===l)],[m,u,l]),y=sn(D=>D.draggingIds.length>0),g=V.useMemo(()=>(d+o.edge.label.fontSize)/2,[d,o.edge.label.fontSize]),x=V.useMemo(()=>uH(v.position,_.position,YV(g,s)),[v.position,_.position,g,s]),S=sn(D=>D.edgeContextMenus),E=sn(D=>D.setEdgeContextMenus),[{labelPosition:A}]=zo(()=>({from:{labelPosition:[0,0,0]},to:{labelPosition:[x.x,x.y,x.z]},config:{...Uo,duration:t&&!y?void 0:0}}),[x,t,y]),T=V.useCallback(D=>{S.delete(D),E(new Set(S))},[S,E]),C=V.useMemo(()=>s==="natural"?new Ea(0,0,0):new Ea(0,0,Math.atan2(_.position.y-v.position.y,_.position.x-v.position.x)),[s,_.position.y,_.position.x,v.position.y,v.position.x]),O=V.useMemo(()=>({prepend:!0,center:!0,position:x}),[x]),M=V.useMemo(()=>({text:c,ellipsis:15,fontUrl:r,stroke:o.edge.label.stroke,color:e,opacity:a,fontSize:o.edge.label.fontSize,rotation:C}),[c,r,o.edge.label.stroke,e,a,o.edge.label.fontSize,C]);return B.jsxs("group",{children:[h&&c&&B.jsx(ns.group,{position:A,children:B.jsx(h_,{...M})}),n&&S.has(i.id)&&B.jsx(eI,{...O,children:n({data:i,onClose:()=>T(i.id)})})]})},Spe=({interpolation:t="linear",arrowPlacement:e="end",labelPlacement:n="inline",animated:i=!0,contextMenu:r,disabled:s,edges:a,labelFontUrl:o,onClick:l,onContextMenu:u,onPointerOut:c,onPointerOver:h})=>{const d=sn($=>$.theme),{getGeometries:m,getGeometry:v}=ppe(e,t),_=sn($=>$.draggingIds),y=sn($=>$.edgeMeshes),g=sn($=>$.setEdgeMeshes),x=sn($=>$.actives||[]),S=sn($=>$.selections||[]),[E,A]=V.useMemo(()=>{if(!i)return[a,[]];const $=new Set([...S,...x]),ne=new Set(_),q=[],se=[];return a.forEach(ve=>{$.has(ve.source)||$.has(ve.target)||ne.has(ve.source)||ne.has(ve.target)||S.includes(ve.id)||x.includes(ve.id)?q.push(ve):se.push(ve)}),[se,q]},[a,i,S,x,_]),[T,C,O,M]=V.useMemo(()=>{const $=[],ne=[],q=[],se=[];return E.forEach(ve=>{if(_.includes(ve.source)||_.includes(ve.target)){S.includes(ve.id)||x.includes(ve.id)?q.push(ve):se.push(ve);return}S.includes(ve.id)||x.includes(ve.id)?$.push(ve):ne.push(ve)}),[$,ne,q,se]},[E,x,S,_]),D=!!S.length,P=V.useMemo(()=>v(T,C),[v,T,C]),{activeOpacity:F,inactiveOpacity:G}=vpe(i,D,d);gpe(P,i),V.useEffect(()=>{if(_.length===0){const ne=m(E).map(q=>new vr(q));g(ne)}},[m,g,E,_.length]);const z=V.useRef(new vr),Y=V.useRef(new vr),N=V.useCallback($=>{if(!$.camera)return[];const ne=$.intersectObjects(y);return ne.length?ne.map(q=>E[y.indexOf(q.object)]):[]},[y,E]),{handleClick:k,handleContextMenu:j,handleIntersections:X}=mpe({onClick:l,onContextMenu:u,onPointerOut:c,onPointerOver:h},r,s),Q=V.useRef([]),H=V.useRef([]);return DT($=>{if(z.current.geometry=P,s)return;const ne=Q.current;if((_.length||_.length===0&&ne!==null)&&(Y.current.geometry=v(O,M)),Q.current=_,_.length)return;const q=H.current,se=N($.raycaster);X(q,se),se.join()!==q.join()&&(Y.current.geometry=v(se,[])),H.current=se}),B.jsxs("group",{onClick:k,onContextMenu:j,children:[B.jsxs("mesh",{ref:z,children:[B.jsx(ns.meshBasicMaterial,{attach:"material-0",color:d.edge.fill,depthTest:!1,fog:!0,opacity:G,side:es,transparent:!0}),B.jsx(ns.meshBasicMaterial,{attach:"material-1",color:d.edge.activeFill,depthTest:!1,fog:!0,opacity:F,side:es,transparent:!0})]}),B.jsxs("mesh",{ref:Y,children:[B.jsx(ns.meshBasicMaterial,{attach:"material-0",color:d.edge.fill,depthTest:!1,fog:!0,opacity:G,side:es,transparent:!0}),B.jsx(ns.meshBasicMaterial,{attach:"material-1",color:d.edge.activeFill,depthTest:!1,fog:!0,opacity:F,side:es,transparent:!0})]}),A.map($=>B.jsx(_pe,{id:$.id,animated:i,disabled:s,labelFontUrl:o,labelPlacement:n,arrowPlacement:e,interpolation:t,contextMenu:r,onClick:l,onContextMenu:u,onPointerOver:h,onPointerOut:c},$.id)),E.map($=>B.jsx(bpe,{animated:i,contextMenu:r,color:d.edge.label.color,disabled:s,edge:$,labelFontUrl:o,labelPlacement:n},$.id))]})},Epe=({color:t="#D8E6EA",size:e=1,opacity:n=.5,animated:i,strokeWidth:r=5,innerRadius:s=4,segments:a=25})=>{const o=V.useMemo(()=>new nn(t),[t]),{ringSize:l,ringOpacity:u}=zo({from:{ringOpacity:0,ringSize:[1e-5,1e-5,1e-5]},to:{ringOpacity:n,ringSize:[e/2,e/2,1]},config:{...Uo,duration:i?void 0:0}}),c=r/10,h=s+c;return B.jsx(k9,{position:[0,0,1],children:B.jsxs(ns.mesh,{scale:l,children:[B.jsx("ringGeometry",{attach:"geometry",args:[s,h,a]}),B.jsx(ns.meshBasicMaterial,{attach:"material",color:o,transparent:!0,depthTest:!1,opacity:u,side:es,fog:!0})]})})},wpe=({color:t,id:e,size:n,selected:i,opacity:r=1,animated:s})=>{const{scale:a,nodeOpacity:o}=zo({from:{scale:[1e-5,1e-5,1e-5],nodeOpacity:0},to:{scale:[n,n,n],nodeOpacity:r},config:{...Uo,duration:s?void 0:0}}),l=V.useMemo(()=>new nn(t),[t]),u=sn(c=>c.theme);return B.jsxs(B.Fragment,{children:[B.jsxs(ns.mesh,{userData:{id:e,type:"node"},scale:a,children:[B.jsx("sphereGeometry",{attach:"geometry",args:[1,25,25]}),B.jsx(ns.meshPhongMaterial,{attach:"material",side:es,transparent:!0,fog:!0,opacity:o,color:l,emissive:l,emissiveIntensity:.7})]}),B.jsx(Epe,{opacity:i?.5:0,size:n,animated:s,color:i?u.ring.activeFill:u.ring.fill})]})},Ape=({image:t,id:e,size:n,opacity:i=1,animated:r})=>{const s=V.useMemo(()=>new _8().load(t),[t]),{scale:a,spriteOpacity:o}=zo({from:{scale:[1e-5,1e-5,1e-5],spriteOpacity:0},to:{scale:[n,n,n],spriteOpacity:i},config:{...Uo,duration:r?void 0:0}});return B.jsx(ns.sprite,{userData:{id:e,type:"node"},scale:a,children:B.jsx(ns.spriteMaterial,{attach:"material",opacity:o,fog:!0,depthTest:!1,transparent:!0,side:es,children:B.jsx("primitive",{attach:"map",object:s,minFilter:ts})})})},Tpe=({animated:t,disabled:e,id:n,draggable:i=!1,labelFontUrl:r,contextMenu:s,onClick:a,onDoubleClick:o,onPointerOver:l,onDragged:u,onPointerOut:c,onContextMenu:h,renderNode:d,constrainDragging:m})=>{var W,I,De;const v=qT(),_=sn(ge=>ge.theme),y=sn(ge=>ge.nodes.find(ze=>ze.id===n)),g=sn(ge=>ge.edges),x=sn(ge=>ge.draggingIds),S=sn(ge=>ge.collapsedNodeIds),E=sn(ge=>ge.addDraggingId),A=sn(ge=>ge.removeDraggingId),T=sn(ge=>ge.setHoveredNodeId),C=sn(ge=>ge.setNodePosition),O=sn(ge=>ge.setCollapsedNodeIds),M=sn(ge=>ge.collapsedNodeIds.includes(n)),D=sn(ge=>{var ze;return(ze=ge.actives)==null?void 0:ze.includes(n)}),P=sn(ge=>{var ze;return(ze=ge.selections)==null?void 0:ze.includes(n)}),F=sn(ge=>{var ze;return((ze=ge.selections)==null?void 0:ze.length)>0}),G=sn(ge=>ge.centerPosition),z=sn(ge=>ge.clusters.get(y.cluster)),Y=x.includes(n),N=x.length>0,{position:k,label:j,subLabel:X,size:Q=7,labelVisible:H=!0}=y,$=V.useRef(null),[ne,q]=V.useState(!1),[se,ve]=V.useState(!1),pe=ne||P||D,xe=F?pe?_.node.selectedOpacity:_.node.inactiveOpacity:_.node.opacity,ot=V.useMemo(()=>g.filter(ze=>ze.source===n).length>0||M,[g,n,M]),st=V.useCallback(()=>{ot&&O(M?S.filter(ge=>ge!==n):[...S,n])},[ot,S,n,M,O]),[{nodePosition:et,labelPosition:Te,subLabelPosition:Xe}]=zo(()=>({from:{nodePosition:G?[G.x,G.y,0]:[0,0,0],labelPosition:[0,-(Q+7),2],subLabelPosition:[0,-(Q+14),2]},to:{nodePosition:k?[k.x,k.y,pe?k.z+1:k.z]:[0,0,0],labelPosition:[0,-(Q+7),2],subLabelPosition:[0,-(Q+14),2]},config:{...Uo,duration:t&&!N?void 0:0}}),[Y,k,t,Q,pe]),K=t7({draggable:i,position:k,bounds:m?z==null?void 0:z.position:void 0,set:ge=>C(n,ge),onDragStart:()=>{E(n),q(!0)},onDragEnd:()=>{A(n),u==null||u(y)}});Gp(ne&&!N&&a!==void 0,"pointer"),Gp(ne&&i&&!Y&&a===void 0,"grab"),Gp(Y,"grabbing");const Pe=pe||Y,Ne=Pe?_.node.activeFill:y.fill||_.node.fill,{pointerOver:Ve,pointerOut:_e}=iI({disabled:e||Y,onPointerOver:ge=>{v.freeze(),q(!0),l==null||l(y,ge),T(n)},onPointerOut:ge=>{v.unFreeze(),q(!1),c==null||c(y,ge),T(null)}}),ft=V.useMemo(()=>d?d({id:n,color:Ne,size:Q,active:Pe,opacity:xe,animated:t,selected:P,node:y}):B.jsx(B.Fragment,{children:y.icon?B.jsx(Ape,{id:n,image:y.icon||"",size:Q+8,opacity:xe,animated:t,color:Ne,node:y,active:Pe,selected:P}):B.jsx(wpe,{id:n,size:Q,opacity:xe,animated:t,color:Ne,node:y,active:Pe,selected:P})}),[d,n,Ne,Q,Pe,xe,t,P,y]),ke=V.useMemo(()=>{var ge,ze,ct;return H&&(H||P||ne)&&j&&B.jsxs(B.Fragment,{children:[B.jsx(ns.group,{position:Te,children:B.jsx(h_,{text:j,fontUrl:r,opacity:xe,stroke:_.node.label.stroke,active:P||ne||Y||D,color:P||ne||Y||D?_.node.label.activeColor:_.node.label.color})}),X&&B.jsx(ns.group,{position:Xe,children:B.jsx(h_,{text:X,fontUrl:r,fontSize:5,opacity:xe,stroke:(ge=_.node.subLabel)==null?void 0:ge.stroke,active:P||ne||Y||D,color:P||ne||Y||D?(ze=_.node.subLabel)==null?void 0:ze.activeColor:(ct=_.node.subLabel)==null?void 0:ct.color})})]})},[ne,D,Y,P,j,r,Te,H,xe,X,Xe,_.node.label.activeColor,_.node.label.color,_.node.label.stroke,(W=_.node.subLabel)==null?void 0:W.activeColor,(I=_.node.subLabel)==null?void 0:I.color,(De=_.node.subLabel)==null?void 0:De.stroke]),Z=V.useMemo(()=>se&&s&&B.jsx(eI,{prepend:!0,center:!0,children:s({data:y,canCollapse:ot,isCollapsed:M,onCollapse:st,onClose:()=>ve(!1)})}),[se,s,y,ot,M,st]);return B.jsxs(ns.group,{renderOrder:1,userData:{id:n,type:"node"},ref:$,position:et,onPointerOver:Ve,onPointerOut:_e,onClick:ge=>{!e&&!Y&&(a==null||a(y,{canCollapse:ot,isCollapsed:M},ge))},onDoubleClick:ge=>{!e&&!Y&&(o==null||o(y,ge))},onContextMenu:()=>{e||(ve(!0),h==null||h(y,{canCollapse:ot,isCollapsed:M,onCollapse:st}))},...K(),children:[ft,Z,ke]})};function i7(t,e){const n=e.position.z;t<n?t-=n:t+=n;const i=e.fov/e.zoom*Math.PI/180;return 2*Math.tan(i/2)*Math.abs(t)}function Mpe(t,e){return i7(t,e)*e.aspect}function L5(t,e){var s,a,o,l;const n=Mpe(1,t),i=i7(1,t),r={x0:((s=t==null?void 0:t.position)==null?void 0:s.x)-n/2,x1:((a=t==null?void 0:t.position)==null?void 0:a.x)+n/2,y0:((o=t==null?void 0:t.position)==null?void 0:o.y)-i/2,y1:((l=t==null?void 0:t.position)==null?void 0:l.y)+i/2};return(e==null?void 0:e.x)>r.x0&&(e==null?void 0:e.x)<r.x1&&(e==null?void 0:e.y)>r.y0&&(e==null?void 0:e.y)<r.y1}function P5(t,e){return e.reduce((n,i)=>Math.abs(i-t%Math.PI)<Math.abs(n-t%Math.PI)?i:n)}function Cpe(t,e){const n=P5(t,[0,Math.PI]),i=P5(e,[Math.PI/2,3*Math.PI/2]);return{horizontalRotation:n-t%Math.PI,verticalRotation:i-e%Math.PI}}const N2=50,Rpe=({animated:t,disabled:e,layoutType:n})=>{const i=sn(_=>_.nodes),[r,s]=V.useState(!1),a=xs(_=>_.invalidate),{controls:o}=qT(),l=xs(_=>_.camera),u=V.useRef(!1),c=V.useCallback(async(_,y)=>{const g=(y==null?void 0:y.animated)!==void 0?y==null?void 0:y.animated:!0,x=(y==null?void 0:y.centerOnlyIfNodesNotInView)!==void 0?y==null?void 0:y.centerOnlyIfNodesNotInView:!1;if(!u.current||!x||x&&(_!=null&&_.some(S=>!L5(l,S.position)))){const{x:S,y:E,z:A}=r_(_);await o.setTarget(S,E,A,g),r||s(!0),a()}},[a,o,i]),h=V.useCallback(async(_,y={animated:!0,fitOnlyIfNodesNotInView:!1})=>{const{fitOnlyIfNodesNotInView:g}=y;if(!g||g&&(_!=null&&_.some(x=>!L5(l,x.position)))){const{minX:x,maxX:S,minY:E,maxY:A,minZ:T,maxZ:C}=r_(_);if(!n.includes("3d")){const{horizontalRotation:O,verticalRotation:M}=Cpe(o==null?void 0:o.azimuthAngle,o==null?void 0:o.polarAngle);o==null||o.rotate(O,M,!0)}await(o==null?void 0:o.zoomTo(1,y==null?void 0:y.animated)),await(o==null?void 0:o.fitToBox(new bs(new re(x,E,T),new re(S,A,C)),y==null?void 0:y.animated,{cover:!1,paddingLeft:N2,paddingRight:N2,paddingBottom:N2,paddingTop:N2}))}},[l,o,n]),d=V.useCallback(_=>{let y=null;return _!=null&&_.length&&(y=_.reduce((g,x)=>{const S=i.find(E=>E.id===x);if(S)g.push(S);else throw new Error(`Attempted to center ${x} but it was not found in the nodes`);return g},[])),y},[i]),m=V.useCallback((_,y)=>{const g=d(_);c(g||i,{animated:t,centerOnlyIfNodesNotInView:y==null?void 0:y.centerOnlyIfNodesNotInView})},[t,c,d,i]),v=V.useCallback(async(_,y)=>{const g=d(_);await h(g||i,{animated:t,...y})},[t,h,d,i]);return V.useLayoutEffect(()=>{async function _(){o&&(i!=null&&i.length)&&(u.current||(await c(i,{animated:!1}),await h(i,{animated:!1}),u.current=!0))}_()},[o,c,i,t,l,h]),{centerNodes:c,centerNodesById:m,fitNodesInViewById:v,isCentered:r}},r7=V.forwardRef(({onNodeClick:t,onNodeDoubleClick:e,onNodeContextMenu:n,onEdgeContextMenu:i,onEdgeClick:r,onEdgePointerOver:s,onEdgePointerOut:a,onNodePointerOver:o,onNodePointerOut:l,onClusterClick:u,onNodeDragged:c,onClusterDragged:h,onClusterPointerOver:d,onClusterPointerOut:m,contextMenu:v,animated:_,disabled:y,draggable:g,constrainDragging:x=!1,edgeLabelPosition:S,edgeArrowPosition:E,edgeInterpolation:A="linear",labelFontUrl:T,renderNode:C,onRenderCluster:O,...M},D)=>{const{layoutType:P,clusterAttribute:F}=M,G=xs(xe=>xe.gl),z=xs(xe=>xe.scene),Y=xs(xe=>xe.camera),{updateLayout:N}=Cce({...M,constrainDragging:x});if(F&&!(P==="forceDirected2d"||P==="forceDirected3d"))throw new Error("Clustering is only supported for the force directed layouts.");const k=sn(xe=>xe.graph),j=sn(xe=>xe.nodes),X=sn(xe=>xe.edges),Q=sn(xe=>[...xe.clusters.values()]),{centerNodesById:H,fitNodesInViewById:$,isCentered:ne}=Rpe({animated:_,disabled:y,layoutType:P});V.useImperativeHandle(D,()=>({centerGraph:H,fitNodesInView:$,graph:k,renderScene:()=>G.render(z,Y)}),[H,$,k,G,z,Y]);const q=V.useCallback(xe=>{c==null||c(xe),F&&N()},[F,c,N]),se=V.useMemo(()=>j.map(xe=>B.jsx(Tpe,{id:xe==null?void 0:xe.id,labelFontUrl:T,draggable:g,constrainDragging:x,disabled:y,animated:_,contextMenu:v,renderNode:C,onClick:t,onDoubleClick:e,onContextMenu:n,onPointerOver:o,onPointerOut:l,onDragged:q},xe==null?void 0:xe.id)),[x,_,v,y,g,T,j,t,n,e,q,l,o,C]),ve=V.useMemo(()=>B.jsx(Spe,{edges:X,disabled:y,animated:_,labelFontUrl:T,labelPlacement:S,arrowPlacement:E,interpolation:A,contextMenu:v,onClick:r,onContextMenu:i,onPointerOver:s,onPointerOut:a}),[X,_,v,y,E,A,S,T,r,i,a,s]),pe=V.useMemo(()=>Q.map(xe=>B.jsx(dpe,{animated:_,disabled:y,draggable:g,labelFontUrl:T,onClick:u,onPointerOver:d,onPointerOut:m,onDragged:h,onRender:O,...xe},xe.label)),[_,Q,y,g,T,u,m,d,h,O]);return ne&&B.jsxs(V.Fragment,{children:[ve,se,pe]})});/*!
 * hold-event
 * https://github.com/yomotsu/hold-event
 * (c) 2020 @yomotsu
 * Released under the MIT License.
 */var g1;(function(t){t.HOLD_START="holdStart",t.HOLD_END="holdEnd",t.HOLDING="holding"})(g1||(g1={}));class Dpe{constructor(){this._listeners={}}addEventListener(e,n){const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}removeEventListener(e,n){const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e)}}}class Ope extends Dpe{constructor(e){super(),this._enabled=!0,this._holding=!1,this._intervalId=-1,this._deltaTime=0,this._elapsedTime=0,this._lastTime=0,this._holdStart=n=>{if(!this._enabled||this._holding)return;this._deltaTime=0,this._elapsedTime=0,this._lastTime=performance.now(),this.dispatchEvent({type:g1.HOLD_START,deltaTime:this._deltaTime,elapsedTime:this._elapsedTime,originalEvent:n}),this._holding=!0;const i=()=>{this._intervalId=this.holdIntervalDelay?window.setTimeout(i,this.holdIntervalDelay):window.requestAnimationFrame(i);const r=performance.now();this._deltaTime=r-this._lastTime,this._elapsedTime+=this._deltaTime,this._lastTime=performance.now(),this.dispatchEvent({type:g1.HOLDING,deltaTime:this._deltaTime,elapsedTime:this._elapsedTime,originalEvent:n})};this._intervalId=this.holdIntervalDelay?window.setTimeout(i,this.holdIntervalDelay):window.requestAnimationFrame(i)},this._holdEnd=n=>{if(!this._enabled||!this._holding)return;const i=performance.now();this._deltaTime=i-this._lastTime,this._elapsedTime+=this._deltaTime,this._lastTime=performance.now(),this.dispatchEvent({type:g1.HOLD_END,deltaTime:this._deltaTime,elapsedTime:this._elapsedTime,originalEvent:n}),window.clearTimeout(this._intervalId),window.cancelAnimationFrame(this._intervalId),this._holding=!1},this.holdIntervalDelay=e}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this._enabled||this._holdEnd())}}class B2 extends Ope{constructor(e,n){super(n),this._holdStart=this._holdStart.bind(this),this._holdEnd=this._holdEnd.bind(this);const i=s=>{Upe(s)||s.keyCode===e&&this._holdStart(s)},r=s=>{s.keyCode===e&&this._holdEnd(s)};document.addEventListener("keydown",i),document.addEventListener("keyup",r),window.addEventListener("blur",this._holdEnd)}}function Upe(t){const e=t.target;return e.tagName==="INPUT"||e.tagName==="SELECT"||e.tagName==="TEXTAREA"||e.isContentEditable}Hs.install({THREE:{MOUSE:j6,Vector2:Tt,Vector3:re,Vector4:bi,Quaternion:ra,Matrix4:kn,Spherical:I8,Box3:bs,Sphere:Us,Raycaster:ez,MathUtils:{DEG2RAD:Ih==null?void 0:Ih.DEG2RAD,clamp:Ih==null?void 0:Ih.clamp}}});hV({ThreeCameraControls:Hs});const k2={ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40},s7=V.forwardRef(({mode:t="rotate",children:e,animated:n,disabled:i,minDistance:r=1e3,maxDistance:s=5e4},a)=>{const o=V.useRef(null),l=xs(G=>G.camera),u=xs(G=>G.gl),c=t==="orbit",h=sn(G=>G.setPanning),d=sn(G=>G.draggingIds.length>0),m=V.useRef(0),[v,_]=V.useState(!1);DT((G,z)=>{var Y,N;(Y=o.current)!=null&&Y.enabled&&((N=o.current)==null||N.update(z)),c&&(o.current.azimuthAngle+=20*z*Ih.DEG2RAD)},-1),V.useEffect(()=>()=>{var G;return(G=o.current)==null?void 0:G.dispose()},[]);const y=V.useCallback(()=>{var G;(G=o.current)==null||G.zoom(l.zoom/2,n)},[n,l.zoom]),g=V.useCallback(()=>{var G;(G=o.current)==null||G.zoom(-l.zoom/2,n)},[n,l.zoom]),x=V.useCallback(G=>{var z;(z=o.current)==null||z.dolly(G,n)},[n]),S=V.useCallback(G=>{var z;(z=o.current)==null||z.dolly(G,n)},[n]),E=V.useCallback(G=>{var z;c||(z=o.current)==null||z.truck(-.03*G.deltaTime,0,n)},[n,c]),A=V.useCallback(G=>{var z;c||(z=o.current)==null||z.truck(.03*G.deltaTime,0,n)},[n,c]),T=V.useCallback(G=>{var z;c||(z=o.current)==null||z.truck(0,.03*G.deltaTime,n)},[n,c]),C=V.useCallback(G=>{var z;c||(z=o.current)==null||z.truck(0,-.03*G.deltaTime,n)},[n,c]),O=V.useCallback(G=>{G.code==="Space"&&(t==="rotate"?o.current.mouseButtons.left=Hs.ACTION.TRUCK:o.current.mouseButtons.left=Hs.ACTION.ROTATE)},[t]),M=V.useCallback(G=>{G.code==="Space"&&(t==="rotate"?o.current.mouseButtons.left=Hs.ACTION.ROTATE:o.current.mouseButtons.left=Hs.ACTION.TRUCK)},[t]),[D,P]=V.useState(null);V.useEffect(()=>{mz||P({leftKey:new B2(k2.ARROW_LEFT,100),rightKey:new B2(k2.ARROW_RIGHT,100),upKey:new B2(k2.ARROW_UP,100),downKey:new B2(k2.ARROW_DOWN,100)})},[]),V.useEffect(()=>(!i&&D&&(D.leftKey.addEventListener("holding",A),D.rightKey.addEventListener("holding",E),D.upKey.addEventListener("holding",T),D.downKey.addEventListener("holding",C),window.addEventListener("keydown",O),window.addEventListener("keyup",M)),()=>{D&&(D.leftKey.removeEventListener("holding",A),D.rightKey.removeEventListener("holding",E),D.upKey.removeEventListener("holding",T),D.downKey.removeEventListener("holding",C),window.removeEventListener("keydown",O),window.removeEventListener("keyup",M))}),[i,O,M,C,A,E,T,D]),V.useEffect(()=>{i?(o.current.mouseButtons.left=Hs.ACTION.NONE,o.current.mouseButtons.middle=Hs.ACTION.NONE,o.current.mouseButtons.wheel=Hs.ACTION.NONE):(o.current.mouseButtons.left=Hs.ACTION.TRUCK,o.current.mouseButtons.middle=Hs.ACTION.TRUCK,o.current.mouseButtons.wheel=Hs.ACTION.DOLLY)},[i]),V.useEffect(()=>{const G=()=>h(!0),z=()=>h(!1),Y=o.current;return Y&&(Y.addEventListener("control",G),Y.addEventListener("controlend",z)),()=>{Y&&(Y.removeEventListener("control",G),Y.removeEventListener("controlend",z))}},[o,h]),V.useEffect(()=>{d?(o.current.mouseButtons.left=Hs.ACTION.NONE,o.current.touches.one=Hs.ACTION.NONE):t==="rotate"?(o.current.mouseButtons.left=Hs.ACTION.ROTATE,o.current.touches.one=Hs.ACTION.TOUCH_ROTATE):(o.current.touches.one=Hs.ACTION.TOUCH_TRUCK,o.current.mouseButtons.left=Hs.ACTION.TRUCK)},[d,t]);const F=V.useMemo(()=>({controls:o.current,zoomIn:()=>y(),zoomOut:()=>g(),dollyIn:(G=1e3)=>x(G),dollyOut:(G=-1e3)=>S(G),panLeft:(G=100)=>A({deltaTime:G}),panRight:(G=100)=>E({deltaTime:G}),panDown:(G=100)=>C({deltaTime:G}),panUp:(G=100)=>T({deltaTime:G}),resetControls:G=>{var z;return(z=o.current)==null?void 0:z.reset(G)},freeze:()=>{o.current.truckSpeed&&(m.current=o.current.truckSpeed),o.current.truckSpeed=0},unFreeze:()=>o.current.truckSpeed=m.current}),[y,g,A,E,C,T,o.current]);return V.useImperativeHandle(a,()=>F),B.jsxs(n7.Provider,{value:F,children:[B.jsx("threeCameraControls",{ref:G=>{o.current=G,v||_(!0)},args:[l,u.domElement],smoothTime:.1,minDistance:r,dollyToCursor:!0,maxDistance:s}),e]})}),Df={canvas:{background:"#fff"},node:{fill:"#7CA0AB",activeFill:"#1DE9AC",opacity:1,selectedOpacity:1,inactiveOpacity:.2,label:{color:"#2A6475",stroke:"#fff",activeColor:"#1DE9AC"},subLabel:{color:"#ddd",stroke:"transparent",activeColor:"#1DE9AC"}},lasso:{border:"1px solid #55aaff",background:"rgba(75, 160, 255, 0.1)"},ring:{fill:"#D8E6EA",activeFill:"#1DE9AC"},edge:{fill:"#D8E6EA",activeFill:"#1DE9AC",opacity:1,selectedOpacity:1,inactiveOpacity:.1,label:{stroke:"#fff",color:"#2A6475",activeColor:"#1DE9AC",fontSize:6}},arrow:{fill:"#D8E6EA",activeFill:"#1DE9AC"},cluster:{stroke:"#D8E6EA",opacity:1,selectedOpacity:1,inactiveOpacity:.1,label:{stroke:"#fff",color:"#2A6475"}}};function F2(t,e,n){const{offsetX:i,offsetY:r}=t,{width:s,height:a}=n;e.set(i/s*2-1,-(r/a)*2+1)}function zpe(t){const e=document.createElement("div");return e.style.pointerEvents="none",e.style.border=t.lasso.border,e.style.backgroundColor=t.lasso.background,e.style.position="fixed",e}const a7=({children:t,type:e="none",onLasso:n,onLassoEnd:i,disabled:r})=>{var P;const s=sn(F=>F.theme),a=xs(F=>F.camera),o=xs(F=>F.gl),l=xs(F=>F.setEvents),u=xs(F=>F.size),c=xs(F=>F.get),h=xs(F=>F.scene),d=qT(),m=sn(F=>F.actives),v=sn(F=>F.setActives),_=sn(F=>F.edges),y=sn(F=>F.edgeMeshes),g=V.useRef(null),x=V.useRef(null),S=V.useRef(zpe(s)),E=V.useRef(null),A=V.useRef(!1),T=V.useRef(c().events.enabled),C=V.useRef((P=d.controls)==null?void 0:P.enabled),O=V.useCallback(F=>{if(A.current){const[G,z,Y]=E.current;Y.x=Math.max(G.x,F.clientX),Y.y=Math.max(G.y,F.clientY),z.x=Math.min(G.x,F.clientX),z.y=Math.min(G.y,F.clientY),S.current.style.left=`${z.x}px`,S.current.style.top=`${z.y}px`,S.current.style.width=`${Y.x-z.x}px`,S.current.style.height=`${Y.y-z.y}px`,F2(F,g.current.endPoint,u),F2(F,x.current.endPoint,u);const N=[],k=x.current.select().sort(X=>X.uuid).map(X=>_[y.indexOf(X)].id);N.push(...k);const j=g.current.select().sort(X=>X.uuid).filter(X=>{var Q,H;return X.isMesh&&((Q=X.userData)==null?void 0:Q.id)&&(((H=X.userData)==null?void 0:H.type)===e||e==="all")}).map(X=>X.userData.id);N.push(...j),requestAnimationFrame(()=>{v(N),n==null||n(N)}),document.addEventListener("pointermove",O,{passive:!0,capture:!0,once:!0})}},[u,_,y,e,v,n]),M=V.useCallback(()=>{var F;A.current&&(l({enabled:T.current}),A.current=!1,(F=S.current.parentElement)==null||F.removeChild(S.current),d.controls.enabled=C.current,i==null||i(m),document.removeEventListener("pointermove",O),document.removeEventListener("pointerup",M))},[l,d.controls,i,m,O]),D=V.useCallback(F=>{var G,z;if(F.shiftKey){T.current=c().events.enabled,C.current=(G=d.controls)==null?void 0:G.enabled,g.current=new l5(a,h);const Y=new aT;y.length&&Y.add(...y),x.current=new l5(a,Y),E.current=[new Tt,new Tt,new Tt];const[N]=E.current;d.controls.enabled=!1,l({enabled:!1}),A.current=!0,(z=o.domElement.parentElement)==null||z.appendChild(S.current),S.current.style.left=`${F.clientX}px`,S.current.style.top=`${F.clientY}px`,S.current.style.width="0px",S.current.style.height="0px",N.x=F.clientX,N.y=F.clientY,F2(F,g.current.startPoint,u),F2(F,x.current.startPoint,u),document.addEventListener("pointermove",O,{passive:!0,capture:!0,once:!0}),document.addEventListener("pointerup",M,{passive:!0})}},[a,d.controls,y,c,o.domElement.parentElement,O,M,h,l,u]);return V.useEffect(()=>{if(!(r||e==="none"))return typeof window<"u"&&(document.addEventListener("pointerdown",D,{passive:!0}),document.addEventListener("pointermove",O,{passive:!0}),document.addEventListener("pointerup",M,{passive:!0})),()=>{typeof window<"u"&&(document.removeEventListener("pointerdown",D),document.removeEventListener("pointermove",O),document.removeEventListener("pointerup",M))}},[e,r,D,O,M]),B.jsx("group",{children:t})},Ipe="_canvas_670zp_1",o7={canvas:Ipe},Lpe={alpha:!0,antialias:!0},Ppe={position:[0,0,1e3],near:5,far:5e4,fov:10},ym=V.forwardRef(({cameraMode:t="pan",layoutType:e="forceDirected2d",sizingType:n="default",labelType:i="auto",theme:r=Df,animated:s=!0,defaultNodeSize:a=7,minNodeSize:o=5,maxNodeSize:l=15,lassoType:u="none",glOptions:c={},edges:h,children:d,nodes:m,minDistance:v,maxDistance:_,onCanvasClick:y,disabled:g,onLasso:x,onLassoEnd:S,...E},A)=>{var Y,N;const T=V.useRef(null),C=V.useRef(null),O=V.useRef(null);V.useImperativeHandle(A,()=>({centerGraph:(k,j)=>{var X;return(X=T.current)==null?void 0:X.centerGraph(k,j)},fitNodesInView:(k,j)=>{var X;return(X=T.current)==null?void 0:X.fitNodesInView(k,j)},zoomIn:()=>{var k;return(k=C.current)==null?void 0:k.zoomIn()},zoomOut:()=>{var k;return(k=C.current)==null?void 0:k.zoomOut()},dollyIn:k=>{var j;return(j=C.current)==null?void 0:j.dollyIn(k)},dollyOut:k=>{var j;return(j=C.current)==null?void 0:j.dollyOut(k)},panLeft:()=>{var k;return(k=C.current)==null?void 0:k.panLeft()},panRight:()=>{var k;return(k=C.current)==null?void 0:k.panRight()},panDown:()=>{var k;return(k=C.current)==null?void 0:k.panDown()},panUp:()=>{var k;return(k=C.current)==null?void 0:k.panUp()},resetControls:k=>{var j;return(j=C.current)==null?void 0:j.resetControls(k)},getControls:()=>{var k;return(k=C.current)==null?void 0:k.controls},getGraph:()=>{var k;return(k=T.current)==null?void 0:k.graph},exportCanvas:()=>(T.current.renderScene(),O.current.toDataURL()),freeze:()=>{var k;return(k=C.current)==null?void 0:k.freeze()},unFreeze:()=>{var k;return(k=C.current)==null?void 0:k.unFreeze()}}));const{selections:M,actives:D,collapsedNodeIds:P}=E,F=h.length+m.length>400?!1:s,G=V.useMemo(()=>({...c,...Lpe}),[c]),z=V.useRef(Nz({selections:M,actives:D,theme:r,collapsedNodeIds:P})).current;return B.jsx("div",{className:o7.canvas,children:B.jsx(_V,{legacy:!0,linear:!0,ref:O,flat:!0,gl:G,camera:Ppe,onPointerMissed:y,children:B.jsxs(YH,{store:z,children:[((Y=r.canvas)==null?void 0:Y.background)&&B.jsx("color",{attach:"background",args:[r.canvas.background]}),B.jsx("ambientLight",{intensity:1}),d,((N=r.canvas)==null?void 0:N.fog)&&B.jsx("fog",{attach:"fog",args:[r.canvas.fog,4e3,9e3]}),B.jsx(s7,{mode:t,ref:C,disabled:g,minDistance:v,maxDistance:_,animated:s,children:B.jsx(a7,{disabled:g,type:u,onLasso:x,onLassoEnd:S,children:B.jsx(V.Suspense,{children:B.jsx(r7,{ref:T,disabled:g,animated:F,edges:h,nodes:m,layoutType:e,sizingType:n,labelType:i,defaultNodeSize:a,minNodeSize:o,maxNodeSize:l,...E})})})})]})})})}),Npe="/assets/demon-DzkTbD3N.svg",Bpe="data:image/svg+xml,%3c?xml%20version='1.0'?%3e%3csvg%20fill='%23000'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2050%2050'%20width='50px'%20height='50px'%3e%3cpath%20d='M%205%204%20C%204.448%204%204%204.448%204%205%20L%204%2031%20C%204%2032.105%204.895%2033%206%2033%20L%2044%2033%20C%2045.105%2033%2046%2032.105%2046%2031%20L%2046%205%20C%2046%204.448%2045.552%204%2045%204%20L%205%204%20z%20M%2010%209%20L%2040%209%20C%2040.552%209%2041%209.448%2041%2010%20L%2041%2027%20C%2041%2027.552%2040.552%2028%2040%2028%20L%2010%2028%20C%209.448%2028%209%2027.552%209%2027%20L%209%2010%20C%209%209.448%209.448%209%2010%209%20z%20M%206%2035%20C%204.895%2035%204%2035.895%204%2037%20L%204%2045%20C%204%2045.552%204.448%2046%205%2046%20L%2045%2046%20C%2045.552%2046%2046%2045.552%2046%2045%20L%2046%2037%20C%2046%2035.895%2045.105%2035%2044%2035%20L%206%2035%20z%20M%2038%2038%20C%2039.104%2038%2040%2038.895%2040%2040%20C%2040%2041.105%2039.104%2042%2038%2042%20C%2036.896%2042%2036%2041.105%2036%2040%20C%2036%2038.895%2036.896%2038%2038%2038%20z%20M%2010%2039%20L%2026%2039%20L%2026%2041%20L%2010%2041%20L%2010%2039%20z'/%3e%3c/svg%3e",wo=(t,e)=>Math.floor(Math.random()*e)+t,Av=gl(5).map(t=>({id:`n-${t}`,label:`Node ${t}`,data:{priority:wo(0,10)}}));[...gl(5).map(t=>t===2?{id:`n-${t}`,label:`Node ${t} - 3 Children`,data:{priority:wo(0,10)}}:t===3?{id:`n-${t}`,label:`Node ${t} - 1 Child`,data:{priority:wo(0,10)}}:{id:`n-${t}`,label:`Node ${t}`,data:{priority:wo(0,10)}}),...gl(3).map(t=>t===0?{id:`n-2-n-${t}`,label:`Node 2 > ${t} - 1 Child`,data:{priority:wo(0,10)}}:{id:`n-2-n-${t}`,label:`Node 2 > ${t}`,data:{priority:wo(0,10)}}),wo(0,10)];const FD=["IP","URL","Email","MD5"],d_=["#3730a3","#c2410c","#166534","#075985"],kpe=gl(25).map(t=>{const e=wo(0,FD.length),n=FD[e];return{id:`n-${t}`,label:`${n} ${t}`,fill:d_[e],data:{type:n,segment:t%2===0?"A":void 0}}});gl(2).map(t=>{const e=t,n=t;return{id:`n-${t}`,label:`${n} ${t}`,fill:d_[e],data:{type:n}}});gl(20).map(t=>{const e=t==0?2:t%2,n=FD[e];return{id:`n-${t}`,label:`${n} ${t}`,fill:d_[e],data:{type:n}}});const N5=["IPV4","URL","Email","MD5","SHA256","Domain","IPV6","CRC32","SHA512"];gl(500).map(t=>{const e=wo(0,N5.length),n=N5[e];return{id:`n-${t}`,label:`${n} ${t}`,fill:d_[e%d_.length],data:{type:n}}});gl(wo(5,25)).map(t=>({id:`e-${t}`,source:`n-${t}`,target:`n-${wo(0,kpe.length-1)}`,label:"0-1"}));gl(5).map(t=>({id:`n-${t}`,label:`Node ${t}`,fill:`hsl(${wo(0,360)}, 100%, 50%)`}));gl(5).map(t=>({id:`n-${t}`,label:`Node ${t}`,size:t%2===0?50:25,icon:t%2===0?Bpe:Npe,data:{priority:wo(0,10)}}));gl(100).map(t=>({id:`n-${t}`,label:`Node ${t}`,data:{priority:Math.floor(Math.random()*10)+1}}));const xm=[{id:"0->1",source:"n-0",target:"n-1",label:"Edge 0-1"},{id:"0->2",source:"n-0",target:"n-2",label:"Edge 0-2"},{id:"0->3",source:"n-0",target:"n-3",label:"Edge 0-3"},{id:"0->4",source:"n-0",target:"n-4",label:"Edge 0-4"}];[...xm];const Fpe=gl(25).map(t=>({id:`${t}`,label:`Node ${t}`})),Gpe=[{id:"0->2",source:"0",target:"2",label:"Edge 0-2"},{id:"1->3",source:"1",target:"3",label:"Edge 1-3"},{id:"2->4",source:"2",target:"4",label:"Edge 2-4"},{id:"3->5",source:"3",target:"5",label:"Edge 3-5"},{id:"5->15",source:"5",target:"15",label:"Edge 5-15"},{id:"5->7",source:"5",target:"7",label:"Edge 5-7"},{id:"6->8",source:"6",target:"8",label:"Edge 6-8"},{id:"7->9",source:"7",target:"9",label:"Edge 7-9"},{id:"8->10",source:"8",target:"10",label:"Edge 8-10"},{id:"9->11",source:"9",target:"11",label:"Edge 9-11"},{id:"10->12",source:"10",target:"12",label:"Edge 10-12"},{id:"11->13",source:"11",target:"13",label:"Edge 11-13"},{id:"22->9",source:"22",target:"9",label:"Edge 22-9"},{id:"13->15",source:"13",target:"15",label:"Edge 13-15"},{id:"14->16",source:"14",target:"16",label:"Edge 14-16"},{id:"15->17",source:"15",target:"17",label:"Edge 15-17"},{id:"16->18",source:"16",target:"18",label:"Edge 16-18"},{id:"17->19",source:"17",target:"19",label:"Edge 17-19"},{id:"18->20",source:"18",target:"20",label:"Edge 18-20"},{id:"19->21",source:"19",target:"21",label:"Edge 19-21"},{id:"20->22",source:"20",target:"22",label:"Edge 20-22"},{id:"21->23",source:"21",target:"23",label:"Edge 21-23"},{id:"22->24",source:"22",target:"24",label:"Edge 22-24"},{id:"23->0",source:"23",target:"0",label:"Edge 23-0"},{id:"24->1",source:"24",target:"1",label:"Edge 24-1"},{id:"0->3",source:"0",target:"3",label:"Edge 0-3"},{id:"1->4",source:"1",target:"4",label:"Edge 1-4"},{id:"2->5",source:"2",target:"5",label:"Edge 2-5"},{id:"3->6",source:"3",target:"6",label:"Edge 3-6"},{id:"4->7",source:"4",target:"7",label:"Edge 4-7"},{id:"5->8",source:"5",target:"8",label:"Edge 5-8"},{id:"6->9",source:"6",target:"9",label:"Edge 6-9"},{id:"7->10",source:"7",target:"10",label:"Edge 7-10"},{id:"8->11",source:"8",target:"11",label:"Edge 8-11"},{id:"9->12",source:"9",target:"12",label:"Edge 9-12"},{id:"10->13",source:"10",target:"13",label:"Edge 10-13"},{id:"11->14",source:"11",target:"14",label:"Edge 11-14"},{id:"12->15",source:"12",target:"15",label:"Edge 12-15"},{id:"13->16",source:"13",target:"16",label:"Edge 13-16"},{id:"14->17",source:"14",target:"17",label:"Edge 14-17"},{id:"15->18",source:"15",target:"18",label:"Edge 15-18"}],Vpe=()=>{const t=If();return B.jsxs("div",{style:{width:"100%",minHeight:"100vh",display:"flex",flexDirection:"column",fontFamily:"system-ui, -apple-system, sans-serif"},children:[B.jsxs("header",{style:{padding:"20px",backgroundColor:"#f5f5f5",borderBottom:"1px solid #ddd"},children:[B.jsx("h1",{style:{margin:0,fontSize:"24px"},children:"Graph Optimization Experiments"}),B.jsx("p",{style:{margin:"10px 0 0 0",color:"#666"},children:"Performance Comparisons: Web Workers and GPU Acceleration"})]}),B.jsxs("nav",{style:{padding:"15px 20px",backgroundColor:"#fafafa",borderBottom:"1px solid #e0e0e0",display:"flex",gap:"20px",flexWrap:"wrap"},children:[B.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"center"},children:[B.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Web Workers:"}),B.jsx("button",{onClick:()=>t("/baseline"),style:{background:"none",border:"none",color:"#0066cc",cursor:"pointer",padding:0},children:"Baseline"}),B.jsx("button",{onClick:()=>t("/optimized"),style:{background:"none",border:"none",color:"#0066cc",cursor:"pointer",padding:0},children:"Optimized"}),B.jsx("button",{onClick:()=>t("/compare"),style:{background:"none",border:"none",color:"#0066cc",cursor:"pointer",padding:0},children:"Compare"}),B.jsx("button",{onClick:()=>t("/metrics"),style:{background:"none",border:"none",color:"#0066cc",cursor:"pointer",padding:0},children:"Metrics Dashboard"})]}),B.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"center",marginLeft:"auto"},children:[B.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"GPU:"}),B.jsx("button",{onClick:()=>t("/cosmos-gpu"),style:{background:"none",border:"none",color:"#10b981",cursor:"pointer",padding:0},children:"Cosmos GPU"}),B.jsx("button",{onClick:()=>t("/cosmos-compare"),style:{background:"none",border:"none",color:"#10b981",cursor:"pointer",padding:0},children:"CPU vs GPU"}),B.jsx("button",{onClick:()=>t("/gpu-js"),style:{background:"none",border:"none",color:"#8b5cf6",cursor:"pointer",padding:0},children:"GPU.js"})]})]}),B.jsx("main",{style:{flex:1,padding:"30px",backgroundColor:"#ffffff",overflow:"auto"},children:B.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[B.jsxs("section",{style:{marginBottom:"40px"},children:[B.jsx("h2",{children:"Overview"}),B.jsx("p",{children:"These experiments explore different optimization strategies for graph rendering performance. We compare Web Workers for CPU parallelization and GPU acceleration using Cosmos."})]}),B.jsxs("section",{style:{marginBottom:"40px"},children:[B.jsx("h3",{children:"Test Scenarios"}),B.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[B.jsxs("div",{children:[B.jsx("h4",{children:"Web Workers Optimization"}),B.jsxs("ul",{children:[B.jsxs("li",{children:[B.jsx("strong",{children:"Baseline:"})," Original implementation running on the main thread"]}),B.jsxs("li",{children:[B.jsx("strong",{children:"Optimized:"})," Web Worker implementation with offloaded calculations"]}),B.jsxs("li",{children:[B.jsx("strong",{children:"Compare:"})," Side-by-side comparison with real-time metrics"]}),B.jsxs("li",{children:[B.jsx("strong",{children:"Metrics Dashboard:"})," Detailed performance analysis"]})]})]}),B.jsxs("div",{children:[B.jsx("h4",{children:"GPU Acceleration"}),B.jsxs("ul",{children:[B.jsxs("li",{children:[B.jsx("strong",{children:"Cosmos GPU:"})," GPU-accelerated layout using @cosmos.gl/graph"]}),B.jsxs("li",{children:[B.jsx("strong",{children:"CPU vs GPU:"})," Direct performance comparison between CPU and GPU implementations"]}),B.jsxs("li",{children:[B.jsx("strong",{children:"GPU.js:"})," Custom GPU kernels for force calculations using GPU.js"]})]})]})]})]}),B.jsxs("section",{children:[B.jsx("h3",{children:"Quick Demo"}),B.jsx("div",{style:{height:"400px",border:"1px solid #e0e0e0",borderRadius:"8px",overflow:"hidden"},children:B.jsx(ym,{nodes:Av,edges:xm,layoutType:"forceDirected2d"})})]})]})})]})};class Hpe{constructor(){this.metrics=[],this.events=[],this.startTime=0,this.isRecording=!1,this.layoutStartTime=0,this.renderStartTime=0,this.mainThreadBlockingTime=0,this.setupPerformanceObserver()}setupPerformanceObserver(){if(typeof PerformanceObserver<"u")try{this.observer=new PerformanceObserver(e=>{for(const n of e.getEntries())n.entryType==="longtask"&&(this.mainThreadBlockingTime+=n.duration)}),this.observer.observe({entryTypes:["longtask"]})}catch(e){console.warn("PerformanceObserver not supported:",e)}}startRecording(){this.isRecording=!0,this.startTime=performance.now(),this.metrics=[],this.events=[],this.mainThreadBlockingTime=0}stopRecording(){return this.isRecording=!1,this.metrics}recordLayoutStart(){this.isRecording&&(this.layoutStartTime=performance.now(),this.recordEvent({type:"layout-start",timestamp:this.layoutStartTime}))}recordLayoutEnd(e,n,i){if(!this.isRecording||!this.layoutStartTime)return;const r=performance.now()-this.layoutStartTime;this.recordEvent({type:"layout-end",timestamp:performance.now(),data:{duration:r,nodeCount:e,edgeCount:n,layoutType:i}}),window.dispatchEvent(new CustomEvent("graph-layout-time",{detail:{duration:r}}))}recordRenderStart(){this.isRecording&&(this.renderStartTime=performance.now(),this.recordEvent({type:"render-start",timestamp:this.renderStartTime}))}recordRenderEnd(){if(!this.isRecording||!this.renderStartTime)return;const e=performance.now()-this.renderStartTime;this.recordEvent({type:"render-end",timestamp:performance.now(),data:{duration:e}})}recordFrame(e,n){this.isRecording&&this.recordEvent({type:"frame-update",timestamp:performance.now(),data:{fps:e,memoryUsed:n}})}recordSnapshot(e){if(!this.isRecording)return;const n={layoutCalculationTime:e.layoutCalculationTime||0,renderTime:e.renderTime||0,totalTime:performance.now()-this.startTime,fps:e.fps||0,minFps:Math.min(...this.metrics.map(i=>i.fps).filter(Boolean),e.fps||60),maxFps:Math.max(...this.metrics.map(i=>i.fps).filter(Boolean),e.fps||0),avgFps:this.calculateAverageFps(),memoryUsed:e.memoryUsed||0,memoryDelta:this.calculateMemoryDelta(e.memoryUsed||0),heapSize:e.heapSize||0,mainThreadBlockingTime:this.mainThreadBlockingTime,workerUtilization:e.workerUtilization,nodeCount:e.nodeCount||0,edgeCount:e.edgeCount||0,layoutType:e.layoutType||"",timestamp:performance.now()};this.metrics.push(n),window.dispatchEvent(new CustomEvent("main-thread-blocking",{detail:{duration:this.mainThreadBlockingTime}}))}recordEvent(e){this.events.push(e)}calculateAverageFps(){const e=this.metrics.map(n=>n.fps).filter(Boolean);return e.length===0?0:e.reduce((n,i)=>n+i,0)/e.length}calculateMemoryDelta(e){if(this.metrics.length===0)return 0;const n=this.metrics[0].memoryUsed;return e-n}getMetrics(){return this.metrics}getEvents(){return this.events}getSummary(){const e=this.metrics.map(a=>a.layoutCalculationTime).filter(Boolean),n=this.metrics.map(a=>a.fps).filter(Boolean),i=this.metrics.map(a=>a.memoryUsed).filter(Boolean),r=this.metrics.map(a=>a.mainThreadBlockingTime).filter(Boolean),s=a=>a.length>0?a.reduce((o,l)=>o+l,0)/a.length:0;return{avgLayoutTime:{baseline:s(e),optimized:0},avgFps:{baseline:s(n),optimized:0},avgMemory:{baseline:s(i),optimized:0},avgMainThreadBlocking:{baseline:s(r),optimized:0},improvements:{layoutTime:0,fps:0,memory:0,mainThreadBlocking:0}}}clear(){this.metrics=[],this.events=[],this.mainThreadBlockingTime=0}destroy(){this.observer&&this.observer.disconnect()}}const nc=new Hpe,pA=({onMetricsUpdate:t,visible:e=!0,position:n="bottom-left",implementation:i="baseline"})=>{const[r,s]=V.useState(0),[a,o]=V.useState(0),[l,u]=V.useState(0),[c,h]=V.useState(0),d=V.useRef(0),m=V.useRef(performance.now()),v=V.useRef(),_=V.useCallback(()=>{const S=performance.now(),E=S-m.current;if(d.current++,E>=1e3){const A=Math.round(d.current*1e3/E);if(s(A),d.current=0,m.current=S,"memory"in performance&&performance.memory){const T=performance.memory,C=Math.round((T.usedJSHeapSize||0)/1024/1024);o(C)}t&&t({fps:A,memoryUsed:a,timestamp:S})}v.current=requestAnimationFrame(_)},[t]);if(V.useEffect(()=>(e&&(v.current=requestAnimationFrame(_)),()=>{v.current&&cancelAnimationFrame(v.current)}),[e,_]),V.useEffect(()=>{const S=A=>{u(A.detail.duration)},E=A=>{h(A.detail.duration)};return window.addEventListener("graph-layout-time",S),window.addEventListener("main-thread-blocking",E),()=>{window.removeEventListener("graph-layout-time",S),window.removeEventListener("main-thread-blocking",E)}},[]),!e)return null;const y={"top-left":{top:"20px",left:"20px"},"top-right":{top:"20px",right:"20px"},"bottom-left":{bottom:"60px",left:"20px"},"bottom-right":{bottom:"60px",right:"20px"}},g="rgba(0, 0, 0, 0.85)",x=i==="optimized"?"#28a745":"#666";return B.jsxs("div",{style:{position:"absolute",...y[n],background:g,color:"white",padding:"12px 16px",borderRadius:"6px",fontSize:"12px",fontFamily:"Monaco, monospace",zIndex:1e3,minWidth:"200px",border:`1px solid ${x}`,boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:[B.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"14px",color:i==="optimized"?"#28a745":"#fff"},children:["Performance Monitor ",i==="optimized"?"(Optimized)":"(Baseline)"]}),B.jsxs("div",{style:{display:"grid",gap:"4px"},children:[B.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[B.jsx("span",{children:"FPS:"}),B.jsx("span",{style:{fontWeight:"bold",color:r>=50?"#4caf50":r>=30?"#ff9800":"#f44336"},children:r})]}),B.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[B.jsx("span",{children:"Memory:"}),B.jsxs("span",{children:[a," MB"]})]}),B.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[B.jsx("span",{children:"Layout Time:"}),B.jsxs("span",{children:[l.toFixed(1)," ms"]})]}),B.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[B.jsx("span",{children:"Main Thread:"}),B.jsxs("span",{children:[c.toFixed(1)," ms"]})]}),i==="optimized"&&B.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#90EE90"},children:"✓ Web Workers Active"})]})]})},mA=({id:t,children:e,onRender:n})=>{const i=(r,s,a,o,l,u,c)=>{(s==="update"||s==="mount")&&nc.recordRenderEnd(),n&&n(r,s,a),nc.recordRenderStart()};return B.jsx(V.Profiler,{id:t,onRender:i,children:e})},jpe=()=>{const t=If(),[e,n]=V.useState(100),[i,r]=V.useState("forceDirected2d"),s=u=>{const c=Array.from({length:u},(d,m)=>({id:`node-${m}`,label:`Node ${m}`})),h=Array.from({length:Math.floor(u*1.5)},(d,m)=>({id:`edge-${m}`,source:`node-${Math.floor(Math.random()*u)}`,target:`node-${Math.floor(Math.random()*u)}`}));return{nodes:c,edges:h}},{nodes:a,edges:o}=e<=10?{nodes:Av,edges:xm}:s(e),l=V.useCallback(u=>{nc.recordSnapshot({...u,nodeCount:a.length,edgeCount:o.length,layoutType:i})},[a.length,o.length,i]);return iu.useEffect(()=>(nc.startRecording(),()=>{nc.stopRecording()}),[]),B.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",fontFamily:"system-ui, -apple-system, sans-serif"},children:[B.jsxs("header",{style:{padding:"20px",backgroundColor:"#f5f5f5",borderBottom:"1px solid #ddd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[B.jsxs("div",{children:[B.jsx("h1",{style:{margin:0,fontSize:"24px"},children:"Baseline Implementation"}),B.jsx("p",{style:{margin:"5px 0 0 0",color:"#666"},children:"Original graph rendering on main thread"})]}),B.jsx("div",{style:{display:"flex",gap:"10px"},children:B.jsx("button",{onClick:()=>t("/"),style:{padding:"8px 16px",background:"#0066cc",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"← Back to Overview"})})]}),B.jsxs("div",{style:{padding:"20px",backgroundColor:"#fafafa",borderBottom:"1px solid #e0e0e0",display:"flex",gap:"20px",alignItems:"center"},children:[B.jsxs("div",{children:[B.jsx("label",{style:{marginRight:"10px"},children:"Nodes:"}),B.jsxs("select",{value:e,onChange:u=>n(Number(u.target.value)),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #ccc"},children:[B.jsx("option",{value:10,children:"10 nodes"}),B.jsx("option",{value:100,children:"100 nodes"}),B.jsx("option",{value:500,children:"500 nodes"}),B.jsx("option",{value:1e3,children:"1,000 nodes"}),B.jsx("option",{value:5e3,children:"5,000 nodes"}),B.jsx("option",{value:1e4,children:"10,000 nodes"})]})]}),B.jsxs("div",{children:[B.jsx("label",{style:{marginRight:"10px"},children:"Layout:"}),B.jsxs("select",{value:i,onChange:u=>r(u.target.value),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #ccc"},children:[B.jsx("option",{value:"forceDirected2d",children:"Force Directed 2D"}),B.jsx("option",{value:"forceDirected3d",children:"Force Directed 3D"}),B.jsx("option",{value:"circular2d",children:"Circular 2D"}),B.jsx("option",{value:"hierarchicalTd",children:"Hierarchical Top-Down"}),B.jsx("option",{value:"treeTd2d",children:"Tree Top-Down 2D"})]})]}),B.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"15px",color:"#666"},children:[B.jsxs("span",{children:["Nodes: ",a.length]}),B.jsxs("span",{children:["Edges: ",o.length]}),B.jsxs("span",{children:["Layout: ",i]})]})]}),B.jsxs("main",{style:{flex:1,position:"relative",paddingBottom:"80px"},children:[B.jsx(mA,{id:"baseline-graph",onRender:(u,c,h)=>{console.log(`Baseline render: ${c} - ${h}ms`)},children:B.jsx(ym,{nodes:a,edges:o,layoutType:i,theme:Df,cameraMode:"pan"})}),B.jsx(pA,{onMetricsUpdate:l,implementation:"baseline",position:"bottom-left"})]})]})};class B5{constructor(e,n=navigator.hardwareConcurrency||4){this.workerScript=e,this.poolSize=n,this.workers=[],this.availableWorkers=[],this.taskQueue=[],this.taskMap=new Map,this.workerTasks=new Map,this.initializeWorkers()}createWorker(){return typeof this.workerScript=="function"?this.workerScript():new Worker(this.workerScript,{type:"module"})}initializeWorkers(){for(let e=0;e<this.poolSize;e++){const n=this.createWorker();n.addEventListener("message",i=>{this.handleWorkerMessage(n,i)}),n.addEventListener("error",i=>{this.handleWorkerError(n,i)}),this.workers.push(n),this.availableWorkers.push(n)}}handleWorkerMessage(e,n){const i=this.workerTasks.get(e),r=i?this.taskMap.get(i):void 0;if(r){const{type:s,payload:a,error:o}=n.data;s==="LAYOUT_COMPLETE"||s==="LAYOUT_ERROR"?(o?r.reject(new Error(o)):r.resolve(a),this.taskMap.delete(i),this.workerTasks.delete(e),this.availableWorkers.push(e),this.processNextTask()):s==="LAYOUT_PROGRESS"&&r.resolve&&console.log(`Worker progress: ${a.progress}%`)}}handleWorkerError(e,n){console.error("Worker error:",n);const i=this.workerTasks.get(e),r=i?this.taskMap.get(i):void 0;r&&(r.reject(n),this.taskMap.delete(i),this.workerTasks.delete(e));const s=this.workers.indexOf(e);if(s!==-1){e.terminate();const a=this.createWorker();a.addEventListener("message",o=>{this.handleWorkerMessage(a,o)}),a.addEventListener("error",o=>{this.handleWorkerError(a,o)}),this.workers[s]=a,this.availableWorkers.push(a)}this.processNextTask()}processNextTask(){if(this.taskQueue.length===0||this.availableWorkers.length===0)return;const e=this.taskQueue.shift(),n=this.availableWorkers.shift();this.workerTasks.set(n,e.id)}execute(e){return new Promise((n,i)=>{const r={id:e.id,resolve:n,reject:i};if(this.taskMap.set(r.id,r),this.availableWorkers.length>0){const s=this.availableWorkers.shift();this.workerTasks.set(s,r.id),s.postMessage(e)}else this.taskQueue.push(r)})}getUtilization(){return(this.workers.length-this.availableWorkers.length)/this.workers.length*100}terminate(){this.workers.forEach(e=>e.terminate()),this.workers=[],this.availableWorkers=[],this.taskQueue=[],this.taskMap.clear(),this.workerTasks.clear()}}function Wpe(t){return new Worker("/layout.worker.js",{type:"module",name:t==null?void 0:t.name})}const Xpe=new URL("data:video/mp2t;base64,aW1wb3J0IHsKICBmb3JjZVNpbXVsYXRpb24gYXMgZDNGb3JjZVNpbXVsYXRpb24sCiAgZm9yY2VMaW5rIGFzIGQzRm9yY2VMaW5rLAogIGZvcmNlQ29sbGlkZSwKICBmb3JjZU1hbnlCb2R5IGFzIGQzRm9yY2VNYW55Qm9keSwKICBmb3JjZVggYXMgZDNGb3JjZVgsCiAgZm9yY2VZIGFzIGQzRm9yY2VZLAogIGZvcmNlWiBhcyBkM0ZvcmNlWiwKICBmb3JjZUNlbnRlciBhcyBkM0ZvcmNlQ2VudGVyCn0gZnJvbSAnZDMtZm9yY2UtM2QnOwoKaW50ZXJmYWNlIFdvcmtlck5vZGUgewogIGlkOiBzdHJpbmc7CiAgeD86IG51bWJlcjsKICB5PzogbnVtYmVyOwogIHo/OiBudW1iZXI7CiAgcmFkaXVzPzogbnVtYmVyOwp9CgppbnRlcmZhY2UgV29ya2VyRWRnZSB7CiAgaWQ6IHN0cmluZzsKICBzb3VyY2U6IHN0cmluZzsKICB0YXJnZXQ6IHN0cmluZzsKfQoKaW50ZXJmYWNlIExheW91dE1lc3NhZ2UgewogIHR5cGU6ICdDQUxDVUxBVEVfTEFZT1VUJzsKICBpZDogc3RyaW5nOwogIHBheWxvYWQ6IHsKICAgIG5vZGVzOiBXb3JrZXJOb2RlW107CiAgICBlZGdlczogV29ya2VyRWRnZVtdOwogICAgbGF5b3V0VHlwZTogc3RyaW5nOwogICAgZGltZW5zaW9ucz86IG51bWJlcjsKICAgIG5vZGVTdHJlbmd0aD86IG51bWJlcjsKICAgIGxpbmtEaXN0YW5jZT86IG51bWJlcjsKICB9Owp9CgppbnRlcmZhY2UgTGF5b3V0UmVzcG9uc2UgewogIHR5cGU6ICdMQVlPVVRfQ09NUExFVEUnIHwgJ0xBWU9VVF9QUk9HUkVTUycgfCAnTEFZT1VUX0VSUk9SJzsKICBpZDogc3RyaW5nOwogIHBheWxvYWQ/OiB7CiAgICBub2RlczogV29ya2VyTm9kZVtdOwogICAgcHJvZ3Jlc3M/OiBudW1iZXI7CiAgICBkdXJhdGlvbj86IG51bWJlcjsKICB9OwogIGVycm9yPzogc3RyaW5nOwp9CgovLyBIYW5kbGUgbWVzc2FnZXMgZnJvbSBtYWluIHRocmVhZApzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCAoZXZlbnQ6IE1lc3NhZ2VFdmVudDxMYXlvdXRNZXNzYWdlPikgPT4gewogIGNvbnN0IHsgdHlwZSwgaWQsIHBheWxvYWQgfSA9IGV2ZW50LmRhdGE7CiAgCiAgaWYgKHR5cGUgPT09ICdDQUxDVUxBVEVfTEFZT1VUJykgewogICAgdHJ5IHsKICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIGNvbnN0IHsgbm9kZXMsIGVkZ2VzLCBsYXlvdXRUeXBlLCBkaW1lbnNpb25zID0gMywgbm9kZVN0cmVuZ3RoID0gLTI1MCwgbGlua0Rpc3RhbmNlID0gNTAgfSA9IHBheWxvYWQ7CiAgICAgIAogICAgICAvLyBDcmVhdGUgYSBjb3B5IG9mIG5vZGVzIHRvIGF2b2lkIG11dGF0aW9uCiAgICAgIGNvbnN0IGxheW91dE5vZGVzID0gbm9kZXMubWFwKG4gPT4gKHsgLi4ubiB9KSk7CiAgICAgIAogICAgICAvLyBJbml0aWFsaXplIHBvc2l0aW9ucyBpZiBub3Qgc2V0CiAgICAgIGxheW91dE5vZGVzLmZvckVhY2goKG5vZGUsIGkpID0+IHsKICAgICAgICBpZiAobm9kZS54ID09PSB1bmRlZmluZWQpIG5vZGUueCA9IE1hdGgucmFuZG9tKCkgKiAxMDAgLSA1MDsKICAgICAgICBpZiAobm9kZS55ID09PSB1bmRlZmluZWQpIG5vZGUueSA9IE1hdGgucmFuZG9tKCkgKiAxMDAgLSA1MDsKICAgICAgICBpZiAobm9kZS56ID09PSB1bmRlZmluZWQpIG5vZGUueiA9IGRpbWVuc2lvbnMgPT09IDMgPyBNYXRoLnJhbmRvbSgpICogMTAwIC0gNTAgOiAwOwogICAgICB9KTsKICAgICAgCiAgICAgIC8vIENyZWF0ZSBzaW11bGF0aW9uIGJhc2VkIG9uIGxheW91dCB0eXBlCiAgICAgIGNvbnN0IHNpbXVsYXRpb24gPSBjcmVhdGVTaW11bGF0aW9uKGxheW91dFR5cGUsIGxheW91dE5vZGVzLCBlZGdlcywgZGltZW5zaW9ucywgbm9kZVN0cmVuZ3RoLCBsaW5rRGlzdGFuY2UpOwogICAgICAKICAgICAgLy8gUnVuIHNpbXVsYXRpb24KICAgICAgbGV0IHByb2dyZXNzID0gMDsKICAgICAgY29uc3QgdG90YWxJdGVyYXRpb25zID0gMzAwOyAvLyBEZWZhdWx0IGl0ZXJhdGlvbnMKICAgICAgCiAgICAgIC8vIFNlbmQgcHJvZ3Jlc3MgdXBkYXRlcwogICAgICBjb25zdCBwcm9ncmVzc0ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgIGlmIChwcm9ncmVzcyA8IDEwMCkgewogICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIHR5cGU6ICdMQVlPVVRfUFJPR1JFU1MnLAogICAgICAgICAgICBpZCwKICAgICAgICAgICAgcGF5bG9hZDogeyBwcm9ncmVzcywgbm9kZXM6IGxheW91dE5vZGVzIH0KICAgICAgICAgIH0gYXMgTGF5b3V0UmVzcG9uc2UpOwogICAgICAgIH0KICAgICAgfSwgMTAwKTsKICAgICAgCiAgICAgIC8vIFJ1biBzaW11bGF0aW9uIHN5bmNocm9ub3VzbHkKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbEl0ZXJhdGlvbnM7IGkrKykgewogICAgICAgIHNpbXVsYXRpb24udGljaygpOwogICAgICAgIHByb2dyZXNzID0gTWF0aC5yb3VuZCgoaSAvIHRvdGFsSXRlcmF0aW9ucykgKiAxMDApOwogICAgICB9CiAgICAgIAogICAgICBjbGVhckludGVydmFsKHByb2dyZXNzSW50ZXJ2YWwpOwogICAgICAKICAgICAgY29uc3QgZHVyYXRpb24gPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTsKICAgICAgCiAgICAgIC8vIFNlbmQgZmluYWwgcmVzdWx0CiAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgIHR5cGU6ICdMQVlPVVRfQ09NUExFVEUnLAogICAgICAgIGlkLAogICAgICAgIHBheWxvYWQ6IHsKICAgICAgICAgIG5vZGVzOiBsYXlvdXROb2RlcywKICAgICAgICAgIGR1cmF0aW9uCiAgICAgICAgfQogICAgICB9IGFzIExheW91dFJlc3BvbnNlKTsKICAgICAgCiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICB0eXBlOiAnTEFZT1VUX0VSUk9SJywKICAgICAgICBpZCwKICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicKICAgICAgfSBhcyBMYXlvdXRSZXNwb25zZSk7CiAgICB9CiAgfQp9KTsKCmZ1bmN0aW9uIGNyZWF0ZVNpbXVsYXRpb24oCiAgbGF5b3V0VHlwZTogc3RyaW5nLAogIG5vZGVzOiBXb3JrZXJOb2RlW10sCiAgZWRnZXM6IFdvcmtlckVkZ2VbXSwKICBkaW1lbnNpb25zOiBudW1iZXIsCiAgbm9kZVN0cmVuZ3RoOiBudW1iZXIsCiAgbGlua0Rpc3RhbmNlOiBudW1iZXIKKSB7CiAgY29uc3Qgc2ltdWxhdGlvbiA9IGQzRm9yY2VTaW11bGF0aW9uKG5vZGVzIGFzIGFueSkKICAgIC5mb3JjZSgnY2VudGVyJywgZDNGb3JjZUNlbnRlcigwLCAwLCAwKSkKICAgIC5mb3JjZSgnY2hhcmdlJywgZDNGb3JjZU1hbnlCb2R5KCkuc3RyZW5ndGgobm9kZVN0cmVuZ3RoKSkKICAgIC5mb3JjZSgnY29sbGlkZScsIGZvcmNlQ29sbGlkZSgoZDogYW55KSA9PiAoZC5yYWRpdXMgfHwgMjApICsgMTApKTsKICAKICBpZiAoZWRnZXMubGVuZ3RoID4gMCkgewogICAgc2ltdWxhdGlvbi5mb3JjZSgnbGluaycsIGQzRm9yY2VMaW5rKGVkZ2VzIGFzIGFueSkKICAgICAgLmlkKChkOiBhbnkpID0+IGQuaWQpCiAgICAgIC5kaXN0YW5jZShsaW5rRGlzdGFuY2UpKTsKICB9CiAgCiAgLy8gQWRkIGRpbWVuc2lvbmFsIGZvcmNlcyBiYXNlZCBvbiBsYXlvdXQgdHlwZQogIGlmIChsYXlvdXRUeXBlID09PSAnZm9yY2VEaXJlY3RlZDJkJyB8fCBkaW1lbnNpb25zID09PSAyKSB7CiAgICBzaW11bGF0aW9uCiAgICAgIC5mb3JjZSgneCcsIGQzRm9yY2VYKCkpCiAgICAgIC5mb3JjZSgneScsIGQzRm9yY2VZKCkpCiAgICAgIC5mb3JjZSgneicsIG51bGwpOwogIH0gZWxzZSB7CiAgICBzaW11bGF0aW9uCiAgICAgIC5mb3JjZSgneCcsIGQzRm9yY2VYKDApLnN0cmVuZ3RoKDAuMDUpKQogICAgICAuZm9yY2UoJ3knLCBkM0ZvcmNlWSgwKS5zdHJlbmd0aCgwLjA1KSkKICAgICAgLmZvcmNlKCd6JywgZDNGb3JjZVooMCkuc3RyZW5ndGgoMC4wNSkpOwogIH0KICAKICAvLyBTdG9wIGF1dG8tdGlja2luZwogIHNpbXVsYXRpb24uc3RvcCgpOwogIAogIHJldHVybiBzaW11bGF0aW9uOwp9CgovLyBFeHBvcnQgZm9yIFR5cGVTY3JpcHQKZXhwb3J0IHt9Ow==",import.meta.url);class Ype{constructor(){this.requestId=0;try{this.layoutPool=new B5(()=>new Wpe,4),console.log("WorkerBridge: Using Vite worker constructor")}catch(e){console.warn("WorkerBridge: Falling back to URL-based worker",e),this.layoutPool=new B5(Xpe,4)}}async calculateLayout(e){const n=`layout-${++this.requestId}`;nc.recordLayoutStart();try{const i=await this.layoutPool.execute({type:"CALCULATE_LAYOUT",id:n,payload:e});return nc.recordLayoutEnd(e.nodes.length,e.edges.length,e.layoutType),i}catch(i){throw console.error("Layout calculation failed:",i),i}}getWorkerUtilization(){return this.layoutPool.getUtilization()}terminate(){this.layoutPool.terminate()}}const F3=new Ype;function Zpe({nodes:t,edges:e,layoutType:n,enabled:i=!0,onLayoutComplete:r}){const s=t.map(y=>({...y,position:y.position||{x:0,y:0,z:0}})),[a,o]=V.useState(s),[l,u]=V.useState(!1),[c,h]=V.useState(null),[d,m]=V.useState(0),v=V.useRef(!1),_=V.useCallback(async()=>{if(!(!i||v.current)){v.current=!0,u(!0),h(null);try{const y=await F3.calculateLayout({nodes:t.map(x=>{var S,E,A;return{id:x.id,x:(S=x.position)==null?void 0:S.x,y:(E=x.position)==null?void 0:E.y,z:(A=x.position)==null?void 0:A.z,radius:x.size}}),edges:e.map(x=>({id:x.id,source:x.source,target:x.target})),layoutType:n,dimensions:n.includes("2d")?2:3}),g=t.map(x=>{const S=y.nodes.find(E=>E.id===x.id);return S?{...x,position:{x:S.x||0,y:S.y||0,z:S.z||0}}:x});o(g),r&&r(g),m(F3.getWorkerUtilization())}catch(y){console.error("Layout calculation failed:",y),h(y);const g=t.map(x=>({...x,position:x.position||{x:0,y:0,z:0}}));o(g)}finally{u(!1),v.current=!1}}},[t,e,n,i,r]);return V.useEffect(()=>{_()},[_]),V.useEffect(()=>{if(!i)return;const y=setInterval(()=>{m(F3.getWorkerUtilization())},1e3);return()=>clearInterval(y)},[i]),{nodes:a,isCalculating:l,error:c,workerUtilization:d,recalculate:_}}const qpe={alpha:!0,antialias:!0},Kpe={near:1,far:2e4,fov:55,position:[0,0,100]},rI=V.forwardRef(({children:t,theme:e=Df,cameraMode:n="pan",nodes:i,edges:r,layoutType:s="forceDirected3d",lassoType:a="2d",glOptions:o={},disabled:l,animated:u=!0,defaultNodeSize:c,minDistance:h=1e3,maxDistance:d=5e4,onCanvasClick:m,onLasso:v,onLassoEnd:_,onNodeClick:y,onNodeRightClick:g,onNodePointerOver:x,onNodePointerOut:S,onNodeDrag:E,onNodeDragStart:A,onNodeDragEnd:T,onEdgeClick:C,onEdgeRightClick:O,onEdgePointerOver:M,onEdgePointerOut:D,...P},F)=>{var H,$;const G=V.useRef(null),z=V.useRef(null),Y=V.useRef(null),N=V.useMemo(()=>Nz({theme:e,selections:P.selections,actives:P.actives,collapsedNodeIds:P.collapsedNodeIds}),[e,P.selections,P.actives,P.collapsedNodeIds]),{nodes:k,isCalculating:j,workerUtilization:X}=Zpe({nodes:i,edges:r,layoutType:s,enabled:!0}),Q=V.useCallback(ne=>{m&&ne.target===Y.current&&m(ne.nativeEvent)},[m]);return V.useImperativeHandle(F,()=>({getGraph:()=>{var ne;if(!((ne=z.current)!=null&&ne.graph))throw new Error("Graph not initialized");return z.current.graph},getControls:()=>{var ne;if(!((ne=G.current)!=null&&ne.controls))throw new Error("Camera controls not initialized");return G.current.controls},centerGraph:ne=>{var q,se;(se=(q=G.current)==null?void 0:q.centerGraph)==null||se.call(q,ne)},zoomIn:()=>{var ne,q;(q=(ne=G.current)==null?void 0:ne.zoomIn)==null||q.call(ne)},zoomOut:()=>{var ne,q;(q=(ne=G.current)==null?void 0:ne.zoomOut)==null||q.call(ne)},resetControls:()=>{var ne,q;(q=(ne=G.current)==null?void 0:ne.resetControls)==null||q.call(ne)},fitNodesInView:ne=>{var q,se;(se=(q=G.current)==null?void 0:q.fitNodesInView)==null||se.call(q,ne)},freeze:()=>{var ne,q;(q=(ne=G.current)==null?void 0:ne.freeze)==null||q.call(ne)},unFreeze:()=>{var ne,q;(q=(ne=G.current)==null?void 0:ne.unFreeze)==null||q.call(ne)},exportCanvas:()=>{if(!Y.current)throw new Error("Canvas not initialized");return Y.current.toDataURL()},getWorkerUtilization:()=>X,highlightNode:ne=>{var q,se;(se=(q=z.current)==null?void 0:q.highlightNode)==null||se.call(q,ne)},highlightEdge:ne=>{var q,se;(se=(q=z.current)==null?void 0:q.highlightEdge)==null||se.call(q,ne)},clearHighlights:()=>{var ne,q;(q=(ne=z.current)==null?void 0:ne.clearHighlights)==null||q.call(ne)}}),[]),B.jsxs("div",{className:o7.canvas,onClick:Q,children:[B.jsx(_V,{ref:Y,gl:Object.assign({},qpe,o),camera:Kpe,children:B.jsxs(YH,{store:N,children:[((H=e.canvas)==null?void 0:H.background)&&B.jsx("color",{attach:"background",args:[e.canvas.background]}),B.jsx("ambientLight",{intensity:1}),(($=e.canvas)==null?void 0:$.fog)&&B.jsx("fog",{attach:"fog",args:[e.canvas.fog,4e3,9e3]}),B.jsx(s7,{ref:G,mode:n,minDistance:h,maxDistance:d,animated:u,disabled:l,children:B.jsx(a7,{disabled:l,type:a,onLasso:v,onLassoEnd:_,children:B.jsxs(V.Suspense,{fallback:null,children:[B.jsx(r7,{ref:z,disabled:l,animated:u,theme:e,defaultNodeSize:c,layoutType:s,sizingType:"default",labelType:"nodes",nodes:k,edges:r,onNodeClick:y,onNodeRightClick:g,onNodePointerOver:x,onNodePointerOut:S,onNodeDrag:E,onNodeDragStart:A,onNodeDragEnd:T,onEdgeClick:C,onEdgeRightClick:O,onEdgePointerOver:M,onEdgePointerOut:D,...P}),t]})})})]})}),j&&B.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0, 0, 0, 0.8)",color:"white",padding:"10px 20px",borderRadius:"4px",fontSize:"14px"},children:"Calculating layout with Web Workers..."})]})});rI.displayName="OptimizedGraphCanvas";function Qpe(){console.group("🔍 Worker Setup Debug"),console.log("Worker support:",typeof Worker<"u"?"✅ Available":"❌ Not available");try{new Worker("data:,",{type:"module"}),console.log("Module workers:","✅ Supported")}catch(e){console.log("Module workers:","⚠️  Not supported -",e.message)}const t=window.location.href;console.log("Current URL:",t),console.log("Vite dev mode:","❌ Not in dev mode"),console.group("Testing Worker Import Methods:");try{upe(()=>import("./test.worker-BaHCLvaH.js"),[]).then(e=>{console.log("✅ Method 1 (?worker import): Success");const n=new e.default;n.postMessage({test:"method1"}),n.onmessage=i=>{console.log("Method 1 response:",i.data),n.terminate()}}).catch(e=>{console.error("❌ Method 1 (?worker import) failed:",e)})}catch(e){console.error("❌ Method 1 (?worker import) failed:",e)}try{const e=new URL("data:video/mp2t;base64,aW1wb3J0IHsKICBmb3JjZVNpbXVsYXRpb24gYXMgZDNGb3JjZVNpbXVsYXRpb24sCiAgZm9yY2VMaW5rIGFzIGQzRm9yY2VMaW5rLAogIGZvcmNlQ29sbGlkZSwKICBmb3JjZU1hbnlCb2R5IGFzIGQzRm9yY2VNYW55Qm9keSwKICBmb3JjZVggYXMgZDNGb3JjZVgsCiAgZm9yY2VZIGFzIGQzRm9yY2VZLAogIGZvcmNlWiBhcyBkM0ZvcmNlWiwKICBmb3JjZUNlbnRlciBhcyBkM0ZvcmNlQ2VudGVyCn0gZnJvbSAnZDMtZm9yY2UtM2QnOwoKaW50ZXJmYWNlIFdvcmtlck5vZGUgewogIGlkOiBzdHJpbmc7CiAgeD86IG51bWJlcjsKICB5PzogbnVtYmVyOwogIHo/OiBudW1iZXI7CiAgcmFkaXVzPzogbnVtYmVyOwp9CgppbnRlcmZhY2UgV29ya2VyRWRnZSB7CiAgaWQ6IHN0cmluZzsKICBzb3VyY2U6IHN0cmluZzsKICB0YXJnZXQ6IHN0cmluZzsKfQoKaW50ZXJmYWNlIExheW91dE1lc3NhZ2UgewogIHR5cGU6ICdDQUxDVUxBVEVfTEFZT1VUJzsKICBpZDogc3RyaW5nOwogIHBheWxvYWQ6IHsKICAgIG5vZGVzOiBXb3JrZXJOb2RlW107CiAgICBlZGdlczogV29ya2VyRWRnZVtdOwogICAgbGF5b3V0VHlwZTogc3RyaW5nOwogICAgZGltZW5zaW9ucz86IG51bWJlcjsKICAgIG5vZGVTdHJlbmd0aD86IG51bWJlcjsKICAgIGxpbmtEaXN0YW5jZT86IG51bWJlcjsKICB9Owp9CgppbnRlcmZhY2UgTGF5b3V0UmVzcG9uc2UgewogIHR5cGU6ICdMQVlPVVRfQ09NUExFVEUnIHwgJ0xBWU9VVF9QUk9HUkVTUycgfCAnTEFZT1VUX0VSUk9SJzsKICBpZDogc3RyaW5nOwogIHBheWxvYWQ/OiB7CiAgICBub2RlczogV29ya2VyTm9kZVtdOwogICAgcHJvZ3Jlc3M/OiBudW1iZXI7CiAgICBkdXJhdGlvbj86IG51bWJlcjsKICB9OwogIGVycm9yPzogc3RyaW5nOwp9CgovLyBIYW5kbGUgbWVzc2FnZXMgZnJvbSBtYWluIHRocmVhZApzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCAoZXZlbnQ6IE1lc3NhZ2VFdmVudDxMYXlvdXRNZXNzYWdlPikgPT4gewogIGNvbnN0IHsgdHlwZSwgaWQsIHBheWxvYWQgfSA9IGV2ZW50LmRhdGE7CiAgCiAgaWYgKHR5cGUgPT09ICdDQUxDVUxBVEVfTEFZT1VUJykgewogICAgdHJ5IHsKICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIGNvbnN0IHsgbm9kZXMsIGVkZ2VzLCBsYXlvdXRUeXBlLCBkaW1lbnNpb25zID0gMywgbm9kZVN0cmVuZ3RoID0gLTI1MCwgbGlua0Rpc3RhbmNlID0gNTAgfSA9IHBheWxvYWQ7CiAgICAgIAogICAgICAvLyBDcmVhdGUgYSBjb3B5IG9mIG5vZGVzIHRvIGF2b2lkIG11dGF0aW9uCiAgICAgIGNvbnN0IGxheW91dE5vZGVzID0gbm9kZXMubWFwKG4gPT4gKHsgLi4ubiB9KSk7CiAgICAgIAogICAgICAvLyBJbml0aWFsaXplIHBvc2l0aW9ucyBpZiBub3Qgc2V0CiAgICAgIGxheW91dE5vZGVzLmZvckVhY2goKG5vZGUsIGkpID0+IHsKICAgICAgICBpZiAobm9kZS54ID09PSB1bmRlZmluZWQpIG5vZGUueCA9IE1hdGgucmFuZG9tKCkgKiAxMDAgLSA1MDsKICAgICAgICBpZiAobm9kZS55ID09PSB1bmRlZmluZWQpIG5vZGUueSA9IE1hdGgucmFuZG9tKCkgKiAxMDAgLSA1MDsKICAgICAgICBpZiAobm9kZS56ID09PSB1bmRlZmluZWQpIG5vZGUueiA9IGRpbWVuc2lvbnMgPT09IDMgPyBNYXRoLnJhbmRvbSgpICogMTAwIC0gNTAgOiAwOwogICAgICB9KTsKICAgICAgCiAgICAgIC8vIENyZWF0ZSBzaW11bGF0aW9uIGJhc2VkIG9uIGxheW91dCB0eXBlCiAgICAgIGNvbnN0IHNpbXVsYXRpb24gPSBjcmVhdGVTaW11bGF0aW9uKGxheW91dFR5cGUsIGxheW91dE5vZGVzLCBlZGdlcywgZGltZW5zaW9ucywgbm9kZVN0cmVuZ3RoLCBsaW5rRGlzdGFuY2UpOwogICAgICAKICAgICAgLy8gUnVuIHNpbXVsYXRpb24KICAgICAgbGV0IHByb2dyZXNzID0gMDsKICAgICAgY29uc3QgdG90YWxJdGVyYXRpb25zID0gMzAwOyAvLyBEZWZhdWx0IGl0ZXJhdGlvbnMKICAgICAgCiAgICAgIC8vIFNlbmQgcHJvZ3Jlc3MgdXBkYXRlcwogICAgICBjb25zdCBwcm9ncmVzc0ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgIGlmIChwcm9ncmVzcyA8IDEwMCkgewogICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIHR5cGU6ICdMQVlPVVRfUFJPR1JFU1MnLAogICAgICAgICAgICBpZCwKICAgICAgICAgICAgcGF5bG9hZDogeyBwcm9ncmVzcywgbm9kZXM6IGxheW91dE5vZGVzIH0KICAgICAgICAgIH0gYXMgTGF5b3V0UmVzcG9uc2UpOwogICAgICAgIH0KICAgICAgfSwgMTAwKTsKICAgICAgCiAgICAgIC8vIFJ1biBzaW11bGF0aW9uIHN5bmNocm9ub3VzbHkKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbEl0ZXJhdGlvbnM7IGkrKykgewogICAgICAgIHNpbXVsYXRpb24udGljaygpOwogICAgICAgIHByb2dyZXNzID0gTWF0aC5yb3VuZCgoaSAvIHRvdGFsSXRlcmF0aW9ucykgKiAxMDApOwogICAgICB9CiAgICAgIAogICAgICBjbGVhckludGVydmFsKHByb2dyZXNzSW50ZXJ2YWwpOwogICAgICAKICAgICAgY29uc3QgZHVyYXRpb24gPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTsKICAgICAgCiAgICAgIC8vIFNlbmQgZmluYWwgcmVzdWx0CiAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgIHR5cGU6ICdMQVlPVVRfQ09NUExFVEUnLAogICAgICAgIGlkLAogICAgICAgIHBheWxvYWQ6IHsKICAgICAgICAgIG5vZGVzOiBsYXlvdXROb2RlcywKICAgICAgICAgIGR1cmF0aW9uCiAgICAgICAgfQogICAgICB9IGFzIExheW91dFJlc3BvbnNlKTsKICAgICAgCiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICB0eXBlOiAnTEFZT1VUX0VSUk9SJywKICAgICAgICBpZCwKICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicKICAgICAgfSBhcyBMYXlvdXRSZXNwb25zZSk7CiAgICB9CiAgfQp9KTsKCmZ1bmN0aW9uIGNyZWF0ZVNpbXVsYXRpb24oCiAgbGF5b3V0VHlwZTogc3RyaW5nLAogIG5vZGVzOiBXb3JrZXJOb2RlW10sCiAgZWRnZXM6IFdvcmtlckVkZ2VbXSwKICBkaW1lbnNpb25zOiBudW1iZXIsCiAgbm9kZVN0cmVuZ3RoOiBudW1iZXIsCiAgbGlua0Rpc3RhbmNlOiBudW1iZXIKKSB7CiAgY29uc3Qgc2ltdWxhdGlvbiA9IGQzRm9yY2VTaW11bGF0aW9uKG5vZGVzIGFzIGFueSkKICAgIC5mb3JjZSgnY2VudGVyJywgZDNGb3JjZUNlbnRlcigwLCAwLCAwKSkKICAgIC5mb3JjZSgnY2hhcmdlJywgZDNGb3JjZU1hbnlCb2R5KCkuc3RyZW5ndGgobm9kZVN0cmVuZ3RoKSkKICAgIC5mb3JjZSgnY29sbGlkZScsIGZvcmNlQ29sbGlkZSgoZDogYW55KSA9PiAoZC5yYWRpdXMgfHwgMjApICsgMTApKTsKICAKICBpZiAoZWRnZXMubGVuZ3RoID4gMCkgewogICAgc2ltdWxhdGlvbi5mb3JjZSgnbGluaycsIGQzRm9yY2VMaW5rKGVkZ2VzIGFzIGFueSkKICAgICAgLmlkKChkOiBhbnkpID0+IGQuaWQpCiAgICAgIC5kaXN0YW5jZShsaW5rRGlzdGFuY2UpKTsKICB9CiAgCiAgLy8gQWRkIGRpbWVuc2lvbmFsIGZvcmNlcyBiYXNlZCBvbiBsYXlvdXQgdHlwZQogIGlmIChsYXlvdXRUeXBlID09PSAnZm9yY2VEaXJlY3RlZDJkJyB8fCBkaW1lbnNpb25zID09PSAyKSB7CiAgICBzaW11bGF0aW9uCiAgICAgIC5mb3JjZSgneCcsIGQzRm9yY2VYKCkpCiAgICAgIC5mb3JjZSgneScsIGQzRm9yY2VZKCkpCiAgICAgIC5mb3JjZSgneicsIG51bGwpOwogIH0gZWxzZSB7CiAgICBzaW11bGF0aW9uCiAgICAgIC5mb3JjZSgneCcsIGQzRm9yY2VYKDApLnN0cmVuZ3RoKDAuMDUpKQogICAgICAuZm9yY2UoJ3knLCBkM0ZvcmNlWSgwKS5zdHJlbmd0aCgwLjA1KSkKICAgICAgLmZvcmNlKCd6JywgZDNGb3JjZVooMCkuc3RyZW5ndGgoMC4wNSkpOwogIH0KICAKICAvLyBTdG9wIGF1dG8tdGlja2luZwogIHNpbXVsYXRpb24uc3RvcCgpOwogIAogIHJldHVybiBzaW11bGF0aW9uOwp9CgovLyBFeHBvcnQgZm9yIFR5cGVTY3JpcHQKZXhwb3J0IHt9Ow==",import.meta.url);console.log("Method 2 URL:",e.href);const n=new Worker(e,{type:"module"});n.addEventListener("error",i=>{console.error("❌ Method 2 (URL) error:",i)}),n.addEventListener("message",i=>{console.log("✅ Method 2 (URL) response:",i.data),n.terminate()}),setTimeout(()=>{console.log("Method 2: Sending test message..."),n.postMessage({type:"CALCULATE_LAYOUT",id:"test-2",payload:{nodes:[{id:"test",x:0,y:0,z:0}],edges:[],layoutType:"forceDirected3d"}})},100)}catch(e){console.error("❌ Method 2 (URL) failed:",e)}try{const e=new Worker("/src/experiments/graph-optimization/workers/test.worker.ts",{type:"module"});e.onmessage=()=>{console.log("✅ Method 3 (string path): Success"),e.terminate()},e.onerror=()=>{console.log("❌ Method 3 (string path): Failed (expected in Vite)"),e.terminate()},e.postMessage({test:"method3"})}catch(e){console.log("❌ Method 3 (string path): Failed (expected in Vite)",e.message)}console.groupEnd(),console.groupEnd()}const Jpe=()=>{const t=If(),[e,n]=V.useState(100),[i,r]=V.useState("forceDirected2d"),[s,a]=V.useState("idle"),o=V.useRef(null),l=d=>{const m=Array.from({length:d},(_,y)=>({id:`node-${y}`,label:`Node ${y}`})),v=Array.from({length:Math.floor(d*1.5)},(_,y)=>({id:`edge-${y}`,source:`node-${Math.floor(Math.random()*d)}`,target:`node-${Math.floor(Math.random()*d)}`}));return{nodes:m,edges:v}},{nodes:u,edges:c}=e<=10?{nodes:Av,edges:xm}:l(e),h=V.useCallback(d=>{var v,_;const m=((_=(v=o.current)==null?void 0:v.getWorkerUtilization)==null?void 0:_.call(v))||0;nc.recordSnapshot({...d,nodeCount:u.length,edgeCount:c.length,layoutType:i,workerUtilization:m})},[u.length,c.length,i]);return iu.useEffect(()=>(nc.startRecording(),a("active"),Qpe(),()=>{nc.stopRecording(),a("idle")}),[]),B.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",fontFamily:"system-ui, -apple-system, sans-serif"},children:[B.jsxs("header",{style:{padding:"20px",backgroundColor:"#f5f5f5",borderBottom:"1px solid #ddd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[B.jsxs("div",{children:[B.jsx("h1",{style:{margin:0,fontSize:"24px"},children:"Optimized Implementation"}),B.jsx("p",{style:{margin:"5px 0 0 0",color:"#666"},children:"Web Worker-based graph rendering"})]}),B.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[B.jsxs("div",{style:{padding:"4px 12px",background:s==="active"?"#28a745":"#6c757d",color:"white",borderRadius:"4px",fontSize:"14px"},children:["Worker: ",s]}),B.jsx("button",{onClick:()=>t("/"),style:{padding:"8px 16px",background:"#0066cc",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"← Back to Overview"})]})]}),B.jsxs("div",{style:{padding:"20px",backgroundColor:"#fafafa",borderBottom:"1px solid #e0e0e0",display:"flex",gap:"20px",alignItems:"center"},children:[B.jsxs("div",{children:[B.jsx("label",{style:{marginRight:"10px"},children:"Nodes:"}),B.jsxs("select",{value:e,onChange:d=>n(Number(d.target.value)),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #ccc"},children:[B.jsx("option",{value:10,children:"10 nodes"}),B.jsx("option",{value:100,children:"100 nodes"}),B.jsx("option",{value:500,children:"500 nodes"}),B.jsx("option",{value:1e3,children:"1,000 nodes"}),B.jsx("option",{value:5e3,children:"5,000 nodes"}),B.jsx("option",{value:1e4,children:"10,000 nodes"})]})]}),B.jsxs("div",{children:[B.jsx("label",{style:{marginRight:"10px"},children:"Layout:"}),B.jsxs("select",{value:i,onChange:d=>r(d.target.value),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #ccc"},children:[B.jsx("option",{value:"forceDirected2d",children:"Force Directed 2D"}),B.jsx("option",{value:"forceDirected3d",children:"Force Directed 3D"}),B.jsx("option",{value:"circular2d",children:"Circular 2D"}),B.jsx("option",{value:"hierarchicalTd",children:"Hierarchical Top-Down"}),B.jsx("option",{value:"treeTd2d",children:"Tree Top-Down 2D"})]})]}),B.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"15px",color:"#666"},children:[B.jsxs("span",{children:["Nodes: ",u.length]}),B.jsxs("span",{children:["Edges: ",c.length]}),B.jsxs("span",{children:["Layout: ",i]}),B.jsx("span",{style:{color:"#28a745"},children:"✓ Web Workers Enabled"})]})]}),B.jsxs("main",{style:{flex:1,position:"relative",paddingBottom:"80px"},children:[B.jsx(mA,{id:"optimized-graph",onRender:(d,m,v)=>{console.log(`Optimized render: ${m} - ${v}ms`)},children:B.jsx(rI,{ref:o,nodes:u,edges:c,layoutType:i,theme:Df,cameraMode:"pan",animated:!1})}),B.jsx(pA,{onMetricsUpdate:h,implementation:"optimized",position:"bottom-left"}),B.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",background:"rgba(40, 167, 69, 0.1)",border:"1px solid #28a745",borderRadius:"4px",padding:"10px",fontSize:"14px"},children:[B.jsx("strong",{children:"Optimization Status:"}),B.jsx("br",{}),"This will use Web Workers for:",B.jsx("br",{}),"• Layout calculations",B.jsx("br",{}),"• Node sizing computations",B.jsx("br",{}),"• Cluster analysis",B.jsx("br",{}),"• Graph transformations"]})]})]})},$pe=()=>{const t=If(),[e,n]=V.useState(100),[i,r]=V.useState("forceDirected2d"),[s,a]=V.useState(!0),[o,l]=V.useState({}),[u,c]=V.useState({}),h=v=>{const _=Array.from({length:v},(g,x)=>({id:`node-${x}`,label:`Node ${x}`})),y=Array.from({length:Math.floor(v*1.5)},(g,x)=>({id:`edge-${x}`,source:`node-${Math.floor(Math.random()*v)}`,target:`node-${Math.floor(Math.random()*v)}`}));return{nodes:_,edges:y}},{nodes:d,edges:m}=e<=10?{nodes:Av,edges:xm}:h(e);return B.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",fontFamily:"system-ui, -apple-system, sans-serif"},children:[B.jsxs("header",{style:{padding:"20px",backgroundColor:"#f5f5f5",borderBottom:"1px solid #ddd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[B.jsxs("div",{children:[B.jsx("h1",{style:{margin:0,fontSize:"24px"},children:"Performance Comparison"}),B.jsx("p",{style:{margin:"5px 0 0 0",color:"#666"},children:"Side-by-side comparison of baseline vs optimized implementation"})]}),B.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[B.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[B.jsx("input",{type:"checkbox",checked:s,onChange:v=>a(v.target.checked)}),"Sync Controls"]}),B.jsx("button",{onClick:()=>t("/"),style:{padding:"8px 16px",background:"#0066cc",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"← Back to Overview"})]})]}),B.jsxs("div",{style:{padding:"20px",backgroundColor:"#fafafa",borderBottom:"1px solid #e0e0e0",display:"flex",gap:"20px",alignItems:"center"},children:[B.jsxs("div",{children:[B.jsx("label",{style:{marginRight:"10px"},children:"Nodes:"}),B.jsxs("select",{value:e,onChange:v=>n(Number(v.target.value)),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #ccc"},children:[B.jsx("option",{value:10,children:"10 nodes"}),B.jsx("option",{value:100,children:"100 nodes"}),B.jsx("option",{value:500,children:"500 nodes"}),B.jsx("option",{value:1e3,children:"1,000 nodes"}),B.jsx("option",{value:5e3,children:"5,000 nodes"}),B.jsx("option",{value:1e4,children:"10,000 nodes"})]})]}),B.jsxs("div",{children:[B.jsx("label",{style:{marginRight:"10px"},children:"Layout:"}),B.jsxs("select",{value:i,onChange:v=>r(v.target.value),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #ccc"},children:[B.jsx("option",{value:"forceDirected2d",children:"Force Directed 2D"}),B.jsx("option",{value:"forceDirected3d",children:"Force Directed 3D"}),B.jsx("option",{value:"circular2d",children:"Circular 2D"}),B.jsx("option",{value:"hierarchicalTd",children:"Hierarchical Top-Down"}),B.jsx("option",{value:"treeTd2d",children:"Tree Top-Down 2D"})]})]}),B.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"15px",color:"#666"},children:[B.jsxs("span",{children:["Nodes: ",d.length]}),B.jsxs("span",{children:["Edges: ",m.length]}),B.jsxs("span",{children:["Layout: ",i]})]})]}),B.jsxs("main",{style:{flex:1,display:"flex"},children:[B.jsxs("div",{style:{flex:1,position:"relative",borderRight:"1px solid #e0e0e0",paddingBottom:"80px"},children:[B.jsx("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"8px 12px",borderRadius:"4px",zIndex:10,fontSize:"14px",fontWeight:"bold"},children:"BASELINE"}),B.jsx(mA,{id:"baseline-comparison",onRender:(v,_,y)=>{console.log(`Baseline comparison render: ${_} - ${y}ms`)},children:B.jsx(ym,{nodes:d,edges:m,layoutType:i,theme:Df,cameraMode:"pan"})}),B.jsx(pA,{onMetricsUpdate:l,implementation:"baseline",position:"bottom-left",visible:!0})]}),B.jsxs("div",{style:{flex:1,position:"relative",paddingBottom:"80px"},children:[B.jsx("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(40, 167, 69, 0.9)",color:"white",padding:"8px 12px",borderRadius:"4px",zIndex:10,fontSize:"14px",fontWeight:"bold"},children:"OPTIMIZED"}),B.jsx(mA,{id:"optimized-comparison",onRender:(v,_,y)=>{console.log(`Optimized comparison render: ${_} - ${y}ms`)},children:B.jsx(rI,{nodes:d,edges:m,layoutType:i,theme:Df,cameraMode:"pan"})}),B.jsx(pA,{onMetricsUpdate:c,implementation:"optimized",position:"bottom-left",visible:!0})]})]})]})},eme=()=>{const t=If(),[e,n]=V.useState("all"),i=[{nodeCount:100,layoutType:"forceDirected2d",baseline:{layoutTime:120,fps:60,memoryUsage:25,mainThreadBlocking:45},optimized:{layoutTime:80,fps:60,memoryUsage:28,mainThreadBlocking:15},improvement:{layoutTime:"-33%",fps:"0%",memoryUsage:"+12%",mainThreadBlocking:"-67%"}},{nodeCount:1e3,layoutType:"forceDirected2d",baseline:{layoutTime:850,fps:45,memoryUsage:85,mainThreadBlocking:75},optimized:{layoutTime:420,fps:58,memoryUsage:92,mainThreadBlocking:25},improvement:{layoutTime:"-51%",fps:"+29%",memoryUsage:"+8%",mainThreadBlocking:"-67%"}},{nodeCount:5e3,layoutType:"forceDirected2d",baseline:{layoutTime:4200,fps:25,memoryUsage:250,mainThreadBlocking:95},optimized:{layoutTime:1800,fps:55,memoryUsage:265,mainThreadBlocking:20},improvement:{layoutTime:"-57%",fps:"+120%",memoryUsage:"+6%",mainThreadBlocking:"-79%"}}];return B.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",fontFamily:"system-ui, -apple-system, sans-serif",backgroundColor:"#f8f9fa"},children:[B.jsxs("header",{style:{padding:"20px",backgroundColor:"#fff",borderBottom:"1px solid #ddd",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[B.jsxs("div",{children:[B.jsx("h1",{style:{margin:0,fontSize:"24px"},children:"Performance Metrics Dashboard"}),B.jsx("p",{style:{margin:"5px 0 0 0",color:"#666"},children:"Detailed performance analysis and benchmarks"})]}),B.jsx("button",{onClick:()=>t("/"),style:{padding:"8px 16px",background:"#0066cc",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"← Back to Overview"})]}),B.jsxs("div",{style:{padding:"20px",backgroundColor:"#fff",borderBottom:"1px solid #e0e0e0",display:"flex",gap:"20px",alignItems:"center"},children:[B.jsx("button",{onClick:()=>console.log("Run benchmarks"),style:{padding:"8px 16px",background:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Run All Benchmarks"}),B.jsx("button",{onClick:()=>console.log("Export results"),style:{padding:"8px 16px",background:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Export Results"}),B.jsxs("div",{style:{marginLeft:"auto"},children:[B.jsx("label",{style:{marginRight:"10px"},children:"Filter:"}),B.jsxs("select",{value:e,onChange:r=>n(r.target.value),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #ccc"},children:[B.jsx("option",{value:"all",children:"All Benchmarks"}),B.jsx("option",{value:"small",children:"Small Graphs (≤100 nodes)"}),B.jsx("option",{value:"medium",children:"Medium Graphs (100-1000 nodes)"}),B.jsx("option",{value:"large",children:"Large Graphs (>1000 nodes)"})]})]})]}),B.jsx("main",{style:{flex:1,padding:"30px",overflow:"auto"},children:B.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[B.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px",marginBottom:"30px"},children:[B.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[B.jsx("h3",{style:{margin:"0 0 10px 0",color:"#28a745"},children:"Average Performance Gain"}),B.jsx("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#28a745"},children:"52%"}),B.jsx("p",{style:{margin:"5px 0 0 0",color:"#666",fontSize:"14px"},children:"Layout calculation speedup"})]}),B.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[B.jsx("h3",{style:{margin:"0 0 10px 0",color:"#0066cc"},children:"FPS Improvement"}),B.jsx("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#0066cc"},children:"+89%"}),B.jsx("p",{style:{margin:"5px 0 0 0",color:"#666",fontSize:"14px"},children:"Average frame rate increase"})]}),B.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[B.jsx("h3",{style:{margin:"0 0 10px 0",color:"#ffc107"},children:"Memory Overhead"}),B.jsx("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#ffc107"},children:"+8%"}),B.jsx("p",{style:{margin:"5px 0 0 0",color:"#666",fontSize:"14px"},children:"Additional memory usage"})]}),B.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[B.jsx("h3",{style:{margin:"0 0 10px 0",color:"#dc3545"},children:"Main Thread Relief"}),B.jsx("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#dc3545"},children:"-71%"}),B.jsx("p",{style:{margin:"5px 0 0 0",color:"#666",fontSize:"14px"},children:"Reduction in blocking time"})]})]}),B.jsxs("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",overflow:"hidden"},children:[B.jsx("h2",{style:{margin:0,padding:"20px",borderBottom:"1px solid #e0e0e0"},children:"Benchmark Results"}),B.jsx("div",{style:{overflowX:"auto"},children:B.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[B.jsxs("thead",{children:[B.jsxs("tr",{style:{backgroundColor:"#f8f9fa"},children:[B.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Nodes"}),B.jsx("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Layout"}),B.jsx("th",{colSpan:2,style:{padding:"12px",textAlign:"center",borderBottom:"2px solid #dee2e6"},children:"Layout Time (ms)"}),B.jsx("th",{colSpan:2,style:{padding:"12px",textAlign:"center",borderBottom:"2px solid #dee2e6"},children:"FPS"}),B.jsx("th",{colSpan:2,style:{padding:"12px",textAlign:"center",borderBottom:"2px solid #dee2e6"},children:"Memory (MB)"}),B.jsx("th",{colSpan:2,style:{padding:"12px",textAlign:"center",borderBottom:"2px solid #dee2e6"},children:"Main Thread Block (%)"})]}),B.jsxs("tr",{style:{backgroundColor:"#f8f9fa"},children:[B.jsx("th",{style:{padding:"8px",borderBottom:"2px solid #dee2e6"}}),B.jsx("th",{style:{padding:"8px",borderBottom:"2px solid #dee2e6"}}),B.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"2px solid #dee2e6",fontSize:"12px"},children:"Baseline"}),B.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"2px solid #dee2e6",fontSize:"12px"},children:"Optimized"}),B.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"2px solid #dee2e6",fontSize:"12px"},children:"Baseline"}),B.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"2px solid #dee2e6",fontSize:"12px"},children:"Optimized"}),B.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"2px solid #dee2e6",fontSize:"12px"},children:"Baseline"}),B.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"2px solid #dee2e6",fontSize:"12px"},children:"Optimized"}),B.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"2px solid #dee2e6",fontSize:"12px"},children:"Baseline"}),B.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"2px solid #dee2e6",fontSize:"12px"},children:"Optimized"})]})]}),B.jsx("tbody",{children:i.map((r,s)=>B.jsxs("tr",{style:{borderBottom:"1px solid #dee2e6"},children:[B.jsx("td",{style:{padding:"12px"},children:r.nodeCount}),B.jsx("td",{style:{padding:"12px"},children:r.layoutType}),B.jsx("td",{style:{padding:"12px",textAlign:"center"},children:r.baseline.layoutTime}),B.jsxs("td",{style:{padding:"12px",textAlign:"center",color:"#28a745",fontWeight:"bold"},children:[r.optimized.layoutTime," (",r.improvement.layoutTime,")"]}),B.jsx("td",{style:{padding:"12px",textAlign:"center"},children:r.baseline.fps}),B.jsxs("td",{style:{padding:"12px",textAlign:"center",color:"#28a745",fontWeight:"bold"},children:[r.optimized.fps," (",r.improvement.fps,")"]}),B.jsx("td",{style:{padding:"12px",textAlign:"center"},children:r.baseline.memoryUsage}),B.jsxs("td",{style:{padding:"12px",textAlign:"center",color:"#ffc107"},children:[r.optimized.memoryUsage," (",r.improvement.memoryUsage,")"]}),B.jsx("td",{style:{padding:"12px",textAlign:"center"},children:r.baseline.mainThreadBlocking}),B.jsxs("td",{style:{padding:"12px",textAlign:"center",color:"#28a745",fontWeight:"bold"},children:[r.optimized.mainThreadBlocking," (",r.improvement.mainThreadBlocking,")"]})]},s))})]})})]}),B.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",marginTop:"20px"},children:[B.jsx("h3",{style:{margin:"0 0 15px 0"},children:"Test Environment"}),B.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"10px",fontSize:"14px"},children:[B.jsxs("div",{children:[B.jsx("strong",{children:"Browser:"})," Chrome 120"]}),B.jsxs("div",{children:[B.jsx("strong",{children:"CPU:"})," Apple M1 Pro"]}),B.jsxs("div",{children:[B.jsx("strong",{children:"Memory:"})," 16GB RAM"]}),B.jsxs("div",{children:[B.jsx("strong",{children:"GPU:"})," Integrated"]}),B.jsxs("div",{children:[B.jsx("strong",{children:"OS:"})," macOS 14.0"]}),B.jsxs("div",{children:[B.jsx("strong",{children:"Workers:"})," 4 threads"]})]})]})]})})]})};var GD="http://www.w3.org/1999/xhtml";const k5={svg:"http://www.w3.org/2000/svg",xhtml:GD,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function KT(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),k5.hasOwnProperty(e)?{space:k5[e],local:t}:t}function tme(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===GD&&e.documentElement.namespaceURI===GD?e.createElement(t):e.createElementNS(n,t)}}function nme(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function l7(t){var e=KT(t);return(e.local?nme:tme)(e)}function ime(){}function sI(t){return t==null?ime:function(){return this.querySelector(t)}}function rme(t){typeof t!="function"&&(t=sI(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,o=i[r]=new Array(a),l,u,c=0;c<a;++c)(l=s[c])&&(u=t.call(l,l.__data__,c,s))&&("__data__"in l&&(u.__data__=l.__data__),o[c]=u);return new Io(i,this._parents)}function sme(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ame(){return[]}function u7(t){return t==null?ame:function(){return this.querySelectorAll(t)}}function ome(t){return function(){return sme(t.apply(this,arguments))}}function lme(t){typeof t=="function"?t=ome(t):t=u7(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var a=e[s],o=a.length,l,u=0;u<o;++u)(l=a[u])&&(i.push(t.call(l,l.__data__,u,a)),r.push(l));return new Io(i,r)}function c7(t){return function(){return this.matches(t)}}function f7(t){return function(e){return e.matches(t)}}var ume=Array.prototype.find;function cme(t){return function(){return ume.call(this.children,t)}}function fme(){return this.firstElementChild}function hme(t){return this.select(t==null?fme:cme(typeof t=="function"?t:f7(t)))}var dme=Array.prototype.filter;function pme(){return Array.from(this.children)}function mme(t){return function(){return dme.call(this.children,t)}}function gme(t){return this.selectAll(t==null?pme:mme(typeof t=="function"?t:f7(t)))}function vme(t){typeof t!="function"&&(t=c7(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,o=i[r]=[],l,u=0;u<a;++u)(l=s[u])&&t.call(l,l.__data__,u,s)&&o.push(l);return new Io(i,this._parents)}function h7(t){return new Array(t.length)}function yme(){return new Io(this._enter||this._groups.map(h7),this._parents)}function gA(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}gA.prototype={constructor:gA,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function xme(t){return function(){return t}}function _me(t,e,n,i,r,s){for(var a=0,o,l=e.length,u=s.length;a<u;++a)(o=e[a])?(o.__data__=s[a],i[a]=o):n[a]=new gA(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function bme(t,e,n,i,r,s,a){var o,l,u=new Map,c=e.length,h=s.length,d=new Array(c),m;for(o=0;o<c;++o)(l=e[o])&&(d[o]=m=a.call(l,l.__data__,o,e)+"",u.has(m)?r[o]=l:u.set(m,l));for(o=0;o<h;++o)m=a.call(t,s[o],o,s)+"",(l=u.get(m))?(i[o]=l,l.__data__=s[o],u.delete(m)):n[o]=new gA(t,s[o]);for(o=0;o<c;++o)(l=e[o])&&u.get(d[o])===l&&(r[o]=l)}function Sme(t){return t.__data__}function Eme(t,e){if(!arguments.length)return Array.from(this,Sme);var n=e?bme:_me,i=this._parents,r=this._groups;typeof t!="function"&&(t=xme(t));for(var s=r.length,a=new Array(s),o=new Array(s),l=new Array(s),u=0;u<s;++u){var c=i[u],h=r[u],d=h.length,m=wme(t.call(c,c&&c.__data__,u,i)),v=m.length,_=o[u]=new Array(v),y=a[u]=new Array(v),g=l[u]=new Array(d);n(c,h,_,y,g,m,e);for(var x=0,S=0,E,A;x<v;++x)if(E=_[x]){for(x>=S&&(S=x+1);!(A=y[S])&&++S<v;);E._next=A||null}}return a=new Io(a,i),a._enter=o,a._exit=l,a}function wme(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ame(){return new Io(this._exit||this._groups.map(h7),this._parents)}function Tme(t,e,n){var i=this.enter(),r=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function Mme(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,a=Math.min(r,s),o=new Array(r),l=0;l<a;++l)for(var u=n[l],c=i[l],h=u.length,d=o[l]=new Array(h),m,v=0;v<h;++v)(m=u[v]||c[v])&&(d[v]=m);for(;l<r;++l)o[l]=n[l];return new Io(o,this._parents)}function Cme(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],a;--r>=0;)(a=i[r])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function Rme(t){t||(t=Dme);function e(h,d){return h&&d?t(h.__data__,d.__data__):!h-!d}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var a=n[s],o=a.length,l=r[s]=new Array(o),u,c=0;c<o;++c)(u=a[c])&&(l[c]=u);l.sort(e)}return new Io(r,this._parents).order()}function Dme(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ome(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ume(){return Array.from(this)}function zme(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var a=i[r];if(a)return a}return null}function Ime(){let t=0;for(const e of this)++t;return t}function Lme(){return!this.node()}function Pme(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,a=r.length,o;s<a;++s)(o=r[s])&&t.call(o,o.__data__,s,r);return this}function Nme(t){return function(){this.removeAttribute(t)}}function Bme(t){return function(){this.removeAttributeNS(t.space,t.local)}}function kme(t,e){return function(){this.setAttribute(t,e)}}function Fme(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Gme(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Vme(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Hme(t,e){var n=KT(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?Bme:Nme:typeof e=="function"?n.local?Vme:Gme:n.local?Fme:kme)(n,e))}function d7(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function jme(t){return function(){this.style.removeProperty(t)}}function Wme(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Xme(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Yme(t,e,n){return arguments.length>1?this.each((e==null?jme:typeof e=="function"?Xme:Wme)(t,e,n??"")):tv(this.node(),t)}function tv(t,e){return t.style.getPropertyValue(e)||d7(t).getComputedStyle(t,null).getPropertyValue(e)}function Zme(t){return function(){delete this[t]}}function qme(t,e){return function(){this[t]=e}}function Kme(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Qme(t,e){return arguments.length>1?this.each((e==null?Zme:typeof e=="function"?Kme:qme)(t,e)):this.node()[t]}function p7(t){return t.trim().split(/^|\s+/)}function aI(t){return t.classList||new m7(t)}function m7(t){this._node=t,this._names=p7(t.getAttribute("class")||"")}m7.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function g7(t,e){for(var n=aI(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function v7(t,e){for(var n=aI(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Jme(t){return function(){g7(this,t)}}function $me(t){return function(){v7(this,t)}}function ege(t,e){return function(){(e.apply(this,arguments)?g7:v7)(this,t)}}function tge(t,e){var n=p7(t+"");if(arguments.length<2){for(var i=aI(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?ege:e?Jme:$me)(n,e))}function nge(){this.textContent=""}function ige(t){return function(){this.textContent=t}}function rge(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function sge(t){return arguments.length?this.each(t==null?nge:(typeof t=="function"?rge:ige)(t)):this.node().textContent}function age(){this.innerHTML=""}function oge(t){return function(){this.innerHTML=t}}function lge(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function uge(t){return arguments.length?this.each(t==null?age:(typeof t=="function"?lge:oge)(t)):this.node().innerHTML}function cge(){this.nextSibling&&this.parentNode.appendChild(this)}function fge(){return this.each(cge)}function hge(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function dge(){return this.each(hge)}function pge(t){var e=typeof t=="function"?t:l7(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function mge(){return null}function gge(t,e){var n=typeof t=="function"?t:l7(t),i=e==null?mge:typeof e=="function"?e:sI(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function vge(){var t=this.parentNode;t&&t.removeChild(this)}function yge(){return this.each(vge)}function xge(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function _ge(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function bge(t){return this.select(t?_ge:xge)}function Sge(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ege(t){return function(e){t.call(this,e,this.__data__)}}function wge(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Age(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function Tge(t,e,n){return function(){var i=this.__on,r,s=Ege(e);if(i){for(var a=0,o=i.length;a<o;++a)if((r=i[a]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function Mge(t,e,n){var i=wge(t+""),r,s=i.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,u=o.length,c;l<u;++l)for(r=0,c=o[l];r<s;++r)if((a=i[r]).type===c.type&&a.name===c.name)return c.value}return}for(o=e?Tge:Age,r=0;r<s;++r)this.each(o(i[r],e,n));return this}function y7(t,e,n){var i=d7(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Cge(t,e){return function(){return y7(this,t,e)}}function Rge(t,e){return function(){return y7(this,t,e.apply(this,arguments))}}function Dge(t,e){return this.each((typeof e=="function"?Rge:Cge)(t,e))}function*Oge(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length,a;r<s;++r)(a=i[r])&&(yield a)}var x7=[null];function Io(t,e){this._groups=t,this._parents=e}function ab(){return new Io([[document.documentElement]],x7)}function Uge(){return this}Io.prototype=ab.prototype={constructor:Io,select:rme,selectAll:lme,selectChild:hme,selectChildren:gme,filter:vme,data:Eme,enter:yme,exit:Ame,join:Tme,merge:Mme,selection:Uge,order:Cme,sort:Rme,call:Ome,nodes:Ume,node:zme,size:Ime,empty:Lme,each:Pme,attr:Hme,style:Yme,property:Qme,classed:tge,text:sge,html:uge,raise:fge,lower:dge,append:pge,insert:gge,remove:yge,clone:bge,datum:Sge,on:Mge,dispatch:Dge,[Symbol.iterator]:Oge};function Ws(t){return typeof t=="string"?new Io([[document.querySelector(t)]],[document.documentElement]):new Io([[t]],x7)}function zge(t){let e;for(;e=t.sourceEvent;)t=e;return t}function $c(t,e){if(t=zge(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}var Ige={value:()=>{}};function QT(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new SE(n)}function SE(t){this._=t}function Lge(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}SE.prototype=QT.prototype={constructor:SE,on:function(t,e){var n=this._,i=Lge(t+"",n),r,s=-1,a=i.length;if(arguments.length<2){for(;++s<a;)if((r=(t=i[s]).type)&&(r=Pge(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<a;)if(r=(t=i[s]).type)n[r]=F5(n[r],t.name,e);else if(e==null)for(r in n)n[r]=F5(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new SE(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function Pge(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function F5(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=Ige,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var nv=0,Nx=0,wx=0,_7=1e3,vA,Bx,yA=0,sm=0,JT=0,p_=typeof performance=="object"&&performance.now?performance:Date,b7=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function oI(){return sm||(b7(Nge),sm=p_.now()+JT)}function Nge(){sm=0}function xA(){this._call=this._time=this._next=null}xA.prototype=S7.prototype={constructor:xA,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?oI():+n)+(e==null?0:+e),!this._next&&Bx!==this&&(Bx?Bx._next=this:vA=this,Bx=this),this._call=t,this._time=n,VD()},stop:function(){this._call&&(this._call=null,this._time=1/0,VD())}};function S7(t,e,n){var i=new xA;return i.restart(t,e,n),i}function Bge(){oI(),++nv;for(var t=vA,e;t;)(e=sm-t._time)>=0&&t._call.call(null,e),t=t._next;--nv}function G5(){sm=(yA=p_.now())+JT,nv=Nx=0;try{Bge()}finally{nv=0,Fge(),sm=0}}function kge(){var t=p_.now(),e=t-yA;e>_7&&(JT-=e,yA=t)}function Fge(){for(var t,e=vA,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:vA=n);Bx=t,VD(i)}function VD(t){if(!nv){Nx&&(Nx=clearTimeout(Nx));var e=t-sm;e>24?(t<1/0&&(Nx=setTimeout(G5,t-p_.now()-JT)),wx&&(wx=clearInterval(wx))):(wx||(yA=p_.now(),wx=setInterval(kge,_7)),nv=1,b7(G5))}}function V5(t,e,n){var i=new xA;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var Gge=QT("start","end","cancel","interrupt"),Vge=[],E7=0,H5=1,HD=2,EE=3,j5=4,jD=5,wE=6;function $T(t,e,n,i,r,s){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;Hge(t,n,{name:e,index:i,group:r,on:Gge,tween:Vge,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:E7})}function lI(t,e){var n=cu(t,e);if(n.state>E7)throw new Error("too late; already scheduled");return n}function hc(t,e){var n=cu(t,e);if(n.state>EE)throw new Error("too late; already running");return n}function cu(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Hge(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=S7(s,0,n.time);function s(u){n.state=H5,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var c,h,d,m;if(n.state!==H5)return l();for(c in i)if(m=i[c],m.name===n.name){if(m.state===EE)return V5(a);m.state===j5?(m.state=wE,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete i[c]):+c<e&&(m.state=wE,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete i[c])}if(V5(function(){n.state===EE&&(n.state=j5,n.timer.restart(o,n.delay,n.time),o(u))}),n.state=HD,n.on.call("start",t,t.__data__,n.index,n.group),n.state===HD){for(n.state=EE,r=new Array(d=n.tween.length),c=0,h=-1;c<d;++c)(m=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++h]=m);r.length=h+1}}function o(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=jD,1),h=-1,d=r.length;++h<d;)r[h].call(t,c);n.state===jD&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=wE,n.timer.stop(),delete i[e];for(var u in i)return;delete t.__transition}}function AE(t,e){var n=t.__transition,i,r,s=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((i=n[a]).name!==e){s=!1;continue}r=i.state>HD&&i.state<jD,i.state=wE,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[a]}s&&delete t.__transition}}function jge(t){return this.each(function(){AE(this,t)})}function uI(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function w7(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function ob(){}var m_=.7,_A=1/m_,T0="\\s*([+-]?\\d+)\\s*",g_="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ic="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wge=/^#([0-9a-f]{3,8})$/,Xge=new RegExp(`^rgb\\(${T0},${T0},${T0}\\)$`),Yge=new RegExp(`^rgb\\(${ic},${ic},${ic}\\)$`),Zge=new RegExp(`^rgba\\(${T0},${T0},${T0},${g_}\\)$`),qge=new RegExp(`^rgba\\(${ic},${ic},${ic},${g_}\\)$`),Kge=new RegExp(`^hsl\\(${g_},${ic},${ic}\\)$`),Qge=new RegExp(`^hsla\\(${g_},${ic},${ic},${g_}\\)$`),W5={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};uI(ob,ud,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:X5,formatHex:X5,formatHex8:Jge,formatHsl:$ge,formatRgb:Y5,toString:Y5});function X5(){return this.rgb().formatHex()}function Jge(){return this.rgb().formatHex8()}function $ge(){return A7(this).formatHsl()}function Y5(){return this.rgb().formatRgb()}function ud(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Wge.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Z5(e):n===3?new so(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?G2(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?G2(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Xge.exec(t))?new so(e[1],e[2],e[3],1):(e=Yge.exec(t))?new so(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Zge.exec(t))?G2(e[1],e[2],e[3],e[4]):(e=qge.exec(t))?G2(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Kge.exec(t))?Q5(e[1],e[2]/100,e[3]/100,1):(e=Qge.exec(t))?Q5(e[1],e[2]/100,e[3]/100,e[4]):W5.hasOwnProperty(t)?Z5(W5[t]):t==="transparent"?new so(NaN,NaN,NaN,0):null}function Z5(t){return new so(t>>16&255,t>>8&255,t&255,1)}function G2(t,e,n,i){return i<=0&&(t=e=n=NaN),new so(t,e,n,i)}function e0e(t){return t instanceof ob||(t=ud(t)),t?(t=t.rgb(),new so(t.r,t.g,t.b,t.opacity)):new so}function WD(t,e,n,i){return arguments.length===1?e0e(t):new so(t,e,n,i??1)}function so(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}uI(so,WD,w7(ob,{brighter(t){return t=t==null?_A:Math.pow(_A,t),new so(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?m_:Math.pow(m_,t),new so(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new so(Hp(this.r),Hp(this.g),Hp(this.b),bA(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:q5,formatHex:q5,formatHex8:t0e,formatRgb:K5,toString:K5}));function q5(){return`#${Rp(this.r)}${Rp(this.g)}${Rp(this.b)}`}function t0e(){return`#${Rp(this.r)}${Rp(this.g)}${Rp(this.b)}${Rp((isNaN(this.opacity)?1:this.opacity)*255)}`}function K5(){const t=bA(this.opacity);return`${t===1?"rgb(":"rgba("}${Hp(this.r)}, ${Hp(this.g)}, ${Hp(this.b)}${t===1?")":`, ${t})`}`}function bA(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Hp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Rp(t){return t=Hp(t),(t<16?"0":"")+t.toString(16)}function Q5(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new eu(t,e,n,i)}function A7(t){if(t instanceof eu)return new eu(t.h,t.s,t.l,t.opacity);if(t instanceof ob||(t=ud(t)),!t)return new eu;if(t instanceof eu)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),a=NaN,o=s-r,l=(s+r)/2;return o?(e===s?a=(n-i)/o+(n<i)*6:n===s?a=(i-e)/o+2:a=(e-n)/o+4,o/=l<.5?s+r:2-s-r,a*=60):o=l>0&&l<1?0:a,new eu(a,o,l,t.opacity)}function n0e(t,e,n,i){return arguments.length===1?A7(t):new eu(t,e,n,i??1)}function eu(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}uI(eu,n0e,w7(ob,{brighter(t){return t=t==null?_A:Math.pow(_A,t),new eu(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?m_:Math.pow(m_,t),new eu(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new so(G3(t>=240?t-240:t+120,r,i),G3(t,r,i),G3(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new eu(J5(this.h),V2(this.s),V2(this.l),bA(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=bA(this.opacity);return`${t===1?"hsl(":"hsla("}${J5(this.h)}, ${V2(this.s)*100}%, ${V2(this.l)*100}%${t===1?")":`, ${t})`}`}}));function J5(t){return t=(t||0)%360,t<0?t+360:t}function V2(t){return Math.max(0,Math.min(1,t||0))}function G3(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const cI=t=>()=>t;function i0e(t,e){return function(n){return t+n*e}}function r0e(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function s0e(t){return(t=+t)==1?T7:function(e,n){return n-e?r0e(e,n,t):cI(isNaN(e)?n:e)}}function T7(t,e){var n=e-t;return n?i0e(t,n):cI(isNaN(t)?e:t)}const SA=function t(e){var n=s0e(e);function i(r,s){var a=n((r=WD(r)).r,(s=WD(s)).r),o=n(r.g,s.g),l=n(r.b,s.b),u=T7(r.opacity,s.opacity);return function(c){return r.r=a(c),r.g=o(c),r.b=l(c),r.opacity=u(c),r+""}}return i.gamma=t,i}(1);function a0e(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function o0e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function l0e(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),s=new Array(n),a;for(a=0;a<i;++a)r[a]=fI(t[a],e[a]);for(;a<n;++a)s[a]=e[a];return function(o){for(a=0;a<i;++a)s[a]=r[a](o);return s}}function u0e(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Jl(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function c0e(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=fI(t[r],e[r]):i[r]=e[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var XD=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,V3=new RegExp(XD.source,"g");function f0e(t){return function(){return t}}function h0e(t){return function(e){return t(e)+""}}function M7(t,e){var n=XD.lastIndex=V3.lastIndex=0,i,r,s,a=-1,o=[],l=[];for(t=t+"",e=e+"";(i=XD.exec(t))&&(r=V3.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(i=i[0])===(r=r[0])?o[a]?o[a]+=r:o[++a]=r:(o[++a]=null,l.push({i:a,x:Jl(i,r)})),n=V3.lastIndex;return n<e.length&&(s=e.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?h0e(l[0].x):f0e(e):(e=l.length,function(u){for(var c=0,h;c<e;++c)o[(h=l[c]).i]=h.x(u);return o.join("")})}function fI(t,e){var n=typeof e,i;return e==null||n==="boolean"?cI(e):(n==="number"?Jl:n==="string"?(i=ud(e))?(e=i,SA):M7:e instanceof ud?SA:e instanceof Date?u0e:o0e(e)?a0e:Array.isArray(e)?l0e:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?c0e:Jl)(t,e)}function d0e(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var $5=180/Math.PI,C7={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function R7(t,e,n,i,r,s){var a,o,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,l/=o),t*i<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*$5,skewX:Math.atan(l)*$5,scaleX:a,scaleY:o}}var H2;function p0e(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?C7:R7(e.a,e.b,e.c,e.d,e.e,e.f)}function m0e(t){return t==null||(H2||(H2=document.createElementNS("http://www.w3.org/2000/svg","g")),H2.setAttribute("transform",t),!(t=H2.transform.baseVal.consolidate()))?C7:(t=t.matrix,R7(t.a,t.b,t.c,t.d,t.e,t.f))}function D7(t,e,n,i){function r(u){return u.length?u.pop()+" ":""}function s(u,c,h,d,m,v){if(u!==h||c!==d){var _=m.push("translate(",null,e,null,n);v.push({i:_-4,x:Jl(u,h)},{i:_-2,x:Jl(c,d)})}else(h||d)&&m.push("translate("+h+e+d+n)}function a(u,c,h,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:h.push(r(h)+"rotate(",null,i)-2,x:Jl(u,c)})):c&&h.push(r(h)+"rotate("+c+i)}function o(u,c,h,d){u!==c?d.push({i:h.push(r(h)+"skewX(",null,i)-2,x:Jl(u,c)}):c&&h.push(r(h)+"skewX("+c+i)}function l(u,c,h,d,m,v){if(u!==h||c!==d){var _=m.push(r(m)+"scale(",null,",",null,")");v.push({i:_-4,x:Jl(u,h)},{i:_-2,x:Jl(c,d)})}else(h!==1||d!==1)&&m.push(r(m)+"scale("+h+","+d+")")}return function(u,c){var h=[],d=[];return u=t(u),c=t(c),s(u.translateX,u.translateY,c.translateX,c.translateY,h,d),a(u.rotate,c.rotate,h,d),o(u.skewX,c.skewX,h,d),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,h,d),u=c=null,function(m){for(var v=-1,_=d.length,y;++v<_;)h[(y=d[v]).i]=y.x(m);return h.join("")}}}var g0e=D7(p0e,"px, ","px)","deg)"),v0e=D7(m0e,", ",")",")"),y0e=1e-12;function eB(t){return((t=Math.exp(t))+1/t)/2}function x0e(t){return((t=Math.exp(t))-1/t)/2}function _0e(t){return((t=Math.exp(2*t))-1)/(t+1)}const b0e=function t(e,n,i){function r(s,a){var o=s[0],l=s[1],u=s[2],c=a[0],h=a[1],d=a[2],m=c-o,v=h-l,_=m*m+v*v,y,g;if(_<y0e)g=Math.log(d/u)/e,y=function(C){return[o+C*m,l+C*v,u*Math.exp(e*C*g)]};else{var x=Math.sqrt(_),S=(d*d-u*u+i*_)/(2*u*n*x),E=(d*d-u*u-i*_)/(2*d*n*x),A=Math.log(Math.sqrt(S*S+1)-S),T=Math.log(Math.sqrt(E*E+1)-E);g=(T-A)/e,y=function(C){var O=C*g,M=eB(A),D=u/(n*x)*(M*_0e(e*O+A)-x0e(A));return[o+D*m,l+D*v,u*M/eB(e*O+A)]}}return y.duration=g*1e3*e/Math.SQRT2,y}return r.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return t(a,o,l)},r}(Math.SQRT2,2,4);function S0e(t,e){var n,i;return function(){var r=hc(this,t),s=r.tween;if(s!==n){i=n=s;for(var a=0,o=i.length;a<o;++a)if(i[a].name===e){i=i.slice(),i.splice(a,1);break}}r.tween=i}}function E0e(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=hc(this,t),a=s.tween;if(a!==i){r=(i=a).slice();for(var o={name:e,value:n},l=0,u=r.length;l<u;++l)if(r[l].name===e){r[l]=o;break}l===u&&r.push(o)}s.tween=r}}function w0e(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=cu(this.node(),n).tween,r=0,s=i.length,a;r<s;++r)if((a=i[r]).name===t)return a.value;return null}return this.each((e==null?S0e:E0e)(n,t,e))}function hI(t,e,n){var i=t._id;return t.each(function(){var r=hc(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return cu(r,i).value[e]}}function O7(t,e){var n;return(typeof e=="number"?Jl:e instanceof ud?SA:(n=ud(e))?(e=n,SA):M7)(t,e)}function A0e(t){return function(){this.removeAttribute(t)}}function T0e(t){return function(){this.removeAttributeNS(t.space,t.local)}}function M0e(t,e,n){var i,r=n+"",s;return function(){var a=this.getAttribute(t);return a===r?null:a===i?s:s=e(i=a,n)}}function C0e(t,e,n){var i,r=n+"",s;return function(){var a=this.getAttributeNS(t.space,t.local);return a===r?null:a===i?s:s=e(i=a,n)}}function R0e(t,e,n){var i,r,s;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=o+"",a===l?null:a===i&&l===r?s:(r=l,s=e(i=a,o)))}}function D0e(t,e,n){var i,r,s;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=o+"",a===l?null:a===i&&l===r?s:(r=l,s=e(i=a,o)))}}function O0e(t,e){var n=KT(t),i=n==="transform"?v0e:O7;return this.attrTween(t,typeof e=="function"?(n.local?D0e:R0e)(n,i,hI(this,"attr."+t,e)):e==null?(n.local?T0e:A0e)(n):(n.local?C0e:M0e)(n,i,e))}function U0e(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function z0e(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function I0e(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&z0e(t,s)),n}return r._value=e,r}function L0e(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&U0e(t,s)),n}return r._value=e,r}function P0e(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=KT(t);return this.tween(n,(i.local?I0e:L0e)(i,e))}function N0e(t,e){return function(){lI(this,t).delay=+e.apply(this,arguments)}}function B0e(t,e){return e=+e,function(){lI(this,t).delay=e}}function k0e(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?N0e:B0e)(e,t)):cu(this.node(),e).delay}function F0e(t,e){return function(){hc(this,t).duration=+e.apply(this,arguments)}}function G0e(t,e){return e=+e,function(){hc(this,t).duration=e}}function V0e(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?F0e:G0e)(e,t)):cu(this.node(),e).duration}function H0e(t,e){if(typeof e!="function")throw new Error;return function(){hc(this,t).ease=e}}function j0e(t){var e=this._id;return arguments.length?this.each(H0e(e,t)):cu(this.node(),e).ease}function W0e(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;hc(this,t).ease=n}}function X0e(t){if(typeof t!="function")throw new Error;return this.each(W0e(this._id,t))}function Y0e(t){typeof t!="function"&&(t=c7(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,o=i[r]=[],l,u=0;u<a;++u)(l=s[u])&&t.call(l,l.__data__,u,s)&&o.push(l);return new Of(i,this._parents,this._name,this._id)}function Z0e(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),a=new Array(i),o=0;o<s;++o)for(var l=e[o],u=n[o],c=l.length,h=a[o]=new Array(c),d,m=0;m<c;++m)(d=l[m]||u[m])&&(h[m]=d);for(;o<i;++o)a[o]=e[o];return new Of(a,this._parents,this._name,this._id)}function q0e(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function K0e(t,e,n){var i,r,s=q0e(e)?lI:hc;return function(){var a=s(this,t),o=a.on;o!==i&&(r=(i=o).copy()).on(e,n),a.on=r}}function Q0e(t,e){var n=this._id;return arguments.length<2?cu(this.node(),n).on.on(t):this.each(K0e(n,t,e))}function J0e(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function $0e(){return this.on("end.remove",J0e(this._id))}function eve(t){var e=this._name,n=this._id;typeof t!="function"&&(t=sI(t));for(var i=this._groups,r=i.length,s=new Array(r),a=0;a<r;++a)for(var o=i[a],l=o.length,u=s[a]=new Array(l),c,h,d=0;d<l;++d)(c=o[d])&&(h=t.call(c,c.__data__,d,o))&&("__data__"in c&&(h.__data__=c.__data__),u[d]=h,$T(u[d],e,n,d,u,cu(c,n)));return new Of(s,this._parents,e,n)}function tve(t){var e=this._name,n=this._id;typeof t!="function"&&(t=u7(t));for(var i=this._groups,r=i.length,s=[],a=[],o=0;o<r;++o)for(var l=i[o],u=l.length,c,h=0;h<u;++h)if(c=l[h]){for(var d=t.call(c,c.__data__,h,l),m,v=cu(c,n),_=0,y=d.length;_<y;++_)(m=d[_])&&$T(m,e,n,_,d,v);s.push(d),a.push(c)}return new Of(s,a,e,n)}var nve=ab.prototype.constructor;function ive(){return new nve(this._groups,this._parents)}function rve(t,e){var n,i,r;return function(){var s=tv(this,t),a=(this.style.removeProperty(t),tv(this,t));return s===a?null:s===n&&a===i?r:r=e(n=s,i=a)}}function U7(t){return function(){this.style.removeProperty(t)}}function sve(t,e,n){var i,r=n+"",s;return function(){var a=tv(this,t);return a===r?null:a===i?s:s=e(i=a,n)}}function ave(t,e,n){var i,r,s;return function(){var a=tv(this,t),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(t),tv(this,t))),a===l?null:a===i&&l===r?s:(r=l,s=e(i=a,o))}}function ove(t,e){var n,i,r,s="style."+e,a="end."+s,o;return function(){var l=hc(this,t),u=l.on,c=l.value[s]==null?o||(o=U7(e)):void 0;(u!==n||r!==c)&&(i=(n=u).copy()).on(a,r=c),l.on=i}}function lve(t,e,n){var i=(t+="")=="transform"?g0e:O7;return e==null?this.styleTween(t,rve(t,i)).on("end.style."+t,U7(t)):typeof e=="function"?this.styleTween(t,ave(t,i,hI(this,"style."+t,e))).each(ove(this._id,t)):this.styleTween(t,sve(t,i,e),n).on("end.style."+t,null)}function uve(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function cve(t,e,n){var i,r;function s(){var a=e.apply(this,arguments);return a!==r&&(i=(r=a)&&uve(t,a,n)),i}return s._value=e,s}function fve(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,cve(t,e,n??""))}function hve(t){return function(){this.textContent=t}}function dve(t){return function(){var e=t(this);this.textContent=e??""}}function pve(t){return this.tween("text",typeof t=="function"?dve(hI(this,"text",t)):hve(t==null?"":t+""))}function mve(t){return function(e){this.textContent=t.call(this,e)}}function gve(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&mve(r)),e}return i._value=t,i}function vve(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,gve(t))}function yve(){for(var t=this._name,e=this._id,n=z7(),i=this._groups,r=i.length,s=0;s<r;++s)for(var a=i[s],o=a.length,l,u=0;u<o;++u)if(l=a[u]){var c=cu(l,e);$T(l,t,n,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Of(i,this._parents,t,n)}function xve(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,a){var o={value:a},l={value:function(){--r===0&&s()}};n.each(function(){var u=hc(this,i),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),u.on=e}),r===0&&s()})}var _ve=0;function Of(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function z7(){return++_ve}var Qc=ab.prototype;Of.prototype={constructor:Of,select:eve,selectAll:tve,selectChild:Qc.selectChild,selectChildren:Qc.selectChildren,filter:Y0e,merge:Z0e,selection:ive,transition:yve,call:Qc.call,nodes:Qc.nodes,node:Qc.node,size:Qc.size,empty:Qc.empty,each:Qc.each,on:Q0e,attr:O0e,attrTween:P0e,style:lve,styleTween:fve,text:pve,textTween:vve,remove:$0e,tween:w0e,delay:k0e,duration:V0e,ease:j0e,easeVarying:X0e,end:xve,[Symbol.iterator]:Qc[Symbol.iterator]};function bve(t){return t*t}function Sve(t){return t*(2-t)}function Eve(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function wve(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Ave={time:null,delay:0,duration:250,ease:wve};function Tve(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Mve(t){var e,n;t instanceof Of?(e=t._id,t=t._name):(e=z7(),(n=Ave).time=oI(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var a=i[s],o=a.length,l,u=0;u<o;++u)(l=a[u])&&$T(l,t,e,u,a,n||Tve(l,e));return new Of(i,this._parents,t,e)}ab.prototype.interrupt=jge;ab.prototype.transition=Mve;function dI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Cve(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var YD={exports:{}},Rve=YD.exports,tB;function Dve(){return tB||(tB=1,function(t,e){(function(n,i){t.exports=i()})(Rve,function(){var n=function(L){return L instanceof Uint8Array||L instanceof Uint16Array||L instanceof Uint32Array||L instanceof Int8Array||L instanceof Int16Array||L instanceof Int32Array||L instanceof Float32Array||L instanceof Float64Array||L instanceof Uint8ClampedArray},i=function(L,ee){for(var fe=Object.keys(ee),Be=0;Be<fe.length;++Be)L[fe[Be]]=ee[fe[Be]];return L},r=`
`;function s(L){return typeof atob<"u"?atob(L):"base64:"+L}function a(L){var ee=new Error("(regl) "+L);throw console.error(ee),ee}function o(L,ee){L||a(ee)}function l(L){return L?": "+L:""}function u(L,ee,fe){L in ee||a("unknown parameter ("+L+")"+l(fe)+". possible values: "+Object.keys(ee).join())}function c(L,ee){n(L)||a("invalid parameter type"+l(ee)+". must be a typed array")}function h(L,ee){switch(ee){case"number":return typeof L=="number";case"object":return typeof L=="object";case"string":return typeof L=="string";case"boolean":return typeof L=="boolean";case"function":return typeof L=="function";case"undefined":return typeof L>"u";case"symbol":return typeof L=="symbol"}}function d(L,ee,fe){h(L,ee)||a("invalid parameter type"+l(fe)+". expected "+ee+", got "+typeof L)}function m(L,ee){L>=0&&(L|0)===L||a("invalid parameter type, ("+L+")"+l(ee)+". must be a nonnegative integer")}function v(L,ee,fe){ee.indexOf(L)<0&&a("invalid value"+l(fe)+". must be one of: "+ee)}var _=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function y(L){Object.keys(L).forEach(function(ee){_.indexOf(ee)<0&&a('invalid regl constructor argument "'+ee+'". must be one of '+_)})}function g(L,ee){for(L=L+"";L.length<ee;)L=" "+L;return L}function x(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function S(L,ee){this.number=L,this.line=ee,this.errors=[]}function E(L,ee,fe){this.file=L,this.line=ee,this.message=fe}function A(){var L=new Error,ee=(L.stack||L).toString(),fe=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(ee);if(fe)return fe[1];var Be=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(ee);return Be?Be[1]:"unknown"}function T(){var L=new Error,ee=(L.stack||L).toString(),fe=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(ee);if(fe)return fe[1];var Be=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(ee);return Be?Be[1]:"unknown"}function C(L,ee){var fe=L.split(`
`),Be=1,nt=0,Le={unknown:new x,0:new x};Le.unknown.name=Le[0].name=ee||A(),Le.unknown.lines.push(new S(0,""));for(var He=0;He<fe.length;++He){var yt=fe[He],mt=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(yt);if(mt)switch(mt[1]){case"line":var Ct=/(\d+)(\s+\d+)?/.exec(mt[2]);Ct&&(Be=Ct[1]|0,Ct[2]&&(nt=Ct[2]|0,nt in Le||(Le[nt]=new x)));break;case"define":var xt=/SHADER_NAME(_B64)?\s+(.*)$/.exec(mt[2]);xt&&(Le[nt].name=xt[1]?s(xt[2]):xt[2]);break}Le[nt].lines.push(new S(Be++,yt))}return Object.keys(Le).forEach(function(gt){var ht=Le[gt];ht.lines.forEach(function(dt){ht.index[dt.number]=dt})}),Le}function O(L){var ee=[];return L.split(`
`).forEach(function(fe){if(!(fe.length<5)){var Be=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(fe);Be?ee.push(new E(Be[1]|0,Be[2]|0,Be[3].trim())):fe.length>0&&ee.push(new E("unknown",0,fe))}}),ee}function M(L,ee){ee.forEach(function(fe){var Be=L[fe.file];if(Be){var nt=Be.index[fe.line];if(nt){nt.errors.push(fe),Be.hasErrors=!0;return}}L.unknown.hasErrors=!0,L.unknown.lines[0].errors.push(fe)})}function D(L,ee,fe,Be,nt){if(!L.getShaderParameter(ee,L.COMPILE_STATUS)){var Le=L.getShaderInfoLog(ee),He=Be===L.FRAGMENT_SHADER?"fragment":"vertex";k(fe,"string",He+" shader source must be a string",nt);var yt=C(fe,nt),mt=O(Le);M(yt,mt),Object.keys(yt).forEach(function(Ct){var xt=yt[Ct];if(!xt.hasErrors)return;var gt=[""],ht=[""];function dt(bt,Me){gt.push(bt),ht.push(Me||"")}dt("file number "+Ct+": "+xt.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),xt.lines.forEach(function(bt){if(bt.errors.length>0){dt(g(bt.number,4)+"|  ","background-color:yellow; font-weight:bold"),dt(bt.line+r,"color:red; background-color:yellow; font-weight:bold");var Me=0;bt.errors.forEach(function(je){var wt=je.message,Wt=/^\s*'(.*)'\s*:\s*(.*)$/.exec(wt);if(Wt){var pt=Wt[1];switch(wt=Wt[2],pt){case"assign":pt="=";break}Me=Math.max(bt.line.indexOf(pt,Me),0)}else Me=0;dt(g("| ",6)),dt(g("^^^",Me+3)+r,"font-weight:bold"),dt(g("| ",6)),dt(wt+r,"font-weight:bold")}),dt(g("| ",6)+r)}else dt(g(bt.number,4)+"|  "),dt(bt.line+r,"color:red")}),typeof document<"u"&&!window.chrome?(ht[0]=gt.join("%c"),console.log.apply(console,ht)):console.log(gt.join(""))}),o.raise("Error compiling "+He+" shader, "+yt[0].name)}}function P(L,ee,fe,Be,nt){if(!L.getProgramParameter(ee,L.LINK_STATUS)){var Le=L.getProgramInfoLog(ee),He=C(fe,nt),yt=C(Be,nt),mt='Error linking program with vertex shader, "'+yt[0].name+'", and fragment shader "'+He[0].name+'"';typeof document<"u"?console.log("%c"+mt+r+"%c"+Le,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(mt+r+Le),o.raise(mt)}}function F(L){L._commandRef=A()}function G(L,ee,fe,Be){F(L);function nt(mt){return mt?Be.id(mt):0}L._fragId=nt(L.static.frag),L._vertId=nt(L.static.vert);function Le(mt,Ct){Object.keys(Ct).forEach(function(xt){mt[Be.id(xt)]=!0})}var He=L._uniformSet={};Le(He,ee.static),Le(He,ee.dynamic);var yt=L._attributeSet={};Le(yt,fe.static),Le(yt,fe.dynamic),L._hasCount="count"in L.static||"count"in L.dynamic||"elements"in L.static||"elements"in L.dynamic}function z(L,ee){var fe=T();a(L+" in command "+(ee||A())+(fe==="unknown"?"":" called from "+fe))}function Y(L,ee,fe){L||z(ee,fe||A())}function N(L,ee,fe,Be){L in ee||z("unknown parameter ("+L+")"+l(fe)+". possible values: "+Object.keys(ee).join(),Be||A())}function k(L,ee,fe,Be){h(L,ee)||z("invalid parameter type"+l(fe)+". expected "+ee+", got "+typeof L,Be||A())}function j(L){L()}function X(L,ee,fe){L.texture?v(L.texture._texture.internalformat,ee,"unsupported texture format for attachment"):v(L.renderbuffer._renderbuffer.format,fe,"unsupported renderbuffer format for attachment")}var Q=33071,H=9728,$=9984,ne=9985,q=9986,se=9987,ve=5120,pe=5121,xe=5122,ot=5123,st=5124,et=5125,Te=5126,Xe=32819,K=32820,Pe=33635,Ne=34042,Ve=36193,_e={};_e[ve]=_e[pe]=1,_e[xe]=_e[ot]=_e[Ve]=_e[Pe]=_e[Xe]=_e[K]=2,_e[st]=_e[et]=_e[Te]=_e[Ne]=4;function ft(L,ee){return L===K||L===Xe||L===Pe?2:L===Ne?4:_e[L]*ee}function ke(L){return!(L&L-1)&&!!L}function Z(L,ee,fe){var Be,nt=ee.width,Le=ee.height,He=ee.channels;o(nt>0&&nt<=fe.maxTextureSize&&Le>0&&Le<=fe.maxTextureSize,"invalid texture shape"),(L.wrapS!==Q||L.wrapT!==Q)&&o(ke(nt)&&ke(Le),"incompatible wrap mode for texture, both width and height must be power of 2"),ee.mipmask===1?nt!==1&&Le!==1&&o(L.minFilter!==$&&L.minFilter!==q&&L.minFilter!==ne&&L.minFilter!==se,"min filter requires mipmap"):(o(ke(nt)&&ke(Le),"texture must be a square power of 2 to support mipmapping"),o(ee.mipmask===(nt<<1)-1,"missing or incomplete mipmap data")),ee.type===Te&&(fe.extensions.indexOf("oes_texture_float_linear")<0&&o(L.minFilter===H&&L.magFilter===H,"filter not supported, must enable oes_texture_float_linear"),o(!L.genMipmaps,"mipmap generation not supported with float textures"));var yt=ee.images;for(Be=0;Be<16;++Be)if(yt[Be]){var mt=nt>>Be,Ct=Le>>Be;o(ee.mipmask&1<<Be,"missing mipmap data");var xt=yt[Be];if(o(xt.width===mt&&xt.height===Ct,"invalid shape for mip images"),o(xt.format===ee.format&&xt.internalformat===ee.internalformat&&xt.type===ee.type,"incompatible type for mip image"),!xt.compressed)if(xt.data){var gt=Math.ceil(ft(xt.type,He)*mt/xt.unpackAlignment)*xt.unpackAlignment;o(xt.data.byteLength===gt*Ct,"invalid data for image, buffer size is inconsistent with image format")}else xt.element||xt.copy}else L.genMipmaps||o((ee.mipmask&1<<Be)===0,"extra mipmap data");ee.compressed&&o(!L.genMipmaps,"mipmap generation for compressed images not supported")}function W(L,ee,fe,Be){var nt=L.width,Le=L.height,He=L.channels;o(nt>0&&nt<=Be.maxTextureSize&&Le>0&&Le<=Be.maxTextureSize,"invalid texture shape"),o(nt===Le,"cube map must be square"),o(ee.wrapS===Q&&ee.wrapT===Q,"wrap mode not supported by cube map");for(var yt=0;yt<fe.length;++yt){var mt=fe[yt];o(mt.width===nt&&mt.height===Le,"inconsistent cube map face shape"),ee.genMipmaps&&(o(!mt.compressed,"can not generate mipmap for compressed textures"),o(mt.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Ct=mt.images,xt=0;xt<16;++xt){var gt=Ct[xt];if(gt){var ht=nt>>xt,dt=Le>>xt;o(mt.mipmask&1<<xt,"missing mipmap data"),o(gt.width===ht&&gt.height===dt,"invalid shape for mip images"),o(gt.format===L.format&&gt.internalformat===L.internalformat&&gt.type===L.type,"incompatible type for mip image"),gt.compressed||(gt.data?o(gt.data.byteLength===ht*dt*Math.max(ft(gt.type,He),gt.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):gt.element||gt.copy)}}}}var I=i(o,{optional:j,raise:a,commandRaise:z,command:Y,parameter:u,commandParameter:N,constructor:y,type:d,commandType:k,isTypedArray:c,nni:m,oneOf:v,shaderError:D,linkError:P,callSite:T,saveCommandRef:F,saveDrawInfo:G,framebufferFormat:X,guessCommand:A,texture2D:Z,textureCube:W}),De=0,ge=0,ze=5,ct=6;function at(L,ee){this.id=De++,this.type=L,this.data=ee}function Rt(L){return L.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Nt(L){if(L.length===0)return[];var ee=L.charAt(0),fe=L.charAt(L.length-1);if(L.length>1&&ee===fe&&(ee==='"'||ee==="'"))return['"'+Rt(L.substr(1,L.length-2))+'"'];var Be=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(L);if(Be)return Nt(L.substr(0,Be.index)).concat(Nt(Be[1])).concat(Nt(L.substr(Be.index+Be[0].length)));var nt=L.split(".");if(nt.length===1)return['"'+Rt(L)+'"'];for(var Le=[],He=0;He<nt.length;++He)Le=Le.concat(Nt(nt[He]));return Le}function vt(L){return"["+Nt(L).join("][")+"]"}function Vt(L,ee){return new at(L,vt(ee+""))}function Bt(L){return typeof L=="function"&&!L._reglType||L instanceof at}function Ht(L,ee){if(typeof L=="function")return new at(ge,L);if(typeof L=="number"||typeof L=="boolean")return new at(ze,L);if(Array.isArray(L))return new at(ct,L.map(function(fe,Be){return Ht(fe,ee+"["+Be+"]")}));if(L instanceof at)return L;I(!1,"invalid option type in uniform "+ee)}var ut={DynamicVariable:at,define:Vt,isDynamic:Bt,unbox:Ht,accessor:vt},xn={next:typeof requestAnimationFrame=="function"?function(L){return requestAnimationFrame(L)}:function(L){return setTimeout(L,16)},cancel:typeof cancelAnimationFrame=="function"?function(L){return cancelAnimationFrame(L)}:clearTimeout},un=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Vn(){var L={"":0},ee=[""];return{id:function(fe){var Be=L[fe];return Be||(Be=L[fe]=ee.length,ee.push(fe),Be)},str:function(fe){return ee[fe]}}}function be(L,ee,fe){var Be=document.createElement("canvas");i(Be.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),L.appendChild(Be),L===document.body&&(Be.style.position="absolute",i(L.style,{margin:0,padding:0}));function nt(){var yt=window.innerWidth,mt=window.innerHeight;if(L!==document.body){var Ct=Be.getBoundingClientRect();yt=Ct.right-Ct.left,mt=Ct.bottom-Ct.top}Be.width=fe*yt,Be.height=fe*mt}var Le;L!==document.body&&typeof ResizeObserver=="function"?(Le=new ResizeObserver(function(){setTimeout(nt)}),Le.observe(L)):window.addEventListener("resize",nt,!1);function He(){Le?Le.disconnect():window.removeEventListener("resize",nt),L.removeChild(Be)}return nt(),{canvas:Be,onDestroy:He}}function _t(L,ee){function fe(Be){try{return L.getContext(Be,ee)}catch{return null}}return fe("webgl")||fe("experimental-webgl")||fe("webgl-experimental")}function Ye(L){return typeof L.nodeName=="string"&&typeof L.appendChild=="function"&&typeof L.getBoundingClientRect=="function"}function Et(L){return typeof L.drawArrays=="function"||typeof L.drawElements=="function"}function Ot(L){return typeof L=="string"?L.split():(I(Array.isArray(L),"invalid extension array"),L)}function Mt(L){return typeof L=="string"?(I(typeof document<"u","not supported outside of DOM"),document.querySelector(L)):L}function vn(L){var ee=L||{},fe,Be,nt,Le,He={},yt=[],mt=[],Ct=typeof window>"u"?1:window.devicePixelRatio,xt=!1,gt=function(bt){bt&&I.raise(bt)},ht=function(){};if(typeof ee=="string"?(I(typeof document<"u","selector queries only supported in DOM enviroments"),fe=document.querySelector(ee),I(fe,"invalid query string for element")):typeof ee=="object"?Ye(ee)?fe=ee:Et(ee)?(Le=ee,nt=Le.canvas):(I.constructor(ee),"gl"in ee?Le=ee.gl:"canvas"in ee?nt=Mt(ee.canvas):"container"in ee&&(Be=Mt(ee.container)),"attributes"in ee&&(He=ee.attributes,I.type(He,"object","invalid context attributes")),"extensions"in ee&&(yt=Ot(ee.extensions)),"optionalExtensions"in ee&&(mt=Ot(ee.optionalExtensions)),"onDone"in ee&&(I.type(ee.onDone,"function","invalid or missing onDone callback"),gt=ee.onDone),"profile"in ee&&(xt=!!ee.profile),"pixelRatio"in ee&&(Ct=+ee.pixelRatio,I(Ct>0,"invalid pixel ratio"))):I.raise("invalid arguments to regl"),fe&&(fe.nodeName.toLowerCase()==="canvas"?nt=fe:Be=fe),!Le){if(!nt){I(typeof document<"u","must manually specify webgl context outside of DOM environments");var dt=be(Be||document.body,gt,Ct);if(!dt)return null;nt=dt.canvas,ht=dt.onDestroy}He.premultipliedAlpha===void 0&&(He.premultipliedAlpha=!0),Le=_t(nt,He)}return Le?{gl:Le,canvas:nt,container:Be,extensions:yt,optionalExtensions:mt,pixelRatio:Ct,profile:xt,onDone:gt,onDestroy:ht}:(ht(),gt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Un(L,ee){var fe={};function Be(He){I.type(He,"string","extension name must be string");var yt=He.toLowerCase(),mt;try{mt=fe[yt]=L.getExtension(yt)}catch{}return!!mt}for(var nt=0;nt<ee.extensions.length;++nt){var Le=ee.extensions[nt];if(!Be(Le))return ee.onDestroy(),ee.onDone('"'+Le+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return ee.optionalExtensions.forEach(Be),{extensions:fe,restore:function(){Object.keys(fe).forEach(function(He){if(fe[He]&&!Be(He))throw new Error("(regl): error restoring extension "+He)})}}}function an(L,ee){for(var fe=Array(L),Be=0;Be<L;++Be)fe[Be]=ee(Be);return fe}var An=5120,Ri=5121,Ni=5122,lr=5123,us=5124,Vr=5125,Sr=5126;function aa(L){for(var ee=16;ee<=1<<28;ee*=16)if(L<=ee)return ee;return 0}function Hr(L){var ee,fe;return ee=(L>65535)<<4,L>>>=ee,fe=(L>255)<<3,L>>>=fe,ee|=fe,fe=(L>15)<<2,L>>>=fe,ee|=fe,fe=(L>3)<<1,L>>>=fe,ee|=fe,ee|L>>1}function ur(){var L=an(8,function(){return[]});function ee(Le){var He=aa(Le),yt=L[Hr(He)>>2];return yt.length>0?yt.pop():new ArrayBuffer(He)}function fe(Le){L[Hr(Le.byteLength)>>2].push(Le)}function Be(Le,He){var yt=null;switch(Le){case An:yt=new Int8Array(ee(He),0,He);break;case Ri:yt=new Uint8Array(ee(He),0,He);break;case Ni:yt=new Int16Array(ee(2*He),0,He);break;case lr:yt=new Uint16Array(ee(2*He),0,He);break;case us:yt=new Int32Array(ee(4*He),0,He);break;case Vr:yt=new Uint32Array(ee(4*He),0,He);break;case Sr:yt=new Float32Array(ee(4*He),0,He);break;default:return null}return yt.length!==He?yt.subarray(0,He):yt}function nt(Le){fe(Le.buffer)}return{alloc:ee,free:fe,allocType:Be,freeType:nt}}var Zn=ur();Zn.zero=ur();var xi=3408,xl=3410,Po=3411,Vf=3412,dc=3413,fu=3414,_l=3415,pc=33901,hu=33902,te=3379,we=3386,Ke=34921,Ee=36347,Ue=36348,It=35661,en=35660,on=34930,fn=36349,zn=34076,Dn=34024,En=7936,ai=7937,ui=7938,er=35724,Di=34047,ci=36063,Tn=34852,Zi=3553,ei=34067,cs=34069,oa=33984,dr=6408,Rr=5126,Oi=5121,Er=36160,Dr=36053,jr=36064,wr=16384,qs=function(L,ee){var fe=1;ee.ext_texture_filter_anisotropic&&(fe=L.getParameter(Di));var Be=1,nt=1;ee.webgl_draw_buffers&&(Be=L.getParameter(Tn),nt=L.getParameter(ci));var Le=!!ee.oes_texture_float;if(Le){var He=L.createTexture();L.bindTexture(Zi,He),L.texImage2D(Zi,0,dr,1,1,0,dr,Rr,null);var yt=L.createFramebuffer();if(L.bindFramebuffer(Er,yt),L.framebufferTexture2D(Er,jr,Zi,He,0),L.bindTexture(Zi,null),L.checkFramebufferStatus(Er)!==Dr)Le=!1;else{L.viewport(0,0,1,1),L.clearColor(1,0,0,1),L.clear(wr);var mt=Zn.allocType(Rr,4);L.readPixels(0,0,1,1,dr,Rr,mt),L.getError()?Le=!1:(L.deleteFramebuffer(yt),L.deleteTexture(He),Le=mt[0]===1),Zn.freeType(mt)}}var Ct=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),xt=!0;if(!Ct){var gt=L.createTexture(),ht=Zn.allocType(Oi,36);L.activeTexture(oa),L.bindTexture(ei,gt),L.texImage2D(cs,0,dr,3,3,0,dr,Oi,ht),Zn.freeType(ht),L.bindTexture(ei,null),L.deleteTexture(gt),xt=!L.getError()}return{colorBits:[L.getParameter(xl),L.getParameter(Po),L.getParameter(Vf),L.getParameter(dc)],depthBits:L.getParameter(fu),stencilBits:L.getParameter(_l),subpixelBits:L.getParameter(xi),extensions:Object.keys(ee).filter(function(dt){return!!ee[dt]}),maxAnisotropic:fe,maxDrawbuffers:Be,maxColorAttachments:nt,pointSizeDims:L.getParameter(pc),lineWidthDims:L.getParameter(hu),maxViewportDims:L.getParameter(we),maxCombinedTextureUnits:L.getParameter(It),maxCubeMapSize:L.getParameter(zn),maxRenderbufferSize:L.getParameter(Dn),maxTextureUnits:L.getParameter(on),maxTextureSize:L.getParameter(te),maxAttributes:L.getParameter(Ke),maxVertexUniforms:L.getParameter(Ee),maxVertexTextureUnits:L.getParameter(en),maxVaryingVectors:L.getParameter(Ue),maxFragmentUniforms:L.getParameter(fn),glsl:L.getParameter(er),renderer:L.getParameter(ai),vendor:L.getParameter(En),version:L.getParameter(ui),readFloat:Le,npotTextureCube:xt}};function pr(L){return!!L&&typeof L=="object"&&Array.isArray(L.shape)&&Array.isArray(L.stride)&&typeof L.offset=="number"&&L.shape.length===L.stride.length&&(Array.isArray(L.data)||n(L.data))}var is=function(L){return Object.keys(L).map(function(ee){return L[ee]})},No={shape:El,flatten:Sl};function Hf(L,ee,fe){for(var Be=0;Be<ee;++Be)fe[Be]=L[Be]}function bl(L,ee,fe,Be){for(var nt=0,Le=0;Le<ee;++Le)for(var He=L[Le],yt=0;yt<fe;++yt)Be[nt++]=He[yt]}function jf(L,ee,fe,Be,nt,Le){for(var He=Le,yt=0;yt<ee;++yt)for(var mt=L[yt],Ct=0;Ct<fe;++Ct)for(var xt=mt[Ct],gt=0;gt<Be;++gt)nt[He++]=xt[gt]}function du(L,ee,fe,Be,nt){for(var Le=1,He=fe+1;He<ee.length;++He)Le*=ee[He];var yt=ee[fe];if(ee.length-fe===4){var mt=ee[fe+1],Ct=ee[fe+2],xt=ee[fe+3];for(He=0;He<yt;++He)jf(L[He],mt,Ct,xt,Be,nt),nt+=Le}else for(He=0;He<yt;++He)du(L[He],ee,fe+1,Be,nt),nt+=Le}function Sl(L,ee,fe,Be){var nt=1;if(ee.length)for(var Le=0;Le<ee.length;++Le)nt*=ee[Le];else nt=0;var He=Be||Zn.allocType(fe,nt);switch(ee.length){case 0:break;case 1:Hf(L,ee[0],He);break;case 2:bl(L,ee[0],ee[1],He);break;case 3:jf(L,ee[0],ee[1],ee[2],He,0);break;default:du(L,ee,0,He,0)}return He}function El(L){for(var ee=[],fe=L;fe.length;fe=fe[0])ee.push(fe.length);return ee}var co={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},yd=5120,pu=5122,mc=5124,Wf=5121,xd=5123,gc=5125,vc=5126,_d=5126,Wr={int8:yd,int16:pu,int32:mc,uint8:Wf,uint16:xd,uint32:gc,float:vc,float32:_d},bd=35048,_m=35040,mu={dynamic:bd,stream:_m,static:35044},fo=No.flatten,yc=No.shape,gu=35044,vu=35040,Bo=5121,la=5126,ka=[];ka[5120]=1,ka[5122]=2,ka[5124]=4,ka[5121]=1,ka[5123]=2,ka[5125]=4,ka[5126]=4;function wl(L){return co[Object.prototype.toString.call(L)]|0}function Fa(L,ee){for(var fe=0;fe<ee.length;++fe)L[fe]=ee[fe]}function ho(L,ee,fe,Be,nt,Le,He){for(var yt=0,mt=0;mt<fe;++mt)for(var Ct=0;Ct<Be;++Ct)L[yt++]=ee[nt*mt+Le*Ct+He]}function Sd(L,ee,fe,Be){var nt=0,Le={};function He(Me){this.id=nt++,this.buffer=L.createBuffer(),this.type=Me,this.usage=gu,this.byteLength=0,this.dimension=1,this.dtype=Bo,this.persistentData=null,fe.profile&&(this.stats={size:0})}He.prototype.bind=function(){L.bindBuffer(this.type,this.buffer)},He.prototype.destroy=function(){ht(this)};var yt=[];function mt(Me,je){var wt=yt.pop();return wt||(wt=new He(Me)),wt.bind(),gt(wt,je,vu,0,1,!1),wt}function Ct(Me){yt.push(Me)}function xt(Me,je,wt){Me.byteLength=je.byteLength,L.bufferData(Me.type,je,wt)}function gt(Me,je,wt,Wt,pt,Ft){var Gt;if(Me.usage=wt,Array.isArray(je)){if(Me.dtype=Wt||la,je.length>0){var hn;if(Array.isArray(je[0])){Gt=yc(je);for(var lt=1,it=1;it<Gt.length;++it)lt*=Gt[it];Me.dimension=lt,hn=fo(je,Gt,Me.dtype),xt(Me,hn,wt),Ft?Me.persistentData=hn:Zn.freeType(hn)}else if(typeof je[0]=="number"){Me.dimension=pt;var Zt=Zn.allocType(Me.dtype,je.length);Fa(Zt,je),xt(Me,Zt,wt),Ft?Me.persistentData=Zt:Zn.freeType(Zt)}else n(je[0])?(Me.dimension=je[0].length,Me.dtype=Wt||wl(je[0])||la,hn=fo(je,[je.length,je[0].length],Me.dtype),xt(Me,hn,wt),Ft?Me.persistentData=hn:Zn.freeType(hn)):I.raise("invalid buffer data")}}else if(n(je))Me.dtype=Wt||wl(je),Me.dimension=pt,xt(Me,je,wt),Ft&&(Me.persistentData=new Uint8Array(new Uint8Array(je.buffer)));else if(pr(je)){Gt=je.shape;var Pt=je.stride,St=je.offset,Ut=0,Lt=0,Cn=0,Mn=0;Gt.length===1?(Ut=Gt[0],Lt=1,Cn=Pt[0],Mn=0):Gt.length===2?(Ut=Gt[0],Lt=Gt[1],Cn=Pt[0],Mn=Pt[1]):I.raise("invalid shape"),Me.dtype=Wt||wl(je.data)||la,Me.dimension=Lt;var kt=Zn.allocType(Me.dtype,Ut*Lt);ho(kt,je.data,Ut,Lt,Cn,Mn,St),xt(Me,kt,wt),Ft?Me.persistentData=kt:Zn.freeType(kt)}else je instanceof ArrayBuffer?(Me.dtype=Bo,Me.dimension=pt,xt(Me,je,wt),Ft&&(Me.persistentData=new Uint8Array(new Uint8Array(je)))):I.raise("invalid buffer data")}function ht(Me){ee.bufferCount--,Be(Me);var je=Me.buffer;I(je,"buffer must not be deleted already"),L.deleteBuffer(je),Me.buffer=null,delete Le[Me.id]}function dt(Me,je,wt,Wt){ee.bufferCount++;var pt=new He(je);Le[pt.id]=pt;function Ft(lt){var it=gu,Zt=null,Pt=0,St=0,Ut=1;return Array.isArray(lt)||n(lt)||pr(lt)||lt instanceof ArrayBuffer?Zt=lt:typeof lt=="number"?Pt=lt|0:lt&&(I.type(lt,"object","buffer arguments must be an object, a number or an array"),"data"in lt&&(I(Zt===null||Array.isArray(Zt)||n(Zt)||pr(Zt),"invalid data for buffer"),Zt=lt.data),"usage"in lt&&(I.parameter(lt.usage,mu,"invalid buffer usage"),it=mu[lt.usage]),"type"in lt&&(I.parameter(lt.type,Wr,"invalid buffer type"),St=Wr[lt.type]),"dimension"in lt&&(I.type(lt.dimension,"number","invalid dimension"),Ut=lt.dimension|0),"length"in lt&&(I.nni(Pt,"buffer length must be a nonnegative integer"),Pt=lt.length|0)),pt.bind(),Zt?gt(pt,Zt,it,St,Ut,Wt):(Pt&&L.bufferData(pt.type,Pt,it),pt.dtype=St||Bo,pt.usage=it,pt.dimension=Ut,pt.byteLength=Pt),fe.profile&&(pt.stats.size=pt.byteLength*ka[pt.dtype]),Ft}function Gt(lt,it){I(it+lt.byteLength<=pt.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+lt.byteLength+" starting from offset "+it+" to a buffer of size "+pt.byteLength),L.bufferSubData(pt.type,it,lt)}function hn(lt,it){var Zt=(it||0)|0,Pt;if(pt.bind(),n(lt)||lt instanceof ArrayBuffer)Gt(lt,Zt);else if(Array.isArray(lt)){if(lt.length>0)if(typeof lt[0]=="number"){var St=Zn.allocType(pt.dtype,lt.length);Fa(St,lt),Gt(St,Zt),Zn.freeType(St)}else if(Array.isArray(lt[0])||n(lt[0])){Pt=yc(lt);var Ut=fo(lt,Pt,pt.dtype);Gt(Ut,Zt),Zn.freeType(Ut)}else I.raise("invalid buffer data")}else if(pr(lt)){Pt=lt.shape;var Lt=lt.stride,Cn=0,Mn=0,kt=0,jt=0;Pt.length===1?(Cn=Pt[0],Mn=1,kt=Lt[0],jt=0):Pt.length===2?(Cn=Pt[0],Mn=Pt[1],kt=Lt[0],jt=Lt[1]):I.raise("invalid shape");var yn=Array.isArray(lt.data)?pt.dtype:wl(lt.data),wn=Zn.allocType(yn,Cn*Mn);ho(wn,lt.data,Cn,Mn,kt,jt,lt.offset),Gt(wn,Zt),Zn.freeType(wn)}else I.raise("invalid data for buffer subdata");return Ft}return wt||Ft(Me),Ft._reglType="buffer",Ft._buffer=pt,Ft.subdata=hn,fe.profile&&(Ft.stats=pt.stats),Ft.destroy=function(){ht(pt)},Ft}function bt(){is(Le).forEach(function(Me){Me.buffer=L.createBuffer(),L.bindBuffer(Me.type,Me.buffer),L.bufferData(Me.type,Me.persistentData||Me.byteLength,Me.usage)})}return fe.profile&&(ee.getTotalBufferSize=function(){var Me=0;return Object.keys(Le).forEach(function(je){Me+=Le[je].stats.size}),Me}),{create:dt,createStream:mt,destroyStream:Ct,clear:function(){is(Le).forEach(ht),yt.forEach(ht)},getBuffer:function(Me){return Me&&Me._buffer instanceof He?Me._buffer:null},restore:bt,_initBuffer:gt}}var Al=0,Xf=0,Ps=1,Tv=1,Ar=4,xc=4,Ga={points:Al,point:Xf,lines:Ps,line:Tv,triangles:Ar,triangle:xc,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},bm=0,Ss=1,fs=4,Xr=5120,Es=5121,Yf=5122,_c=5123,Mv=5124,Tl=5125,Ed=34963,lb=35040,Cv=35044;function Rv(L,ee,fe,Be){var nt={},Le=0,He={uint8:Es,uint16:_c};ee.oes_element_index_uint&&(He.uint32=Tl);function yt(bt){this.id=Le++,nt[this.id]=this,this.buffer=bt,this.primType=fs,this.vertCount=0,this.type=0}yt.prototype.bind=function(){this.buffer.bind()};var mt=[];function Ct(bt){var Me=mt.pop();return Me||(Me=new yt(fe.create(null,Ed,!0,!1)._buffer)),gt(Me,bt,lb,-1,-1,0,0),Me}function xt(bt){mt.push(bt)}function gt(bt,Me,je,wt,Wt,pt,Ft){bt.buffer.bind();var Gt;if(Me){var hn=Ft;!Ft&&(!n(Me)||pr(Me)&&!n(Me.data))&&(hn=ee.oes_element_index_uint?Tl:_c),fe._initBuffer(bt.buffer,Me,je,hn,3)}else L.bufferData(Ed,pt,je),bt.buffer.dtype=Gt||Es,bt.buffer.usage=je,bt.buffer.dimension=3,bt.buffer.byteLength=pt;if(Gt=Ft,!Ft){switch(bt.buffer.dtype){case Es:case Xr:Gt=Es;break;case _c:case Yf:Gt=_c;break;case Tl:case Mv:Gt=Tl;break;default:I.raise("unsupported type for element array")}bt.buffer.dtype=Gt}bt.type=Gt,I(Gt!==Tl||!!ee.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var lt=Wt;lt<0&&(lt=bt.buffer.byteLength,Gt===_c?lt>>=1:Gt===Tl&&(lt>>=2)),bt.vertCount=lt;var it=wt;if(wt<0){it=fs;var Zt=bt.buffer.dimension;Zt===1&&(it=bm),Zt===2&&(it=Ss),Zt===3&&(it=fs)}bt.primType=it}function ht(bt){Be.elementsCount--,I(bt.buffer!==null,"must not double destroy elements"),delete nt[bt.id],bt.buffer.destroy(),bt.buffer=null}function dt(bt,Me){var je=fe.create(null,Ed,!0),wt=new yt(je._buffer);Be.elementsCount++;function Wt(pt){if(!pt)je(),wt.primType=fs,wt.vertCount=0,wt.type=Es;else if(typeof pt=="number")je(pt),wt.primType=fs,wt.vertCount=pt|0,wt.type=Es;else{var Ft=null,Gt=Cv,hn=-1,lt=-1,it=0,Zt=0;Array.isArray(pt)||n(pt)||pr(pt)?Ft=pt:(I.type(pt,"object","invalid arguments for elements"),"data"in pt&&(Ft=pt.data,I(Array.isArray(Ft)||n(Ft)||pr(Ft),"invalid data for element buffer")),"usage"in pt&&(I.parameter(pt.usage,mu,"invalid element buffer usage"),Gt=mu[pt.usage]),"primitive"in pt&&(I.parameter(pt.primitive,Ga,"invalid element buffer primitive"),hn=Ga[pt.primitive]),"count"in pt&&(I(typeof pt.count=="number"&&pt.count>=0,"invalid vertex count for elements"),lt=pt.count|0),"type"in pt&&(I.parameter(pt.type,He,"invalid buffer type"),Zt=He[pt.type]),"length"in pt?it=pt.length|0:(it=lt,Zt===_c||Zt===Yf?it*=2:(Zt===Tl||Zt===Mv)&&(it*=4))),gt(wt,Ft,Gt,hn,lt,it,Zt)}return Wt}return Wt(bt),Wt._reglType="elements",Wt._elements=wt,Wt.subdata=function(pt,Ft){return je.subdata(pt,Ft),Wt},Wt.destroy=function(){ht(wt)},Wt}return{create:dt,createStream:Ct,destroyStream:xt,getElements:function(bt){return typeof bt=="function"&&bt._elements instanceof yt?bt._elements:null},clear:function(){is(nt).forEach(ht)}}}var Sm=new Float32Array(1),ub=new Uint32Array(Sm.buffer),Dv=5123;function Ov(L){for(var ee=Zn.allocType(Dv,L.length),fe=0;fe<L.length;++fe)if(isNaN(L[fe]))ee[fe]=65535;else if(L[fe]===1/0)ee[fe]=31744;else if(L[fe]===-1/0)ee[fe]=64512;else{Sm[0]=L[fe];var Be=ub[0],nt=Be>>>31<<15,Le=(Be<<1>>>24)-127,He=Be>>13&1023;if(Le<-24)ee[fe]=nt;else if(Le<-14){var yt=-14-Le;ee[fe]=nt+(He+1024>>yt)}else Le>15?ee[fe]=nt+31744:ee[fe]=nt+(Le+15<<10)+He}return ee}function _i(L){return Array.isArray(L)||n(L)}var Em=function(L){return!(L&L-1)&&!!L},tM=34467,po=3553,ko=34067,Va=34069,Ml=6408,wd=6406,yu=6407,xu=6409,Fo=6410,ws=32854,Zf=32855,Uv=36194,zv=32819,Ad=32820,Iv=33635,wm=34042,Am=6402,Ns=34041,Tm=35904,Td=35906,bc=36193,Mm=33776,Md=33777,Cd=33778,Cm=33779,Rd=35986,qf=35987,mr=34798,cb=35840,fb=35841,Lv=35842,Kf=35843,Cl=36196,Sc=5121,Rm=5123,Rl=5125,As=5126,hb=10242,db=10243,pb=10497,Dd=33071,Pv=33648,Dm=10240,mb=10241,Nv=9728,gb=9729,Om=9984,Ha=9985,Um=9986,zm=9987,nM=33170,Qf=4352,ua=4353,vb=4354,Aa=34046,yb=3317,Dl=37440,Jf=37441,_u=37443,Im=37444,Ec=33984,bu=[Om,Um,Ha,zm],Od=[0,xu,Fo,yu,Ml],Ts={};Ts[xu]=Ts[wd]=Ts[Am]=1,Ts[Ns]=Ts[Fo]=2,Ts[yu]=Ts[Tm]=3,Ts[Ml]=Ts[Td]=4;function Go(L){return"[object "+L+"]"}var Su=Go("HTMLCanvasElement"),Bv=Go("OffscreenCanvas"),kv=Go("CanvasRenderingContext2D"),$f=Go("ImageBitmap"),Fv=Go("HTMLImageElement"),Ud=Go("HTMLVideoElement"),xb=Object.keys(co).concat([Su,Bv,kv,$f,Fv,Ud]),Eu=[];Eu[Sc]=1,Eu[As]=4,Eu[bc]=2,Eu[Rm]=2,Eu[Rl]=4;var Yr=[];Yr[ws]=2,Yr[Zf]=2,Yr[Uv]=2,Yr[Ns]=4,Yr[Mm]=.5,Yr[Md]=.5,Yr[Cd]=1,Yr[Cm]=1,Yr[Rd]=.5,Yr[qf]=1,Yr[mr]=1,Yr[cb]=.5,Yr[fb]=.25,Yr[Lv]=.5,Yr[Kf]=.25,Yr[Cl]=.5;function Lm(L){return Array.isArray(L)&&(L.length===0||typeof L[0]=="number")}function Gv(L){if(!Array.isArray(L))return!1;var ee=L.length;return!(ee===0||!_i(L[0]))}function Ol(L){return Object.prototype.toString.call(L)}function ca(L){return Ol(L)===Su}function Vv(L){return Ol(L)===Bv}function Ks(L){return Ol(L)===kv}function _b(L){return Ol(L)===$f}function Hv(L){return Ol(L)===Fv}function bb(L){return Ol(L)===Ud}function jv(L){if(!L)return!1;var ee=Ol(L);return xb.indexOf(ee)>=0?!0:Lm(L)||Gv(L)||pr(L)}function Vo(L){return co[Object.prototype.toString.call(L)]|0}function Sb(L,ee){var fe=ee.length;switch(L.type){case Sc:case Rm:case Rl:case As:var Be=Zn.allocType(L.type,fe);Be.set(ee),L.data=Be;break;case bc:L.data=Ov(ee);break;default:I.raise("unsupported texture type, must specify a typed array")}}function Pm(L,ee){return Zn.allocType(L.type===bc?As:L.type,ee)}function wc(L,ee){L.type===bc?(L.data=Ov(ee),Zn.freeType(ee)):L.data=ee}function Eb(L,ee,fe,Be,nt,Le){for(var He=L.width,yt=L.height,mt=L.channels,Ct=He*yt*mt,xt=Pm(L,Ct),gt=0,ht=0;ht<yt;++ht)for(var dt=0;dt<He;++dt)for(var bt=0;bt<mt;++bt)xt[gt++]=ee[fe*dt+Be*ht+nt*bt+Le];wc(L,xt)}function zd(L,ee,fe,Be,nt,Le){var He;if(typeof Yr[L]<"u"?He=Yr[L]:He=Ts[L]*Eu[ee],Le&&(He*=6),nt){for(var yt=0,mt=fe;mt>=1;)yt+=He*mt*mt,mt/=2;return yt}else return He*fe*Be}function wb(L,ee,fe,Be,nt,Le,He){var yt={"don't care":Qf,"dont care":Qf,nice:vb,fast:ua},mt={repeat:pb,clamp:Dd,mirror:Pv},Ct={nearest:Nv,linear:gb},xt=i({mipmap:zm,"nearest mipmap nearest":Om,"linear mipmap nearest":Ha,"nearest mipmap linear":Um,"linear mipmap linear":zm},Ct),gt={none:0,browser:Im},ht={uint8:Sc,rgba4:zv,rgb565:Iv,"rgb5 a1":Ad},dt={alpha:wd,luminance:xu,"luminance alpha":Fo,rgb:yu,rgba:Ml,rgba4:ws,"rgb5 a1":Zf,rgb565:Uv},bt={};ee.ext_srgb&&(dt.srgb=Tm,dt.srgba=Td),ee.oes_texture_float&&(ht.float32=ht.float=As),ee.oes_texture_half_float&&(ht.float16=ht["half float"]=bc),ee.webgl_depth_texture&&(i(dt,{depth:Am,"depth stencil":Ns}),i(ht,{uint16:Rm,uint32:Rl,"depth stencil":wm})),ee.webgl_compressed_texture_s3tc&&i(bt,{"rgb s3tc dxt1":Mm,"rgba s3tc dxt1":Md,"rgba s3tc dxt3":Cd,"rgba s3tc dxt5":Cm}),ee.webgl_compressed_texture_atc&&i(bt,{"rgb atc":Rd,"rgba atc explicit alpha":qf,"rgba atc interpolated alpha":mr}),ee.webgl_compressed_texture_pvrtc&&i(bt,{"rgb pvrtc 4bppv1":cb,"rgb pvrtc 2bppv1":fb,"rgba pvrtc 4bppv1":Lv,"rgba pvrtc 2bppv1":Kf}),ee.webgl_compressed_texture_etc1&&(bt["rgb etc1"]=Cl);var Me=Array.prototype.slice.call(L.getParameter(tM));Object.keys(bt).forEach(function(ue){var Ge=bt[ue];Me.indexOf(Ge)>=0&&(dt[ue]=Ge)});var je=Object.keys(dt);fe.textureFormats=je;var wt=[];Object.keys(dt).forEach(function(ue){var Ge=dt[ue];wt[Ge]=ue});var Wt=[];Object.keys(ht).forEach(function(ue){var Ge=ht[ue];Wt[Ge]=ue});var pt=[];Object.keys(Ct).forEach(function(ue){var Ge=Ct[ue];pt[Ge]=ue});var Ft=[];Object.keys(xt).forEach(function(ue){var Ge=xt[ue];Ft[Ge]=ue});var Gt=[];Object.keys(mt).forEach(function(ue){var Ge=mt[ue];Gt[Ge]=ue});var hn=je.reduce(function(ue,Ge){var Oe=dt[Ge];return Oe===xu||Oe===wd||Oe===xu||Oe===Fo||Oe===Am||Oe===Ns||ee.ext_srgb&&(Oe===Tm||Oe===Td)?ue[Oe]=Oe:Oe===Zf||Ge.indexOf("rgba")>=0?ue[Oe]=Ml:ue[Oe]=yu,ue},{});function lt(){this.internalformat=Ml,this.format=Ml,this.type=Sc,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Im,this.width=0,this.height=0,this.channels=0}function it(ue,Ge){ue.internalformat=Ge.internalformat,ue.format=Ge.format,ue.type=Ge.type,ue.compressed=Ge.compressed,ue.premultiplyAlpha=Ge.premultiplyAlpha,ue.flipY=Ge.flipY,ue.unpackAlignment=Ge.unpackAlignment,ue.colorSpace=Ge.colorSpace,ue.width=Ge.width,ue.height=Ge.height,ue.channels=Ge.channels}function Zt(ue,Ge){if(!(typeof Ge!="object"||!Ge)){if("premultiplyAlpha"in Ge&&(I.type(Ge.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),ue.premultiplyAlpha=Ge.premultiplyAlpha),"flipY"in Ge&&(I.type(Ge.flipY,"boolean","invalid texture flip"),ue.flipY=Ge.flipY),"alignment"in Ge&&(I.oneOf(Ge.alignment,[1,2,4,8],"invalid texture unpack alignment"),ue.unpackAlignment=Ge.alignment),"colorSpace"in Ge&&(I.parameter(Ge.colorSpace,gt,"invalid colorSpace"),ue.colorSpace=gt[Ge.colorSpace]),"type"in Ge){var Oe=Ge.type;I(ee.oes_texture_float||!(Oe==="float"||Oe==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),I(ee.oes_texture_half_float||!(Oe==="half float"||Oe==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),I(ee.webgl_depth_texture||!(Oe==="uint16"||Oe==="uint32"||Oe==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),I.parameter(Oe,ht,"invalid texture type"),ue.type=ht[Oe]}var Xt=ue.width,Gn=ue.height,ae=ue.channels,J=!1;"shape"in Ge?(I(Array.isArray(Ge.shape)&&Ge.shape.length>=2,"shape must be an array"),Xt=Ge.shape[0],Gn=Ge.shape[1],Ge.shape.length===3&&(ae=Ge.shape[2],I(ae>0&&ae<=4,"invalid number of channels"),J=!0),I(Xt>=0&&Xt<=fe.maxTextureSize,"invalid width"),I(Gn>=0&&Gn<=fe.maxTextureSize,"invalid height")):("radius"in Ge&&(Xt=Gn=Ge.radius,I(Xt>=0&&Xt<=fe.maxTextureSize,"invalid radius")),"width"in Ge&&(Xt=Ge.width,I(Xt>=0&&Xt<=fe.maxTextureSize,"invalid width")),"height"in Ge&&(Gn=Ge.height,I(Gn>=0&&Gn<=fe.maxTextureSize,"invalid height")),"channels"in Ge&&(ae=Ge.channels,I(ae>0&&ae<=4,"invalid number of channels"),J=!0)),ue.width=Xt|0,ue.height=Gn|0,ue.channels=ae|0;var he=!1;if("format"in Ge){var Ae=Ge.format;I(ee.webgl_depth_texture||!(Ae==="depth"||Ae==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),I.parameter(Ae,dt,"invalid texture format");var Ce=ue.internalformat=dt[Ae];ue.format=hn[Ce],Ae in ht&&("type"in Ge||(ue.type=ht[Ae])),Ae in bt&&(ue.compressed=!0),he=!0}!J&&he?ue.channels=Ts[ue.format]:J&&!he?ue.channels!==Od[ue.format]&&(ue.format=ue.internalformat=Od[ue.channels]):he&&J&&I(ue.channels===Ts[ue.format],"number of channels inconsistent with specified format")}}function Pt(ue){L.pixelStorei(Dl,ue.flipY),L.pixelStorei(Jf,ue.premultiplyAlpha),L.pixelStorei(_u,ue.colorSpace),L.pixelStorei(yb,ue.unpackAlignment)}function St(){lt.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Ut(ue,Ge){var Oe=null;if(jv(Ge)?Oe=Ge:Ge&&(I.type(Ge,"object","invalid pixel data type"),Zt(ue,Ge),"x"in Ge&&(ue.xOffset=Ge.x|0),"y"in Ge&&(ue.yOffset=Ge.y|0),jv(Ge.data)&&(Oe=Ge.data)),I(!ue.compressed||Oe instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Ge.copy){I(!Oe,"can not specify copy and data field for the same texture");var Xt=nt.viewportWidth,Gn=nt.viewportHeight;ue.width=ue.width||Xt-ue.xOffset,ue.height=ue.height||Gn-ue.yOffset,ue.needsCopy=!0,I(ue.xOffset>=0&&ue.xOffset<Xt&&ue.yOffset>=0&&ue.yOffset<Gn&&ue.width>0&&ue.width<=Xt&&ue.height>0&&ue.height<=Gn,"copy texture read out of bounds")}else if(!Oe)ue.width=ue.width||1,ue.height=ue.height||1,ue.channels=ue.channels||4;else if(n(Oe))ue.channels=ue.channels||4,ue.data=Oe,!("type"in Ge)&&ue.type===Sc&&(ue.type=Vo(Oe));else if(Lm(Oe))ue.channels=ue.channels||4,Sb(ue,Oe),ue.alignment=1,ue.needsFree=!0;else if(pr(Oe)){var ae=Oe.data;!Array.isArray(ae)&&ue.type===Sc&&(ue.type=Vo(ae));var J=Oe.shape,he=Oe.stride,Ae,Ce,me,de,Se,le;J.length===3?(me=J[2],le=he[2]):(I(J.length===2,"invalid ndarray pixel data, must be 2 or 3D"),me=1,le=1),Ae=J[0],Ce=J[1],de=he[0],Se=he[1],ue.alignment=1,ue.width=Ae,ue.height=Ce,ue.channels=me,ue.format=ue.internalformat=Od[me],ue.needsFree=!0,Eb(ue,ae,de,Se,le,Oe.offset)}else if(ca(Oe)||Vv(Oe)||Ks(Oe))ca(Oe)||Vv(Oe)?ue.element=Oe:ue.element=Oe.canvas,ue.width=ue.element.width,ue.height=ue.element.height,ue.channels=4;else if(_b(Oe))ue.element=Oe,ue.width=Oe.width,ue.height=Oe.height,ue.channels=4;else if(Hv(Oe))ue.element=Oe,ue.width=Oe.naturalWidth,ue.height=Oe.naturalHeight,ue.channels=4;else if(bb(Oe))ue.element=Oe,ue.width=Oe.videoWidth,ue.height=Oe.videoHeight,ue.channels=4;else if(Gv(Oe)){var ce=ue.width||Oe[0].length,oe=ue.height||Oe.length,Ie=ue.channels;_i(Oe[0][0])?Ie=Ie||Oe[0][0].length:Ie=Ie||1;for(var Re=No.shape(Oe),Qe=1,qe=0;qe<Re.length;++qe)Qe*=Re[qe];var zt=Pm(ue,Qe);No.flatten(Oe,Re,"",zt),wc(ue,zt),ue.alignment=1,ue.width=ce,ue.height=oe,ue.channels=Ie,ue.format=ue.internalformat=Od[Ie],ue.needsFree=!0}ue.type===As?I(fe.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):ue.type===bc&&I(fe.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Lt(ue,Ge,Oe){var Xt=ue.element,Gn=ue.data,ae=ue.internalformat,J=ue.format,he=ue.type,Ae=ue.width,Ce=ue.height;Pt(ue),Xt?L.texImage2D(Ge,Oe,J,J,he,Xt):ue.compressed?L.compressedTexImage2D(Ge,Oe,ae,Ae,Ce,0,Gn):ue.needsCopy?(Be(),L.copyTexImage2D(Ge,Oe,J,ue.xOffset,ue.yOffset,Ae,Ce,0)):L.texImage2D(Ge,Oe,J,Ae,Ce,0,J,he,Gn||null)}function Cn(ue,Ge,Oe,Xt,Gn){var ae=ue.element,J=ue.data,he=ue.internalformat,Ae=ue.format,Ce=ue.type,me=ue.width,de=ue.height;Pt(ue),ae?L.texSubImage2D(Ge,Gn,Oe,Xt,Ae,Ce,ae):ue.compressed?L.compressedTexSubImage2D(Ge,Gn,Oe,Xt,he,me,de,J):ue.needsCopy?(Be(),L.copyTexSubImage2D(Ge,Gn,Oe,Xt,ue.xOffset,ue.yOffset,me,de)):L.texSubImage2D(Ge,Gn,Oe,Xt,me,de,Ae,Ce,J)}var Mn=[];function kt(){return Mn.pop()||new St}function jt(ue){ue.needsFree&&Zn.freeType(ue.data),St.call(ue),Mn.push(ue)}function yn(){lt.call(this),this.genMipmaps=!1,this.mipmapHint=Qf,this.mipmask=0,this.images=Array(16)}function wn(ue,Ge,Oe){var Xt=ue.images[0]=kt();ue.mipmask=1,Xt.width=ue.width=Ge,Xt.height=ue.height=Oe,Xt.channels=ue.channels=4}function In(ue,Ge){var Oe=null;if(jv(Ge))Oe=ue.images[0]=kt(),it(Oe,ue),Ut(Oe,Ge),ue.mipmask=1;else if(Zt(ue,Ge),Array.isArray(Ge.mipmap))for(var Xt=Ge.mipmap,Gn=0;Gn<Xt.length;++Gn)Oe=ue.images[Gn]=kt(),it(Oe,ue),Oe.width>>=Gn,Oe.height>>=Gn,Ut(Oe,Xt[Gn]),ue.mipmask|=1<<Gn;else Oe=ue.images[0]=kt(),it(Oe,ue),Ut(Oe,Ge),ue.mipmask=1;it(ue,ue.images[0]),ue.compressed&&(ue.internalformat===Mm||ue.internalformat===Md||ue.internalformat===Cd||ue.internalformat===Cm)&&I(ue.width%4===0&&ue.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Ui(ue,Ge){for(var Oe=ue.images,Xt=0;Xt<Oe.length;++Xt){if(!Oe[Xt])return;Lt(Oe[Xt],Ge,Xt)}}var Ai=[];function jn(){var ue=Ai.pop()||new yn;lt.call(ue),ue.mipmask=0;for(var Ge=0;Ge<16;++Ge)ue.images[Ge]=null;return ue}function tr(ue){for(var Ge=ue.images,Oe=0;Oe<Ge.length;++Oe)Ge[Oe]&&jt(Ge[Oe]),Ge[Oe]=null;Ai.push(ue)}function Ti(){this.minFilter=Nv,this.magFilter=Nv,this.wrapS=Dd,this.wrapT=Dd,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Qf}function Si(ue,Ge){if("min"in Ge){var Oe=Ge.min;I.parameter(Oe,xt),ue.minFilter=xt[Oe],bu.indexOf(ue.minFilter)>=0&&!("faces"in Ge)&&(ue.genMipmaps=!0)}if("mag"in Ge){var Xt=Ge.mag;I.parameter(Xt,Ct),ue.magFilter=Ct[Xt]}var Gn=ue.wrapS,ae=ue.wrapT;if("wrap"in Ge){var J=Ge.wrap;typeof J=="string"?(I.parameter(J,mt),Gn=ae=mt[J]):Array.isArray(J)&&(I.parameter(J[0],mt),I.parameter(J[1],mt),Gn=mt[J[0]],ae=mt[J[1]])}else{if("wrapS"in Ge){var he=Ge.wrapS;I.parameter(he,mt),Gn=mt[he]}if("wrapT"in Ge){var Ae=Ge.wrapT;I.parameter(Ae,mt),ae=mt[Ae]}}if(ue.wrapS=Gn,ue.wrapT=ae,"anisotropic"in Ge){var Ce=Ge.anisotropic;I(typeof Ce=="number"&&Ce>=1&&Ce<=fe.maxAnisotropic,"aniso samples must be between 1 and "),ue.anisotropic=Ge.anisotropic}if("mipmap"in Ge){var me=!1;switch(typeof Ge.mipmap){case"string":I.parameter(Ge.mipmap,yt,"invalid mipmap hint"),ue.mipmapHint=yt[Ge.mipmap],ue.genMipmaps=!0,me=!0;break;case"boolean":me=ue.genMipmaps=Ge.mipmap;break;case"object":I(Array.isArray(Ge.mipmap),"invalid mipmap type"),ue.genMipmaps=!1,me=!0;break;default:I.raise("invalid mipmap type")}me&&!("min"in Ge)&&(ue.minFilter=Om)}}function zi(ue,Ge){L.texParameteri(Ge,mb,ue.minFilter),L.texParameteri(Ge,Dm,ue.magFilter),L.texParameteri(Ge,hb,ue.wrapS),L.texParameteri(Ge,db,ue.wrapT),ee.ext_texture_filter_anisotropic&&L.texParameteri(Ge,Aa,ue.anisotropic),ue.genMipmaps&&(L.hint(nM,ue.mipmapHint),L.generateMipmap(Ge))}var oi=0,nr={},Rn=fe.maxTextureUnits,Ln=Array(Rn).map(function(){return null});function dn(ue){lt.call(this),this.mipmask=0,this.internalformat=Ml,this.id=oi++,this.refCount=1,this.target=ue,this.texture=L.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ti,He.profile&&(this.stats={size:0})}function Or(ue){L.activeTexture(Ec),L.bindTexture(ue.target,ue.texture)}function ti(){var ue=Ln[0];ue?L.bindTexture(ue.target,ue.texture):L.bindTexture(po,null)}function pn(ue){var Ge=ue.texture;I(Ge,"must not double destroy texture");var Oe=ue.unit,Xt=ue.target;Oe>=0&&(L.activeTexture(Ec+Oe),L.bindTexture(Xt,null),Ln[Oe]=null),L.deleteTexture(Ge),ue.texture=null,ue.params=null,ue.pixels=null,ue.refCount=0,delete nr[ue.id],Le.textureCount--}i(dn.prototype,{bind:function(){var ue=this;ue.bindCount+=1;var Ge=ue.unit;if(Ge<0){for(var Oe=0;Oe<Rn;++Oe){var Xt=Ln[Oe];if(Xt){if(Xt.bindCount>0)continue;Xt.unit=-1}Ln[Oe]=ue,Ge=Oe;break}Ge>=Rn&&I.raise("insufficient number of texture units"),He.profile&&Le.maxTextureUnits<Ge+1&&(Le.maxTextureUnits=Ge+1),ue.unit=Ge,L.activeTexture(Ec+Ge),L.bindTexture(ue.target,ue.texture)}return Ge},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&pn(this)}});function Fn(ue,Ge){var Oe=new dn(po);nr[Oe.id]=Oe,Le.textureCount++;function Xt(J,he){var Ae=Oe.texInfo;Ti.call(Ae);var Ce=jn();return typeof J=="number"?typeof he=="number"?wn(Ce,J|0,he|0):wn(Ce,J|0,J|0):J?(I.type(J,"object","invalid arguments to regl.texture"),Si(Ae,J),In(Ce,J)):wn(Ce,1,1),Ae.genMipmaps&&(Ce.mipmask=(Ce.width<<1)-1),Oe.mipmask=Ce.mipmask,it(Oe,Ce),I.texture2D(Ae,Ce,fe),Oe.internalformat=Ce.internalformat,Xt.width=Ce.width,Xt.height=Ce.height,Or(Oe),Ui(Ce,po),zi(Ae,po),ti(),tr(Ce),He.profile&&(Oe.stats.size=zd(Oe.internalformat,Oe.type,Ce.width,Ce.height,Ae.genMipmaps,!1)),Xt.format=wt[Oe.internalformat],Xt.type=Wt[Oe.type],Xt.mag=pt[Ae.magFilter],Xt.min=Ft[Ae.minFilter],Xt.wrapS=Gt[Ae.wrapS],Xt.wrapT=Gt[Ae.wrapT],Xt}function Gn(J,he,Ae,Ce){I(!!J,"must specify image data");var me=he|0,de=Ae|0,Se=Ce|0,le=kt();return it(le,Oe),le.width=0,le.height=0,Ut(le,J),le.width=le.width||(Oe.width>>Se)-me,le.height=le.height||(Oe.height>>Se)-de,I(Oe.type===le.type&&Oe.format===le.format&&Oe.internalformat===le.internalformat,"incompatible format for texture.subimage"),I(me>=0&&de>=0&&me+le.width<=Oe.width&&de+le.height<=Oe.height,"texture.subimage write out of bounds"),I(Oe.mipmask&1<<Se,"missing mipmap data"),I(le.data||le.element||le.needsCopy,"missing image data"),Or(Oe),Cn(le,po,me,de,Se),ti(),jt(le),Xt}function ae(J,he){var Ae=J|0,Ce=he|0||Ae;if(Ae===Oe.width&&Ce===Oe.height)return Xt;Xt.width=Oe.width=Ae,Xt.height=Oe.height=Ce,Or(Oe);for(var me=0;Oe.mipmask>>me;++me){var de=Ae>>me,Se=Ce>>me;if(!de||!Se)break;L.texImage2D(po,me,Oe.format,de,Se,0,Oe.format,Oe.type,null)}return ti(),He.profile&&(Oe.stats.size=zd(Oe.internalformat,Oe.type,Ae,Ce,!1,!1)),Xt}return Xt(ue,Ge),Xt.subimage=Gn,Xt.resize=ae,Xt._reglType="texture2d",Xt._texture=Oe,He.profile&&(Xt.stats=Oe.stats),Xt.destroy=function(){Oe.decRef()},Xt}function qn(ue,Ge,Oe,Xt,Gn,ae){var J=new dn(ko);nr[J.id]=J,Le.cubeCount++;var he=new Array(6);function Ae(de,Se,le,ce,oe,Ie){var Re,Qe=J.texInfo;for(Ti.call(Qe),Re=0;Re<6;++Re)he[Re]=jn();if(typeof de=="number"||!de){var qe=de|0||1;for(Re=0;Re<6;++Re)wn(he[Re],qe,qe)}else if(typeof de=="object")if(Se)In(he[0],de),In(he[1],Se),In(he[2],le),In(he[3],ce),In(he[4],oe),In(he[5],Ie);else if(Si(Qe,de),Zt(J,de),"faces"in de){var zt=de.faces;for(I(Array.isArray(zt)&&zt.length===6,"cube faces must be a length 6 array"),Re=0;Re<6;++Re)I(typeof zt[Re]=="object"&&!!zt[Re],"invalid input for cube map face"),it(he[Re],J),In(he[Re],zt[Re])}else for(Re=0;Re<6;++Re)In(he[Re],de);else I.raise("invalid arguments to cube map");for(it(J,he[0]),I.optional(function(){fe.npotTextureCube||I(Em(J.width)&&Em(J.height),"your browser does not support non power or two texture dimensions")}),Qe.genMipmaps?J.mipmask=(he[0].width<<1)-1:J.mipmask=he[0].mipmask,I.textureCube(J,Qe,he,fe),J.internalformat=he[0].internalformat,Ae.width=he[0].width,Ae.height=he[0].height,Or(J),Re=0;Re<6;++Re)Ui(he[Re],Va+Re);for(zi(Qe,ko),ti(),He.profile&&(J.stats.size=zd(J.internalformat,J.type,Ae.width,Ae.height,Qe.genMipmaps,!0)),Ae.format=wt[J.internalformat],Ae.type=Wt[J.type],Ae.mag=pt[Qe.magFilter],Ae.min=Ft[Qe.minFilter],Ae.wrapS=Gt[Qe.wrapS],Ae.wrapT=Gt[Qe.wrapT],Re=0;Re<6;++Re)tr(he[Re]);return Ae}function Ce(de,Se,le,ce,oe){I(!!Se,"must specify image data"),I(typeof de=="number"&&de===(de|0)&&de>=0&&de<6,"invalid face");var Ie=le|0,Re=ce|0,Qe=oe|0,qe=kt();return it(qe,J),qe.width=0,qe.height=0,Ut(qe,Se),qe.width=qe.width||(J.width>>Qe)-Ie,qe.height=qe.height||(J.height>>Qe)-Re,I(J.type===qe.type&&J.format===qe.format&&J.internalformat===qe.internalformat,"incompatible format for texture.subimage"),I(Ie>=0&&Re>=0&&Ie+qe.width<=J.width&&Re+qe.height<=J.height,"texture.subimage write out of bounds"),I(J.mipmask&1<<Qe,"missing mipmap data"),I(qe.data||qe.element||qe.needsCopy,"missing image data"),Or(J),Cn(qe,Va+de,Ie,Re,Qe),ti(),jt(qe),Ae}function me(de){var Se=de|0;if(Se!==J.width){Ae.width=J.width=Se,Ae.height=J.height=Se,Or(J);for(var le=0;le<6;++le)for(var ce=0;J.mipmask>>ce;++ce)L.texImage2D(Va+le,ce,J.format,Se>>ce,Se>>ce,0,J.format,J.type,null);return ti(),He.profile&&(J.stats.size=zd(J.internalformat,J.type,Ae.width,Ae.height,!1,!0)),Ae}}return Ae(ue,Ge,Oe,Xt,Gn,ae),Ae.subimage=Ce,Ae.resize=me,Ae._reglType="textureCube",Ae._texture=J,He.profile&&(Ae.stats=J.stats),Ae.destroy=function(){J.decRef()},Ae}function Hi(){for(var ue=0;ue<Rn;++ue)L.activeTexture(Ec+ue),L.bindTexture(po,null),Ln[ue]=null;is(nr).forEach(pn),Le.cubeCount=0,Le.textureCount=0}He.profile&&(Le.getTotalTextureSize=function(){var ue=0;return Object.keys(nr).forEach(function(Ge){ue+=nr[Ge].stats.size}),ue});function jo(){for(var ue=0;ue<Rn;++ue){var Ge=Ln[ue];Ge&&(Ge.bindCount=0,Ge.unit=-1,Ln[ue]=null)}is(nr).forEach(function(Oe){Oe.texture=L.createTexture(),L.bindTexture(Oe.target,Oe.texture);for(var Xt=0;Xt<32;++Xt)if(Oe.mipmask&1<<Xt)if(Oe.target===po)L.texImage2D(po,Xt,Oe.internalformat,Oe.width>>Xt,Oe.height>>Xt,0,Oe.internalformat,Oe.type,null);else for(var Gn=0;Gn<6;++Gn)L.texImage2D(Va+Gn,Xt,Oe.internalformat,Oe.width>>Xt,Oe.height>>Xt,0,Oe.internalformat,Oe.type,null);zi(Oe.texInfo,Oe.target)})}function Bl(){for(var ue=0;ue<Rn;++ue){var Ge=Ln[ue];Ge&&(Ge.bindCount=0,Ge.unit=-1,Ln[ue]=null),L.activeTexture(Ec+ue),L.bindTexture(po,null),L.bindTexture(ko,null)}}return{create2D:Fn,createCube:qn,clear:Hi,getTexture:function(ue){return null},restore:jo,refresh:Bl}}var Ul=36161,eh=32854,Nm=32855,Ab=36194,Tb=33189,Mb=36168,Wv=34041,Xv=35907,Ac=34836,Id=34842,Yv=34843,ja=[];ja[eh]=2,ja[Nm]=2,ja[Ab]=2,ja[Tb]=2,ja[Mb]=1,ja[Wv]=4,ja[Xv]=4,ja[Ac]=16,ja[Id]=8,ja[Yv]=6;function Cb(L,ee,fe){return ja[L]*ee*fe}var Rb=function(L,ee,fe,Be,nt){var Le={rgba4:eh,rgb565:Ab,"rgb5 a1":Nm,depth:Tb,stencil:Mb,"depth stencil":Wv};ee.ext_srgb&&(Le.srgba=Xv),ee.ext_color_buffer_half_float&&(Le.rgba16f=Id,Le.rgb16f=Yv),ee.webgl_color_buffer_float&&(Le.rgba32f=Ac);var He=[];Object.keys(Le).forEach(function(dt){var bt=Le[dt];He[bt]=dt});var yt=0,mt={};function Ct(dt){this.id=yt++,this.refCount=1,this.renderbuffer=dt,this.format=eh,this.width=0,this.height=0,nt.profile&&(this.stats={size:0})}Ct.prototype.decRef=function(){--this.refCount<=0&&xt(this)};function xt(dt){var bt=dt.renderbuffer;I(bt,"must not double destroy renderbuffer"),L.bindRenderbuffer(Ul,null),L.deleteRenderbuffer(bt),dt.renderbuffer=null,dt.refCount=0,delete mt[dt.id],Be.renderbufferCount--}function gt(dt,bt){var Me=new Ct(L.createRenderbuffer());mt[Me.id]=Me,Be.renderbufferCount++;function je(Wt,pt){var Ft=0,Gt=0,hn=eh;if(typeof Wt=="object"&&Wt){var lt=Wt;if("shape"in lt){var it=lt.shape;I(Array.isArray(it)&&it.length>=2,"invalid renderbuffer shape"),Ft=it[0]|0,Gt=it[1]|0}else"radius"in lt&&(Ft=Gt=lt.radius|0),"width"in lt&&(Ft=lt.width|0),"height"in lt&&(Gt=lt.height|0);"format"in lt&&(I.parameter(lt.format,Le,"invalid renderbuffer format"),hn=Le[lt.format])}else typeof Wt=="number"?(Ft=Wt|0,typeof pt=="number"?Gt=pt|0:Gt=Ft):Wt?I.raise("invalid arguments to renderbuffer constructor"):Ft=Gt=1;if(I(Ft>0&&Gt>0&&Ft<=fe.maxRenderbufferSize&&Gt<=fe.maxRenderbufferSize,"invalid renderbuffer size"),!(Ft===Me.width&&Gt===Me.height&&hn===Me.format))return je.width=Me.width=Ft,je.height=Me.height=Gt,Me.format=hn,L.bindRenderbuffer(Ul,Me.renderbuffer),L.renderbufferStorage(Ul,hn,Ft,Gt),I(L.getError()===0,"invalid render buffer format"),nt.profile&&(Me.stats.size=Cb(Me.format,Me.width,Me.height)),je.format=He[Me.format],je}function wt(Wt,pt){var Ft=Wt|0,Gt=pt|0||Ft;return Ft===Me.width&&Gt===Me.height||(I(Ft>0&&Gt>0&&Ft<=fe.maxRenderbufferSize&&Gt<=fe.maxRenderbufferSize,"invalid renderbuffer size"),je.width=Me.width=Ft,je.height=Me.height=Gt,L.bindRenderbuffer(Ul,Me.renderbuffer),L.renderbufferStorage(Ul,Me.format,Ft,Gt),I(L.getError()===0,"invalid render buffer format"),nt.profile&&(Me.stats.size=Cb(Me.format,Me.width,Me.height))),je}return je(dt,bt),je.resize=wt,je._reglType="renderbuffer",je._renderbuffer=Me,nt.profile&&(je.stats=Me.stats),je.destroy=function(){Me.decRef()},je}nt.profile&&(Be.getTotalRenderbufferSize=function(){var dt=0;return Object.keys(mt).forEach(function(bt){dt+=mt[bt].stats.size}),dt});function ht(){is(mt).forEach(function(dt){dt.renderbuffer=L.createRenderbuffer(),L.bindRenderbuffer(Ul,dt.renderbuffer),L.renderbufferStorage(Ul,dt.format,dt.width,dt.height)}),L.bindRenderbuffer(Ul,null)}return{create:gt,clear:function(){is(mt).forEach(xt)},restore:ht}},Qs=36160,Bm=36161,gi=3553,th=34069,Db=36064,Zv=36096,Ob=36128,Ub=33306,zb=36053,iM=36054,qv=36055,wu=36057,Ib=36061,km=36193,Tc=5121,Lb=5126,Fm=6407,Gm=6408,rM=6402,Pb=[Fm,Gm],Vm=[];Vm[Gm]=4,Vm[Fm]=3;var Ld=[];Ld[Tc]=1,Ld[Lb]=4,Ld[km]=2;var Nb=32854,Bb=32855,Kv=36194,pi=33189,sM=36168,fa=34041,Qv=35907,aM=34836,Hm=34842,nh=34843,ih=[Nb,Bb,Kv,Qv,Hm,nh,aM],Mc={};Mc[zb]="complete",Mc[iM]="incomplete attachment",Mc[wu]="incomplete dimensions",Mc[qv]="incomplete, missing attachment",Mc[Ib]="unsupported";function Jv(L,ee,fe,Be,nt,Le){var He={cur:null,next:null,dirty:!1,setFBO:null},yt=["rgba"],mt=["rgba4","rgb565","rgb5 a1"];ee.ext_srgb&&mt.push("srgba"),ee.ext_color_buffer_half_float&&mt.push("rgba16f","rgb16f"),ee.webgl_color_buffer_float&&mt.push("rgba32f");var Ct=["uint8"];ee.oes_texture_half_float&&Ct.push("half float","float16"),ee.oes_texture_float&&Ct.push("float","float32");function xt(St,Ut,Lt){this.target=St,this.texture=Ut,this.renderbuffer=Lt;var Cn=0,Mn=0;Ut?(Cn=Ut.width,Mn=Ut.height):Lt&&(Cn=Lt.width,Mn=Lt.height),this.width=Cn,this.height=Mn}function gt(St){St&&(St.texture&&St.texture._texture.decRef(),St.renderbuffer&&St.renderbuffer._renderbuffer.decRef())}function ht(St,Ut,Lt){if(St)if(St.texture){var Cn=St.texture._texture,Mn=Math.max(1,Cn.width),kt=Math.max(1,Cn.height);I(Mn===Ut&&kt===Lt,"inconsistent width/height for supplied texture"),Cn.refCount+=1}else{var jt=St.renderbuffer._renderbuffer;I(jt.width===Ut&&jt.height===Lt,"inconsistent width/height for renderbuffer"),jt.refCount+=1}}function dt(St,Ut){Ut&&(Ut.texture?L.framebufferTexture2D(Qs,St,Ut.target,Ut.texture._texture.texture,0):L.framebufferRenderbuffer(Qs,St,Bm,Ut.renderbuffer._renderbuffer.renderbuffer))}function bt(St){var Ut=gi,Lt=null,Cn=null,Mn=St;typeof St=="object"&&(Mn=St.data,"target"in St&&(Ut=St.target|0)),I.type(Mn,"function","invalid attachment data");var kt=Mn._reglType;return kt==="texture2d"?(Lt=Mn,I(Ut===gi)):kt==="textureCube"?(Lt=Mn,I(Ut>=th&&Ut<th+6,"invalid cube map target")):kt==="renderbuffer"?(Cn=Mn,Ut=Bm):I.raise("invalid regl object for attachment"),new xt(Ut,Lt,Cn)}function Me(St,Ut,Lt,Cn,Mn){if(Lt){var kt=Be.create2D({width:St,height:Ut,format:Cn,type:Mn});return kt._texture.refCount=0,new xt(gi,kt,null)}else{var jt=nt.create({width:St,height:Ut,format:Cn});return jt._renderbuffer.refCount=0,new xt(Bm,null,jt)}}function je(St){return St&&(St.texture||St.renderbuffer)}function wt(St,Ut,Lt){St&&(St.texture?St.texture.resize(Ut,Lt):St.renderbuffer&&St.renderbuffer.resize(Ut,Lt),St.width=Ut,St.height=Lt)}var Wt=0,pt={};function Ft(){this.id=Wt++,pt[this.id]=this,this.framebuffer=L.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Gt(St){St.colorAttachments.forEach(gt),gt(St.depthAttachment),gt(St.stencilAttachment),gt(St.depthStencilAttachment)}function hn(St){var Ut=St.framebuffer;I(Ut,"must not double destroy framebuffer"),L.deleteFramebuffer(Ut),St.framebuffer=null,Le.framebufferCount--,delete pt[St.id]}function lt(St){var Ut;L.bindFramebuffer(Qs,St.framebuffer);var Lt=St.colorAttachments;for(Ut=0;Ut<Lt.length;++Ut)dt(Db+Ut,Lt[Ut]);for(Ut=Lt.length;Ut<fe.maxColorAttachments;++Ut)L.framebufferTexture2D(Qs,Db+Ut,gi,null,0);L.framebufferTexture2D(Qs,Ub,gi,null,0),L.framebufferTexture2D(Qs,Zv,gi,null,0),L.framebufferTexture2D(Qs,Ob,gi,null,0),dt(Zv,St.depthAttachment),dt(Ob,St.stencilAttachment),dt(Ub,St.depthStencilAttachment);var Cn=L.checkFramebufferStatus(Qs);!L.isContextLost()&&Cn!==zb&&I.raise("framebuffer configuration not supported, status = "+Mc[Cn]),L.bindFramebuffer(Qs,He.next?He.next.framebuffer:null),He.cur=He.next,L.getError()}function it(St,Ut){var Lt=new Ft;Le.framebufferCount++;function Cn(kt,jt){var yn;I(He.next!==Lt,"can not update framebuffer which is currently in use");var wn=0,In=0,Ui=!0,Ai=!0,jn=null,tr=!0,Ti="rgba",Si="uint8",zi=1,oi=null,nr=null,Rn=null,Ln=!1;if(typeof kt=="number")wn=kt|0,In=jt|0||wn;else if(!kt)wn=In=1;else{I.type(kt,"object","invalid arguments for framebuffer");var dn=kt;if("shape"in dn){var Or=dn.shape;I(Array.isArray(Or)&&Or.length>=2,"invalid shape for framebuffer"),wn=Or[0],In=Or[1]}else"radius"in dn&&(wn=In=dn.radius),"width"in dn&&(wn=dn.width),"height"in dn&&(In=dn.height);("color"in dn||"colors"in dn)&&(jn=dn.color||dn.colors,Array.isArray(jn)&&I(jn.length===1||ee.webgl_draw_buffers,"multiple render targets not supported")),jn||("colorCount"in dn&&(zi=dn.colorCount|0,I(zi>0,"invalid color buffer count")),"colorTexture"in dn&&(tr=!!dn.colorTexture,Ti="rgba4"),"colorType"in dn&&(Si=dn.colorType,tr?(I(ee.oes_texture_float||!(Si==="float"||Si==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),I(ee.oes_texture_half_float||!(Si==="half float"||Si==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Si==="half float"||Si==="float16"?(I(ee.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ti="rgba16f"):(Si==="float"||Si==="float32")&&(I(ee.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ti="rgba32f"),I.oneOf(Si,Ct,"invalid color type")),"colorFormat"in dn&&(Ti=dn.colorFormat,yt.indexOf(Ti)>=0?tr=!0:mt.indexOf(Ti)>=0?tr=!1:I.optional(function(){tr?I.oneOf(dn.colorFormat,yt,"invalid color format for texture"):I.oneOf(dn.colorFormat,mt,"invalid color format for renderbuffer")}))),("depthTexture"in dn||"depthStencilTexture"in dn)&&(Ln=!!(dn.depthTexture||dn.depthStencilTexture),I(!Ln||ee.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in dn&&(typeof dn.depth=="boolean"?Ui=dn.depth:(oi=dn.depth,Ai=!1)),"stencil"in dn&&(typeof dn.stencil=="boolean"?Ai=dn.stencil:(nr=dn.stencil,Ui=!1)),"depthStencil"in dn&&(typeof dn.depthStencil=="boolean"?Ui=Ai=dn.depthStencil:(Rn=dn.depthStencil,Ui=!1,Ai=!1))}var ti=null,pn=null,Fn=null,qn=null;if(Array.isArray(jn))ti=jn.map(bt);else if(jn)ti=[bt(jn)];else for(ti=new Array(zi),yn=0;yn<zi;++yn)ti[yn]=Me(wn,In,tr,Ti,Si);I(ee.webgl_draw_buffers||ti.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),I(ti.length<=fe.maxColorAttachments,"too many color attachments, not supported"),wn=wn||ti[0].width,In=In||ti[0].height,oi?pn=bt(oi):Ui&&!Ai&&(pn=Me(wn,In,Ln,"depth","uint32")),nr?Fn=bt(nr):Ai&&!Ui&&(Fn=Me(wn,In,!1,"stencil","uint8")),Rn?qn=bt(Rn):!oi&&!nr&&Ai&&Ui&&(qn=Me(wn,In,Ln,"depth stencil","depth stencil")),I(!!oi+!!nr+!!Rn<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Hi=null;for(yn=0;yn<ti.length;++yn)if(ht(ti[yn],wn,In),I(!ti[yn]||ti[yn].texture&&Pb.indexOf(ti[yn].texture._texture.format)>=0||ti[yn].renderbuffer&&ih.indexOf(ti[yn].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+yn+" is invalid"),ti[yn]&&ti[yn].texture){var jo=Vm[ti[yn].texture._texture.format]*Ld[ti[yn].texture._texture.type];Hi===null?Hi=jo:I(Hi===jo,"all color attachments much have the same number of bits per pixel.")}return ht(pn,wn,In),I(!pn||pn.texture&&pn.texture._texture.format===rM||pn.renderbuffer&&pn.renderbuffer._renderbuffer.format===pi,"invalid depth attachment for framebuffer object"),ht(Fn,wn,In),I(!Fn||Fn.renderbuffer&&Fn.renderbuffer._renderbuffer.format===sM,"invalid stencil attachment for framebuffer object"),ht(qn,wn,In),I(!qn||qn.texture&&qn.texture._texture.format===fa||qn.renderbuffer&&qn.renderbuffer._renderbuffer.format===fa,"invalid depth-stencil attachment for framebuffer object"),Gt(Lt),Lt.width=wn,Lt.height=In,Lt.colorAttachments=ti,Lt.depthAttachment=pn,Lt.stencilAttachment=Fn,Lt.depthStencilAttachment=qn,Cn.color=ti.map(je),Cn.depth=je(pn),Cn.stencil=je(Fn),Cn.depthStencil=je(qn),Cn.width=Lt.width,Cn.height=Lt.height,lt(Lt),Cn}function Mn(kt,jt){I(He.next!==Lt,"can not resize a framebuffer which is currently in use");var yn=Math.max(kt|0,1),wn=Math.max(jt|0||yn,1);if(yn===Lt.width&&wn===Lt.height)return Cn;for(var In=Lt.colorAttachments,Ui=0;Ui<In.length;++Ui)wt(In[Ui],yn,wn);return wt(Lt.depthAttachment,yn,wn),wt(Lt.stencilAttachment,yn,wn),wt(Lt.depthStencilAttachment,yn,wn),Lt.width=Cn.width=yn,Lt.height=Cn.height=wn,lt(Lt),Cn}return Cn(St,Ut),i(Cn,{resize:Mn,_reglType:"framebuffer",_framebuffer:Lt,destroy:function(){hn(Lt),Gt(Lt)},use:function(kt){He.setFBO({framebuffer:Cn},kt)}})}function Zt(St){var Ut=Array(6);function Lt(Mn){var kt;I(Ut.indexOf(He.next)<0,"can not update framebuffer which is currently in use");var jt={color:null},yn=0,wn=null,In="rgba",Ui="uint8",Ai=1;if(typeof Mn=="number")yn=Mn|0;else if(!Mn)yn=1;else{I.type(Mn,"object","invalid arguments for framebuffer");var jn=Mn;if("shape"in jn){var tr=jn.shape;I(Array.isArray(tr)&&tr.length>=2,"invalid shape for framebuffer"),I(tr[0]===tr[1],"cube framebuffer must be square"),yn=tr[0]}else"radius"in jn&&(yn=jn.radius|0),"width"in jn?(yn=jn.width|0,"height"in jn&&I(jn.height===yn,"must be square")):"height"in jn&&(yn=jn.height|0);("color"in jn||"colors"in jn)&&(wn=jn.color||jn.colors,Array.isArray(wn)&&I(wn.length===1||ee.webgl_draw_buffers,"multiple render targets not supported")),wn||("colorCount"in jn&&(Ai=jn.colorCount|0,I(Ai>0,"invalid color buffer count")),"colorType"in jn&&(I.oneOf(jn.colorType,Ct,"invalid color type"),Ui=jn.colorType),"colorFormat"in jn&&(In=jn.colorFormat,I.oneOf(jn.colorFormat,yt,"invalid color format for texture"))),"depth"in jn&&(jt.depth=jn.depth),"stencil"in jn&&(jt.stencil=jn.stencil),"depthStencil"in jn&&(jt.depthStencil=jn.depthStencil)}var Ti;if(wn)if(Array.isArray(wn))for(Ti=[],kt=0;kt<wn.length;++kt)Ti[kt]=wn[kt];else Ti=[wn];else{Ti=Array(Ai);var Si={radius:yn,format:In,type:Ui};for(kt=0;kt<Ai;++kt)Ti[kt]=Be.createCube(Si)}for(jt.color=Array(Ti.length),kt=0;kt<Ti.length;++kt){var zi=Ti[kt];I(typeof zi=="function"&&zi._reglType==="textureCube","invalid cube map"),yn=yn||zi.width,I(zi.width===yn&&zi.height===yn,"invalid cube map shape"),jt.color[kt]={target:th,data:Ti[kt]}}for(kt=0;kt<6;++kt){for(var oi=0;oi<Ti.length;++oi)jt.color[oi].target=th+kt;kt>0&&(jt.depth=Ut[0].depth,jt.stencil=Ut[0].stencil,jt.depthStencil=Ut[0].depthStencil),Ut[kt]?Ut[kt](jt):Ut[kt]=it(jt)}return i(Lt,{width:yn,height:yn,color:Ti})}function Cn(Mn){var kt,jt=Mn|0;if(I(jt>0&&jt<=fe.maxCubeMapSize,"invalid radius for cube fbo"),jt===Lt.width)return Lt;var yn=Lt.color;for(kt=0;kt<yn.length;++kt)yn[kt].resize(jt);for(kt=0;kt<6;++kt)Ut[kt].resize(jt);return Lt.width=Lt.height=jt,Lt}return Lt(St),i(Lt,{faces:Ut,resize:Cn,_reglType:"framebufferCube",destroy:function(){Ut.forEach(function(Mn){Mn.destroy()})}})}function Pt(){He.cur=null,He.next=null,He.dirty=!0,is(pt).forEach(function(St){St.framebuffer=L.createFramebuffer(),lt(St)})}return i(He,{getFramebuffer:function(St){if(typeof St=="function"&&St._reglType==="framebuffer"){var Ut=St._framebuffer;if(Ut instanceof Ft)return Ut}return null},create:it,createCube:Zt,clear:function(){is(pt).forEach(hn)},restore:Pt})}var oM=5126,$v=34962,mo=34963,jm=["attributes","elements","offset","count","primitive","instances"];function Pd(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=oM,this.offset=0,this.stride=0,this.divisor=0}function ey(L,ee,fe,Be,nt,Le,He){for(var yt=fe.maxAttributes,mt=new Array(yt),Ct=0;Ct<yt;++Ct)mt[Ct]=new Pd;var xt=0,gt={},ht={Record:Pd,scope:{},state:mt,currentVAO:null,targetVAO:null,restore:bt()?Gt:function(){},createVAO:hn,getVAO:je,destroyBuffer:dt,setVAO:bt()?wt:Wt,clear:bt()?pt:function(){}};function dt(lt){for(var it=0;it<mt.length;++it){var Zt=mt[it];Zt.buffer===lt&&(L.disableVertexAttribArray(it),Zt.buffer=null)}}function bt(){return ee.oes_vertex_array_object}function Me(){return ee.angle_instanced_arrays}function je(lt){return typeof lt=="function"&&lt._vao?lt._vao:null}function wt(lt){if(lt!==ht.currentVAO){var it=bt();lt?it.bindVertexArrayOES(lt.vao):it.bindVertexArrayOES(null),ht.currentVAO=lt}}function Wt(lt){if(lt!==ht.currentVAO){if(lt)lt.bindAttrs();else{for(var it=Me(),Zt=0;Zt<mt.length;++Zt){var Pt=mt[Zt];Pt.buffer?(L.enableVertexAttribArray(Zt),Pt.buffer.bind(),L.vertexAttribPointer(Zt,Pt.size,Pt.type,Pt.normalized,Pt.stride,Pt.offfset),it&&Pt.divisor&&it.vertexAttribDivisorANGLE(Zt,Pt.divisor)):(L.disableVertexAttribArray(Zt),L.vertexAttrib4f(Zt,Pt.x,Pt.y,Pt.z,Pt.w))}He.elements?L.bindBuffer(mo,He.elements.buffer.buffer):L.bindBuffer(mo,null)}ht.currentVAO=lt}}function pt(){is(gt).forEach(function(lt){lt.destroy()})}function Ft(){this.id=++xt,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var lt=bt();lt?this.vao=lt.createVertexArrayOES():this.vao=null,gt[this.id]=this,this.buffers=[]}Ft.prototype.bindAttrs=function(){for(var lt=Me(),it=this.attributes,Zt=0;Zt<it.length;++Zt){var Pt=it[Zt];Pt.buffer?(L.enableVertexAttribArray(Zt),L.bindBuffer($v,Pt.buffer.buffer),L.vertexAttribPointer(Zt,Pt.size,Pt.type,Pt.normalized,Pt.stride,Pt.offset),lt&&Pt.divisor&&lt.vertexAttribDivisorANGLE(Zt,Pt.divisor)):(L.disableVertexAttribArray(Zt),L.vertexAttrib4f(Zt,Pt.x,Pt.y,Pt.z,Pt.w))}for(var St=it.length;St<yt;++St)L.disableVertexAttribArray(St);var Ut=Le.getElements(this.elements);Ut?L.bindBuffer(mo,Ut.buffer.buffer):L.bindBuffer(mo,null)},Ft.prototype.refresh=function(){var lt=bt();lt&&(lt.bindVertexArrayOES(this.vao),this.bindAttrs(),ht.currentVAO=null,lt.bindVertexArrayOES(null))},Ft.prototype.destroy=function(){if(this.vao){var lt=bt();this===ht.currentVAO&&(ht.currentVAO=null,lt.bindVertexArrayOES(null)),lt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),gt[this.id]&&(delete gt[this.id],Be.vaoCount-=1)};function Gt(){var lt=bt();lt&&is(gt).forEach(function(it){it.refresh()})}function hn(lt){var it=new Ft;Be.vaoCount+=1;function Zt(Pt){var St;if(Array.isArray(Pt))St=Pt,it.elements&&it.ownsElements&&it.elements.destroy(),it.elements=null,it.ownsElements=!1,it.offset=0,it.count=0,it.instances=-1,it.primitive=4;else{if(I(typeof Pt=="object","invalid arguments for create vao"),I("attributes"in Pt,"must specify attributes for vao"),Pt.elements){var Ut=Pt.elements;it.ownsElements?typeof Ut=="function"&&Ut._reglType==="elements"?(it.elements.destroy(),it.ownsElements=!1):(it.elements(Ut),it.ownsElements=!1):Le.getElements(Pt.elements)?(it.elements=Pt.elements,it.ownsElements=!1):(it.elements=Le.create(Pt.elements),it.ownsElements=!0)}else it.elements=null,it.ownsElements=!1;St=Pt.attributes,it.offset=0,it.count=-1,it.instances=-1,it.primitive=4,it.elements&&(it.count=it.elements._elements.vertCount,it.primitive=it.elements._elements.primType),"offset"in Pt&&(it.offset=Pt.offset|0),"count"in Pt&&(it.count=Pt.count|0),"instances"in Pt&&(it.instances=Pt.instances|0),"primitive"in Pt&&(I(Pt.primitive in Ga,"bad primitive type: "+Pt.primitive),it.primitive=Ga[Pt.primitive]),I.optional(()=>{for(var Ui=Object.keys(Pt),Ai=0;Ai<Ui.length;++Ai)I(jm.indexOf(Ui[Ai])>=0,'invalid option for vao: "'+Ui[Ai]+'" valid options are '+jm)}),I(Array.isArray(St),"attributes must be an array")}I(St.length<yt,"too many attributes"),I(St.length>0,"must specify at least one attribute");var Lt={},Cn=it.attributes;Cn.length=St.length;for(var Mn=0;Mn<St.length;++Mn){var kt=St[Mn],jt=Cn[Mn]=new Pd,yn=kt.data||kt;if(Array.isArray(yn)||n(yn)||pr(yn)){var wn;it.buffers[Mn]&&(wn=it.buffers[Mn],n(yn)&&wn._buffer.byteLength>=yn.byteLength?wn.subdata(yn):(wn.destroy(),it.buffers[Mn]=null)),it.buffers[Mn]||(wn=it.buffers[Mn]=nt.create(kt,$v,!1,!0)),jt.buffer=nt.getBuffer(wn),jt.size=jt.buffer.dimension|0,jt.normalized=!1,jt.type=jt.buffer.dtype,jt.offset=0,jt.stride=0,jt.divisor=0,jt.state=1,Lt[Mn]=1}else nt.getBuffer(kt)?(jt.buffer=nt.getBuffer(kt),jt.size=jt.buffer.dimension|0,jt.normalized=!1,jt.type=jt.buffer.dtype,jt.offset=0,jt.stride=0,jt.divisor=0,jt.state=1):nt.getBuffer(kt.buffer)?(jt.buffer=nt.getBuffer(kt.buffer),jt.size=(+kt.size||jt.buffer.dimension)|0,jt.normalized=!!kt.normalized||!1,"type"in kt?(I.parameter(kt.type,Wr,"invalid buffer type"),jt.type=Wr[kt.type]):jt.type=jt.buffer.dtype,jt.offset=(kt.offset||0)|0,jt.stride=(kt.stride||0)|0,jt.divisor=(kt.divisor||0)|0,jt.state=1,I(jt.size>=1&&jt.size<=4,"size must be between 1 and 4"),I(jt.offset>=0,"invalid offset"),I(jt.stride>=0&&jt.stride<=255,"stride must be between 0 and 255"),I(jt.divisor>=0,"divisor must be positive"),I(!jt.divisor||!!ee.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in kt?(I(Mn>0,"first attribute must not be a constant"),jt.x=+kt.x||0,jt.y=+kt.y||0,jt.z=+kt.z||0,jt.w=+kt.w||0,jt.state=2):I(!1,"invalid attribute spec for location "+Mn)}for(var In=0;In<it.buffers.length;++In)!Lt[In]&&it.buffers[In]&&(it.buffers[In].destroy(),it.buffers[In]=null);return it.refresh(),Zt}return Zt.destroy=function(){for(var Pt=0;Pt<it.buffers.length;++Pt)it.buffers[Pt]&&it.buffers[Pt].destroy();it.buffers.length=0,it.ownsElements&&(it.elements.destroy(),it.elements=null,it.ownsElements=!1),it.destroy()},Zt._vao=it,Zt._reglType="vao",Zt(lt)}return ht}var Wm=35632,Au=35633,kb=35718,lM=35721;function Fb(L,ee,fe,Be){var nt={},Le={};function He(Me,je,wt,Wt){this.name=Me,this.id=je,this.location=wt,this.info=Wt}function yt(Me,je){for(var wt=0;wt<Me.length;++wt)if(Me[wt].id===je.id){Me[wt].location=je.location;return}Me.push(je)}function mt(Me,je,wt){var Wt=Me===Wm?nt:Le,pt=Wt[je];if(!pt){var Ft=ee.str(je);pt=L.createShader(Me),L.shaderSource(pt,Ft),L.compileShader(pt),I.shaderError(L,pt,Ft,Me,wt),Wt[je]=pt}return pt}var Ct={},xt=[],gt=0;function ht(Me,je){this.id=gt++,this.fragId=Me,this.vertId=je,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Be.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function dt(Me,je,wt){var Wt,pt,Ft=mt(Wm,Me.fragId),Gt=mt(Au,Me.vertId),hn=Me.program=L.createProgram();if(L.attachShader(hn,Ft),L.attachShader(hn,Gt),wt)for(Wt=0;Wt<wt.length;++Wt){var lt=wt[Wt];L.bindAttribLocation(hn,lt[0],lt[1])}L.linkProgram(hn),I.linkError(L,hn,ee.str(Me.fragId),ee.str(Me.vertId),je);var it=L.getProgramParameter(hn,kb);Be.profile&&(Me.stats.uniformsCount=it);var Zt=Me.uniforms;for(Wt=0;Wt<it;++Wt)if(pt=L.getActiveUniform(hn,Wt),pt){if(pt.size>1)for(var Pt=0;Pt<pt.size;++Pt){var St=pt.name.replace("[0]","["+Pt+"]");yt(Zt,new He(St,ee.id(St),L.getUniformLocation(hn,St),pt))}var Ut=pt.name;pt.size>1&&(Ut=Ut.replace("[0]","")),yt(Zt,new He(Ut,ee.id(Ut),L.getUniformLocation(hn,Ut),pt))}var Lt=L.getProgramParameter(hn,lM);Be.profile&&(Me.stats.attributesCount=Lt);var Cn=Me.attributes;for(Wt=0;Wt<Lt;++Wt)pt=L.getActiveAttrib(hn,Wt),pt&&yt(Cn,new He(pt.name,ee.id(pt.name),L.getAttribLocation(hn,pt.name),pt))}Be.profile&&(fe.getMaxUniformsCount=function(){var Me=0;return xt.forEach(function(je){je.stats.uniformsCount>Me&&(Me=je.stats.uniformsCount)}),Me},fe.getMaxAttributesCount=function(){var Me=0;return xt.forEach(function(je){je.stats.attributesCount>Me&&(Me=je.stats.attributesCount)}),Me});function bt(){nt={},Le={};for(var Me=0;Me<xt.length;++Me)dt(xt[Me],null,xt[Me].attributes.map(function(je){return[je.location,je.name]}))}return{clear:function(){var Me=L.deleteShader.bind(L);is(nt).forEach(Me),nt={},is(Le).forEach(Me),Le={},xt.forEach(function(je){L.deleteProgram(je.program)}),xt.length=0,Ct={},fe.shaderCount=0},program:function(Me,je,wt,Wt){I.command(Me>=0,"missing vertex shader",wt),I.command(je>=0,"missing fragment shader",wt);var pt=Ct[je];pt||(pt=Ct[je]={});var Ft=pt[Me];if(Ft&&(Ft.refCount++,!Wt))return Ft;var Gt=new ht(je,Me);return fe.shaderCount++,dt(Gt,wt,Wt),Ft||(pt[Me]=Gt),xt.push(Gt),i(Gt,{destroy:function(){if(Gt.refCount--,Gt.refCount<=0){L.deleteProgram(Gt.program);var hn=xt.indexOf(Gt);xt.splice(hn,1),fe.shaderCount--}pt[Gt.vertId].refCount<=0&&(L.deleteShader(Le[Gt.vertId]),delete Le[Gt.vertId],delete Ct[Gt.fragId][Gt.vertId]),Object.keys(Ct[Gt.fragId]).length||(L.deleteShader(nt[Gt.fragId]),delete nt[Gt.fragId],delete Ct[Gt.fragId])}})},restore:bt,shader:mt,frag:-1,vert:-1}}var uM=6408,Pn=5121,ty=3333,Nd=5126;function ny(L,ee,fe,Be,nt,Le,He){function yt(xt){var gt;ee.next===null?(I(nt.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),gt=Pn):(I(ee.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),gt=ee.next.colorAttachments[0].texture._texture.type,I.optional(function(){Le.oes_texture_float?(I(gt===Pn||gt===Nd,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),gt===Nd&&I(He.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):I(gt===Pn,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var ht=0,dt=0,bt=Be.framebufferWidth,Me=Be.framebufferHeight,je=null;n(xt)?je=xt:xt&&(I.type(xt,"object","invalid arguments to regl.read()"),ht=xt.x|0,dt=xt.y|0,I(ht>=0&&ht<Be.framebufferWidth,"invalid x offset for regl.read"),I(dt>=0&&dt<Be.framebufferHeight,"invalid y offset for regl.read"),bt=(xt.width||Be.framebufferWidth-ht)|0,Me=(xt.height||Be.framebufferHeight-dt)|0,je=xt.data||null),je&&(gt===Pn?I(je instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):gt===Nd&&I(je instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),I(bt>0&&bt+ht<=Be.framebufferWidth,"invalid width for read pixels"),I(Me>0&&Me+dt<=Be.framebufferHeight,"invalid height for read pixels"),fe();var wt=bt*Me*4;return je||(gt===Pn?je=new Uint8Array(wt):gt===Nd&&(je=je||new Float32Array(wt))),I.isTypedArray(je,"data buffer for regl.read() must be a typedarray"),I(je.byteLength>=wt,"data buffer for regl.read() too small"),L.pixelStorei(ty,4),L.readPixels(ht,dt,bt,Me,uM,gt,je),je}function mt(xt){var gt;return ee.setFBO({framebuffer:xt.framebuffer},function(){gt=yt(xt)}),gt}function Ct(xt){return!xt||!("framebuffer"in xt)?yt(xt):mt(xt)}return Ct}function zl(L){return Array.prototype.slice.call(L)}function rh(L){return zl(L).join("")}function cM(){var L=0,ee=[],fe=[];function Be(gt){for(var ht=0;ht<fe.length;++ht)if(fe[ht]===gt)return ee[ht];var dt="g"+L++;return ee.push(dt),fe.push(gt),dt}function nt(){var gt=[];function ht(){gt.push.apply(gt,zl(arguments))}var dt=[];function bt(){var Me="v"+L++;return dt.push(Me),arguments.length>0&&(gt.push(Me,"="),gt.push.apply(gt,zl(arguments)),gt.push(";")),Me}return i(ht,{def:bt,toString:function(){return rh([dt.length>0?"var "+dt.join(",")+";":"",rh(gt)])}})}function Le(){var gt=nt(),ht=nt(),dt=gt.toString,bt=ht.toString;function Me(je,wt){ht(je,wt,"=",gt.def(je,wt),";")}return i(function(){gt.apply(gt,zl(arguments))},{def:gt.def,entry:gt,exit:ht,save:Me,set:function(je,wt,Wt){Me(je,wt),gt(je,wt,"=",Wt,";")},toString:function(){return dt()+bt()}})}function He(){var gt=rh(arguments),ht=Le(),dt=Le(),bt=ht.toString,Me=dt.toString;return i(ht,{then:function(){return ht.apply(ht,zl(arguments)),this},else:function(){return dt.apply(dt,zl(arguments)),this},toString:function(){var je=Me();return je&&(je="else{"+je+"}"),rh(["if(",gt,"){",bt(),"}",je])}})}var yt=nt(),mt={};function Ct(gt,ht){var dt=[];function bt(){var pt="a"+dt.length;return dt.push(pt),pt}ht=ht||0;for(var Me=0;Me<ht;++Me)bt();var je=Le(),wt=je.toString,Wt=mt[gt]=i(je,{arg:bt,toString:function(){return rh(["function(",dt.join(),"){",wt(),"}"])}});return Wt}function xt(){var gt=['"use strict";',yt,"return {"];Object.keys(mt).forEach(function(bt){gt.push('"',bt,'":',mt[bt].toString(),",")}),gt.push("}");var ht=rh(gt).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),dt=Function.apply(null,ee.concat(ht));return dt.apply(null,fe)}return{global:yt,link:Be,block:nt,proc:Ct,scope:Le,cond:He,compile:xt}}var Cc="xyzw".split(""),sh=5121,ah=1,iy=2,ry=0,sy=1,ay=2,Bd=3,kd=4,Fd=5,oy=6,Gb="dither",Vb="blend.enable",Xm="blend.color",go="blend.equation",hs="blend.func",Il="depth.enable",Ta="depth.func",ly="depth.range",Hb="depth.mask",Bs="colorMask",Tu="cull.enable",jb="cull.face",uy="frontFace",cy="lineWidth",Wb="polygonOffset.enable",Ym="polygonOffset.offset",Xb="sample.alpha",fy="sample.enable",hy="sample.coverage",Rc="stencil.enable",Mu="stencil.mask",dy="stencil.func",py="stencil.opFront",Gd="stencil.opBack",oh="scissor.enable",Zm="scissor.box",Ll="viewport",Vd="profile",vo="framebuffer",Hd="vert",jd="frag",Dc="elements",Oc="primitive",Uc="count",qm="offset",Km="instances",Wd="vao",my="Width",gy="Height",lh=vo+my,uh=vo+gy,Yb=Ll+my,fM=Ll+gy,Zb="drawingBuffer",qb=Zb+my,Kb=Zb+gy,hM=[hs,go,dy,py,Gd,hy,Ll,Zm,Ym],ch=34962,Qm=34963,Qb=35632,dM=35633,vy=3553,Jb=34067,$b=2884,yy=3042,xy=3024,pM=2960,mM=2929,gM=3089,vM=32823,eS=32926,tS=32928,_y=5126,Jm=35664,$m=35665,eg=35666,by=5124,tg=35667,ng=35668,ig=35669,Sy=35670,rg=35671,sg=35672,ag=35673,Xd=35674,fh=35675,Yd=35676,Zd=35678,ks=35680,og=4,zc=1028,Cu=1029,Ey=2304,lg=2305,yM=32775,nS=32776,iS=519,Ru=7680,rS=0,sS=1,wy=32774,xM=513,Ms=36160,aS=36064,Ho={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},oS=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],hh={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Pl={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ug={frag:Qb,vert:dM},Du={cw:Ey,ccw:lg};function Nl(L){return Array.isArray(L)||n(L)||pr(L)}function ha(L){return L.sort(function(ee,fe){return ee===Ll?-1:fe===Ll?1:ee<fe?-1:1})}function Zr(L,ee,fe,Be){this.thisDep=L,this.contextDep=ee,this.propDep=fe,this.append=Be}function Ou(L){return L&&!(L.thisDep||L.contextDep||L.propDep)}function cr(L){return new Zr(!1,!1,!1,L)}function Cs(L,ee){var fe=L.type;if(fe===ry){var Be=L.data.length;return new Zr(!0,Be>=1,Be>=2,ee)}else if(fe===kd){var nt=L.data;return new Zr(nt.thisDep,nt.contextDep,nt.propDep,ee)}else{if(fe===Fd)return new Zr(!1,!1,!1,ee);if(fe===oy){for(var Le=!1,He=!1,yt=!1,mt=0;mt<L.data.length;++mt){var Ct=L.data[mt];if(Ct.type===sy)yt=!0;else if(Ct.type===ay)He=!0;else if(Ct.type===Bd)Le=!0;else if(Ct.type===ry){Le=!0;var xt=Ct.data;xt>=1&&(He=!0),xt>=2&&(yt=!0)}else Ct.type===kd&&(Le=Le||Ct.data.thisDep,He=He||Ct.data.contextDep,yt=yt||Ct.data.propDep)}return new Zr(Le,He,yt,ee)}else return new Zr(fe===Bd,fe===ay,fe===sy,ee)}}var qd=new Zr(!1,!1,!1,function(){});function Ay(L,ee,fe,Be,nt,Le,He,yt,mt,Ct,xt,gt,ht,dt,bt){var Me=Ct.Record,je={add:32774,subtract:32778,"reverse subtract":32779};fe.ext_blend_minmax&&(je.min=yM,je.max=nS);var wt=fe.angle_instanced_arrays,Wt=fe.webgl_draw_buffers,pt=fe.oes_vertex_array_object,Ft={dirty:!0,profile:bt.profile},Gt={},hn=[],lt={},it={};function Zt(ae){return ae.replace(".","_")}function Pt(ae,J,he){var Ae=Zt(ae);hn.push(ae),Gt[Ae]=Ft[Ae]=!!he,lt[Ae]=J}function St(ae,J,he){var Ae=Zt(ae);hn.push(ae),Array.isArray(he)?(Ft[Ae]=he.slice(),Gt[Ae]=he.slice()):Ft[Ae]=Gt[Ae]=he,it[Ae]=J}Pt(Gb,xy),Pt(Vb,yy),St(Xm,"blendColor",[0,0,0,0]),St(go,"blendEquationSeparate",[wy,wy]),St(hs,"blendFuncSeparate",[sS,rS,sS,rS]),Pt(Il,mM,!0),St(Ta,"depthFunc",xM),St(ly,"depthRange",[0,1]),St(Hb,"depthMask",!0),St(Bs,Bs,[!0,!0,!0,!0]),Pt(Tu,$b),St(jb,"cullFace",Cu),St(uy,uy,lg),St(cy,cy,1),Pt(Wb,vM),St(Ym,"polygonOffset",[0,0]),Pt(Xb,eS),Pt(fy,tS),St(hy,"sampleCoverage",[1,!1]),Pt(Rc,pM),St(Mu,"stencilMask",-1),St(dy,"stencilFunc",[iS,0,-1]),St(py,"stencilOpSeparate",[zc,Ru,Ru,Ru]),St(Gd,"stencilOpSeparate",[Cu,Ru,Ru,Ru]),Pt(oh,gM),St(Zm,"scissor",[0,0,L.drawingBufferWidth,L.drawingBufferHeight]),St(Ll,Ll,[0,0,L.drawingBufferWidth,L.drawingBufferHeight]);var Ut={gl:L,context:ht,strings:ee,next:Gt,current:Ft,draw:gt,elements:Le,buffer:nt,shader:xt,attributes:Ct.state,vao:Ct,uniforms:mt,framebuffer:yt,extensions:fe,timer:dt,isBufferArgs:Nl},Lt={primTypes:Ga,compareFuncs:hh,blendFuncs:Ho,blendEquations:je,stencilOps:Pl,glTypes:Wr,orientationType:Du};I.optional(function(){Ut.isArrayLike=_i}),Wt&&(Lt.backBuffer=[Cu],Lt.drawBuffer=an(Be.maxDrawbuffers,function(ae){return ae===0?[0]:an(ae,function(J){return aS+J})}));var Cn=0;function Mn(){var ae=cM(),J=ae.link,he=ae.global;ae.id=Cn++,ae.batchId="0";var Ae=J(Ut),Ce=ae.shared={props:"a0"};Object.keys(Ut).forEach(function(ce){Ce[ce]=he.def(Ae,".",ce)}),I.optional(function(){ae.CHECK=J(I),ae.commandStr=I.guessCommand(),ae.command=J(ae.commandStr),ae.assert=function(ce,oe,Ie){ce("if(!(",oe,"))",this.CHECK,".commandRaise(",J(Ie),",",this.command,");")},Lt.invalidBlendCombinations=oS});var me=ae.next={},de=ae.current={};Object.keys(it).forEach(function(ce){Array.isArray(Ft[ce])&&(me[ce]=he.def(Ce.next,".",ce),de[ce]=he.def(Ce.current,".",ce))});var Se=ae.constants={};Object.keys(Lt).forEach(function(ce){Se[ce]=he.def(JSON.stringify(Lt[ce]))}),ae.invoke=function(ce,oe){switch(oe.type){case ry:var Ie=["this",Ce.context,Ce.props,ae.batchId];return ce.def(J(oe.data),".call(",Ie.slice(0,Math.max(oe.data.length+1,4)),")");case sy:return ce.def(Ce.props,oe.data);case ay:return ce.def(Ce.context,oe.data);case Bd:return ce.def("this",oe.data);case kd:return oe.data.append(ae,ce),oe.data.ref;case Fd:return oe.data.toString();case oy:return oe.data.map(function(Re){return ae.invoke(ce,Re)})}},ae.attribCache={};var le={};return ae.scopeAttrib=function(ce){var oe=ee.id(ce);if(oe in le)return le[oe];var Ie=Ct.scope[oe];Ie||(Ie=Ct.scope[oe]=new Me);var Re=le[oe]=J(Ie);return Re},ae}function kt(ae){var J=ae.static,he=ae.dynamic,Ae;if(Vd in J){var Ce=!!J[Vd];Ae=cr(function(de,Se){return Ce}),Ae.enable=Ce}else if(Vd in he){var me=he[Vd];Ae=Cs(me,function(de,Se){return de.invoke(Se,me)})}return Ae}function jt(ae,J){var he=ae.static,Ae=ae.dynamic;if(vo in he){var Ce=he[vo];return Ce?(Ce=yt.getFramebuffer(Ce),I.command(Ce,"invalid framebuffer object"),cr(function(de,Se){var le=de.link(Ce),ce=de.shared;Se.set(ce.framebuffer,".next",le);var oe=ce.context;return Se.set(oe,"."+lh,le+".width"),Se.set(oe,"."+uh,le+".height"),le})):cr(function(de,Se){var le=de.shared;Se.set(le.framebuffer,".next","null");var ce=le.context;return Se.set(ce,"."+lh,ce+"."+qb),Se.set(ce,"."+uh,ce+"."+Kb),"null"})}else if(vo in Ae){var me=Ae[vo];return Cs(me,function(de,Se){var le=de.invoke(Se,me),ce=de.shared,oe=ce.framebuffer,Ie=Se.def(oe,".getFramebuffer(",le,")");I.optional(function(){de.assert(Se,"!"+le+"||"+Ie,"invalid framebuffer object")}),Se.set(oe,".next",Ie);var Re=ce.context;return Se.set(Re,"."+lh,Ie+"?"+Ie+".width:"+Re+"."+qb),Se.set(Re,"."+uh,Ie+"?"+Ie+".height:"+Re+"."+Kb),Ie})}else return null}function yn(ae,J,he){var Ae=ae.static,Ce=ae.dynamic;function me(le){if(le in Ae){var ce=Ae[le];I.commandType(ce,"object","invalid "+le,he.commandStr);var oe=!0,Ie=ce.x|0,Re=ce.y|0,Qe,qe;return"width"in ce?(Qe=ce.width|0,I.command(Qe>=0,"invalid "+le,he.commandStr)):oe=!1,"height"in ce?(qe=ce.height|0,I.command(qe>=0,"invalid "+le,he.commandStr)):oe=!1,new Zr(!oe&&J&&J.thisDep,!oe&&J&&J.contextDep,!oe&&J&&J.propDep,function(Jt,qt){var tt=Jt.shared.context,Ze=Qe;"width"in ce||(Ze=qt.def(tt,".",lh,"-",Ie));var Kt=qe;return"height"in ce||(Kt=qt.def(tt,".",uh,"-",Re)),[Ie,Re,Ze,Kt]})}else if(le in Ce){var zt=Ce[le],bn=Cs(zt,function(Jt,qt){var tt=Jt.invoke(qt,zt);I.optional(function(){Jt.assert(qt,tt+"&&typeof "+tt+'==="object"',"invalid "+le)});var Ze=Jt.shared.context,Kt=qt.def(tt,".x|0"),$t=qt.def(tt,".y|0"),Sn=qt.def('"width" in ',tt,"?",tt,".width|0:","(",Ze,".",lh,"-",Kt,")"),fi=qt.def('"height" in ',tt,"?",tt,".height|0:","(",Ze,".",uh,"-",$t,")");return I.optional(function(){Jt.assert(qt,Sn+">=0&&"+fi+">=0","invalid "+le)}),[Kt,$t,Sn,fi]});return J&&(bn.thisDep=bn.thisDep||J.thisDep,bn.contextDep=bn.contextDep||J.contextDep,bn.propDep=bn.propDep||J.propDep),bn}else return J?new Zr(J.thisDep,J.contextDep,J.propDep,function(Jt,qt){var tt=Jt.shared.context;return[0,0,qt.def(tt,".",lh),qt.def(tt,".",uh)]}):null}var de=me(Ll);if(de){var Se=de;de=new Zr(de.thisDep,de.contextDep,de.propDep,function(le,ce){var oe=Se.append(le,ce),Ie=le.shared.context;return ce.set(Ie,"."+Yb,oe[2]),ce.set(Ie,"."+fM,oe[3]),oe})}return{viewport:de,scissor_box:me(Zm)}}function wn(ae,J){var he=ae.static,Ae=typeof he[jd]=="string"&&typeof he[Hd]=="string";if(Ae){if(Object.keys(J.dynamic).length>0)return null;var Ce=J.static,me=Object.keys(Ce);if(me.length>0&&typeof Ce[me[0]]=="number"){for(var de=[],Se=0;Se<me.length;++Se)I(typeof Ce[me[Se]]=="number","must specify all vertex attribute locations when using vaos"),de.push([Ce[me[Se]]|0,me[Se]]);return de}}return null}function In(ae,J,he){var Ae=ae.static,Ce=ae.dynamic;function me(oe){if(oe in Ae){var Ie=ee.id(Ae[oe]);I.optional(function(){xt.shader(ug[oe],Ie,I.guessCommand())});var Re=cr(function(){return Ie});return Re.id=Ie,Re}else if(oe in Ce){var Qe=Ce[oe];return Cs(Qe,function(qe,zt){var bn=qe.invoke(zt,Qe),Jt=zt.def(qe.shared.strings,".id(",bn,")");return I.optional(function(){zt(qe.shared.shader,".shader(",ug[oe],",",Jt,",",qe.command,");")}),Jt})}return null}var de=me(jd),Se=me(Hd),le=null,ce;return Ou(de)&&Ou(Se)?(le=xt.program(Se.id,de.id,null,he),ce=cr(function(oe,Ie){return oe.link(le)})):ce=new Zr(de&&de.thisDep||Se&&Se.thisDep,de&&de.contextDep||Se&&Se.contextDep,de&&de.propDep||Se&&Se.propDep,function(oe,Ie){var Re=oe.shared.shader,Qe;de?Qe=de.append(oe,Ie):Qe=Ie.def(Re,".",jd);var qe;Se?qe=Se.append(oe,Ie):qe=Ie.def(Re,".",Hd);var zt=Re+".program("+qe+","+Qe;return I.optional(function(){zt+=","+oe.command}),Ie.def(zt+")")}),{frag:de,vert:Se,progVar:ce,program:le}}function Ui(ae,J){var he=ae.static,Ae=ae.dynamic,Ce={},me=!1;function de(){if(Wd in he){var qt=he[Wd];return qt!==null&&Ct.getVAO(qt)===null&&(qt=Ct.createVAO(qt)),me=!0,Ce.vao=qt,cr(function(Ze){var Kt=Ct.getVAO(qt);return Kt?Ze.link(Kt):"null"})}else if(Wd in Ae){me=!0;var tt=Ae[Wd];return Cs(tt,function(Ze,Kt){var $t=Ze.invoke(Kt,tt);return Kt.def(Ze.shared.vao+".getVAO("+$t+")")})}return null}var Se=de(),le=!1;function ce(){if(Dc in he){var qt=he[Dc];if(Ce.elements=qt,Nl(qt)){var tt=Ce.elements=Le.create(qt,!0);qt=Le.getElements(tt),le=!0}else qt&&(qt=Le.getElements(qt),le=!0,I.command(qt,"invalid elements",J.commandStr));var Ze=cr(function($t,Sn){if(qt){var fi=$t.link(qt);return $t.ELEMENTS=fi,fi}return $t.ELEMENTS=null,null});return Ze.value=qt,Ze}else if(Dc in Ae){le=!0;var Kt=Ae[Dc];return Cs(Kt,function($t,Sn){var fi=$t.shared,Ur=fi.isBufferArgs,Wo=fi.elements,Wa=$t.invoke(Sn,Kt),Ma=Sn.def("null"),Xa=Sn.def(Ur,"(",Wa,")"),Lc=$t.cond(Xa).then(Ma,"=",Wo,".createStream(",Wa,");").else(Ma,"=",Wo,".getElements(",Wa,");");return I.optional(function(){$t.assert(Lc.else,"!"+Wa+"||"+Ma,"invalid elements")}),Sn.entry(Lc),Sn.exit($t.cond(Xa).then(Wo,".destroyStream(",Ma,");")),$t.ELEMENTS=Ma,Ma})}else if(me)return new Zr(Se.thisDep,Se.contextDep,Se.propDep,function($t,Sn){return Sn.def($t.shared.vao+".currentVAO?"+$t.shared.elements+".getElements("+$t.shared.vao+".currentVAO.elements):null")});return null}var oe=ce();function Ie(){if(Oc in he){var qt=he[Oc];return Ce.primitive=qt,I.commandParameter(qt,Ga,"invalid primitve",J.commandStr),cr(function(Ze,Kt){return Ga[qt]})}else if(Oc in Ae){var tt=Ae[Oc];return Cs(tt,function(Ze,Kt){var $t=Ze.constants.primTypes,Sn=Ze.invoke(Kt,tt);return I.optional(function(){Ze.assert(Kt,Sn+" in "+$t,"invalid primitive, must be one of "+Object.keys(Ga))}),Kt.def($t,"[",Sn,"]")})}else{if(le)return Ou(oe)?oe.value?cr(function(Ze,Kt){return Kt.def(Ze.ELEMENTS,".primType")}):cr(function(){return og}):new Zr(oe.thisDep,oe.contextDep,oe.propDep,function(Ze,Kt){var $t=Ze.ELEMENTS;return Kt.def($t,"?",$t,".primType:",og)});if(me)return new Zr(Se.thisDep,Se.contextDep,Se.propDep,function(Ze,Kt){return Kt.def(Ze.shared.vao+".currentVAO?"+Ze.shared.vao+".currentVAO.primitive:"+og)})}return null}function Re(qt,tt){if(qt in he){var Ze=he[qt]|0;return tt?Ce.offset=Ze:Ce.instances=Ze,I.command(!tt||Ze>=0,"invalid "+qt,J.commandStr),cr(function($t,Sn){return tt&&($t.OFFSET=Ze),Ze})}else if(qt in Ae){var Kt=Ae[qt];return Cs(Kt,function($t,Sn){var fi=$t.invoke(Sn,Kt);return tt&&($t.OFFSET=fi,I.optional(function(){$t.assert(Sn,fi+">=0","invalid "+qt)})),fi})}else if(tt){if(le)return cr(function($t,Sn){return $t.OFFSET=0,0});if(me)return new Zr(Se.thisDep,Se.contextDep,Se.propDep,function($t,Sn){return Sn.def($t.shared.vao+".currentVAO?"+$t.shared.vao+".currentVAO.offset:0")})}else if(me)return new Zr(Se.thisDep,Se.contextDep,Se.propDep,function($t,Sn){return Sn.def($t.shared.vao+".currentVAO?"+$t.shared.vao+".currentVAO.instances:-1")});return null}var Qe=Re(qm,!0);function qe(){if(Uc in he){var qt=he[Uc]|0;return Ce.count=qt,I.command(typeof qt=="number"&&qt>=0,"invalid vertex count",J.commandStr),cr(function(){return qt})}else if(Uc in Ae){var tt=Ae[Uc];return Cs(tt,function(Sn,fi){var Ur=Sn.invoke(fi,tt);return I.optional(function(){Sn.assert(fi,"typeof "+Ur+'==="number"&&'+Ur+">=0&&"+Ur+"===("+Ur+"|0)","invalid vertex count")}),Ur})}else if(le)if(Ou(oe)){if(oe)return Qe?new Zr(Qe.thisDep,Qe.contextDep,Qe.propDep,function(Sn,fi){var Ur=fi.def(Sn.ELEMENTS,".vertCount-",Sn.OFFSET);return I.optional(function(){Sn.assert(fi,Ur+">=0","invalid vertex offset/element buffer too small")}),Ur}):cr(function(Sn,fi){return fi.def(Sn.ELEMENTS,".vertCount")});var Ze=cr(function(){return-1});return I.optional(function(){Ze.MISSING=!0}),Ze}else{var Kt=new Zr(oe.thisDep||Qe.thisDep,oe.contextDep||Qe.contextDep,oe.propDep||Qe.propDep,function(Sn,fi){var Ur=Sn.ELEMENTS;return Sn.OFFSET?fi.def(Ur,"?",Ur,".vertCount-",Sn.OFFSET,":-1"):fi.def(Ur,"?",Ur,".vertCount:-1")});return I.optional(function(){Kt.DYNAMIC=!0}),Kt}else if(me){var $t=new Zr(Se.thisDep,Se.contextDep,Se.propDep,function(Sn,fi){return fi.def(Sn.shared.vao,".currentVAO?",Sn.shared.vao,".currentVAO.count:-1")});return $t}return null}var zt=Ie(),bn=qe(),Jt=Re(Km,!1);return{elements:oe,primitive:zt,count:bn,instances:Jt,offset:Qe,vao:Se,vaoActive:me,elementsActive:le,static:Ce}}function Ai(ae,J){var he=ae.static,Ae=ae.dynamic,Ce={};return hn.forEach(function(me){var de=Zt(me);function Se(le,ce){if(me in he){var oe=le(he[me]);Ce[de]=cr(function(){return oe})}else if(me in Ae){var Ie=Ae[me];Ce[de]=Cs(Ie,function(Re,Qe){return ce(Re,Qe,Re.invoke(Qe,Ie))})}}switch(me){case Tu:case Vb:case Gb:case Rc:case Il:case oh:case Wb:case Xb:case fy:case Hb:return Se(function(le){return I.commandType(le,"boolean",me,J.commandStr),le},function(le,ce,oe){return I.optional(function(){le.assert(ce,"typeof "+oe+'==="boolean"',"invalid flag "+me,le.commandStr)}),oe});case Ta:return Se(function(le){return I.commandParameter(le,hh,"invalid "+me,J.commandStr),hh[le]},function(le,ce,oe){var Ie=le.constants.compareFuncs;return I.optional(function(){le.assert(ce,oe+" in "+Ie,"invalid "+me+", must be one of "+Object.keys(hh))}),ce.def(Ie,"[",oe,"]")});case ly:return Se(function(le){return I.command(_i(le)&&le.length===2&&typeof le[0]=="number"&&typeof le[1]=="number"&&le[0]<=le[1],"depth range is 2d array",J.commandStr),le},function(le,ce,oe){I.optional(function(){le.assert(ce,le.shared.isArrayLike+"("+oe+")&&"+oe+".length===2&&typeof "+oe+'[0]==="number"&&typeof '+oe+'[1]==="number"&&'+oe+"[0]<="+oe+"[1]","depth range must be a 2d array")});var Ie=ce.def("+",oe,"[0]"),Re=ce.def("+",oe,"[1]");return[Ie,Re]});case hs:return Se(function(le){I.commandType(le,"object","blend.func",J.commandStr);var ce="srcRGB"in le?le.srcRGB:le.src,oe="srcAlpha"in le?le.srcAlpha:le.src,Ie="dstRGB"in le?le.dstRGB:le.dst,Re="dstAlpha"in le?le.dstAlpha:le.dst;return I.commandParameter(ce,Ho,de+".srcRGB",J.commandStr),I.commandParameter(oe,Ho,de+".srcAlpha",J.commandStr),I.commandParameter(Ie,Ho,de+".dstRGB",J.commandStr),I.commandParameter(Re,Ho,de+".dstAlpha",J.commandStr),I.command(oS.indexOf(ce+", "+Ie)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+ce+", "+Ie+")",J.commandStr),[Ho[ce],Ho[Ie],Ho[oe],Ho[Re]]},function(le,ce,oe){var Ie=le.constants.blendFuncs;I.optional(function(){le.assert(ce,oe+"&&typeof "+oe+'==="object"',"invalid blend func, must be an object")});function Re(tt,Ze){var Kt=ce.def('"',tt,Ze,'" in ',oe,"?",oe,".",tt,Ze,":",oe,".",tt);return I.optional(function(){le.assert(ce,Kt+" in "+Ie,"invalid "+me+"."+tt+Ze+", must be one of "+Object.keys(Ho))}),Kt}var Qe=Re("src","RGB"),qe=Re("dst","RGB");I.optional(function(){var tt=le.constants.invalidBlendCombinations;le.assert(ce,tt+".indexOf("+Qe+'+", "+'+qe+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var zt=ce.def(Ie,"[",Qe,"]"),bn=ce.def(Ie,"[",Re("src","Alpha"),"]"),Jt=ce.def(Ie,"[",qe,"]"),qt=ce.def(Ie,"[",Re("dst","Alpha"),"]");return[zt,Jt,bn,qt]});case go:return Se(function(le){if(typeof le=="string")return I.commandParameter(le,je,"invalid "+me,J.commandStr),[je[le],je[le]];if(typeof le=="object")return I.commandParameter(le.rgb,je,me+".rgb",J.commandStr),I.commandParameter(le.alpha,je,me+".alpha",J.commandStr),[je[le.rgb],je[le.alpha]];I.commandRaise("invalid blend.equation",J.commandStr)},function(le,ce,oe){var Ie=le.constants.blendEquations,Re=ce.def(),Qe=ce.def(),qe=le.cond("typeof ",oe,'==="string"');return I.optional(function(){function zt(bn,Jt,qt){le.assert(bn,qt+" in "+Ie,"invalid "+Jt+", must be one of "+Object.keys(je))}zt(qe.then,me,oe),le.assert(qe.else,oe+"&&typeof "+oe+'==="object"',"invalid "+me),zt(qe.else,me+".rgb",oe+".rgb"),zt(qe.else,me+".alpha",oe+".alpha")}),qe.then(Re,"=",Qe,"=",Ie,"[",oe,"];"),qe.else(Re,"=",Ie,"[",oe,".rgb];",Qe,"=",Ie,"[",oe,".alpha];"),ce(qe),[Re,Qe]});case Xm:return Se(function(le){return I.command(_i(le)&&le.length===4,"blend.color must be a 4d array",J.commandStr),an(4,function(ce){return+le[ce]})},function(le,ce,oe){return I.optional(function(){le.assert(ce,le.shared.isArrayLike+"("+oe+")&&"+oe+".length===4","blend.color must be a 4d array")}),an(4,function(Ie){return ce.def("+",oe,"[",Ie,"]")})});case Mu:return Se(function(le){return I.commandType(le,"number",de,J.commandStr),le|0},function(le,ce,oe){return I.optional(function(){le.assert(ce,"typeof "+oe+'==="number"',"invalid stencil.mask")}),ce.def(oe,"|0")});case dy:return Se(function(le){I.commandType(le,"object",de,J.commandStr);var ce=le.cmp||"keep",oe=le.ref||0,Ie="mask"in le?le.mask:-1;return I.commandParameter(ce,hh,me+".cmp",J.commandStr),I.commandType(oe,"number",me+".ref",J.commandStr),I.commandType(Ie,"number",me+".mask",J.commandStr),[hh[ce],oe,Ie]},function(le,ce,oe){var Ie=le.constants.compareFuncs;I.optional(function(){function zt(){le.assert(ce,Array.prototype.join.call(arguments,""),"invalid stencil.func")}zt(oe+"&&typeof ",oe,'==="object"'),zt('!("cmp" in ',oe,")||(",oe,".cmp in ",Ie,")")});var Re=ce.def('"cmp" in ',oe,"?",Ie,"[",oe,".cmp]",":",Ru),Qe=ce.def(oe,".ref|0"),qe=ce.def('"mask" in ',oe,"?",oe,".mask|0:-1");return[Re,Qe,qe]});case py:case Gd:return Se(function(le){I.commandType(le,"object",de,J.commandStr);var ce=le.fail||"keep",oe=le.zfail||"keep",Ie=le.zpass||"keep";return I.commandParameter(ce,Pl,me+".fail",J.commandStr),I.commandParameter(oe,Pl,me+".zfail",J.commandStr),I.commandParameter(Ie,Pl,me+".zpass",J.commandStr),[me===Gd?Cu:zc,Pl[ce],Pl[oe],Pl[Ie]]},function(le,ce,oe){var Ie=le.constants.stencilOps;I.optional(function(){le.assert(ce,oe+"&&typeof "+oe+'==="object"',"invalid "+me)});function Re(Qe){return I.optional(function(){le.assert(ce,'!("'+Qe+'" in '+oe+")||("+oe+"."+Qe+" in "+Ie+")","invalid "+me+"."+Qe+", must be one of "+Object.keys(Pl))}),ce.def('"',Qe,'" in ',oe,"?",Ie,"[",oe,".",Qe,"]:",Ru)}return[me===Gd?Cu:zc,Re("fail"),Re("zfail"),Re("zpass")]});case Ym:return Se(function(le){I.commandType(le,"object",de,J.commandStr);var ce=le.factor|0,oe=le.units|0;return I.commandType(ce,"number",de+".factor",J.commandStr),I.commandType(oe,"number",de+".units",J.commandStr),[ce,oe]},function(le,ce,oe){I.optional(function(){le.assert(ce,oe+"&&typeof "+oe+'==="object"',"invalid "+me)});var Ie=ce.def(oe,".factor|0"),Re=ce.def(oe,".units|0");return[Ie,Re]});case jb:return Se(function(le){var ce=0;return le==="front"?ce=zc:le==="back"&&(ce=Cu),I.command(!!ce,de,J.commandStr),ce},function(le,ce,oe){return I.optional(function(){le.assert(ce,oe+'==="front"||'+oe+'==="back"',"invalid cull.face")}),ce.def(oe,'==="front"?',zc,":",Cu)});case cy:return Se(function(le){return I.command(typeof le=="number"&&le>=Be.lineWidthDims[0]&&le<=Be.lineWidthDims[1],"invalid line width, must be a positive number between "+Be.lineWidthDims[0]+" and "+Be.lineWidthDims[1],J.commandStr),le},function(le,ce,oe){return I.optional(function(){le.assert(ce,"typeof "+oe+'==="number"&&'+oe+">="+Be.lineWidthDims[0]+"&&"+oe+"<="+Be.lineWidthDims[1],"invalid line width")}),oe});case uy:return Se(function(le){return I.commandParameter(le,Du,de,J.commandStr),Du[le]},function(le,ce,oe){return I.optional(function(){le.assert(ce,oe+'==="cw"||'+oe+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),ce.def(oe+'==="cw"?'+Ey+":"+lg)});case Bs:return Se(function(le){return I.command(_i(le)&&le.length===4,"color.mask must be length 4 array",J.commandStr),le.map(function(ce){return!!ce})},function(le,ce,oe){return I.optional(function(){le.assert(ce,le.shared.isArrayLike+"("+oe+")&&"+oe+".length===4","invalid color.mask")}),an(4,function(Ie){return"!!"+oe+"["+Ie+"]"})});case hy:return Se(function(le){I.command(typeof le=="object"&&le,de,J.commandStr);var ce="value"in le?le.value:1,oe=!!le.invert;return I.command(typeof ce=="number"&&ce>=0&&ce<=1,"sample.coverage.value must be a number between 0 and 1",J.commandStr),[ce,oe]},function(le,ce,oe){I.optional(function(){le.assert(ce,oe+"&&typeof "+oe+'==="object"',"invalid sample.coverage")});var Ie=ce.def('"value" in ',oe,"?+",oe,".value:1"),Re=ce.def("!!",oe,".invert");return[Ie,Re]})}}),Ce}function jn(ae,J){var he=ae.static,Ae=ae.dynamic,Ce={};return Object.keys(he).forEach(function(me){var de=he[me],Se;if(typeof de=="number"||typeof de=="boolean")Se=cr(function(){return de});else if(typeof de=="function"){var le=de._reglType;le==="texture2d"||le==="textureCube"?Se=cr(function(ce){return ce.link(de)}):le==="framebuffer"||le==="framebufferCube"?(I.command(de.color.length>0,'missing color attachment for framebuffer sent to uniform "'+me+'"',J.commandStr),Se=cr(function(ce){return ce.link(de.color[0])})):I.commandRaise('invalid data for uniform "'+me+'"',J.commandStr)}else _i(de)?Se=cr(function(ce){var oe=ce.global.def("[",an(de.length,function(Ie){return I.command(typeof de[Ie]=="number"||typeof de[Ie]=="boolean","invalid uniform "+me,ce.commandStr),de[Ie]}),"]");return oe}):I.commandRaise('invalid or missing data for uniform "'+me+'"',J.commandStr);Se.value=de,Ce[me]=Se}),Object.keys(Ae).forEach(function(me){var de=Ae[me];Ce[me]=Cs(de,function(Se,le){return Se.invoke(le,de)})}),Ce}function tr(ae,J){var he=ae.static,Ae=ae.dynamic,Ce={};return Object.keys(he).forEach(function(me){var de=he[me],Se=ee.id(me),le=new Me;if(Nl(de))le.state=ah,le.buffer=nt.getBuffer(nt.create(de,ch,!1,!0)),le.type=0;else{var ce=nt.getBuffer(de);if(ce)le.state=ah,le.buffer=ce,le.type=0;else if(I.command(typeof de=="object"&&de,"invalid data for attribute "+me,J.commandStr),"constant"in de){var oe=de.constant;le.buffer="null",le.state=iy,typeof oe=="number"?le.x=oe:(I.command(_i(oe)&&oe.length>0&&oe.length<=4,"invalid constant for attribute "+me,J.commandStr),Cc.forEach(function(Jt,qt){qt<oe.length&&(le[Jt]=oe[qt])}))}else{Nl(de.buffer)?ce=nt.getBuffer(nt.create(de.buffer,ch,!1,!0)):ce=nt.getBuffer(de.buffer),I.command(!!ce,'missing buffer for attribute "'+me+'"',J.commandStr);var Ie=de.offset|0;I.command(Ie>=0,'invalid offset for attribute "'+me+'"',J.commandStr);var Re=de.stride|0;I.command(Re>=0&&Re<256,'invalid stride for attribute "'+me+'", must be integer betweeen [0, 255]',J.commandStr);var Qe=de.size|0;I.command(!("size"in de)||Qe>0&&Qe<=4,'invalid size for attribute "'+me+'", must be 1,2,3,4',J.commandStr);var qe=!!de.normalized,zt=0;"type"in de&&(I.commandParameter(de.type,Wr,"invalid type for attribute "+me,J.commandStr),zt=Wr[de.type]);var bn=de.divisor|0;I.optional(function(){"divisor"in de&&(I.command(bn===0||wt,'cannot specify divisor for attribute "'+me+'", instancing not supported',J.commandStr),I.command(bn>=0,'invalid divisor for attribute "'+me+'"',J.commandStr));var Jt=J.commandStr,qt=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(de).forEach(function(tt){I.command(qt.indexOf(tt)>=0,'unknown parameter "'+tt+'" for attribute pointer "'+me+'" (valid parameters are '+qt+")",Jt)})}),le.buffer=ce,le.state=ah,le.size=Qe,le.normalized=qe,le.type=zt||ce.dtype,le.offset=Ie,le.stride=Re,le.divisor=bn}}Ce[me]=cr(function(Jt,qt){var tt=Jt.attribCache;if(Se in tt)return tt[Se];var Ze={isStream:!1};return Object.keys(le).forEach(function(Kt){Ze[Kt]=le[Kt]}),le.buffer&&(Ze.buffer=Jt.link(le.buffer),Ze.type=Ze.type||Ze.buffer+".dtype"),tt[Se]=Ze,Ze})}),Object.keys(Ae).forEach(function(me){var de=Ae[me];function Se(le,ce){var oe=le.invoke(ce,de),Ie=le.shared,Re=le.constants,Qe=Ie.isBufferArgs,qe=Ie.buffer;I.optional(function(){le.assert(ce,oe+"&&(typeof "+oe+'==="object"||typeof '+oe+'==="function")&&('+Qe+"("+oe+")||"+qe+".getBuffer("+oe+")||"+qe+".getBuffer("+oe+".buffer)||"+Qe+"("+oe+'.buffer)||("constant" in '+oe+"&&(typeof "+oe+'.constant==="number"||'+Ie.isArrayLike+"("+oe+".constant))))",'invalid dynamic attribute "'+me+'"')});var zt={isStream:ce.def(!1)},bn=new Me;bn.state=ah,Object.keys(bn).forEach(function(Ze){zt[Ze]=ce.def(""+bn[Ze])});var Jt=zt.buffer,qt=zt.type;ce("if(",Qe,"(",oe,")){",zt.isStream,"=true;",Jt,"=",qe,".createStream(",ch,",",oe,");",qt,"=",Jt,".dtype;","}else{",Jt,"=",qe,".getBuffer(",oe,");","if(",Jt,"){",qt,"=",Jt,".dtype;",'}else if("constant" in ',oe,"){",zt.state,"=",iy,";","if(typeof "+oe+'.constant === "number"){',zt[Cc[0]],"=",oe,".constant;",Cc.slice(1).map(function(Ze){return zt[Ze]}).join("="),"=0;","}else{",Cc.map(function(Ze,Kt){return zt[Ze]+"="+oe+".constant.length>"+Kt+"?"+oe+".constant["+Kt+"]:0;"}).join(""),"}}else{","if(",Qe,"(",oe,".buffer)){",Jt,"=",qe,".createStream(",ch,",",oe,".buffer);","}else{",Jt,"=",qe,".getBuffer(",oe,".buffer);","}",qt,'="type" in ',oe,"?",Re.glTypes,"[",oe,".type]:",Jt,".dtype;",zt.normalized,"=!!",oe,".normalized;");function tt(Ze){ce(zt[Ze],"=",oe,".",Ze,"|0;")}return tt("size"),tt("offset"),tt("stride"),tt("divisor"),ce("}}"),ce.exit("if(",zt.isStream,"){",qe,".destroyStream(",Jt,");","}"),zt}Ce[me]=Cs(de,Se)}),Ce}function Ti(ae){var J=ae.static,he=ae.dynamic,Ae={};return Object.keys(J).forEach(function(Ce){var me=J[Ce];Ae[Ce]=cr(function(de,Se){return typeof me=="number"||typeof me=="boolean"?""+me:de.link(me)})}),Object.keys(he).forEach(function(Ce){var me=he[Ce];Ae[Ce]=Cs(me,function(de,Se){return de.invoke(Se,me)})}),Ae}function Si(ae,J,he,Ae,Ce){var me=ae.static,de=ae.dynamic;I.optional(function(){var tt=[vo,Hd,jd,Dc,Oc,qm,Uc,Km,Vd,Wd].concat(hn);function Ze(Kt){Object.keys(Kt).forEach(function($t){I.command(tt.indexOf($t)>=0,'unknown parameter "'+$t+'"',Ce.commandStr)})}Ze(me),Ze(de)});var Se=wn(ae,J),le=jt(ae),ce=yn(ae,le,Ce),oe=Ui(ae,Ce),Ie=Ai(ae,Ce),Re=In(ae,Ce,Se);function Qe(tt){var Ze=ce[tt];Ze&&(Ie[tt]=Ze)}Qe(Ll),Qe(Zt(Zm));var qe=Object.keys(Ie).length>0,zt={framebuffer:le,draw:oe,shader:Re,state:Ie,dirty:qe,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(zt.profile=kt(ae),zt.uniforms=jn(he,Ce),zt.drawVAO=zt.scopeVAO=oe.vao,!zt.drawVAO&&Re.program&&!Se&&fe.angle_instanced_arrays&&oe.static.elements){var bn=!0,Jt=Re.program.attributes.map(function(tt){var Ze=J.static[tt];return bn=bn&&!!Ze,Ze});if(bn&&Jt.length>0){var qt=Ct.getVAO(Ct.createVAO({attributes:Jt,elements:oe.static.elements}));zt.drawVAO=new Zr(null,null,null,function(tt,Ze){return tt.link(qt)}),zt.useVAO=!0}}return Se?zt.useVAO=!0:zt.attributes=tr(J,Ce),zt.context=Ti(Ae),zt}function zi(ae,J,he){var Ae=ae.shared,Ce=Ae.context,me=ae.scope();Object.keys(he).forEach(function(de){J.save(Ce,"."+de);var Se=he[de],le=Se.append(ae,J);Array.isArray(le)?me(Ce,".",de,"=[",le.join(),"];"):me(Ce,".",de,"=",le,";")}),J(me)}function oi(ae,J,he,Ae){var Ce=ae.shared,me=Ce.gl,de=Ce.framebuffer,Se;Wt&&(Se=J.def(Ce.extensions,".webgl_draw_buffers"));var le=ae.constants,ce=le.drawBuffer,oe=le.backBuffer,Ie;he?Ie=he.append(ae,J):Ie=J.def(de,".next"),Ae||J("if(",Ie,"!==",de,".cur){"),J("if(",Ie,"){",me,".bindFramebuffer(",Ms,",",Ie,".framebuffer);"),Wt&&J(Se,".drawBuffersWEBGL(",ce,"[",Ie,".colorAttachments.length]);"),J("}else{",me,".bindFramebuffer(",Ms,",null);"),Wt&&J(Se,".drawBuffersWEBGL(",oe,");"),J("}",de,".cur=",Ie,";"),Ae||J("}")}function nr(ae,J,he){var Ae=ae.shared,Ce=Ae.gl,me=ae.current,de=ae.next,Se=Ae.current,le=Ae.next,ce=ae.cond(Se,".dirty");hn.forEach(function(oe){var Ie=Zt(oe);if(!(Ie in he.state)){var Re,Qe;if(Ie in de){Re=de[Ie],Qe=me[Ie];var qe=an(Ft[Ie].length,function(bn){return ce.def(Re,"[",bn,"]")});ce(ae.cond(qe.map(function(bn,Jt){return bn+"!=="+Qe+"["+Jt+"]"}).join("||")).then(Ce,".",it[Ie],"(",qe,");",qe.map(function(bn,Jt){return Qe+"["+Jt+"]="+bn}).join(";"),";"))}else{Re=ce.def(le,".",Ie);var zt=ae.cond(Re,"!==",Se,".",Ie);ce(zt),Ie in lt?zt(ae.cond(Re).then(Ce,".enable(",lt[Ie],");").else(Ce,".disable(",lt[Ie],");"),Se,".",Ie,"=",Re,";"):zt(Ce,".",it[Ie],"(",Re,");",Se,".",Ie,"=",Re,";")}}}),Object.keys(he.state).length===0&&ce(Se,".dirty=false;"),J(ce)}function Rn(ae,J,he,Ae){var Ce=ae.shared,me=ae.current,de=Ce.current,Se=Ce.gl;ha(Object.keys(he)).forEach(function(le){var ce=he[le];if(!(Ae&&!Ae(ce))){var oe=ce.append(ae,J);if(lt[le]){var Ie=lt[le];Ou(ce)?oe?J(Se,".enable(",Ie,");"):J(Se,".disable(",Ie,");"):J(ae.cond(oe).then(Se,".enable(",Ie,");").else(Se,".disable(",Ie,");")),J(de,".",le,"=",oe,";")}else if(_i(oe)){var Re=me[le];J(Se,".",it[le],"(",oe,");",oe.map(function(Qe,qe){return Re+"["+qe+"]="+Qe}).join(";"),";")}else J(Se,".",it[le],"(",oe,");",de,".",le,"=",oe,";")}})}function Ln(ae,J){wt&&(ae.instancing=J.def(ae.shared.extensions,".angle_instanced_arrays"))}function dn(ae,J,he,Ae,Ce){var me=ae.shared,de=ae.stats,Se=me.current,le=me.timer,ce=he.profile;function oe(){return typeof performance>"u"?"Date.now()":"performance.now()"}var Ie,Re;function Qe(tt){Ie=J.def(),tt(Ie,"=",oe(),";"),typeof Ce=="string"?tt(de,".count+=",Ce,";"):tt(de,".count++;"),dt&&(Ae?(Re=J.def(),tt(Re,"=",le,".getNumPendingQueries();")):tt(le,".beginQuery(",de,");"))}function qe(tt){tt(de,".cpuTime+=",oe(),"-",Ie,";"),dt&&(Ae?tt(le,".pushScopeStats(",Re,",",le,".getNumPendingQueries(),",de,");"):tt(le,".endQuery();"))}function zt(tt){var Ze=J.def(Se,".profile");J(Se,".profile=",tt,";"),J.exit(Se,".profile=",Ze,";")}var bn;if(ce){if(Ou(ce)){ce.enable?(Qe(J),qe(J.exit),zt("true")):zt("false");return}bn=ce.append(ae,J),zt(bn)}else bn=J.def(Se,".profile");var Jt=ae.block();Qe(Jt),J("if(",bn,"){",Jt,"}");var qt=ae.block();qe(qt),J.exit("if(",bn,"){",qt,"}")}function Or(ae,J,he,Ae,Ce){var me=ae.shared;function de(le){switch(le){case Jm:case tg:case rg:return 2;case $m:case ng:case sg:return 3;case eg:case ig:case ag:return 4;default:return 1}}function Se(le,ce,oe){var Ie=me.gl,Re=J.def(le,".location"),Qe=J.def(me.attributes,"[",Re,"]"),qe=oe.state,zt=oe.buffer,bn=[oe.x,oe.y,oe.z,oe.w],Jt=["buffer","normalized","offset","stride"];function qt(){J("if(!",Qe,".buffer){",Ie,".enableVertexAttribArray(",Re,");}");var Ze=oe.type,Kt;if(oe.size?Kt=J.def(oe.size,"||",ce):Kt=ce,J("if(",Qe,".type!==",Ze,"||",Qe,".size!==",Kt,"||",Jt.map(function(Sn){return Qe+"."+Sn+"!=="+oe[Sn]}).join("||"),"){",Ie,".bindBuffer(",ch,",",zt,".buffer);",Ie,".vertexAttribPointer(",[Re,Kt,Ze,oe.normalized,oe.stride,oe.offset],");",Qe,".type=",Ze,";",Qe,".size=",Kt,";",Jt.map(function(Sn){return Qe+"."+Sn+"="+oe[Sn]+";"}).join(""),"}"),wt){var $t=oe.divisor;J("if(",Qe,".divisor!==",$t,"){",ae.instancing,".vertexAttribDivisorANGLE(",[Re,$t],");",Qe,".divisor=",$t,";}")}}function tt(){J("if(",Qe,".buffer){",Ie,".disableVertexAttribArray(",Re,");",Qe,".buffer=null;","}if(",Cc.map(function(Ze,Kt){return Qe+"."+Ze+"!=="+bn[Kt]}).join("||"),"){",Ie,".vertexAttrib4f(",Re,",",bn,");",Cc.map(function(Ze,Kt){return Qe+"."+Ze+"="+bn[Kt]+";"}).join(""),"}")}qe===ah?qt():qe===iy?tt():(J("if(",qe,"===",ah,"){"),qt(),J("}else{"),tt(),J("}"))}Ae.forEach(function(le){var ce=le.name,oe=he.attributes[ce],Ie;if(oe){if(!Ce(oe))return;Ie=oe.append(ae,J)}else{if(!Ce(qd))return;var Re=ae.scopeAttrib(ce);I.optional(function(){ae.assert(J,Re+".state","missing attribute "+ce)}),Ie={},Object.keys(new Me).forEach(function(Qe){Ie[Qe]=J.def(Re,".",Qe)})}Se(ae.link(le),de(le.info.type),Ie)})}function ti(ae,J,he,Ae,Ce,me){for(var de=ae.shared,Se=de.gl,le={},ce,oe=0;oe<Ae.length;++oe){var Ie=Ae[oe],Re=Ie.name,Qe=Ie.info.type,qe=Ie.info.size,zt=he.uniforms[Re];if(qe>1){if(!zt)continue;var bn=Re.replace("[0]","");if(le[bn])continue;le[bn]=1}var Jt=ae.link(Ie),qt=Jt+".location",tt;if(zt){if(!Ce(zt))continue;if(Ou(zt)){var Ze=zt.value;if(I.command(Ze!==null&&typeof Ze<"u",'missing uniform "'+Re+'"',ae.commandStr),Qe===Zd||Qe===ks){I.command(typeof Ze=="function"&&(Qe===Zd&&(Ze._reglType==="texture2d"||Ze._reglType==="framebuffer")||Qe===ks&&(Ze._reglType==="textureCube"||Ze._reglType==="framebufferCube")),"invalid texture for uniform "+Re,ae.commandStr);var Kt=ae.link(Ze._texture||Ze.color[0]._texture);J(Se,".uniform1i(",qt,",",Kt+".bind());"),J.exit(Kt,".unbind();")}else if(Qe===Xd||Qe===fh||Qe===Yd){I.optional(function(){I.command(_i(Ze),"invalid matrix for uniform "+Re,ae.commandStr),I.command(Qe===Xd&&Ze.length===4||Qe===fh&&Ze.length===9||Qe===Yd&&Ze.length===16,"invalid length for matrix uniform "+Re,ae.commandStr)});var $t=ae.global.def("new Float32Array(["+Array.prototype.slice.call(Ze)+"])"),Sn=2;Qe===fh?Sn=3:Qe===Yd&&(Sn=4),J(Se,".uniformMatrix",Sn,"fv(",qt,",false,",$t,");")}else{switch(Qe){case _y:qe===1?I.commandType(Ze,"number","uniform "+Re,ae.commandStr):I.command(_i(Ze)&&Ze.length===qe,"uniform "+Re,ae.commandStr),ce="1f";break;case Jm:I.command(_i(Ze)&&Ze.length&&Ze.length%2===0&&Ze.length<=qe*2,"uniform "+Re,ae.commandStr),ce="2f";break;case $m:I.command(_i(Ze)&&Ze.length&&Ze.length%3===0&&Ze.length<=qe*3,"uniform "+Re,ae.commandStr),ce="3f";break;case eg:I.command(_i(Ze)&&Ze.length&&Ze.length%4===0&&Ze.length<=qe*4,"uniform "+Re,ae.commandStr),ce="4f";break;case Sy:qe===1?I.commandType(Ze,"boolean","uniform "+Re,ae.commandStr):I.command(_i(Ze)&&Ze.length===qe,"uniform "+Re,ae.commandStr),ce="1i";break;case by:qe===1?I.commandType(Ze,"number","uniform "+Re,ae.commandStr):I.command(_i(Ze)&&Ze.length===qe,"uniform "+Re,ae.commandStr),ce="1i";break;case rg:I.command(_i(Ze)&&Ze.length&&Ze.length%2===0&&Ze.length<=qe*2,"uniform "+Re,ae.commandStr),ce="2i";break;case tg:I.command(_i(Ze)&&Ze.length&&Ze.length%2===0&&Ze.length<=qe*2,"uniform "+Re,ae.commandStr),ce="2i";break;case sg:I.command(_i(Ze)&&Ze.length&&Ze.length%3===0&&Ze.length<=qe*3,"uniform "+Re,ae.commandStr),ce="3i";break;case ng:I.command(_i(Ze)&&Ze.length&&Ze.length%3===0&&Ze.length<=qe*3,"uniform "+Re,ae.commandStr),ce="3i";break;case ag:I.command(_i(Ze)&&Ze.length&&Ze.length%4===0&&Ze.length<=qe*4,"uniform "+Re,ae.commandStr),ce="4i";break;case ig:I.command(_i(Ze)&&Ze.length&&Ze.length%4===0&&Ze.length<=qe*4,"uniform "+Re,ae.commandStr),ce="4i";break}qe>1?(ce+="v",Ze=ae.global.def("["+Array.prototype.slice.call(Ze)+"]")):Ze=_i(Ze)?Array.prototype.slice.call(Ze):Ze,J(Se,".uniform",ce,"(",qt,",",Ze,");")}continue}else tt=zt.append(ae,J)}else{if(!Ce(qd))continue;tt=J.def(de.uniforms,"[",ee.id(Re),"]")}Qe===Zd?(I(!Array.isArray(tt),"must specify a scalar prop for textures"),J("if(",tt,"&&",tt,'._reglType==="framebuffer"){',tt,"=",tt,".color[0];","}")):Qe===ks&&(I(!Array.isArray(tt),"must specify a scalar prop for cube maps"),J("if(",tt,"&&",tt,'._reglType==="framebufferCube"){',tt,"=",tt,".color[0];","}")),I.optional(function(){function hi(ir,Ya){ae.assert(J,ir,'bad data or missing for uniform "'+Re+'".  '+Ya)}function Kn(ir,Ya){Ya===1&&I(!Array.isArray(tt),"must not specify an array type for uniform"),hi("Array.isArray("+tt+") && typeof "+tt+'[0]===" '+ir+'" || typeof '+tt+'==="'+ir+'"',"invalid type, expected "+ir)}function Wn(ir,Ya,kl){Array.isArray(tt)?I(tt.length&&tt.length%ir===0&&tt.length<=ir*kl,"must have length of "+(kl===1?"":"n * ")+ir):hi(de.isArrayLike+"("+tt+")&&"+tt+".length && "+tt+".length % "+ir+" === 0 && "+tt+".length<="+ir*kl,"invalid vector, should have length of "+(kl===1?"":"n * ")+ir,ae.commandStr)}function qi(ir){I(!Array.isArray(tt),"must not specify a value type"),hi("typeof "+tt+'==="function"&&'+tt+'._reglType==="texture'+(ir===vy?"2d":"Cube")+'"',"invalid texture type",ae.commandStr)}switch(Qe){case by:Kn("number",qe);break;case tg:Wn(2,"number",qe);break;case ng:Wn(3,"number",qe);break;case ig:Wn(4,"number",qe);break;case _y:Kn("number",qe);break;case Jm:Wn(2,"number",qe);break;case $m:Wn(3,"number",qe);break;case eg:Wn(4,"number",qe);break;case Sy:Kn("boolean",qe);break;case rg:Wn(2,"boolean",qe);break;case sg:Wn(3,"boolean",qe);break;case ag:Wn(4,"boolean",qe);break;case Xd:Wn(4,"number",qe);break;case fh:Wn(9,"number",qe);break;case Yd:Wn(16,"number",qe);break;case Zd:qi(vy);break;case ks:qi(Jb);break}});var fi=1;switch(Qe){case Zd:case ks:var Ur=J.def(tt,"._texture");J(Se,".uniform1i(",qt,",",Ur,".bind());"),J.exit(Ur,".unbind();");continue;case by:case Sy:ce="1i";break;case tg:case rg:ce="2i",fi=2;break;case ng:case sg:ce="3i",fi=3;break;case ig:case ag:ce="4i",fi=4;break;case _y:ce="1f";break;case Jm:ce="2f",fi=2;break;case $m:ce="3f",fi=3;break;case eg:ce="4f",fi=4;break;case Xd:ce="Matrix2fv";break;case fh:ce="Matrix3fv";break;case Yd:ce="Matrix4fv";break}if(ce.indexOf("Matrix")===-1&&qe>1&&(ce+="v",fi=1),ce.charAt(0)==="M"){J(Se,".uniform",ce,"(",qt,",");var Wo=Math.pow(Qe-Xd+2,2),Wa=ae.global.def("new Float32Array(",Wo,")");Array.isArray(tt)?J("false,(",an(Wo,function(hi){return Wa+"["+hi+"]="+tt[hi]}),",",Wa,")"):J("false,(Array.isArray(",tt,")||",tt," instanceof Float32Array)?",tt,":(",an(Wo,function(hi){return Wa+"["+hi+"]="+tt+"["+hi+"]"}),",",Wa,")"),J(");")}else if(fi>1){for(var Ma=[],Xa=[],Lc=0;Lc<fi;++Lc)Array.isArray(tt)?Xa.push(tt[Lc]):Xa.push(J.def(tt+"["+Lc+"]")),me&&Ma.push(J.def());me&&J("if(!",ae.batchId,"||",Ma.map(function(hi,Kn){return hi+"!=="+Xa[Kn]}).join("||"),"){",Ma.map(function(hi,Kn){return hi+"="+Xa[Kn]+";"}).join("")),J(Se,".uniform",ce,"(",qt,",",Xa.join(","),");"),me&&J("}")}else{if(I(!Array.isArray(tt),"uniform value must not be an array"),me){var Bi=J.def();J("if(!",ae.batchId,"||",Bi,"!==",tt,"){",Bi,"=",tt,";")}J(Se,".uniform",ce,"(",qt,",",tt,");"),me&&J("}")}}}function pn(ae,J,he,Ae){var Ce=ae.shared,me=Ce.gl,de=Ce.draw,Se=Ae.draw;function le(){var Kt=Se.elements,$t,Sn=J;return Kt?((Kt.contextDep&&Ae.contextDynamic||Kt.propDep)&&(Sn=he),$t=Kt.append(ae,Sn),Se.elementsActive&&Sn("if("+$t+")"+me+".bindBuffer("+Qm+","+$t+".buffer.buffer);")):($t=Sn.def(),Sn($t,"=",de,".",Dc,";","if(",$t,"){",me,".bindBuffer(",Qm,",",$t,".buffer.buffer);}","else if(",Ce.vao,".currentVAO){",$t,"=",ae.shared.elements+".getElements("+Ce.vao,".currentVAO.elements);",pt?"":"if("+$t+")"+me+".bindBuffer("+Qm+","+$t+".buffer.buffer);","}")),$t}function ce(){var Kt=Se.count,$t,Sn=J;return Kt?((Kt.contextDep&&Ae.contextDynamic||Kt.propDep)&&(Sn=he),$t=Kt.append(ae,Sn),I.optional(function(){Kt.MISSING&&ae.assert(J,"false","missing vertex count"),Kt.DYNAMIC&&ae.assert(Sn,$t+">=0","missing vertex count")})):($t=Sn.def(de,".",Uc),I.optional(function(){ae.assert(Sn,$t+">=0","missing vertex count")})),$t}var oe=le();function Ie(Kt){var $t=Se[Kt];return $t?$t.contextDep&&Ae.contextDynamic||$t.propDep?$t.append(ae,he):$t.append(ae,J):J.def(de,".",Kt)}var Re=Ie(Oc),Qe=Ie(qm),qe=ce();if(typeof qe=="number"){if(qe===0)return}else he("if(",qe,"){"),he.exit("}");var zt,bn;wt&&(zt=Ie(Km),bn=ae.instancing);var Jt=oe+".type",qt=Se.elements&&Ou(Se.elements)&&!Se.vaoActive;function tt(){function Kt(){he(bn,".drawElementsInstancedANGLE(",[Re,qe,Jt,Qe+"<<(("+Jt+"-"+sh+")>>1)",zt],");")}function $t(){he(bn,".drawArraysInstancedANGLE(",[Re,Qe,qe,zt],");")}oe&&oe!=="null"?qt?Kt():(he("if(",oe,"){"),Kt(),he("}else{"),$t(),he("}")):$t()}function Ze(){function Kt(){he(me+".drawElements("+[Re,qe,Jt,Qe+"<<(("+Jt+"-"+sh+")>>1)"]+");")}function $t(){he(me+".drawArrays("+[Re,Qe,qe]+");")}oe&&oe!=="null"?qt?Kt():(he("if(",oe,"){"),Kt(),he("}else{"),$t(),he("}")):$t()}wt&&(typeof zt!="number"||zt>=0)?typeof zt=="string"?(he("if(",zt,">0){"),tt(),he("}else if(",zt,"<0){"),Ze(),he("}")):tt():Ze()}function Fn(ae,J,he,Ae,Ce){var me=Mn(),de=me.proc("body",Ce);return I.optional(function(){me.commandStr=J.commandStr,me.command=me.link(J.commandStr)}),wt&&(me.instancing=de.def(me.shared.extensions,".angle_instanced_arrays")),ae(me,de,he,Ae),me.compile().body}function qn(ae,J,he,Ae){Ln(ae,J),he.useVAO?he.drawVAO?J(ae.shared.vao,".setVAO(",he.drawVAO.append(ae,J),");"):J(ae.shared.vao,".setVAO(",ae.shared.vao,".targetVAO);"):(J(ae.shared.vao,".setVAO(null);"),Or(ae,J,he,Ae.attributes,function(){return!0})),ti(ae,J,he,Ae.uniforms,function(){return!0},!1),pn(ae,J,J,he)}function Hi(ae,J){var he=ae.proc("draw",1);Ln(ae,he),zi(ae,he,J.context),oi(ae,he,J.framebuffer),nr(ae,he,J),Rn(ae,he,J.state),dn(ae,he,J,!1,!0);var Ae=J.shader.progVar.append(ae,he);if(he(ae.shared.gl,".useProgram(",Ae,".program);"),J.shader.program)qn(ae,he,J,J.shader.program);else{he(ae.shared.vao,".setVAO(null);");var Ce=ae.global.def("{}"),me=he.def(Ae,".id"),de=he.def(Ce,"[",me,"]");he(ae.cond(de).then(de,".call(this,a0);").else(de,"=",Ce,"[",me,"]=",ae.link(function(Se){return Fn(qn,ae,J,Se,1)}),"(",Ae,");",de,".call(this,a0);"))}Object.keys(J.state).length>0&&he(ae.shared.current,".dirty=true;"),ae.shared.vao&&he(ae.shared.vao,".setVAO(null);")}function jo(ae,J,he,Ae){ae.batchId="a1",Ln(ae,J);function Ce(){return!0}Or(ae,J,he,Ae.attributes,Ce),ti(ae,J,he,Ae.uniforms,Ce,!1),pn(ae,J,J,he)}function Bl(ae,J,he,Ae){Ln(ae,J);var Ce=he.contextDep,me=J.def(),de="a0",Se="a1",le=J.def();ae.shared.props=le,ae.batchId=me;var ce=ae.scope(),oe=ae.scope();J(ce.entry,"for(",me,"=0;",me,"<",Se,";++",me,"){",le,"=",de,"[",me,"];",oe,"}",ce.exit);function Ie(Jt){return Jt.contextDep&&Ce||Jt.propDep}function Re(Jt){return!Ie(Jt)}if(he.needsContext&&zi(ae,oe,he.context),he.needsFramebuffer&&oi(ae,oe,he.framebuffer),Rn(ae,oe,he.state,Ie),he.profile&&Ie(he.profile)&&dn(ae,oe,he,!1,!0),Ae)he.useVAO?he.drawVAO?Ie(he.drawVAO)?oe(ae.shared.vao,".setVAO(",he.drawVAO.append(ae,oe),");"):ce(ae.shared.vao,".setVAO(",he.drawVAO.append(ae,ce),");"):ce(ae.shared.vao,".setVAO(",ae.shared.vao,".targetVAO);"):(ce(ae.shared.vao,".setVAO(null);"),Or(ae,ce,he,Ae.attributes,Re),Or(ae,oe,he,Ae.attributes,Ie)),ti(ae,ce,he,Ae.uniforms,Re,!1),ti(ae,oe,he,Ae.uniforms,Ie,!0),pn(ae,ce,oe,he);else{var Qe=ae.global.def("{}"),qe=he.shader.progVar.append(ae,oe),zt=oe.def(qe,".id"),bn=oe.def(Qe,"[",zt,"]");oe(ae.shared.gl,".useProgram(",qe,".program);","if(!",bn,"){",bn,"=",Qe,"[",zt,"]=",ae.link(function(Jt){return Fn(jo,ae,he,Jt,2)}),"(",qe,");}",bn,".call(this,a0[",me,"],",me,");")}}function ue(ae,J){var he=ae.proc("batch",2);ae.batchId="0",Ln(ae,he);var Ae=!1,Ce=!0;Object.keys(J.context).forEach(function(Qe){Ae=Ae||J.context[Qe].propDep}),Ae||(zi(ae,he,J.context),Ce=!1);var me=J.framebuffer,de=!1;me?(me.propDep?Ae=de=!0:me.contextDep&&Ae&&(de=!0),de||oi(ae,he,me)):oi(ae,he,null),J.state.viewport&&J.state.viewport.propDep&&(Ae=!0);function Se(Qe){return Qe.contextDep&&Ae||Qe.propDep}nr(ae,he,J),Rn(ae,he,J.state,function(Qe){return!Se(Qe)}),(!J.profile||!Se(J.profile))&&dn(ae,he,J,!1,"a1"),J.contextDep=Ae,J.needsContext=Ce,J.needsFramebuffer=de;var le=J.shader.progVar;if(le.contextDep&&Ae||le.propDep)Bl(ae,he,J,null);else{var ce=le.append(ae,he);if(he(ae.shared.gl,".useProgram(",ce,".program);"),J.shader.program)Bl(ae,he,J,J.shader.program);else{he(ae.shared.vao,".setVAO(null);");var oe=ae.global.def("{}"),Ie=he.def(ce,".id"),Re=he.def(oe,"[",Ie,"]");he(ae.cond(Re).then(Re,".call(this,a0,a1);").else(Re,"=",oe,"[",Ie,"]=",ae.link(function(Qe){return Fn(Bl,ae,J,Qe,2)}),"(",ce,");",Re,".call(this,a0,a1);"))}}Object.keys(J.state).length>0&&he(ae.shared.current,".dirty=true;"),ae.shared.vao&&he(ae.shared.vao,".setVAO(null);")}function Ge(ae,J){var he=ae.proc("scope",3);ae.batchId="a2";var Ae=ae.shared,Ce=Ae.current;zi(ae,he,J.context),J.framebuffer&&J.framebuffer.append(ae,he),ha(Object.keys(J.state)).forEach(function(de){var Se=J.state[de],le=Se.append(ae,he);_i(le)?le.forEach(function(ce,oe){he.set(ae.next[de],"["+oe+"]",ce)}):he.set(Ae.next,"."+de,le)}),dn(ae,he,J,!0,!0),[Dc,qm,Uc,Km,Oc].forEach(function(de){var Se=J.draw[de];Se&&he.set(Ae.draw,"."+de,""+Se.append(ae,he))}),Object.keys(J.uniforms).forEach(function(de){var Se=J.uniforms[de].append(ae,he);Array.isArray(Se)&&(Se="["+Se.join()+"]"),he.set(Ae.uniforms,"["+ee.id(de)+"]",Se)}),Object.keys(J.attributes).forEach(function(de){var Se=J.attributes[de].append(ae,he),le=ae.scopeAttrib(de);Object.keys(new Me).forEach(function(ce){he.set(le,"."+ce,Se[ce])})}),J.scopeVAO&&he.set(Ae.vao,".targetVAO",J.scopeVAO.append(ae,he));function me(de){var Se=J.shader[de];Se&&he.set(Ae.shader,"."+de,Se.append(ae,he))}me(Hd),me(jd),Object.keys(J.state).length>0&&(he(Ce,".dirty=true;"),he.exit(Ce,".dirty=true;")),he("a1(",ae.shared.context,",a0,",ae.batchId,");")}function Oe(ae){if(!(typeof ae!="object"||_i(ae))){for(var J=Object.keys(ae),he=0;he<J.length;++he)if(ut.isDynamic(ae[J[he]]))return!0;return!1}}function Xt(ae,J,he){var Ae=J.static[he];if(!Ae||!Oe(Ae))return;var Ce=ae.global,me=Object.keys(Ae),de=!1,Se=!1,le=!1,ce=ae.global.def("{}");me.forEach(function(Ie){var Re=Ae[Ie];if(ut.isDynamic(Re)){typeof Re=="function"&&(Re=Ae[Ie]=ut.unbox(Re));var Qe=Cs(Re,null);de=de||Qe.thisDep,le=le||Qe.propDep,Se=Se||Qe.contextDep}else{switch(Ce(ce,".",Ie,"="),typeof Re){case"number":Ce(Re);break;case"string":Ce('"',Re,'"');break;case"object":Array.isArray(Re)&&Ce("[",Re.join(),"]");break;default:Ce(ae.link(Re));break}Ce(";")}});function oe(Ie,Re){me.forEach(function(Qe){var qe=Ae[Qe];if(ut.isDynamic(qe)){var zt=Ie.invoke(Re,qe);Re(ce,".",Qe,"=",zt,";")}})}J.dynamic[he]=new ut.DynamicVariable(kd,{thisDep:de,contextDep:Se,propDep:le,ref:ce,append:oe}),delete J.static[he]}function Gn(ae,J,he,Ae,Ce){var me=Mn();me.stats=me.link(Ce),Object.keys(J.static).forEach(function(Se){Xt(me,J,Se)}),hM.forEach(function(Se){Xt(me,ae,Se)});var de=Si(ae,J,he,Ae,me);return Hi(me,de),Ge(me,de),ue(me,de),i(me.compile(),{destroy:function(){de.shader.program.destroy()}})}return{next:Gt,current:Ft,procs:function(){var ae=Mn(),J=ae.proc("poll"),he=ae.proc("refresh"),Ae=ae.block();J(Ae),he(Ae);var Ce=ae.shared,me=Ce.gl,de=Ce.next,Se=Ce.current;Ae(Se,".dirty=false;"),oi(ae,J),oi(ae,he,null,!0);var le;wt&&(le=ae.link(wt)),fe.oes_vertex_array_object&&he(ae.link(fe.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var ce=0;ce<Be.maxAttributes;++ce){var oe=he.def(Ce.attributes,"[",ce,"]"),Ie=ae.cond(oe,".buffer");Ie.then(me,".enableVertexAttribArray(",ce,");",me,".bindBuffer(",ch,",",oe,".buffer.buffer);",me,".vertexAttribPointer(",ce,",",oe,".size,",oe,".type,",oe,".normalized,",oe,".stride,",oe,".offset);").else(me,".disableVertexAttribArray(",ce,");",me,".vertexAttrib4f(",ce,",",oe,".x,",oe,".y,",oe,".z,",oe,".w);",oe,".buffer=null;"),he(Ie),wt&&he(le,".vertexAttribDivisorANGLE(",ce,",",oe,".divisor);")}return he(ae.shared.vao,".currentVAO=null;",ae.shared.vao,".setVAO(",ae.shared.vao,".targetVAO);"),Object.keys(lt).forEach(function(Re){var Qe=lt[Re],qe=Ae.def(de,".",Re),zt=ae.block();zt("if(",qe,"){",me,".enable(",Qe,")}else{",me,".disable(",Qe,")}",Se,".",Re,"=",qe,";"),he(zt),J("if(",qe,"!==",Se,".",Re,"){",zt,"}")}),Object.keys(it).forEach(function(Re){var Qe=it[Re],qe=Ft[Re],zt,bn,Jt=ae.block();if(Jt(me,".",Qe,"("),_i(qe)){var qt=qe.length;zt=ae.global.def(de,".",Re),bn=ae.global.def(Se,".",Re),Jt(an(qt,function(tt){return zt+"["+tt+"]"}),");",an(qt,function(tt){return bn+"["+tt+"]="+zt+"["+tt+"];"}).join("")),J("if(",an(qt,function(tt){return zt+"["+tt+"]!=="+bn+"["+tt+"]"}).join("||"),"){",Jt,"}")}else zt=Ae.def(de,".",Re),bn=Ae.def(Se,".",Re),Jt(zt,");",Se,".",Re,"=",zt,";"),J("if(",zt,"!==",bn,"){",Jt,"}");he(Jt)}),ae.compile()}(),compile:Gn}}function _M(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var bM=34918,yo=34919,Ty=35007,SM=function(L,ee){if(!ee.ext_disjoint_timer_query)return null;var fe=[];function Be(){return fe.pop()||ee.ext_disjoint_timer_query.createQueryEXT()}function nt(wt){fe.push(wt)}var Le=[];function He(wt){var Wt=Be();ee.ext_disjoint_timer_query.beginQueryEXT(Ty,Wt),Le.push(Wt),dt(Le.length-1,Le.length,wt)}function yt(){ee.ext_disjoint_timer_query.endQueryEXT(Ty)}function mt(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Ct=[];function xt(){return Ct.pop()||new mt}function gt(wt){Ct.push(wt)}var ht=[];function dt(wt,Wt,pt){var Ft=xt();Ft.startQueryIndex=wt,Ft.endQueryIndex=Wt,Ft.sum=0,Ft.stats=pt,ht.push(Ft)}var bt=[],Me=[];function je(){var wt,Wt,pt=Le.length;if(pt!==0){Me.length=Math.max(Me.length,pt+1),bt.length=Math.max(bt.length,pt+1),bt[0]=0,Me[0]=0;var Ft=0;for(wt=0,Wt=0;Wt<Le.length;++Wt){var Gt=Le[Wt];ee.ext_disjoint_timer_query.getQueryObjectEXT(Gt,yo)?(Ft+=ee.ext_disjoint_timer_query.getQueryObjectEXT(Gt,bM),nt(Gt)):Le[wt++]=Gt,bt[Wt+1]=Ft,Me[Wt+1]=wt}for(Le.length=wt,wt=0,Wt=0;Wt<ht.length;++Wt){var hn=ht[Wt],lt=hn.startQueryIndex,it=hn.endQueryIndex;hn.sum+=bt[it]-bt[lt];var Zt=Me[lt],Pt=Me[it];Pt===Zt?(hn.stats.gpuTime+=hn.sum/1e6,gt(hn)):(hn.startQueryIndex=Zt,hn.endQueryIndex=Pt,ht[wt++]=hn)}ht.length=wt}}return{beginQuery:He,endQuery:yt,pushScopeStats:dt,update:je,getNumPendingQueries:function(){return Le.length},clear:function(){fe.push.apply(fe,Le);for(var wt=0;wt<fe.length;wt++)ee.ext_disjoint_timer_query.deleteQueryEXT(fe[wt]);Le.length=0,fe.length=0},restore:function(){Le.length=0,fe.length=0}}},My=16384,EM=256,wM=1024,AM=34962,dh="webglcontextlost",da="webglcontextrestored",pa=1,lS=2,ph=3;function Ic(L,ee){for(var fe=0;fe<L.length;++fe)if(L[fe]===ee)return fe;return-1}function cg(L){var ee=vn(L);if(!ee)return null;var fe=ee.gl,Be=fe.getContextAttributes(),nt=fe.isContextLost(),Le=Un(fe,ee);if(!Le)return null;var He=Vn(),yt=_M(),mt=Le.extensions,Ct=SM(fe,mt),xt=un(),gt=fe.drawingBufferWidth,ht=fe.drawingBufferHeight,dt={tick:0,time:0,viewportWidth:gt,viewportHeight:ht,framebufferWidth:gt,framebufferHeight:ht,drawingBufferWidth:gt,drawingBufferHeight:ht,pixelRatio:ee.pixelRatio},bt={},Me={elements:null,primitive:4,count:-1,offset:0,instances:-1},je=qs(fe,mt),wt=Sd(fe,yt,ee,Ft),Wt=Rv(fe,mt,wt,yt),pt=ey(fe,mt,je,yt,wt,Wt,Me);function Ft(pn){return pt.destroyBuffer(pn)}var Gt=Fb(fe,He,yt,ee),hn=wb(fe,mt,je,function(){Zt.procs.poll()},dt,yt,ee),lt=Rb(fe,mt,je,yt,ee),it=Jv(fe,mt,je,hn,lt,yt),Zt=Ay(fe,He,mt,je,wt,Wt,hn,it,bt,pt,Gt,Me,dt,Ct,ee),Pt=ny(fe,it,Zt.procs.poll,dt,Be,mt,je),St=Zt.next,Ut=fe.canvas,Lt=[],Cn=[],Mn=[],kt=[ee.onDestroy],jt=null;function yn(){if(Lt.length===0){Ct&&Ct.update(),jt=null;return}jt=xn.next(yn),Rn();for(var pn=Lt.length-1;pn>=0;--pn){var Fn=Lt[pn];Fn&&Fn(dt,null,0)}fe.flush(),Ct&&Ct.update()}function wn(){!jt&&Lt.length>0&&(jt=xn.next(yn))}function In(){jt&&(xn.cancel(yn),jt=null)}function Ui(pn){pn.preventDefault(),nt=!0,In(),Cn.forEach(function(Fn){Fn()})}function Ai(pn){fe.getError(),nt=!1,Le.restore(),Gt.restore(),wt.restore(),hn.restore(),lt.restore(),it.restore(),pt.restore(),Ct&&Ct.restore(),Zt.procs.refresh(),wn(),Mn.forEach(function(Fn){Fn()})}Ut&&(Ut.addEventListener(dh,Ui,!1),Ut.addEventListener(da,Ai,!1));function jn(){Lt.length=0,In(),Ut&&(Ut.removeEventListener(dh,Ui),Ut.removeEventListener(da,Ai)),Gt.clear(),it.clear(),lt.clear(),pt.clear(),hn.clear(),Wt.clear(),wt.clear(),Ct&&Ct.clear(),kt.forEach(function(pn){pn()})}function tr(pn){I(!!pn,"invalid args to regl({...})"),I.type(pn,"object","invalid args to regl({...})");function Fn(Ce){var me=i({},Ce);delete me.uniforms,delete me.attributes,delete me.context,delete me.vao,"stencil"in me&&me.stencil.op&&(me.stencil.opBack=me.stencil.opFront=me.stencil.op,delete me.stencil.op);function de(Se){if(Se in me){var le=me[Se];delete me[Se],Object.keys(le).forEach(function(ce){me[Se+"."+ce]=le[ce]})}}return de("blend"),de("depth"),de("cull"),de("stencil"),de("polygonOffset"),de("scissor"),de("sample"),"vao"in Ce&&(me.vao=Ce.vao),me}function qn(Ce,me){var de={},Se={};return Object.keys(Ce).forEach(function(le){var ce=Ce[le];if(ut.isDynamic(ce)){Se[le]=ut.unbox(ce,le);return}else if(me&&Array.isArray(ce)){for(var oe=0;oe<ce.length;++oe)if(ut.isDynamic(ce[oe])){Se[le]=ut.unbox(ce,le);return}}de[le]=ce}),{dynamic:Se,static:de}}var Hi=qn(pn.context||{},!0),jo=qn(pn.uniforms||{},!0),Bl=qn(pn.attributes||{},!1),ue=qn(Fn(pn),!1),Ge={gpuTime:0,cpuTime:0,count:0},Oe=Zt.compile(ue,Bl,jo,Hi,Ge),Xt=Oe.draw,Gn=Oe.batch,ae=Oe.scope,J=[];function he(Ce){for(;J.length<Ce;)J.push(null);return J}function Ae(Ce,me){var de;if(nt&&I.raise("context lost"),typeof Ce=="function")return ae.call(this,null,Ce,0);if(typeof me=="function")if(typeof Ce=="number")for(de=0;de<Ce;++de)ae.call(this,null,me,de);else if(Array.isArray(Ce))for(de=0;de<Ce.length;++de)ae.call(this,Ce[de],me,de);else return ae.call(this,Ce,me,0);else if(typeof Ce=="number"){if(Ce>0)return Gn.call(this,he(Ce|0),Ce|0)}else if(Array.isArray(Ce)){if(Ce.length)return Gn.call(this,Ce,Ce.length)}else return Xt.call(this,Ce)}return i(Ae,{stats:Ge,destroy:function(){Oe.destroy()}})}var Ti=it.setFBO=tr({framebuffer:ut.define.call(null,pa,"framebuffer")});function Si(pn,Fn){var qn=0;Zt.procs.poll();var Hi=Fn.color;Hi&&(fe.clearColor(+Hi[0]||0,+Hi[1]||0,+Hi[2]||0,+Hi[3]||0),qn|=My),"depth"in Fn&&(fe.clearDepth(+Fn.depth),qn|=EM),"stencil"in Fn&&(fe.clearStencil(Fn.stencil|0),qn|=wM),I(!!qn,"called regl.clear with no buffer specified"),fe.clear(qn)}function zi(pn){if(I(typeof pn=="object"&&pn,"regl.clear() takes an object as input"),"framebuffer"in pn)if(pn.framebuffer&&pn.framebuffer_reglType==="framebufferCube")for(var Fn=0;Fn<6;++Fn)Ti(i({framebuffer:pn.framebuffer.faces[Fn]},pn),Si);else Ti(pn,Si);else Si(null,pn)}function oi(pn){I.type(pn,"function","regl.frame() callback must be a function"),Lt.push(pn);function Fn(){var qn=Ic(Lt,pn);I(qn>=0,"cannot cancel a frame twice");function Hi(){var jo=Ic(Lt,Hi);Lt[jo]=Lt[Lt.length-1],Lt.length-=1,Lt.length<=0&&In()}Lt[qn]=Hi}return wn(),{cancel:Fn}}function nr(){var pn=St.viewport,Fn=St.scissor_box;pn[0]=pn[1]=Fn[0]=Fn[1]=0,dt.viewportWidth=dt.framebufferWidth=dt.drawingBufferWidth=pn[2]=Fn[2]=fe.drawingBufferWidth,dt.viewportHeight=dt.framebufferHeight=dt.drawingBufferHeight=pn[3]=Fn[3]=fe.drawingBufferHeight}function Rn(){dt.tick+=1,dt.time=dn(),nr(),Zt.procs.poll()}function Ln(){hn.refresh(),nr(),Zt.procs.refresh(),Ct&&Ct.update()}function dn(){return(un()-xt)/1e3}Ln();function Or(pn,Fn){I.type(Fn,"function","listener callback must be a function");var qn;switch(pn){case"frame":return oi(Fn);case"lost":qn=Cn;break;case"restore":qn=Mn;break;case"destroy":qn=kt;break;default:I.raise("invalid event, must be one of frame,lost,restore,destroy")}return qn.push(Fn),{cancel:function(){for(var Hi=0;Hi<qn.length;++Hi)if(qn[Hi]===Fn){qn[Hi]=qn[qn.length-1],qn.pop();return}}}}var ti=i(tr,{clear:zi,prop:ut.define.bind(null,pa),context:ut.define.bind(null,lS),this:ut.define.bind(null,ph),draw:tr({}),buffer:function(pn){return wt.create(pn,AM,!1,!1)},elements:function(pn){return Wt.create(pn,!1)},texture:hn.create2D,cube:hn.createCube,renderbuffer:lt.create,framebuffer:it.create,framebufferCube:it.createCube,vao:pt.createVAO,attributes:Be,frame:oi,on:Or,limits:je,hasExtension:function(pn){return je.extensions.indexOf(pn.toLowerCase())>=0},read:Pt,destroy:jn,_gl:fe,_refresh:Ln,poll:function(){Rn(),Ct&&Ct.update()},now:dn,stats:yt});return ee.onDone(null,ti),ti}return cg})}(YD)),YD.exports}var Ove=Dve();const Uve=dI(Ove),zve="#b3b3b3",Ive=void 0,Lve=void 0,Pve=4,Nve="#666666",Bve=.1,kve=1,Fve="#222222",Nn={enableSimulation:!0,spaceSize:8192,pointSizeScale:1,linkWidthScale:1,arrowSizeScale:1,renderLinks:!0,curvedLinks:!1,curvedLinkSegments:19,curvedLinkWeight:.8,curvedLinkControlPointDistance:.5,arrowLinks:!1,linkVisibilityDistanceRange:[50,150],linkVisibilityMinTransparency:.25,hoveredPointCursor:"auto",renderHoveredPointRing:!1,hoveredPointRingColor:"white",focusedPointRingColor:"white",focusedPointIndex:void 0,useClassicQuadtree:!1,simulation:{decay:5e3,gravity:.25,center:0,repulsion:1,repulsionTheta:1.15,repulsionQuadtreeLevels:12,linkSpring:1,linkDistance:10,linkDistRandomVariationRange:[1,1.2],repulsionFromMouse:2,friction:.85,cluster:.1},showFPSMonitor:!1,pixelRatio:2,scalePointsOnZoom:!1,scaleLinksOnZoom:!1,enableZoom:!0,enableSimulationDuringZoom:!1,enableDrag:!1,fitViewOnInit:!0,fitViewDelay:250,fitViewPadding:.1,fitViewDuration:250,pointSamplingDistance:150,attribution:"",rescalePositions:void 0,enableRightClickRepulsion:!1},Gve=.7,Vve=.95,Hve=3,jve=t=>typeof t=="function",I7=t=>Array.isArray(t),Wve=t=>t instanceof Object,Xve=t=>t instanceof Object?t.constructor.name!=="Function"&&t.constructor.name!=="Object":!1,nB=t=>Wve(t)&&!I7(t)&&!jve(t)&&!Xve(t);function jp(t){let e;if(I7(t))e=t;else{const n=ud(t),i=n==null?void 0:n.rgb();e=[(i==null?void 0:i.r)||0,(i==null?void 0:i.g)||0,(i==null?void 0:i.b)||0,(n==null?void 0:n.opacity)??1]}return[e[0]/255,e[1]/255,e[2]/255,e[3]]}function Yve(t,e,n){return .2126*t+.7152*e+.0722*n}function Vu(t,e){let n=new Float32Array;return t({framebuffer:e})(()=>{n=t.read()}),n}function Zve(t,e,n){return Math.min(Math.max(t,e),n)}function Gu(t){return t!=null&&!Number.isNaN(t)}class qve{constructor(){this.enableSimulation=Nn.enableSimulation,this.backgroundColor=Fve,this.spaceSize=Nn.spaceSize,this.pointColor=zve,this.pointGreyoutOpacity=Ive,this.pointGreyoutColor=Lve,this.pointSize=Pve,this.pointSizeScale=Nn.pointSizeScale,this.hoveredPointCursor=Nn.hoveredPointCursor,this.renderHoveredPointRing=Nn.renderHoveredPointRing,this.hoveredPointRingColor=Nn.hoveredPointRingColor,this.focusedPointRingColor=Nn.focusedPointRingColor,this.focusedPointIndex=Nn.focusedPointIndex,this.linkColor=Nve,this.linkGreyoutOpacity=Bve,this.linkWidth=kve,this.linkWidthScale=Nn.linkWidthScale,this.renderLinks=Nn.renderLinks,this.curvedLinks=Nn.curvedLinks,this.curvedLinkSegments=Nn.curvedLinkSegments,this.curvedLinkWeight=Nn.curvedLinkWeight,this.curvedLinkControlPointDistance=Nn.curvedLinkControlPointDistance,this.linkArrows=Nn.arrowLinks,this.linkArrowsSizeScale=Nn.arrowSizeScale,this.scaleLinksOnZoom=Nn.scaleLinksOnZoom,this.linkVisibilityDistanceRange=Nn.linkVisibilityDistanceRange,this.linkVisibilityMinTransparency=Nn.linkVisibilityMinTransparency,this.useClassicQuadtree=Nn.useClassicQuadtree,this.simulationDecay=Nn.simulation.decay,this.simulationGravity=Nn.simulation.gravity,this.simulationCenter=Nn.simulation.center,this.simulationRepulsion=Nn.simulation.repulsion,this.simulationRepulsionTheta=Nn.simulation.repulsionTheta,this.simulationRepulsionQuadtreeLevels=Nn.simulation.repulsionQuadtreeLevels,this.simulationLinkSpring=Nn.simulation.linkSpring,this.simulationLinkDistance=Nn.simulation.linkDistance,this.simulationLinkDistRandomVariationRange=Nn.simulation.linkDistRandomVariationRange,this.simulationRepulsionFromMouse=Nn.simulation.repulsionFromMouse,this.enableRightClickRepulsion=Nn.enableRightClickRepulsion,this.simulationFriction=Nn.simulation.friction,this.simulationCluster=Nn.simulation.cluster,this.onSimulationStart=void 0,this.onSimulationTick=void 0,this.onSimulationEnd=void 0,this.onSimulationPause=void 0,this.onSimulationRestart=void 0,this.onClick=void 0,this.onMouseMove=void 0,this.onPointMouseOver=void 0,this.onPointMouseOut=void 0,this.onZoomStart=void 0,this.onZoom=void 0,this.onZoomEnd=void 0,this.onDragStart=void 0,this.onDrag=void 0,this.onDragEnd=void 0,this.showFPSMonitor=Nn.showFPSMonitor,this.pixelRatio=Nn.pixelRatio,this.scalePointsOnZoom=Nn.scalePointsOnZoom,this.initialZoomLevel=void 0,this.enableZoom=Nn.enableZoom,this.enableSimulationDuringZoom=Nn.enableSimulationDuringZoom,this.enableDrag=Nn.enableDrag,this.fitViewOnInit=Nn.fitViewOnInit,this.fitViewDelay=Nn.fitViewDelay,this.fitViewPadding=Nn.fitViewPadding,this.fitViewDuration=Nn.fitViewDuration,this.fitViewByPointsInRect=void 0,this.randomSeed=void 0,this.pointSamplingDistance=Nn.pointSamplingDistance,this.attribution=Nn.attribution,this.rescalePositions=Nn.rescalePositions}init(e){Object.keys(e).forEach(n=>{this.deepMergeConfig(this.getConfig(),e,n)})}deepMergeConfig(e,n,i){nB(e[i])&&nB(n[i])?Object.keys(n[i]).forEach(r=>{this.deepMergeConfig(e[i],n[i],r)}):e[i]=n[i]}getConfig(){return this}}class Gf{constructor(e,n,i,r,s){this.reglInstance=e,this.config=n,this.store=i,this.data=r,s&&(this.points=s)}}var Kve=`#ifdef GL_ES
precision highp float;
#endif

varying vec4 rgba;

void main() {
  gl_FragColor = rgba;
}`,Qve=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform float pointsTextureSize;

attribute vec2 pointIndices;

varying vec4 rgba;

void main() {
  vec4 pointPosition = texture2D(positionsTexture, pointIndices / pointsTextureSize);
  rgba = vec4(pointPosition.xy, 1.0, 0.0);

  gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
  gl_PointSize = 1.0;
}`,Jve=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform sampler2D centermassTexture;
uniform float centerForce;
uniform float alpha;

varying vec2 textureCoords;

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);
  vec4 velocity = vec4(0.0);
  vec4 centermassValues = texture2D(centermassTexture, vec2(0.0));
  vec2 centermassPosition = centermassValues.xy / centermassValues.b;
  vec2 distVector = centermassPosition - pointPosition.xy;
  float dist = sqrt(dot(distVector, distVector));
  if (dist > 0.0) {
    float angle = atan(distVector.y, distVector.x);
    float addV = alpha * centerForce * dist * 0.01;
    velocity.rg += addV * vec2(cos(angle), sin(angle));
  }

  gl_FragColor = velocity;
}`;function os(t){return{buffer:t.buffer(new Float32Array([-1,-1,1,-1,-1,1,1,1])),size:2}}function Wp(t){const e=new Float32Array(t*t*2);for(let n=0;n<t;n++)for(let i=0;i<t;i++){const r=n*t*2+i*2;e[r+0]=i,e[r+1]=n}return e}var am=`#ifdef GL_ES
precision highp float;
#endif

void main() {
  gl_FragColor = vec4(0.0);
}`,vs=`#ifdef GL_ES
precision highp float;
#endif

attribute vec2 vertexCoord; 
varying vec2 textureCoords; 

void main() {
    
    textureCoords = (vertexCoord + 1.0) / 2.0;
    gl_Position = vec4(vertexCoord, 0, 1);
}`;class $ve extends Gf{create(){const{reglInstance:e,store:n}=this;this.centermassTexture||(this.centermassTexture=e.texture()),this.centermassTexture({data:new Float32Array(4).fill(0),shape:[1,1,4],type:"float"}),this.centermassFbo||(this.centermassFbo=e.framebuffer()),this.centermassFbo({color:this.centermassTexture,depth:!1,stencil:!1}),this.pointIndices||(this.pointIndices=e.buffer(0)),this.pointIndices(Wp(n.pointsTextureSize))}initPrograms(){const{reglInstance:e,config:n,store:i,data:r,points:s}=this;this.clearCentermassCommand||(this.clearCentermassCommand=e({frag:am,vert:vs,framebuffer:()=>this.centermassFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)}})),this.calculateCentermassCommand||(this.calculateCentermassCommand=e({frag:Kve,vert:Qve,framebuffer:()=>this.centermassFbo,primitive:"points",count:()=>r.pointsNumber??0,attributes:{pointIndices:{buffer:this.pointIndices,size:2}},uniforms:{positionsTexture:()=>s==null?void 0:s.previousPositionFbo,pointsTextureSize:()=>i.pointsTextureSize},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.runCommand||(this.runCommand=e({frag:Jve,vert:vs,framebuffer:()=>s==null?void 0:s.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>s==null?void 0:s.previousPositionFbo,centermassTexture:()=>this.centermassFbo,centerForce:()=>n.simulationCenter,alpha:()=>i.alpha}}))}run(){var e,n,i;(e=this.clearCentermassCommand)==null||e.call(this),(n=this.calculateCentermassCommand)==null||n.call(this),(i=this.runCommand)==null||i.call(this)}}var eye=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform float gravity;
uniform float spaceSize;
uniform float alpha;

varying vec2 textureCoords;

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);

  vec4 velocity = vec4(0.0);

  vec2 centerPosition = vec2(spaceSize / 2.0);
  vec2 distVector = centerPosition - pointPosition.rg;
  float dist = sqrt(dot(distVector, distVector));
  if (dist > 0.0) {
    float angle = atan(distVector.y, distVector.x);
    float additionalVelocity = alpha * gravity * dist * 0.1;
    velocity.rg += additionalVelocity * vec2(cos(angle), sin(angle));
  }

  gl_FragColor = velocity;
}`;class tye extends Gf{initPrograms(){const{reglInstance:e,config:n,store:i,points:r}=this;this.runCommand||(this.runCommand=e({frag:eye,vert:vs,framebuffer:()=>r==null?void 0:r.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>r==null?void 0:r.previousPositionFbo,gravity:()=>n.simulationGravity,spaceSize:()=>i.adjustedSpaceSize,alpha:()=>i.alpha}}))}run(){var e;(e=this.runCommand)==null||e.call(this)}}function nye(t){return`
#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform float linkSpring;
uniform float linkDistance;
uniform vec2 linkDistRandomVariationRange;

uniform sampler2D linkInfoTexture; // Texture storing first link indices and amount
uniform sampler2D linkIndicesTexture;
uniform sampler2D linkPropertiesTexture; // Texture storing link bias and strength
uniform sampler2D linkRandomDistanceTexture;

uniform float pointsTextureSize;
uniform float linksTextureSize;
uniform float alpha;

varying vec2 textureCoords;

const float MAX_LINKS = ${t}.0;

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);
  vec4 velocity = vec4(0.0);

  vec4 linkInfo = texture2D(linkInfoTexture, textureCoords);
  float iCount = linkInfo.r;
  float jCount = linkInfo.g;
  float linkAmount = linkInfo.b;
  if (linkAmount > 0.0) {
    for (float i = 0.0; i < MAX_LINKS; i += 1.0) {
      if (i < linkAmount) {
        if (iCount >= linksTextureSize) {
          iCount = 0.0;
          jCount += 1.0;
        }
        vec2 linkTextureIndex = (vec2(iCount, jCount) + 0.5) / linksTextureSize;
        vec4 connectedPointIndex = texture2D(linkIndicesTexture, linkTextureIndex);
        vec4 biasAndStrength = texture2D(linkPropertiesTexture, linkTextureIndex);
        vec4 randomMinDistance = texture2D(linkRandomDistanceTexture, linkTextureIndex);
        float bias = biasAndStrength.r;
        float strength = biasAndStrength.g;
        float randomMinLinkDist = randomMinDistance.r * (linkDistRandomVariationRange.g - linkDistRandomVariationRange.r) + linkDistRandomVariationRange.r;
        randomMinLinkDist *= linkDistance;

        iCount += 1.0;

        vec4 connectedPointPosition = texture2D(positionsTexture, (connectedPointIndex.rg + 0.5) / pointsTextureSize);
        float x = connectedPointPosition.x - (pointPosition.x + velocity.x);
        float y = connectedPointPosition.y - (pointPosition.y + velocity.y);
        float l = sqrt(x * x + y * y);

        // Apply the link force
        l = max(l, randomMinLinkDist * 0.99);
        l = (l - randomMinLinkDist) / l;
        l *= linkSpring * alpha;
        l *= strength;
        l *= bias;
        x *= l;
        y *= l;
        velocity.x += x;
        velocity.y += y;
      }
    }
  }

  gl_FragColor = vec4(velocity.rg, 0.0, 0.0);
}
  `}var ZD=(t=>(t.OUTGOING="outgoing",t.INCOMING="incoming",t))(ZD||{});class iB extends Gf{constructor(){super(...arguments),this.linkFirstIndicesAndAmount=new Float32Array,this.indices=new Float32Array,this.maxPointDegree=0}create(e){const{reglInstance:n,store:{pointsTextureSize:i,linksTextureSize:r},data:s}=this;if(!i||!r)return;this.linkFirstIndicesAndAmount=new Float32Array(i*i*4),this.indices=new Float32Array(r*r*4);const a=new Float32Array(r*r*4),o=new Float32Array(r*r*4),l=e==="incoming"?s.sourceIndexToTargetIndices:s.targetIndexToSourceIndices;this.maxPointDegree=0;let u=0;l==null||l.forEach((c,h)=>{c&&(this.linkFirstIndicesAndAmount[h*4+0]=u%r,this.linkFirstIndicesAndAmount[h*4+1]=Math.floor(u/r),this.linkFirstIndicesAndAmount[h*4+2]=c.length??0,c.forEach(([d,m])=>{var v,_,y;this.indices[u*4+0]=d%i,this.indices[u*4+1]=Math.floor(d/i);const g=((v=s.degree)==null?void 0:v[d])??0,x=((_=s.degree)==null?void 0:_[h])??0,S=g+x,E=S!==0?g/S:.5,A=Math.min(g,x);let T=((y=s.linkStrength)==null?void 0:y[m])??1/Math.max(A,1);T=Math.sqrt(T),a[u*4+0]=E,a[u*4+1]=T,o[u*4]=this.store.getRandomFloat(0,1),u+=1}),this.maxPointDegree=Math.max(this.maxPointDegree,c.length??0))}),this.linkFirstIndicesAndAmountTexture||(this.linkFirstIndicesAndAmountTexture=n.texture()),this.linkFirstIndicesAndAmountTexture({data:this.linkFirstIndicesAndAmount,shape:[i,i,4],type:"float"}),this.linkFirstIndicesAndAmountFbo||(this.linkFirstIndicesAndAmountFbo=n.framebuffer()),this.linkFirstIndicesAndAmountFbo({color:this.linkFirstIndicesAndAmountTexture,depth:!1,stencil:!1}),this.indicesTexture||(this.indicesTexture=n.texture()),this.indicesTexture({data:this.indices,shape:[r,r,4],type:"float"}),this.indicesFbo||(this.indicesFbo=n.framebuffer()),this.indicesFbo({color:this.indicesTexture,depth:!1,stencil:!1}),this.biasAndStrengthTexture||(this.biasAndStrengthTexture=n.texture()),this.biasAndStrengthTexture({data:a,shape:[r,r,4],type:"float"}),this.biasAndStrengthFbo||(this.biasAndStrengthFbo=n.framebuffer()),this.biasAndStrengthFbo({color:this.biasAndStrengthTexture,depth:!1,stencil:!1}),this.randomDistanceTexture||(this.randomDistanceTexture=n.texture()),this.randomDistanceTexture({data:o,shape:[r,r,4],type:"float"}),this.randomDistanceFbo||(this.randomDistanceFbo=n.framebuffer()),this.randomDistanceFbo({color:this.randomDistanceTexture,depth:!1,stencil:!1})}initPrograms(){const{reglInstance:e,config:n,store:i,points:r}=this;this.runCommand||(this.runCommand=e({frag:()=>nye(this.maxPointDegree),vert:vs,framebuffer:()=>r==null?void 0:r.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>r==null?void 0:r.previousPositionFbo,linkSpring:()=>n.simulationLinkSpring,linkDistance:()=>n.simulationLinkDistance,linkDistRandomVariationRange:()=>n.simulationLinkDistRandomVariationRange,linkInfoTexture:()=>this.linkFirstIndicesAndAmountFbo,linkIndicesTexture:()=>this.indicesFbo,linkPropertiesTexture:()=>this.biasAndStrengthFbo,linkRandomDistanceTexture:()=>this.randomDistanceFbo,pointsTextureSize:()=>i.pointsTextureSize,linksTextureSize:()=>i.linksTextureSize,alpha:()=>i.alpha}}))}run(){var e;(e=this.runCommand)==null||e.call(this)}}var L7=`#ifdef GL_ES
precision highp float;
#endif

varying vec4 rgba;

void main() {
  gl_FragColor = rgba;
}`,P7=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform float pointsTextureSize;
uniform float levelTextureSize;
uniform float cellSize;

attribute vec2 pointIndices;

varying vec4 rgba;

void main() {
  vec4 pointPosition = texture2D(positionsTexture, pointIndices / pointsTextureSize);
  rgba = vec4(pointPosition.rg, 1.0, 0.0);

  float n = floor(pointPosition.x / cellSize);
  float m = floor(pointPosition.y / cellSize);
  
  vec2 levelPosition = 2.0 * (vec2(n, m) + 0.5) / levelTextureSize - 1.0;

  gl_Position = vec4(levelPosition, 0.0, 1.0);
  gl_PointSize = 1.0;
}`,iye=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform sampler2D levelFbo;

uniform float level;
uniform float levels;
uniform float levelTextureSize;
uniform float repulsion;
uniform float alpha;
uniform float spaceSize;
uniform float theta;

varying vec2 textureCoords;

const float MAX_LEVELS_NUM = 14.0;

vec2 calculateAdditionalVelocity (vec2 ij, vec2 pp) {
  vec2 add = vec2(0.0);
  vec4 centermass = texture2D(levelFbo, ij);
  if (centermass.r > 0.0 && centermass.g > 0.0 && centermass.b > 0.0) {
    vec2 centermassPosition = vec2(centermass.rg / centermass.b);
    vec2 distVector = pp - centermassPosition;
    float l = dot(distVector, distVector);
    float dist = sqrt(l);
    if (l > 0.0) {
      float c = alpha * repulsion * centermass.b;

      float distanceMin2 = 1.0;
      if (l < distanceMin2) l = sqrt(distanceMin2 * l);
      float addV = c / sqrt(l);
      add = addV * normalize(distVector);
    }
  }
  return add;
}

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);
  float x = pointPosition.x;
  float y = pointPosition.y;

  float left = 0.0;
  float top = 0.0;
  float right = spaceSize;
  float bottom = spaceSize;

  float n_left = 0.0;
  float n_top = 0.0;
  float n_right = 0.0;
  float n_bottom = 0.0;

  float cellSize = 0.0;

  
  for (float i = 0.0; i < MAX_LEVELS_NUM; i += 1.0) {
    if (i <= level) {
      left += cellSize * n_left;
      top += cellSize * n_top;
      right -= cellSize * n_right;
      bottom -= cellSize * n_bottom;

      cellSize = pow(2.0 , levels - i - 1.0);

      float dist_left = x - left;
      n_left = max(0.0, floor(dist_left / cellSize - theta));

      float dist_top = y - top;
      n_top = max(0.0, floor(dist_top / cellSize - theta));
      
      float dist_right = right - x;
      n_right = max(0.0, floor(dist_right / cellSize - theta));

      float dist_bottom = bottom - y;
      n_bottom = max(0.0, floor(dist_bottom / cellSize - theta));

    }
  }

  vec4 velocity = vec4(vec2(0.0), 1.0, 0.0);

  
  for (float i = 0.0; i < 12.0; i += 1.0) {
    for (float j = 0.0; j < 4.0; j += 1.0) {
      float n = left + cellSize * j;
      float m = top + cellSize * n_top + cellSize * i;

      if (n < (left + n_left * cellSize) && m < bottom) {
        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);
      }

      n = left + cellSize * i;
      m = top + cellSize * j;

      if (n < (right - n_right * cellSize) && m < (top + n_top * cellSize)) {
        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);
      }

      n = right - n_right * cellSize + cellSize * j;
      m = top + cellSize * i;

      if (n < right && m < (bottom - n_bottom * cellSize)) {
        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);
      }

      n = left + n_left * cellSize + cellSize * i;
      m = bottom - n_bottom * cellSize + cellSize * j;

      if (n < right && m < bottom) {
        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);
      }
    }
  }

  gl_FragColor = velocity;
}`,rye=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform sampler2D levelFbo;
uniform sampler2D randomValues;

uniform float levelTextureSize;
uniform float repulsion;
uniform float alpha;

varying vec2 textureCoords;

vec2 calculateAdditionalVelocity (vec2 ij, vec2 pp) {
  vec2 add = vec2(0.0);
  vec4 centermass = texture2D(levelFbo, ij);
  if (centermass.r > 0.0 && centermass.g > 0.0 && centermass.b > 0.0) {
    vec2 centermassPosition = vec2(centermass.rg / centermass.b);
    vec2 distVector = pp - centermassPosition;
    float l = dot(distVector, distVector);
    float dist = sqrt(l);
    if (l > 0.0) {
      float angle = atan(distVector.y, distVector.x);
      float c = alpha * repulsion * centermass.b;

      float distanceMin2 = 1.0;
      if (l < distanceMin2) l = sqrt(distanceMin2 * l);
      float addV = c / sqrt(l);
      add = addV * vec2(cos(angle), sin(angle));
    }
  }
  return add;
}

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);
  vec4 random = texture2D(randomValues, textureCoords);

  vec4 velocity = vec4(0.0);

  
  velocity.xy += calculateAdditionalVelocity(pointPosition.xy / levelTextureSize, pointPosition.xy);
  
  velocity.xy += velocity.xy * random.rg;

  gl_FragColor = velocity;
}`;class sye extends Gf{constructor(){super(...arguments),this.levelsFbos=new Map,this.quadtreeLevels=0}create(){const{reglInstance:e,store:n}=this;if(!n.pointsTextureSize)return;this.quadtreeLevels=Math.log2(n.adjustedSpaceSize);for(let r=0;r<this.quadtreeLevels;r+=1){const s=Math.pow(2,r+1);this.levelsFbos.has(`level[${r}]`)||this.levelsFbos.set(`level[${r}]`,e.framebuffer());const a=this.levelsFbos.get(`level[${r}]`);a&&a({shape:[s,s],colorType:"float",depth:!1,stencil:!1})}const i=new Float32Array(n.pointsTextureSize*n.pointsTextureSize*4);for(let r=0;r<n.pointsTextureSize*n.pointsTextureSize;++r)i[r*4]=n.getRandomFloat(-1,1)*1e-5,i[r*4+1]=n.getRandomFloat(-1,1)*1e-5;this.randomValuesTexture||(this.randomValuesTexture=e.texture()),this.randomValuesTexture({data:i,shape:[n.pointsTextureSize,n.pointsTextureSize,4],type:"float"}),this.randomValuesFbo||(this.randomValuesFbo=e.framebuffer()),this.randomValuesFbo({color:this.randomValuesTexture,depth:!1,stencil:!1}),this.pointIndices||(this.pointIndices=e.buffer(0)),this.pointIndices(Wp(n.pointsTextureSize))}initPrograms(){const{reglInstance:e,config:n,store:i,data:r,points:s}=this;this.clearLevelsCommand||(this.clearLevelsCommand=e({frag:am,vert:vs,framebuffer:(a,o)=>o.levelFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)}})),this.calculateLevelsCommand||(this.calculateLevelsCommand=e({frag:L7,vert:P7,framebuffer:(a,o)=>o.levelFbo,primitive:"points",count:()=>r.pointsNumber??0,attributes:{pointIndices:{buffer:this.pointIndices,size:2}},uniforms:{positionsTexture:()=>s==null?void 0:s.previousPositionFbo,pointsTextureSize:()=>i.pointsTextureSize,levelTextureSize:(a,o)=>o.levelTextureSize,cellSize:(a,o)=>o.cellSize},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.forceCommand||(this.forceCommand=e({frag:iye,vert:vs,framebuffer:()=>s==null?void 0:s.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>s==null?void 0:s.previousPositionFbo,level:(a,o)=>o.level,levels:this.quadtreeLevels,levelFbo:(a,o)=>o.levelFbo,levelTextureSize:(a,o)=>o.levelTextureSize,alpha:()=>i.alpha,repulsion:()=>n.simulationRepulsion,spaceSize:()=>i.adjustedSpaceSize,theta:()=>n.simulationRepulsionTheta},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.forceFromItsOwnCentermassCommand||(this.forceFromItsOwnCentermassCommand=e({frag:rye,vert:vs,framebuffer:()=>s==null?void 0:s.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>s==null?void 0:s.previousPositionFbo,randomValues:()=>this.randomValuesFbo,levelFbo:(a,o)=>o.levelFbo,levelTextureSize:(a,o)=>o.levelTextureSize,alpha:()=>i.alpha,repulsion:()=>n.simulationRepulsion,spaceSize:()=>i.adjustedSpaceSize},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.clearVelocityCommand||(this.clearVelocityCommand=e({frag:am,vert:vs,framebuffer:()=>s==null?void 0:s.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)}}))}run(){var e,n,i,r,s;const{store:a}=this;for(let o=0;o<this.quadtreeLevels;o+=1){(e=this.clearLevelsCommand)==null||e.call(this,{levelFbo:this.levelsFbos.get(`level[${o}]`)});const l=Math.pow(2,o+1),u=a.adjustedSpaceSize/l;(n=this.calculateLevelsCommand)==null||n.call(this,{levelFbo:this.levelsFbos.get(`level[${o}]`),levelTextureSize:l,cellSize:u})}(i=this.clearVelocityCommand)==null||i.call(this);for(let o=0;o<this.quadtreeLevels;o+=1){const l=Math.pow(2,o+1);(r=this.forceCommand)==null||r.call(this,{levelFbo:this.levelsFbos.get(`level[${o}]`),levelTextureSize:l,level:o}),o===this.quadtreeLevels-1&&((s=this.forceFromItsOwnCentermassCommand)==null||s.call(this,{levelFbo:this.levelsFbos.get(`level[${o}]`),levelTextureSize:l,level:o}))}}}function aye(t,e){t=Math.min(t,e);const n=e-t,i=`
    float dist = sqrt(l);
    if (dist > 0.0) {
      float c = alpha * repulsion * centermass.b;
      addVelocity += calcAdd(vec2(x, y), l, c);
      addVelocity += addVelocity * random.rg;
    }
  `;function r(s){if(s>=e)return i;{const a=Math.pow(2,s+1),o=new Array(s+1-n).fill(0).map((u,c)=>`pow(2.0, ${s-(c+n)}.0) * i${c+n}`).join("+"),l=new Array(s+1-n).fill(0).map((u,c)=>`pow(2.0, ${s-(c+n)}.0) * j${c+n}`).join("+");return`
      for (float ij${s} = 0.0; ij${s} < 4.0; ij${s} += 1.0) {
        float i${s} = 0.0;
        float j${s} = 0.0;
        if (ij${s} == 1.0 || ij${s} == 3.0) i${s} = 1.0;
        if (ij${s} == 2.0 || ij${s} == 3.0) j${s} = 1.0;
        float i = pow(2.0, ${t}.0) * n / width${s+1} + ${o};
        float j = pow(2.0, ${t}.0) * m / width${s+1} + ${l};
        float groupPosX = (i + 0.5) / ${a}.0;
        float groupPosY = (j + 0.5) / ${a}.0;
        
        vec4 centermass = texture2D(level[${s}], vec2(groupPosX, groupPosY));
        if (centermass.r > 0.0 && centermass.g > 0.0 && centermass.b > 0.0) {
          float x = centermass.r / centermass.b - pointPosition.r;
          float y = centermass.g / centermass.b - pointPosition.g;
          float l = x * x + y * y;
          if ((width${s+1} * width${s+1}) / theta < l) {
            ${i}
          } else {
            ${r(s+1)}
          }
        }
      }
      `}}return`
#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform sampler2D randomValues;
uniform float spaceSize;
uniform float repulsion;
uniform float theta;
uniform float alpha;
uniform sampler2D level[${e}];
varying vec2 textureCoords;

vec2 calcAdd(vec2 xy, float l, float c) {
  float distanceMin2 = 1.0;
  if (l < distanceMin2) l = sqrt(distanceMin2 * l);
  float add = c / l;
  return add * xy;
}

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);
  vec4 random = texture2D(randomValues, textureCoords);

  float width0 = spaceSize;

  vec2 velocity = vec2(0.0);
  vec2 addVelocity = vec2(0.0);

  ${new Array(e).fill(0).map((s,a)=>`float width${a+1} = width${a} / 2.0;`).join(`
`)}

  for (float n = 0.0; n < pow(2.0, ${n}.0); n += 1.0) {
    for (float m = 0.0; m < pow(2.0, ${n}.0); m += 1.0) {
      ${r(n)}
    }
  }

  velocity -= addVelocity;

  gl_FragColor = vec4(velocity, 0.0, 0.0);
}
`}class oye extends Gf{constructor(){super(...arguments),this.levelsTextures=new Map,this.levelsFbos=new Map,this.quadtreeLevels=0}create(){const{reglInstance:e,store:n}=this;if(!n.pointsTextureSize)return;this.quadtreeLevels=Math.log2(n.adjustedSpaceSize);for(let r=0;r<this.quadtreeLevels;r+=1){const s=Math.pow(2,r+1),a=`level[${r}]`;this.levelsTextures.has(a)||this.levelsTextures.set(a,e.texture());const o=this.levelsTextures.get(a);o&&o({data:new Float32Array(s*s*4),shape:[s,s,4],type:"float"}),this.levelsFbos.has(a)||this.levelsFbos.set(a,e.framebuffer());const l=this.levelsFbos.get(a);l&&l({color:this.levelsTextures.get(a),depth:!1,stencil:!1})}const i=new Float32Array(n.pointsTextureSize*n.pointsTextureSize*4);for(let r=0;r<n.pointsTextureSize*n.pointsTextureSize;++r)i[r*4]=n.getRandomFloat(-1,1)*1e-5,i[r*4+1]=n.getRandomFloat(-1,1)*1e-5;this.randomValuesTexture||(this.randomValuesTexture=e.texture()),this.randomValuesTexture({data:i,shape:[n.pointsTextureSize,n.pointsTextureSize,4],type:"float"}),this.randomValuesFbo||(this.randomValuesFbo=e.framebuffer()),this.randomValuesFbo({color:this.randomValuesTexture,depth:!1,stencil:!1}),this.pointIndices||(this.pointIndices=e.buffer(0)),this.pointIndices(Wp(n.pointsTextureSize))}initPrograms(){const{reglInstance:e,config:n,store:i,data:r,points:s}=this;this.clearLevelsCommand||(this.clearLevelsCommand=e({frag:am,vert:vs,framebuffer:(a,o)=>o.levelFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)}})),this.calculateLevelsCommand||(this.calculateLevelsCommand=e({frag:L7,vert:P7,framebuffer:(a,o)=>o.levelFbo,primitive:"points",count:()=>r.pointsNumber??0,attributes:{pointIndices:{buffer:this.pointIndices,size:2}},uniforms:{positionsTexture:()=>s==null?void 0:s.previousPositionFbo,pointsTextureSize:()=>i.pointsTextureSize,levelTextureSize:(a,o)=>o.levelTextureSize,cellSize:(a,o)=>o.cellSize},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.quadtreeCommand=e({frag:aye(n.simulationRepulsionQuadtreeLevels??this.quadtreeLevels,this.quadtreeLevels),vert:vs,framebuffer:()=>s==null?void 0:s.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>s==null?void 0:s.previousPositionFbo,randomValues:()=>this.randomValuesFbo,spaceSize:()=>i.adjustedSpaceSize,repulsion:()=>n.simulationRepulsion,theta:()=>n.simulationRepulsionTheta,alpha:()=>i.alpha,...Object.fromEntries(this.levelsFbos)}})}run(){var e,n,i;const{store:r}=this;for(let s=0;s<this.quadtreeLevels;s+=1){(e=this.clearLevelsCommand)==null||e.call(this,{levelFbo:this.levelsFbos.get(`level[${s}]`)});const a=Math.pow(2,s+1),o=r.adjustedSpaceSize/a;(n=this.calculateLevelsCommand)==null||n.call(this,{levelFbo:this.levelsFbos.get(`level[${s}]`),levelTextureSize:a,cellSize:o})}(i=this.quadtreeCommand)==null||i.call(this)}}var lye=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform float repulsion;
uniform vec2 mousePos;

varying vec2 textureCoords;

void main() {  
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);
  vec4 velocity = vec4(0.0);
  vec2 mouse = mousePos;
  
  vec2 distVector = mouse - pointPosition.rg;
  float dist = sqrt(dot(distVector, distVector));
  dist = max(dist, 10.0);
  float angle = atan(distVector.y, distVector.x);
  float addV = 100.0 * repulsion / (dist * dist);
  velocity.rg -= addV * vec2(cos(angle), sin(angle));

  gl_FragColor = velocity;
}`;class uye extends Gf{initPrograms(){const{reglInstance:e,config:n,store:i,points:r}=this;this.runCommand||(this.runCommand=e({frag:lye,vert:vs,framebuffer:()=>r==null?void 0:r.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>r==null?void 0:r.previousPositionFbo,mousePos:()=>i.mousePosition,repulsion:()=>n.simulationRepulsionFromMouse}}))}run(){var e;(e=this.runCommand)==null||e.call(this)}}var cye=`#ifdef GL_ES
precision highp float;
#endif

varying vec4 rgba;

void main() {
  gl_FragColor = rgba;
}`,fye=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform sampler2D clusterTexture;
uniform float pointsTextureSize;
uniform float clustersTextureSize;

attribute vec2 pointIndices;

varying vec4 rgba;

void main() {
  vec4 pointPosition = texture2D(positionsTexture, pointIndices / pointsTextureSize);
  rgba = vec4(pointPosition.xy, 1.0, 0.0);

  vec4 pointClusterIndices = texture2D(clusterTexture, pointIndices / pointsTextureSize);
  vec2 xy = vec2(0.0);
  if (pointClusterIndices.x >= 0.0 && pointClusterIndices.y >= 0.0) {
    xy = 2.0 * (pointClusterIndices.xy + 0.5) / clustersTextureSize - 1.0;
  }
  
  gl_Position = vec4(xy, 0.0, 1.0);
  gl_PointSize = 1.0;
}`,hye=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform sampler2D centermassTexture;
uniform sampler2D clusterTexture;
uniform sampler2D clusterPositionsTexture;
uniform sampler2D clusterForceCoefficient;
uniform float alpha;
uniform float clustersTextureSize;
uniform float clusterCoefficient;

varying vec2 textureCoords;

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);
  vec4 velocity = vec4(0.0);
  vec4 pointClusterIndices = texture2D(clusterTexture, textureCoords);
  
  if (pointClusterIndices.x >= 0.0 && pointClusterIndices.y >= 0.0) {
    
    vec2 clusterPositions = texture2D(clusterPositionsTexture, pointClusterIndices.xy / clustersTextureSize).xy;
    if (clusterPositions.x < 0.0 || clusterPositions.y < 0.0) {
      vec4 centermassValues = texture2D(centermassTexture, pointClusterIndices.xy / clustersTextureSize);
      clusterPositions = centermassValues.xy / centermassValues.b;
    }
    vec4 clusterCustomCoeff = texture2D(clusterForceCoefficient, textureCoords);
    vec2 distVector = clusterPositions.xy - pointPosition.xy;
    float dist = length(distVector);
    if (dist > 0.0) {
      float addV = alpha * dist * clusterCoefficient * clusterCustomCoeff.r;
      velocity.rg += addV * normalize(distVector);
    }
  }

  gl_FragColor = velocity;
}`;class dye extends Gf{create(){var e;const{reglInstance:n,store:i,data:r}=this,{pointsTextureSize:s}=i;if(r.pointsNumber===void 0||!r.pointClusters&&!r.clusterPositions)return;this.clusterCount=(r.pointClusters??[]).reduce((u,c)=>c===void 0||c<0?u:Math.max(u,c),0)+1,this.clustersTextureSize=Math.ceil(Math.sqrt(this.clusterCount));const a=new Float32Array(s*s*4),o=new Float32Array(this.clustersTextureSize*this.clustersTextureSize*4).fill(-1),l=new Float32Array(s*s*4).fill(1);if(r.clusterPositions)for(let u=0;u<this.clusterCount;++u)o[u*4+0]=r.clusterPositions[u*2+0]??-1,o[u*4+1]=r.clusterPositions[u*2+1]??-1;for(let u=0;u<r.pointsNumber;++u){const c=(e=r.pointClusters)==null?void 0:e[u];c===void 0?(a[u*4+0]=-1,a[u*4+1]=-1):(a[u*4+0]=c%this.clustersTextureSize,a[u*4+1]=Math.floor(c/this.clustersTextureSize)),r.clusterStrength&&(l[u*4+0]=r.clusterStrength[u]??1)}this.clusterTexture||(this.clusterTexture=n.texture()),this.clusterTexture({data:a,shape:[s,s,4],type:"float"}),this.clusterFbo||(this.clusterFbo=n.framebuffer()),this.clusterFbo({color:this.clusterTexture,depth:!1,stencil:!1}),this.clusterPositionsTexture||(this.clusterPositionsTexture=n.texture()),this.clusterPositionsTexture({data:o,shape:[this.clustersTextureSize,this.clustersTextureSize,4],type:"float"}),this.clusterPositionsFbo||(this.clusterPositionsFbo=n.framebuffer()),this.clusterPositionsFbo({color:this.clusterPositionsTexture,depth:!1,stencil:!1}),this.clusterForceCoefficientTexture||(this.clusterForceCoefficientTexture=n.texture()),this.clusterForceCoefficientTexture({data:l,shape:[s,s,4],type:"float"}),this.clusterForceCoefficientFbo||(this.clusterForceCoefficientFbo=n.framebuffer()),this.clusterForceCoefficientFbo({color:this.clusterForceCoefficientTexture,depth:!1,stencil:!1}),this.centermassTexture||(this.centermassTexture=n.texture()),this.centermassTexture({data:new Float32Array(this.clustersTextureSize*this.clustersTextureSize*4).fill(0),shape:[this.clustersTextureSize,this.clustersTextureSize,4],type:"float"}),this.centermassFbo||(this.centermassFbo=n.framebuffer()),this.centermassFbo({color:this.centermassTexture,depth:!1,stencil:!1}),this.pointIndices||(this.pointIndices=n.buffer(0)),this.pointIndices(Wp(i.pointsTextureSize))}initPrograms(){const{reglInstance:e,store:n,data:i,points:r}=this;i.pointClusters!==void 0&&(this.clearCentermassCommand||(this.clearCentermassCommand=e({frag:am,vert:vs,framebuffer:()=>this.centermassFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)}})),this.calculateCentermassCommand||(this.calculateCentermassCommand=e({frag:cye,vert:fye,framebuffer:()=>this.centermassFbo,primitive:"points",count:()=>i.pointsNumber??0,attributes:{pointIndices:{buffer:this.pointIndices,size:2}},uniforms:{positionsTexture:()=>r==null?void 0:r.previousPositionFbo,pointsTextureSize:()=>n.pointsTextureSize,clusterTexture:()=>this.clusterFbo,clustersTextureSize:()=>this.clustersTextureSize},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.applyForcesCommand||(this.applyForcesCommand=e({frag:hye,vert:vs,framebuffer:()=>r==null?void 0:r.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>r==null?void 0:r.previousPositionFbo,clusterTexture:()=>this.clusterFbo,centermassTexture:()=>this.centermassFbo,clusterPositionsTexture:()=>this.clusterPositionsFbo,clusterForceCoefficient:()=>this.clusterForceCoefficientFbo,alpha:()=>n.alpha,clustersTextureSize:()=>this.clustersTextureSize,clusterCoefficient:()=>this.config.simulationCluster}})))}calculateCentermass(){var e,n;(e=this.clearCentermassCommand)==null||e.call(this),(n=this.calculateCentermassCommand)==null||n.call(this)}run(){var e;!this.data.pointClusters&&!this.data.clusterPositions||(this.calculateCentermass(),(e=this.applyForcesCommand)==null||e.call(this))}}var qD={exports:{}},pye=qD.exports,rB;function mye(){return rB||(rB=1,function(t,e){(function(n,i){t.exports=i()})(pye,function(){var n=`<div class="gl-box">
  <svg viewBox="0 0 55 60">
    <text x="27" y="56" class="gl-fps">00 FPS</text>
    <text x="28" y="8" class="gl-mem"></text>
    <rect x="0" y="14" rx="4" ry="4" width="55" height="32"></rect>
    <polyline class="gl-chart"></polyline>
  </svg>
  <svg viewBox="0 0 14 60" class="gl-cpu-svg">
    <line x1="7" y1="38" x2="7" y2="11" class="opacity"/>
    <line x1="7" y1="38" x2="7" y2="11" class="gl-cpu" stroke-dasharray="0 27"/>
    <path d="M5.35 43c-.464 0-.812.377-.812.812v1.16c-.783.1972-1.421.812-1.595 1.624h-1.16c-.435 0-.812.348-.812.812s.348.812.812.812h1.102v1.653H1.812c-.464 0-.812.377-.812.812 0 .464.377.812.812.812h1.131c.1943.783.812 1.392 1.595 1.595v1.131c0 .464.377.812.812.812.464 0 .812-.377.812-.812V53.15h1.653v1.073c0 .464.377.812.812.812.464 0 .812-.377.812-.812v-1.131c.783-.1943 1.392-.812 1.595-1.595h1.131c.464 0 .812-.377.812-.812 0-.464-.377-.812-.812-.812h-1.073V48.22h1.102c.435 0 .812-.348.812-.812s-.348-.812-.812-.812h-1.16c-.1885-.783-.812-1.421-1.595-1.624v-1.131c0-.464-.377-.812-.812-.812-.464 0-.812.377-.812.812v1.073H6.162v-1.073c0-.464-.377-.812-.812-.812zm.58 3.48h2.088c.754 0 1.363.609 1.363 1.363v2.088c0 .754-.609 1.363-1.363 1.363H5.93c-.754 0-1.363-.609-1.363-1.363v-2.088c0-.754.609-1.363 1.363-1.363z"/>
  </svg>
  <svg viewBox="0 0 14 60" class="gl-gpu-svg">
    <line x1="7" y1="38" x2="7" y2="11" class="opacity"/>
    <line x1="7" y1="38" x2="7" y2="11" class="gl-gpu" stroke-dasharray="0 27"/>
    <path d="M1.94775 43.3772a.736.736 0 10-.00416 1.472c.58535.00231.56465.1288.6348.3197.07015.18975.04933.43585.04933.43585l-.00653.05405v8.671a.736.736 0 101.472 0v-1.4145c.253.09522.52785.1495.81765.1495h5.267c1.2535 0 2.254-.9752 2.254-2.185v-3.105c0-1.2075-1.00625-2.185-2.254-2.185h-5.267c-.28865 0-.5635.05405-.8165.1495.01806-.16445.04209-.598-.1357-1.0787-.22425-.6072-.9499-1.2765-2.0125-1.2765zm2.9095 3.6455c.42435 0 .7659.36225.7659.8119v2.9785c0 .44965-.34155.8119-.7659.8119s-.7659-.36225-.7659-.8119v-2.9785c0-.44965.34155-.8119.7659-.8119zm4.117 0a2.3 2.3 0 012.3 2.3 2.3 2.3 0 01-2.3 2.3 2.3 2.3 0 01-2.3-2.3 2.3 2.3 0 012.3-2.3z"/>
  </svg>
</div>`,i=`#gl-bench {
  position:absolute;
  left:0;
  top:0;
  z-index:1000;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

#gl-bench div {
  position: relative;
  display: block;
  margin: 4px;
  padding: 0 7px 0 10px;
  background: #6c6;
  border-radius: 15px;
  cursor: pointer;
  opacity: 0.9;
}

#gl-bench svg {
  height: 60px;
  margin: 0 -1px;
}

#gl-bench text {
  font-size: 12px;
  font-family: Helvetica,Arial,sans-serif;
  font-weight: 700;
  dominant-baseline: middle;
  text-anchor: middle;
}

#gl-bench .gl-mem {
  font-size: 9px;
}

#gl-bench line {
  stroke-width: 5;
  stroke: #112211;
  stroke-linecap: round;
}

#gl-bench polyline {
  fill: none;
  stroke: #112211;
  stroke-linecap: round;
  stroke-linejoin: round;
  stroke-width: 3.5;
}

#gl-bench rect {
  fill: #448844;
}

#gl-bench .opacity {
  stroke: #448844;
}
`;class r{constructor(a,o={}){this.css=i,this.svg=n,this.paramLogger=()=>{},this.chartLogger=()=>{},this.chartLen=20,this.chartHz=20,this.names=[],this.cpuAccums=[],this.gpuAccums=[],this.activeAccums=[],this.chart=new Array(this.chartLen),this.now=()=>performance&&performance.now?performance.now():Date.now(),this.updateUI=()=>{[].forEach.call(this.nodes["gl-gpu-svg"],d=>{d.style.display=this.trackGPU?"inline":"none"})},Object.assign(this,o),this.detected=0,this.finished=[],this.isFramebuffer=0,this.frameId=0;let l,u=0,c,h=d=>{++u<20?l=requestAnimationFrame(h):(this.detected=Math.ceil(1e3*u/(d-c)/70),cancelAnimationFrame(l)),c||(c=d)};if(requestAnimationFrame(h),a){const d=async(v,_)=>Promise.resolve(setTimeout(()=>{a.getError();const y=this.now()-v;_.forEach((g,x)=>{g&&(this.gpuAccums[x]+=y)})},0)),m=(v,_,y)=>function(){const g=_.now();v.apply(y,arguments),_.trackGPU&&_.finished.push(d(g,_.activeAccums.slice(0)))};["drawArrays","drawElements","drawArraysInstanced","drawBuffers","drawElementsInstanced","drawRangeElements"].forEach(v=>{a[v]&&(a[v]=m(a[v],this,a))}),a.getExtension=((v,_)=>function(){let y=v.apply(a,arguments);return y&&["drawElementsInstancedANGLE","drawBuffersWEBGL"].forEach(g=>{y[g]&&(y[g]=m(y[g],_,y))}),y})(a.getExtension,this)}if(!this.withoutUI){this.dom||(this.dom=document.body);let d=document.createElement("div");d.id="gl-bench",this.dom.appendChild(d),this.dom.insertAdjacentHTML("afterbegin",'<style id="gl-bench-style">'+this.css+"</style>"),this.dom=d,this.dom.addEventListener("click",()=>{this.trackGPU=!this.trackGPU,this.updateUI()}),this.paramLogger=((m,v,_)=>{const y=["gl-cpu","gl-gpu","gl-mem","gl-fps","gl-gpu-svg","gl-chart"],g=Object.assign({},y);return y.forEach(x=>g[x]=v.getElementsByClassName(x)),this.nodes=g,(x,S,E,A,T,C,O)=>{g["gl-cpu"][x].style.strokeDasharray=(S*.27).toFixed(0)+" 100",g["gl-gpu"][x].style.strokeDasharray=(E*.27).toFixed(0)+" 100",g["gl-mem"][x].innerHTML=_[x]?_[x]:A?"mem: "+A.toFixed(0)+"mb":"",g["gl-fps"][x].innerHTML=T.toFixed(0)+" FPS",m(_[x],S,E,A,T,C,O)}})(this.paramLogger,this.dom,this.names),this.chartLogger=((m,v)=>{let _={"gl-chart":v.getElementsByClassName("gl-chart")};return(y,g,x)=>{let S="",E=g.length;for(let A=0;A<E;A++){let T=(x+A+1)%E;g[T]!=null&&(S=S+" "+(55*A/(E-1)).toFixed(1)+","+(45-g[T]*22/60/this.detected).toFixed(1))}_["gl-chart"][y].setAttribute("points",S),m(this.names[y],g,x)}})(this.chartLogger,this.dom)}}addUI(a){this.names.indexOf(a)==-1&&(this.names.push(a),this.dom&&(this.dom.insertAdjacentHTML("beforeend",this.svg),this.updateUI()),this.cpuAccums.push(0),this.gpuAccums.push(0),this.activeAccums.push(!1))}nextFrame(a){this.frameId++;const o=a||this.now();if(this.frameId<=1)this.paramFrame=this.frameId,this.paramTime=o;else{let l=o-this.paramTime;if(l>=1e3){const u=this.frameId-this.paramFrame,c=u/l*1e3;for(let h=0;h<this.names.length;h++){const d=this.cpuAccums[h]/l*100,m=this.gpuAccums[h]/l*100,v=performance&&performance.memory?performance.memory.usedJSHeapSize/(1<<20):0;this.paramLogger(h,d,m,v,c,l,u),this.cpuAccums[h]=0,Promise.all(this.finished).then(()=>{this.gpuAccums[h]=0,this.finished=[]})}this.paramFrame=this.frameId,this.paramTime=o}}if(!this.detected||!this.chartFrame)this.chartFrame=this.frameId,this.chartTime=o,this.circularId=0;else{let l=o-this.chartTime,u=this.chartHz*l/1e3;for(;--u>0&&this.detected;){const c=(this.frameId-this.chartFrame)/l*1e3;this.chart[this.circularId%this.chartLen]=c;for(let h=0;h<this.names.length;h++)this.chartLogger(h,this.chart,this.circularId);this.circularId++,this.chartFrame=this.frameId,this.chartTime=o}}}begin(a){this.updateAccums(a)}end(a){this.updateAccums(a)}updateAccums(a){let o=this.names.indexOf(a);o==-1&&(o=this.names.length,this.addUI(a));const l=this.now(),u=l-this.t0;for(let c=0;c<o+1;c++)this.activeAccums[c]&&(this.cpuAccums[c]+=u);this.activeAccums[o]=!this.activeAccums[o],this.t0=l}}return r})}(qD)),qD.exports}var gye=mye();const vye=dI(gye),yye=`
  #gl-bench {
    position:absolute;
    right:0;
    top:0;
    z-index:1000;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  #gl-bench div {
    position: relative;
    display: block;
    margin: 4px;
    padding: 0 7px 0 10px;
    background: #5f69de;
    border-radius: 15px;
    cursor: pointer;
    opacity: 0.9;
  }
  #gl-bench svg {
    height: 60px;
    margin: 0 -1px;
  }
  #gl-bench text {
    font-size: 12px;
    font-family: Helvetica,Arial,sans-serif;
    font-weight: 700;
    dominant-baseline: middle;
    text-anchor: middle;
  }
  #gl-bench .gl-mem {
    font-size: 9px;
  }
  #gl-bench line {
    stroke-width: 5;
    stroke: #112211;
    stroke-linecap: round;
  }
  #gl-bench polyline {
    fill: none;
    stroke: #112211;
    stroke-linecap: round;
    stroke-linejoin: round;
    stroke-width: 3.5;
  }
  #gl-bench rect {
    fill: #8288e4;
  }
  #gl-bench .opacity {
    stroke: #8288e4;
  }
`;class sB{constructor(e){this.destroy();const n=e.getContext("webgl")||e.getContext("experimental-webgl");this.bench=new vye(n,{css:yye})}begin(){var e;(e=this.bench)==null||e.begin("frame")}end(e){var n,i;(n=this.bench)==null||n.end("frame"),(i=this.bench)==null||i.nextFrame(e)}destroy(){this.bench=void 0,Ws("#gl-bench").remove()}}class xye{constructor(e){this._config=e}get pointsNumber(){return this.pointPositions&&this.pointPositions.length/2}get linksNumber(){return this.links&&this.links.length/2}updatePoints(){this.pointPositions=this.inputPointPositions}updatePointColor(){if(this.pointsNumber===void 0){this.pointColors=void 0;return}const e=jp(this._config.pointColor);if(this.inputPointColors===void 0||this.inputPointColors.length/4!==this.pointsNumber){this.pointColors=new Float32Array(this.pointsNumber*4);for(let n=0;n<this.pointColors.length/4;n++)this.pointColors[n*4]=e[0],this.pointColors[n*4+1]=e[1],this.pointColors[n*4+2]=e[2],this.pointColors[n*4+3]=e[3]}else{this.pointColors=this.inputPointColors;for(let n=0;n<this.pointColors.length/4;n++)Gu(this.pointColors[n*4])||(this.pointColors[n*4]=e[0]),Gu(this.pointColors[n*4+1])||(this.pointColors[n*4+1]=e[1]),Gu(this.pointColors[n*4+2])||(this.pointColors[n*4+2]=e[2]),Gu(this.pointColors[n*4+3])||(this.pointColors[n*4+3]=e[3])}}updatePointSize(){if(this.pointsNumber===void 0){this.pointSizes=void 0;return}if(this.inputPointSizes===void 0||this.inputPointSizes.length!==this.pointsNumber)this.pointSizes=new Float32Array(this.pointsNumber).fill(this._config.pointSize);else{this.pointSizes=this.inputPointSizes;for(let e=0;e<this.pointSizes.length;e++)Gu(this.pointSizes[e])||(this.pointSizes[e]=this._config.pointSize)}}updateLinks(){this.links=this.inputLinks}updateLinkColor(){if(this.linksNumber===void 0){this.linkColors=void 0;return}const e=jp(this._config.linkColor);if(this.inputLinkColors===void 0||this.inputLinkColors.length/4!==this.linksNumber){this.linkColors=new Float32Array(this.linksNumber*4);for(let n=0;n<this.linkColors.length/4;n++)this.linkColors[n*4]=e[0],this.linkColors[n*4+1]=e[1],this.linkColors[n*4+2]=e[2],this.linkColors[n*4+3]=e[3]}else{this.linkColors=this.inputLinkColors;for(let n=0;n<this.linkColors.length/4;n++)Gu(this.linkColors[n*4])||(this.linkColors[n*4]=e[0]),Gu(this.linkColors[n*4+1])||(this.linkColors[n*4+1]=e[1]),Gu(this.linkColors[n*4+2])||(this.linkColors[n*4+2]=e[2]),Gu(this.linkColors[n*4+3])||(this.linkColors[n*4+3]=e[3])}}updateLinkWidth(){if(this.linksNumber===void 0){this.linkWidths=void 0;return}if(this.inputLinkWidths===void 0||this.inputLinkWidths.length!==this.linksNumber)this.linkWidths=new Float32Array(this.linksNumber).fill(this._config.linkWidth);else{this.linkWidths=this.inputLinkWidths;for(let e=0;e<this.linkWidths.length;e++)Gu(this.linkWidths[e])||(this.linkWidths[e]=this._config.linkWidth)}}updateArrows(){if(this.linksNumber===void 0){this.linkArrows=void 0;return}this.linkArrowsBoolean===void 0||this.linkArrowsBoolean.length!==this.linksNumber?this.linkArrows=new Array(this.linksNumber).fill(+this._config.linkArrows):this.linkArrows=this.linkArrowsBoolean.map(e=>+e)}updateLinkStrength(){this.linksNumber===void 0&&(this.linkStrength=void 0),this.inputLinkStrength===void 0||this.inputLinkStrength.length!==this.linksNumber?this.linkStrength=void 0:this.linkStrength=this.inputLinkStrength}updateClusters(){if(this.pointsNumber===void 0){this.pointClusters=void 0,this.clusterPositions=void 0;return}this.inputPointClusters===void 0||this.inputPointClusters.length!==this.pointsNumber?this.pointClusters=void 0:this.pointClusters=this.inputPointClusters,this.inputClusterPositions===void 0?this.clusterPositions=void 0:this.clusterPositions=this.inputClusterPositions,this.inputClusterStrength===void 0||this.inputClusterStrength.length!==this.pointsNumber?this.clusterStrength=void 0:this.clusterStrength=this.inputClusterStrength}update(){this.updatePoints(),this.updatePointColor(),this.updatePointSize(),this.updateLinks(),this.updateLinkColor(),this.updateLinkWidth(),this.updateArrows(),this.updateLinkStrength(),this.updateClusters(),this._createAdjacencyLists(),this._calculateDegrees()}getAdjacentIndices(e){var n,i,r,s;return[...((i=(n=this.sourceIndexToTargetIndices)==null?void 0:n[e])==null?void 0:i.map(a=>a[0]))||[],...((s=(r=this.targetIndexToSourceIndices)==null?void 0:r[e])==null?void 0:s.map(a=>a[0]))||[]]}_createAdjacencyLists(){var e,n;if(this.linksNumber===void 0||this.links===void 0){this.sourceIndexToTargetIndices=void 0,this.targetIndexToSourceIndices=void 0;return}this.sourceIndexToTargetIndices=new Array(this.pointsNumber).fill(void 0),this.targetIndexToSourceIndices=new Array(this.pointsNumber).fill(void 0);for(let i=0;i<this.linksNumber;i++){const r=this.links[i*2],s=this.links[i*2+1];r!==void 0&&s!==void 0&&(this.sourceIndexToTargetIndices[r]===void 0&&(this.sourceIndexToTargetIndices[r]=[]),(e=this.sourceIndexToTargetIndices[r])==null||e.push([s,i]),this.targetIndexToSourceIndices[s]===void 0&&(this.targetIndexToSourceIndices[s]=[]),(n=this.targetIndexToSourceIndices[s])==null||n.push([r,i]))}}_calculateDegrees(){var e,n,i,r;if(this.pointsNumber===void 0){this.degree=void 0,this.inDegree=void 0,this.outDegree=void 0;return}this.degree=new Array(this.pointsNumber).fill(0),this.inDegree=new Array(this.pointsNumber).fill(0),this.outDegree=new Array(this.pointsNumber).fill(0);for(let s=0;s<this.pointsNumber;s++)this.inDegree[s]=((n=(e=this.targetIndexToSourceIndices)==null?void 0:e[s])==null?void 0:n.length)??0,this.outDegree[s]=((r=(i=this.sourceIndexToTargetIndices)==null?void 0:i[s])==null?void 0:r.length)??0,this.degree[s]=(this.inDegree[s]??0)+(this.outDegree[s]??0)}}var _ye=`precision highp float;

varying vec4 rgbaColor;
varying vec2 pos;
varying float arrowLength;
varying float useArrow;
varying float smoothing;

float map(float value, float min1, float max1, float min2, float max2) {
  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);
}

void main() {
  float opacity = 1.0;
  vec3 color = rgbaColor.rgb;

  if (useArrow > 0.5) {
    float end_arrow = 0.5 + arrowLength / 2.0;
    float start_arrow = end_arrow - arrowLength;
    float arrowWidthDelta = 0.25;
    float linkOpacity = rgbaColor.a * smoothstep(0.5 - arrowWidthDelta, 0.5 - arrowWidthDelta - smoothing / 2.0, abs(pos.y));
    float arrowOpacity = 1.0;
    if (pos.x > start_arrow && pos.x < start_arrow + arrowLength) {
      float xmapped = map(pos.x, start_arrow, end_arrow, 0.0, 1.0);
      arrowOpacity = rgbaColor.a * smoothstep(xmapped - smoothing, xmapped, map(abs(pos.y), 0.5, 0.0, 0.0, 1.0));
      if (linkOpacity != arrowOpacity) {
        linkOpacity = max(linkOpacity, arrowOpacity);
      }
    }
    opacity = linkOpacity;
  } else opacity = rgbaColor.a * smoothstep(0.5, 0.5 - smoothing, abs(pos.y));
  
  gl_FragColor = vec4(color, opacity);
}`,bye=`precision highp float;

attribute vec2 position, pointA, pointB;
attribute vec4 color;
attribute float width;
attribute float arrow;

uniform sampler2D positionsTexture;
uniform sampler2D pointGreyoutStatus;
uniform mat3 transformationMatrix;
uniform float pointsTextureSize;
uniform float widthScale;
uniform float arrowSizeScale;
uniform float spaceSize;
uniform vec2 screenSize;
uniform vec2 linkVisibilityDistanceRange;
uniform float linkVisibilityMinTransparency;
uniform float greyoutOpacity;
uniform float curvedWeight;
uniform float curvedLinkControlPointDistance;
uniform float curvedLinkSegments;
uniform bool scaleLinksOnZoom;
uniform float maxPointSize;

varying vec4 rgbaColor;
varying vec2 pos;
varying float arrowLength;
varying float useArrow;
varying float smoothing;

float map(float value, float min1, float max1, float min2, float max2) {
  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);
}

vec2 conicParametricCurve(vec2 A, vec2 B, vec2 ControlPoint, float t, float w) {
  vec2 divident = (1.0 - t) * (1.0 - t) * A + 2.0 * (1.0 - t) * t * w * ControlPoint + t * t * B;
  float divisor = (1.0 - t) * (1.0 - t) + 2.0 * (1.0 - t) * t * w + t * t;
  return divident / divisor;
}

float calculateLinkWidth(float width) {
  float linkWidth;
  if (scaleLinksOnZoom) {
    
    linkWidth = width;
  } else {
    
    linkWidth = width / transformationMatrix[0][0];
    
    linkWidth *= min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));
  }
  
  if (useArrow > 0.5) {
    return min(linkWidth, (maxPointSize * 2.0) / transformationMatrix[0][0]);
  } else {
    return min(linkWidth, maxPointSize / transformationMatrix[0][0]);
  }
}

float calculateArrowWidth(float arrowWidth) {
  if (scaleLinksOnZoom) {
    return arrowWidth;
  } else {
    return arrowWidth / transformationMatrix[0][0];
  }
}

void main() {
  pos = position;

  vec2 pointTexturePosA = (pointA + 0.5) / pointsTextureSize;
  vec2 pointTexturePosB = (pointB + 0.5) / pointsTextureSize;
  
  vec4 greyoutStatusA = texture2D(pointGreyoutStatus, pointTexturePosA);
  vec4 greyoutStatusB = texture2D(pointGreyoutStatus, pointTexturePosB);
  
  vec4 pointPositionA = texture2D(positionsTexture, pointTexturePosA);
  vec4 pointPositionB = texture2D(positionsTexture, pointTexturePosB);
  vec2 a = pointPositionA.xy;
  vec2 b = pointPositionB.xy;
  
  
  vec2 xBasis = b - a;
  vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));

  
  float linkDist = length(xBasis);
  float h = curvedLinkControlPointDistance;
  vec2 controlPoint = (a + b) / 2.0 + yBasis * linkDist * h;

  
  float linkDistPx = linkDist * transformationMatrix[0][0];
  
  
  float linkWidth = width * widthScale;
  float k = 2.0;
  
  float arrowWidth = max(5.0, linkWidth * k);
  arrowWidth *= arrowSizeScale;

  
  float arrowWidthPx = calculateArrowWidth(arrowWidth);

  
  
  
  arrowLength = min(0.3, (0.866 * arrowWidthPx * 2.0) / linkDist);

  useArrow = arrow;
  if (useArrow > 0.5) {
    linkWidth *= 2.0;
  }

  
  float linkWidthPx = calculateLinkWidth(linkWidth);
  float smoothingPx = 0.5 / transformationMatrix[0][0];
  smoothing = smoothingPx / linkWidthPx;
  linkWidthPx += smoothingPx;

  
  vec3 rgbColor = color.rgb;
  
  float opacity = color.a * max(linkVisibilityMinTransparency, map(linkDistPx, linkVisibilityDistanceRange.g, linkVisibilityDistanceRange.r, 0.0, 1.0));

  
  if (greyoutStatusA.r > 0.0 || greyoutStatusB.r > 0.0) {
    opacity *= greyoutOpacity;
  }

  
  rgbaColor = vec4(rgbColor, opacity);

  
  float t = position.x;
  float w = curvedWeight;
  
  float tPrev = t - 1.0 / curvedLinkSegments;
  float tNext = t + 1.0 / curvedLinkSegments;
  
  vec2 pointCurr = conicParametricCurve(a, b, controlPoint, t, w);
  
  vec2 pointPrev = conicParametricCurve(a, b, controlPoint, max(0.0, tPrev), w);
  vec2 pointNext = conicParametricCurve(a, b, controlPoint, min(tNext, 1.0), w);
  
  vec2 xBasisCurved = pointNext - pointPrev;
  vec2 yBasisCurved = normalize(vec2(-xBasisCurved.y, xBasisCurved.x));
  
  pointCurr += yBasisCurved * linkWidthPx * position.y;
  
  
  vec2 p = 2.0 * pointCurr / spaceSize - 1.0;
  p *= spaceSize / screenSize;
  vec3 final = transformationMatrix * vec3(p, 1);
  
  gl_Position = vec4(final.rg, 0, 1);
}`;function TE(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Sye(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function N7(t){let e,n,i;t.length!==2?(e=TE,n=(o,l)=>TE(t(o),l),i=(o,l)=>t(o)-l):(e=t===TE||t===Sye?t:Eye,n=t,i=t);function r(o,l,u=0,c=o.length){if(u<c){if(e(l,l)!==0)return c;do{const h=u+c>>>1;n(o[h],l)<0?u=h+1:c=h}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(e(l,l)!==0)return c;do{const h=u+c>>>1;n(o[h],l)<=0?u=h+1:c=h}while(u<c)}return u}function a(o,l,u=0,c=o.length){const h=r(o,l,u,c-1);return h>u&&i(o[h-1],l)>-i(o[h],l)?h-1:h}return{left:r,center:a,right:s}}function Eye(){return 0}function wye(t){return t===null?NaN:+t}const Aye=N7(TE),Tye=Aye.right;N7(wye).center;function aB(t,e){let n,i;for(const r of t)r!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));return[n,i]}var KD=Math.sqrt(50),QD=Math.sqrt(10),JD=Math.sqrt(2);function Mye(t,e,n){var i,r=-1,s,a,o;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((i=e<t)&&(s=t,t=e,e=s),(o=B7(t,e,n))===0||!isFinite(o))return[];if(o>0){let l=Math.round(t/o),u=Math.round(e/o);for(l*o<t&&++l,u*o>e&&--u,a=new Array(s=u-l+1);++r<s;)a[r]=(l+r)*o}else{o=-o;let l=Math.round(t*o),u=Math.round(e*o);for(l/o<t&&++l,u/o>e&&--u,a=new Array(s=u-l+1);++r<s;)a[r]=(l+r)/o}return i&&a.reverse(),a}function B7(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=KD?10:s>=QD?5:s>=JD?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=KD?10:s>=QD?5:s>=JD?2:1)}function Cye(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=KD?r*=10:s>=QD?r*=5:s>=JD&&(r*=2),e<t?-r:r}function Rye(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(r);++i<r;)s[i]=t+i*n;return s}function k7(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Dye(t){return function(){return t}}function Oye(t){return+t}var oB=[0,1];function Zu(t){return t}function $D(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Dye(isNaN(e)?NaN:.5)}function Uye(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function zye(t,e,n){var i=t[0],r=t[1],s=e[0],a=e[1];return r<i?(i=$D(r,i),s=n(a,s)):(i=$D(i,r),s=n(s,a)),function(o){return s(i(o))}}function Iye(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),a=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<i;)r[a]=$D(t[a],t[a+1]),s[a]=n(e[a],e[a+1]);return function(o){var l=Tye(t,o,1,i)-1;return s[l](r[l](o))}}function F7(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function G7(){var t=oB,e=oB,n=fI,i,r,s,a=Zu,o,l,u;function c(){var d=Math.min(t.length,e.length);return a!==Zu&&(a=Uye(t[0],t[d-1])),o=d>2?Iye:zye,l=u=null,h}function h(d){return d==null||isNaN(d=+d)?s:(l||(l=o(t.map(i),e,n)))(i(a(d)))}return h.invert=function(d){return a(r((u||(u=o(e,t.map(i),Jl)))(d)))},h.domain=function(d){return arguments.length?(t=Array.from(d,Oye),c()):t.slice()},h.range=function(d){return arguments.length?(e=Array.from(d),c()):e.slice()},h.rangeRound=function(d){return e=Array.from(d),n=d0e,c()},h.clamp=function(d){return arguments.length?(a=d?!0:Zu,c()):a!==Zu},h.interpolate=function(d){return arguments.length?(n=d,c()):n},h.unknown=function(d){return arguments.length?(s=d,h):s},function(d,m){return i=d,r=m,c()}}function Lye(){return G7()(Zu,Zu)}function Pye(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function EA(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function iv(t){return t=EA(Math.abs(t)),t?t[1]:NaN}function Nye(t,e){return function(n,i){for(var r=n.length,s=[],a=0,o=t[0],l=0;r>0&&o>0&&(l+o+1>i&&(o=Math.max(1,i-l)),s.push(n.substring(r-=o,r+o)),!((l+=o+1)>i));)o=t[a=(a+1)%t.length];return s.reverse().join(e)}}function Bye(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var kye=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function wA(t){if(!(e=kye.exec(t)))throw new Error("invalid format: "+t);var e;return new pI({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}wA.prototype=pI.prototype;function pI(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}pI.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Fye(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var V7;function Gye(t,e){var n=EA(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(V7=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=i.length;return s===a?i:s>a?i+new Array(s-a+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+EA(t,Math.max(0,e+s-1))[0]}function lB(t,e){var n=EA(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const uB={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Pye,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>lB(t*100,e),r:lB,s:Gye,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function cB(t){return t}var fB=Array.prototype.map,hB=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Vye(t){var e=t.grouping===void 0||t.thousands===void 0?cB:Nye(fB.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?cB:Bye(fB.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(h){h=wA(h);var d=h.fill,m=h.align,v=h.sign,_=h.symbol,y=h.zero,g=h.width,x=h.comma,S=h.precision,E=h.trim,A=h.type;A==="n"?(x=!0,A="g"):uB[A]||(S===void 0&&(S=12),E=!0,A="g"),(y||d==="0"&&m==="=")&&(y=!0,d="0",m="=");var T=_==="$"?n:_==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",C=_==="$"?i:/[%p]/.test(A)?a:"",O=uB[A],M=/[defgprs%]/.test(A);S=S===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function D(P){var F=T,G=C,z,Y,N;if(A==="c")G=O(P)+G,P="";else{P=+P;var k=P<0||1/P<0;if(P=isNaN(P)?l:O(Math.abs(P),S),E&&(P=Fye(P)),k&&+P==0&&v!=="+"&&(k=!1),F=(k?v==="("?v:o:v==="-"||v==="("?"":v)+F,G=(A==="s"?hB[8+V7/3]:"")+G+(k&&v==="("?")":""),M){for(z=-1,Y=P.length;++z<Y;)if(N=P.charCodeAt(z),48>N||N>57){G=(N===46?r+P.slice(z+1):P.slice(z))+G,P=P.slice(0,z);break}}}x&&!y&&(P=e(P,1/0));var j=F.length+P.length+G.length,X=j<g?new Array(g-j+1).join(d):"";switch(x&&y&&(P=e(X+P,X.length?g-G.length:1/0),X=""),m){case"<":P=F+P+G+X;break;case"=":P=F+X+P+G;break;case"^":P=X.slice(0,j=X.length>>1)+F+P+G+X.slice(j);break;default:P=X+F+P+G;break}return s(P)}return D.toString=function(){return h+""},D}function c(h,d){var m=u((h=wA(h),h.type="f",h)),v=Math.max(-8,Math.min(8,Math.floor(iv(d)/3)))*3,_=Math.pow(10,-v),y=hB[8+v/3];return function(g){return m(_*g)+y}}return{format:u,formatPrefix:c}}var j2,H7,j7;Hye({thousands:",",grouping:[3],currency:["$",""]});function Hye(t){return j2=Vye(t),H7=j2.format,j7=j2.formatPrefix,j2}function jye(t){return Math.max(0,-iv(Math.abs(t)))}function Wye(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(iv(e)/3)))*3-iv(Math.abs(t)))}function Xye(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,iv(e)-iv(t))+1}function Yye(t,e,n,i){var r=Cye(t,e,n),s;switch(i=wA(i??",f"),i.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(s=Wye(r,a))&&(i.precision=s),j7(i,a)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=Xye(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=jye(r))&&(i.precision=s-(i.type==="%")*2);break}}return H7(i)}function W7(t){var e=t.domain;return t.ticks=function(n){var i=e();return Mye(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return Yye(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,s=i.length-1,a=i[r],o=i[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=r,r=s,s=u);c-- >0;){if(u=B7(a,o,n),u===l)return i[r]=a,i[s]=o,e(i);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return t},t}function eO(){var t=Lye();return t.copy=function(){return F7(t,eO())},k7.apply(t,arguments),W7(t)}function dB(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Zye(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function qye(t){return t<0?-t*t:t*t}function Kye(t){var e=t(Zu,Zu),n=1;function i(){return n===1?t(Zu,Zu):n===.5?t(Zye,qye):t(dB(n),dB(1/n))}return e.exponent=function(r){return arguments.length?(n=+r,i()):n},W7(e)}function X7(){var t=Kye(G7());return t.copy=function(){return F7(t,X7()).exponent(t.exponent())},k7.apply(t,arguments),t}const Qye=t=>{const e=X7().exponent(2).range([0,1]).domain([-1,1]),n=Rye(0,t).map(r=>-.5+r/t);n.push(.5);const i=new Array(n.length*2);return n.forEach((r,s)=>{i[s*2]=[e(r*2),.5],i[s*2+1]=[e(r*2),-.5]}),i};class Jye extends Gf{initPrograms(){const{reglInstance:e,config:n,store:i}=this;this.drawCurveCommand||(this.drawCurveCommand=e({vert:bye,frag:_ye,attributes:{position:{buffer:()=>this.curveLineBuffer,divisor:0},pointA:{buffer:()=>this.pointsBuffer,divisor:1,offset:Float32Array.BYTES_PER_ELEMENT*0,stride:Float32Array.BYTES_PER_ELEMENT*4},pointB:{buffer:()=>this.pointsBuffer,divisor:1,offset:Float32Array.BYTES_PER_ELEMENT*2,stride:Float32Array.BYTES_PER_ELEMENT*4},color:{buffer:()=>this.colorBuffer,divisor:1,offset:Float32Array.BYTES_PER_ELEMENT*0,stride:Float32Array.BYTES_PER_ELEMENT*4},width:{buffer:()=>this.widthBuffer,divisor:1,offset:Float32Array.BYTES_PER_ELEMENT*0,stride:Float32Array.BYTES_PER_ELEMENT*1},arrow:{buffer:()=>this.arrowBuffer,divisor:1,offset:Float32Array.BYTES_PER_ELEMENT*0,stride:Float32Array.BYTES_PER_ELEMENT*1}},uniforms:{positionsTexture:()=>{var r;return(r=this.points)==null?void 0:r.currentPositionFbo},pointGreyoutStatus:()=>{var r;return(r=this.points)==null?void 0:r.greyoutStatusFbo},transformationMatrix:()=>i.transform,pointsTextureSize:()=>i.pointsTextureSize,widthScale:()=>n.linkWidthScale,arrowSizeScale:()=>n.linkArrowsSizeScale,spaceSize:()=>i.adjustedSpaceSize,screenSize:()=>i.screenSize,linkVisibilityDistanceRange:()=>n.linkVisibilityDistanceRange,linkVisibilityMinTransparency:()=>n.linkVisibilityMinTransparency,greyoutOpacity:()=>n.linkGreyoutOpacity,scaleLinksOnZoom:()=>n.scaleLinksOnZoom,maxPointSize:()=>i.maxPointSize,curvedWeight:()=>n.curvedLinkWeight,curvedLinkControlPointDistance:()=>n.curvedLinkControlPointDistance,curvedLinkSegments:()=>n.curvedLinks?n.curvedLinkSegments??Nn.curvedLinkSegments:1},cull:{enable:!0,face:"back"},blend:{enable:!0,func:{dstRGB:"one minus src alpha",srcRGB:"src alpha",dstAlpha:"one minus src alpha",srcAlpha:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},count:()=>{var r;return((r=this.curveLineGeometry)==null?void 0:r.length)??0},instances:()=>this.data.linksNumber??0,primitive:"triangle strip"}))}draw(){var e;this.pointsBuffer&&(this.colorBuffer||this.updateColor(),this.widthBuffer||this.updateWidth(),this.arrowBuffer||this.updateArrow(),this.curveLineGeometry||this.updateCurveLineGeometry(),(e=this.drawCurveCommand)==null||e.call(this))}updatePointsBuffer(){const{reglInstance:e,data:n,store:i}=this;if(n.linksNumber===void 0||n.links===void 0)return;const r=new Float32Array(n.linksNumber*4);for(let s=0;s<n.linksNumber;s++){const a=n.links[s*2],o=n.links[s*2+1],l=a%i.pointsTextureSize,u=Math.floor(a/i.pointsTextureSize),c=o%i.pointsTextureSize,h=Math.floor(o/i.pointsTextureSize),d=s*4;r[d]=l,r[d+1]=u,r[d+2]=c,r[d+3]=h}this.pointsBuffer||(this.pointsBuffer=e.buffer(0)),this.pointsBuffer(r)}updateColor(){const{reglInstance:e,data:n}=this;this.colorBuffer||(this.colorBuffer=e.buffer(0)),this.colorBuffer(n.linkColors??new Float32Array)}updateWidth(){const{reglInstance:e,data:n}=this;this.widthBuffer||(this.widthBuffer=e.buffer(0)),this.widthBuffer(n.linkWidths??new Float32Array)}updateArrow(){const{reglInstance:e,data:n}=this;this.arrowBuffer||(this.arrowBuffer=e.buffer(0)),this.arrowBuffer(n.linkArrows??new Float32Array)}updateCurveLineGeometry(){const{reglInstance:e,config:{curvedLinks:n,curvedLinkSegments:i}}=this;this.curveLineGeometry=Qye(n?i??Nn.curvedLinkSegments:1),this.curveLineBuffer||(this.curveLineBuffer=e.buffer(0)),this.curveLineBuffer(this.curveLineGeometry)}}var $ye=`#ifdef GL_ES
precision highp float;
#endif

varying vec3 rgbColor;
varying float alpha;

const float smoothing = 0.9;

void main() {
    
    if (alpha == 0.0) { discard; }

    
    vec2 pointCoord = 2.0 * gl_PointCoord - 1.0;
    
    float pointCenterDistance = dot(pointCoord, pointCoord);
    
    float opacity = alpha * (1.0 - smoothstep(smoothing, 1.0, pointCenterDistance));

    gl_FragColor = vec4(rgbColor, opacity);
}`,exe=`#ifdef GL_ES
precision highp float;
#endif

attribute vec2 pointIndices;
attribute float size;
attribute vec4 color;

uniform sampler2D positionsTexture;
uniform sampler2D pointGreyoutStatus;
uniform float ratio;
uniform mat3 transformationMatrix;
uniform float pointsTextureSize;
uniform float sizeScale;
uniform float spaceSize;
uniform vec2 screenSize;
uniform float greyoutOpacity;
uniform vec4 greyoutColor;
uniform vec4 backgroundColor;
uniform bool scalePointsOnZoom;
uniform float maxPointSize;
uniform bool darkenGreyout;

varying vec2 textureCoords;
varying vec3 rgbColor;
varying float alpha;

float calculatePointSize(float size) {
  float pSize;
  if (scalePointsOnZoom) { 
    pSize = size * ratio * transformationMatrix[0][0];
  } else {
    pSize = size * ratio * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));
  }

  return min(pSize, maxPointSize * ratio);
}

void main() {  
  textureCoords = pointIndices;
  
  vec4 pointPosition = texture2D(positionsTexture, (textureCoords + 0.5) / pointsTextureSize);
  vec2 point = pointPosition.rg;

  
  vec2 normalizedPosition = 2.0 * point / spaceSize - 1.0;
  normalizedPosition *= spaceSize / screenSize;
  vec3 finalPosition = transformationMatrix * vec3(normalizedPosition, 1);
  gl_Position = vec4(finalPosition.rg, 0, 1);

  gl_PointSize = calculatePointSize(size * sizeScale);

  rgbColor = color.rgb;
  alpha = color.a;

  
  vec4 greyoutStatus = texture2D(pointGreyoutStatus, (textureCoords + 0.5) / pointsTextureSize);
  if (greyoutStatus.r > 0.0) {
    if (greyoutColor[0] != -1.0) {
      rgbColor = greyoutColor.rgb;
      alpha = greyoutColor.a;
    } else {
      
      float blendFactor = 0.65; 
      
      if (darkenGreyout) {
        
        rgbColor = mix(rgbColor, vec3(0.2), blendFactor);
      } else {
        
        rgbColor = mix(rgbColor, max(backgroundColor.rgb, vec3(0.8)), blendFactor);
      }
    }

    if (greyoutOpacity != -1.0) {
      alpha *= greyoutOpacity;
    }
  }
}`,txe=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform sampler2D pointSize;
uniform float sizeScale;
uniform float spaceSize;
uniform vec2 screenSize;
uniform float ratio;
uniform mat3 transformationMatrix;
uniform vec2 selection[2];
uniform bool scalePointsOnZoom;
uniform float maxPointSize;

varying vec2 textureCoords;

float pointSizeF(float size) {
  float pSize;
  if (scalePointsOnZoom) { 
    pSize = size * ratio * transformationMatrix[0][0];
  } else {
    pSize = size * ratio * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));
  }
  return min(pSize, maxPointSize * ratio);
}

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);
  vec2 p = 2.0 * pointPosition.rg / spaceSize - 1.0;
  p *= spaceSize / screenSize;
  vec3 final = transformationMatrix * vec3(p, 1);

  vec4 pSize = texture2D(pointSize, textureCoords);
  float size = pSize.r * sizeScale;

  float left = 2.0 * (selection[0].x - 0.5 * pointSizeF(size)) / screenSize.x - 1.0;
  float right = 2.0 * (selection[1].x + 0.5 * pointSizeF(size)) / screenSize.x - 1.0;
  float top =  2.0 * (selection[0].y - 0.5 * pointSizeF(size)) / screenSize.y - 1.0;
  float bottom =  2.0 * (selection[1].y + 0.5 * pointSizeF(size)) / screenSize.y - 1.0;

  gl_FragColor = vec4(0.0, 0.0, pointPosition.rg);
  if (final.x >= left && final.x <= right && final.y >= top && final.y <= bottom) {
    gl_FragColor.r = 1.0;
  }
}`,nxe=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform sampler2D polygonPathTexture; 
uniform int polygonPathLength;
uniform float spaceSize;
uniform vec2 screenSize;
uniform mat3 transformationMatrix;

varying vec2 textureCoords;

vec2 getPolygonPoint(sampler2D pathTexture, int index, int pathLength) {
  if (index >= pathLength) return vec2(0.0);
  
  
  int textureSize = int(ceil(sqrt(float(pathLength))));
  int x = index - (index / textureSize) * textureSize;
  int y = index / textureSize;
  
  vec2 texCoord = (vec2(float(x), float(y)) + 0.5) / float(textureSize);
  vec4 pathData = texture2D(pathTexture, texCoord);
  
  return pathData.xy;
}

bool pointInPolygon(vec2 point, sampler2D pathTexture, int pathLength) {
  bool inside = false;
  
  for (int i = 0; i < 2048; i++) {
    if (i >= pathLength) break;
    
    int j = int(mod(float(i + 1), float(pathLength)));
    
    vec2 pi = getPolygonPoint(pathTexture, i, pathLength);
    vec2 pj = getPolygonPoint(pathTexture, j, pathLength);
    
    if (((pi.y > point.y) != (pj.y > point.y)) &&
        (point.x < (pj.x - pi.x) * (point.y - pi.y) / (pj.y - pi.y) + pi.x)) {
      inside = !inside;
    }
  }
  
  return inside;
}

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);
  vec2 p = 2.0 * pointPosition.rg / spaceSize - 1.0;
  p *= spaceSize / screenSize;
  vec3 final = transformationMatrix * vec3(p, 1);

  
  vec2 screenPos = (final.xy + 1.0) * screenSize / 2.0;
  
  gl_FragColor = vec4(0.0, 0.0, pointPosition.rg);
  
  
  if (pointInPolygon(screenPos, polygonPathTexture, polygonPathLength)) {
    gl_FragColor.r = 1.0;
  }
}`,ixe=`precision mediump float;

uniform float width;

varying vec2 vertexPosition;
varying float pointOpacity;
varying vec3 rgbColor;

const float smoothing = 1.05;

void main () {
  float r = dot(vertexPosition, vertexPosition);
  float opacity = smoothstep(r, r * smoothing, 1.0);
  float stroke = smoothstep(width, width * smoothing, r);
  gl_FragColor = vec4(rgbColor, opacity * stroke * pointOpacity);
}`,rxe=`precision mediump float;

attribute vec2 vertexCoord;

uniform sampler2D positionsTexture;
uniform sampler2D pointGreyoutStatusTexture;
uniform float size;
uniform mat3 transformationMatrix;
uniform float pointsTextureSize;
uniform float sizeScale;
uniform float spaceSize;
uniform vec2 screenSize;
uniform bool scalePointsOnZoom;
uniform float pointIndex;
uniform float maxPointSize;
uniform vec4 color;
uniform float greyoutOpacity;
uniform bool darkenGreyout;
uniform vec4 backgroundColor;
uniform vec4 greyoutColor;
varying vec2 vertexPosition;
varying float pointOpacity;
varying vec3 rgbColor;

float calculatePointSize(float size) {
  float pSize;
  if (scalePointsOnZoom) { 
    pSize = size * transformationMatrix[0][0];
  } else {
    pSize = size * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));
  }
  return min(pSize, maxPointSize);
}

const float relativeRingRadius = 1.3;

void main () {
  vertexPosition = vertexCoord;

  vec2 textureCoordinates = vec2(mod(pointIndex, pointsTextureSize), floor(pointIndex / pointsTextureSize)) + 0.5;
  vec4 pointPosition = texture2D(positionsTexture, textureCoordinates / pointsTextureSize);

  rgbColor = color.rgb;
  pointOpacity = color.a;
  vec4 greyoutStatus = texture2D(pointGreyoutStatusTexture, textureCoordinates / pointsTextureSize);
  if (greyoutStatus.r > 0.0) {
    if (greyoutColor[0] != -1.0) {
      rgbColor = greyoutColor.rgb;
      pointOpacity = greyoutColor.a;
    } else {
      
      float blendFactor = 0.65; 
      
      if (darkenGreyout) {
        
        rgbColor = mix(rgbColor, vec3(0.2), blendFactor);
      } else {
        
        rgbColor = mix(rgbColor, max(backgroundColor.rgb, vec3(0.8)), blendFactor);
      }
    }

    if (greyoutOpacity != -1.0) {
      pointOpacity *= greyoutOpacity;
    }
  }

  
  float pointSize = (calculatePointSize(size * sizeScale) * relativeRingRadius) / transformationMatrix[0][0];
  float radius = pointSize * 0.5;

  
  vec2 a = pointPosition.xy;
  vec2 b = pointPosition.xy + vec2(0.0, radius);
  vec2 xBasis = b - a;
  vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
  vec2 pointPositionInScreenSpace = a + xBasis * vertexCoord.x + yBasis * radius * vertexCoord.y;

  
  vec2 p = 2.0 * pointPositionInScreenSpace / spaceSize - 1.0;
  p *= spaceSize / screenSize;
  vec3 final =  transformationMatrix * vec3(p, 1);
  
  gl_Position = vec4(final.rg, 0, 1);
}`,sxe=`#ifdef GL_ES
precision highp float;
#endif

varying vec4 rgba;

void main() {
  gl_FragColor = rgba;
}`,axe=`#ifdef GL_ES
precision highp float;
#endif

attribute float size;

uniform sampler2D positionsTexture;
uniform float pointsTextureSize;
uniform float sizeScale;
uniform float spaceSize;
uniform vec2 screenSize;
uniform float ratio;
uniform mat3 transformationMatrix;
uniform vec2 mousePosition;
uniform bool scalePointsOnZoom;
uniform float maxPointSize;

attribute vec2 pointIndices;

varying vec4 rgba;

float calculatePointSize(float size) {
  float pSize;
  if (scalePointsOnZoom) { 
    pSize = size * ratio * transformationMatrix[0][0];
  } else {
    pSize = size * ratio * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));
  }
  return min(pSize, maxPointSize * ratio);
}

float euclideanDistance (float x1, float x2, float y1, float y2) {
  return sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));
}

void main() {
  vec4 pointPosition = texture2D(positionsTexture, (pointIndices + 0.5) / pointsTextureSize);

  
  vec2 normalizedPoint = 2.0 * pointPosition.rg / spaceSize - 1.0;
  normalizedPoint *= spaceSize / screenSize;
  vec3 finalPosition = transformationMatrix * vec3(normalizedPoint, 1);

  float pointRadius = 0.5 * calculatePointSize(size * sizeScale);

  vec2 pointScreenPosition = (finalPosition.xy + 1.0) * screenSize / 2.0;
  rgba = vec4(0.0);
  gl_Position = vec4(0.5, 0.5, 0.0, 1.0);
  
  if (euclideanDistance(pointScreenPosition.x, mousePosition.x, pointScreenPosition.y, mousePosition.y) < pointRadius / ratio) {
    float index = pointIndices.g * pointsTextureSize + pointIndices.r;
    rgba = vec4(index, size, pointPosition.xy);
    gl_Position = vec4(-0.5, -0.5, 0.0, 1.0);
  }

  gl_PointSize = 1.0;
}`,oxe=`#ifdef GL_ES
precision highp float;
#endif

varying vec4 rgba;

void main() {
  gl_FragColor = rgba;
}`,lxe=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform float pointsTextureSize;
uniform float spaceSize;
uniform vec2 screenSize;
uniform mat3 transformationMatrix;

attribute vec2 pointIndices;

varying vec4 rgba;

void main() {
  vec4 pointPosition = texture2D(positionsTexture, (pointIndices + 0.5) / pointsTextureSize);
  vec2 p = 2.0 * pointPosition.rg / spaceSize - 1.0;
  p *= spaceSize / screenSize;
  vec3 final = transformationMatrix * vec3(p, 1);

  vec2 pointScreenPosition = (final.xy + 1.0) * screenSize / 2.0;
  float index = pointIndices.g * pointsTextureSize + pointIndices.r;
  rgba = vec4(index, 1.0, pointPosition.xy);
  float i = (pointScreenPosition.x + 0.5) / screenSize.x;
  float j = (pointScreenPosition.y + 0.5) / screenSize.y;
  gl_Position = vec4(2.0 * vec2(i, j) - 1.0, 0.0, 1.0);

  gl_PointSize = 1.0;
}`,uxe=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform sampler2D velocity;
uniform float friction;
uniform float spaceSize;

varying vec2 textureCoords;

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);
  vec4 pointVelocity = texture2D(velocity, textureCoords);

  
  pointVelocity.rg *= friction;

  pointPosition.rg += pointVelocity.rg;

  pointPosition.r = clamp(pointPosition.r, 0.0, spaceSize);
  pointPosition.g = clamp(pointPosition.g, 0.0, spaceSize);
  
  gl_FragColor = pointPosition;
}`,cxe=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform sampler2D trackedIndices;
uniform float pointsTextureSize;

varying vec2 textureCoords;

void main() {
  vec4 trackedPointIndices = texture2D(trackedIndices, textureCoords);
  if (trackedPointIndices.r < 0.0) discard;
  vec4 pointPosition = texture2D(positionsTexture, (trackedPointIndices.rg + 0.5) / pointsTextureSize);

  gl_FragColor = vec4(pointPosition.rg, 1.0, 1.0);
}`,fxe=`#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D positionsTexture;
uniform vec2 mousePos;
uniform float index;

varying vec2 textureCoords;

void main() {
  vec4 pointPosition = texture2D(positionsTexture, textureCoords);

  
  if (index >= 0.0 && index == pointPosition.b) {
    pointPosition.rg = mousePos.rg;
  }

  gl_FragColor = pointPosition;
}`;class hxe extends Gf{constructor(){super(...arguments),this.polygonPathLength=0}updatePositions(){const{reglInstance:e,store:n,data:i,config:{rescalePositions:r,enableSimulation:s}}=this,{pointsTextureSize:a}=n;if(!a||!i.pointPositions||i.pointsNumber===void 0)return;const o=new Float32Array(a*a*4);let l=r;r===void 0&&!s&&(l=!0),this.dontRescale&&(l=!1),l?this.rescaleInitialNodePositions():this.dontRescale||(this.scaleX=void 0,this.scaleY=void 0),this.dontRescale=void 0;for(let u=0;u<i.pointsNumber;++u)o[u*4+0]=i.pointPositions[u*2+0],o[u*4+1]=i.pointPositions[u*2+1],o[u*4+2]=u;this.currentPositionFbo||(this.currentPositionFbo=e.framebuffer()),this.currentPositionFbo({color:e.texture({data:o,shape:[a,a,4],type:"float"}),depth:!1,stencil:!1}),this.previousPositionFbo||(this.previousPositionFbo=e.framebuffer()),this.previousPositionFbo({color:e.texture({data:o,shape:[a,a,4],type:"float"}),depth:!1,stencil:!1}),this.config.enableSimulation&&(this.velocityFbo||(this.velocityFbo=e.framebuffer()),this.velocityFbo({color:e.texture({data:new Float32Array(a*a*4).fill(0),shape:[a,a,4],type:"float"}),depth:!1,stencil:!1})),this.selectedTexture||(this.selectedTexture=e.texture()),this.selectedTexture({data:o,shape:[a,a,4],type:"float"}),this.selectedFbo||(this.selectedFbo=e.framebuffer()),this.selectedFbo({color:this.selectedTexture,depth:!1,stencil:!1}),this.hoveredFbo||(this.hoveredFbo=e.framebuffer()),this.hoveredFbo({shape:[2,2],colorType:"float",depth:!1,stencil:!1}),this.drawPointIndices||(this.drawPointIndices=e.buffer(0)),this.drawPointIndices(Wp(n.pointsTextureSize)),this.hoveredPointIndices||(this.hoveredPointIndices=e.buffer(0)),this.hoveredPointIndices(Wp(n.pointsTextureSize)),this.sampledPointIndices||(this.sampledPointIndices=e.buffer(0)),this.sampledPointIndices(Wp(n.pointsTextureSize)),this.updateGreyoutStatus(),this.updateSampledPointsGrid(),this.trackPointsByIndices()}initPrograms(){const{reglInstance:e,config:n,store:i,data:r}=this;n.enableSimulation&&(this.updatePositionCommand||(this.updatePositionCommand=e({frag:uxe,vert:vs,framebuffer:()=>this.currentPositionFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>this.previousPositionFbo,velocity:()=>this.velocityFbo,friction:()=>n.simulationFriction,spaceSize:()=>i.adjustedSpaceSize}}))),this.dragPointCommand||(this.dragPointCommand=e({frag:fxe,vert:vs,framebuffer:()=>this.currentPositionFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>this.previousPositionFbo,mousePos:()=>i.mousePosition,index:()=>{var s;return((s=i.hoveredPoint)==null?void 0:s.index)??-1}}})),this.drawCommand||(this.drawCommand=e({frag:$ye,vert:exe,primitive:"points",count:()=>r.pointsNumber??0,attributes:{pointIndices:{buffer:this.drawPointIndices,size:2},size:{buffer:()=>this.sizeBuffer,size:1},color:{buffer:()=>this.colorBuffer,size:4}},uniforms:{positionsTexture:()=>this.currentPositionFbo,pointGreyoutStatus:()=>this.greyoutStatusFbo,ratio:()=>n.pixelRatio,sizeScale:()=>n.pointSizeScale,pointsTextureSize:()=>i.pointsTextureSize,transformationMatrix:()=>i.transform,spaceSize:()=>i.adjustedSpaceSize,screenSize:()=>i.screenSize,greyoutOpacity:()=>n.pointGreyoutOpacity??-1,greyoutColor:()=>i.greyoutPointColor,backgroundColor:()=>i.backgroundColor,darkenGreyout:()=>i.darkenGreyout,scalePointsOnZoom:()=>n.scalePointsOnZoom,maxPointSize:()=>i.maxPointSize},blend:{enable:!0,func:{dstRGB:"one minus src alpha",srcRGB:"src alpha",dstAlpha:"one minus src alpha",srcAlpha:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1}})),this.findPointsOnAreaSelectionCommand||(this.findPointsOnAreaSelectionCommand=e({frag:txe,vert:vs,framebuffer:()=>this.selectedFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>this.currentPositionFbo,pointSize:()=>this.sizeFbo,spaceSize:()=>i.adjustedSpaceSize,screenSize:()=>i.screenSize,sizeScale:()=>n.pointSizeScale,transformationMatrix:()=>i.transform,ratio:()=>n.pixelRatio,"selection[0]":()=>i.selectedArea[0],"selection[1]":()=>i.selectedArea[1],scalePointsOnZoom:()=>n.scalePointsOnZoom,maxPointSize:()=>i.maxPointSize}})),this.findPointsOnPolygonSelectionCommand||(this.findPointsOnPolygonSelectionCommand=e({frag:nxe,vert:vs,framebuffer:()=>this.selectedFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>this.currentPositionFbo,spaceSize:()=>i.adjustedSpaceSize,screenSize:()=>i.screenSize,transformationMatrix:()=>i.transform,polygonPathTexture:()=>this.polygonPathTexture,polygonPathLength:()=>this.polygonPathLength}})),this.clearHoveredFboCommand||(this.clearHoveredFboCommand=e({frag:am,vert:vs,framebuffer:this.hoveredFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)}})),this.findHoveredPointCommand||(this.findHoveredPointCommand=e({frag:sxe,vert:axe,primitive:"points",count:()=>r.pointsNumber??0,framebuffer:()=>this.hoveredFbo,attributes:{pointIndices:{buffer:this.hoveredPointIndices,size:2},size:{buffer:()=>this.sizeBuffer,size:1}},uniforms:{positionsTexture:()=>this.currentPositionFbo,ratio:()=>n.pixelRatio,sizeScale:()=>n.pointSizeScale,pointsTextureSize:()=>i.pointsTextureSize,transformationMatrix:()=>i.transform,spaceSize:()=>i.adjustedSpaceSize,screenSize:()=>i.screenSize,scalePointsOnZoom:()=>n.scalePointsOnZoom,mousePosition:()=>i.screenMousePosition,maxPointSize:()=>i.maxPointSize},depth:{enable:!1,mask:!1}})),this.clearSampledPointsFboCommand||(this.clearSampledPointsFboCommand=e({frag:am,vert:vs,framebuffer:()=>this.sampledPointsFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)}})),this.fillSampledPointsFboCommand||(this.fillSampledPointsFboCommand=e({frag:oxe,vert:lxe,primitive:"points",count:()=>r.pointsNumber??0,framebuffer:()=>this.sampledPointsFbo,attributes:{pointIndices:{buffer:this.sampledPointIndices,size:2}},uniforms:{positionsTexture:()=>this.currentPositionFbo,pointsTextureSize:()=>i.pointsTextureSize,transformationMatrix:()=>i.transform,spaceSize:()=>i.adjustedSpaceSize,screenSize:()=>i.screenSize},depth:{enable:!1,mask:!1}})),this.drawHighlightedCommand||(this.drawHighlightedCommand=e({frag:ixe,vert:rxe,attributes:{vertexCoord:os(e)},primitive:"triangle strip",count:4,uniforms:{color:e.prop("color"),width:e.prop("width"),pointIndex:e.prop("pointIndex"),size:e.prop("size"),positionsTexture:()=>this.currentPositionFbo,sizeScale:()=>n.pointSizeScale,pointsTextureSize:()=>i.pointsTextureSize,transformationMatrix:()=>i.transform,spaceSize:()=>i.adjustedSpaceSize,screenSize:()=>i.screenSize,scalePointsOnZoom:()=>n.scalePointsOnZoom,maxPointSize:()=>i.maxPointSize,pointGreyoutStatusTexture:()=>this.greyoutStatusFbo,greyoutOpacity:()=>n.pointGreyoutOpacity??-1,darkenGreyout:()=>i.darkenGreyout,backgroundColor:()=>i.backgroundColor,greyoutColor:()=>i.greyoutPointColor},blend:{enable:!0,func:{dstRGB:"one minus src alpha",srcRGB:"src alpha",dstAlpha:"one minus src alpha",srcAlpha:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1}})),this.trackPointsCommand||(this.trackPointsCommand=e({frag:cxe,vert:vs,framebuffer:()=>this.trackedPositionsFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:os(e)},uniforms:{positionsTexture:()=>this.currentPositionFbo,trackedIndices:()=>this.trackedIndicesFbo,pointsTextureSize:()=>i.pointsTextureSize}}))}updateColor(){const{reglInstance:e,store:{pointsTextureSize:n},data:i}=this;n&&(this.colorBuffer||(this.colorBuffer=e.buffer(0)),this.colorBuffer(i.pointColors))}updateGreyoutStatus(){const{reglInstance:e,store:{selectedIndices:n,pointsTextureSize:i}}=this;if(!i)return;const r=new Float32Array(i*i*4).fill(n?1:0);if(n)for(const s of n)r[s*4]=0;this.greyoutStatusTexture||(this.greyoutStatusTexture=e.texture()),this.greyoutStatusTexture({data:r,width:i,height:i,type:"float"}),this.greyoutStatusFbo||(this.greyoutStatusFbo=e.framebuffer()),this.greyoutStatusFbo({color:this.greyoutStatusTexture,depth:!1,stencil:!1})}updateSize(){const{reglInstance:e,store:{pointsTextureSize:n},data:i}=this;if(!n||i.pointsNumber===void 0||i.pointSizes===void 0)return;this.sizeBuffer||(this.sizeBuffer=e.buffer(0)),this.sizeBuffer(i.pointSizes);const r=new Float32Array(n*n*4);for(let s=0;s<i.pointsNumber;s++)r[s*4]=i.pointSizes[s];this.sizeTexture||(this.sizeTexture=e.texture()),this.sizeTexture({data:r,width:n,height:n,type:"float"}),this.sizeFbo||(this.sizeFbo=e.framebuffer()),this.sizeFbo({color:this.sizeTexture,depth:!1,stencil:!1})}updateSampledPointsGrid(){const{store:{screenSize:e},config:{pointSamplingDistance:n},reglInstance:i}=this;let r=n??Math.min(...e)/2;r===0&&(r=Nn.pointSamplingDistance);const s=Math.ceil(e[0]/r),a=Math.ceil(e[1]/r);this.sampledPointsFbo||(this.sampledPointsFbo=i.framebuffer()),this.sampledPointsFbo({shape:[s,a],depth:!1,stencil:!1,colorType:"float"})}trackPoints(){var e,n;(e=this.trackedIndices)!=null&&e.length&&((n=this.trackPointsCommand)==null||n.call(this))}draw(){var e,n,i,r,s;const{config:{renderHoveredPointRing:a,pointSize:o},store:l,data:u}=this;this.colorBuffer||this.updateColor(),this.sizeBuffer||this.updateSize(),(e=this.drawCommand)==null||e.call(this),a&&l.hoveredPoint&&((i=this.drawHighlightedCommand)==null||i.call(this,{width:.85,color:l.hoveredPointRingColor,pointIndex:l.hoveredPoint.index,size:((n=u.pointSizes)==null?void 0:n[l.hoveredPoint.index])??o})),l.focusedPoint&&((s=this.drawHighlightedCommand)==null||s.call(this,{width:.75,color:l.focusedPointRingColor,pointIndex:l.focusedPoint.index,size:((r=u.pointSizes)==null?void 0:r[l.focusedPoint.index])??o}))}updatePosition(){var e;(e=this.updatePositionCommand)==null||e.call(this),this.swapFbo()}drag(){var e;(e=this.dragPointCommand)==null||e.call(this),this.swapFbo()}findPointsOnAreaSelection(){var e;(e=this.findPointsOnAreaSelectionCommand)==null||e.call(this)}findPointsOnPolygonSelection(){var e;(e=this.findPointsOnPolygonSelectionCommand)==null||e.call(this)}updatePolygonPath(e){const{reglInstance:n}=this;if(this.polygonPathLength=e.length,e.length===0){this.polygonPathTexture=void 0,this.polygonPathFbo=void 0;return}const i=Math.ceil(Math.sqrt(e.length)),r=new Float32Array(i*i*4);for(const[s,a]of e.entries()){const[o,l]=a;r[s*4]=o,r[s*4+1]=l,r[s*4+2]=0,r[s*4+3]=0}this.polygonPathTexture||(this.polygonPathTexture=n.texture()),this.polygonPathTexture({data:r,width:i,height:i,type:"float"}),this.polygonPathFbo||(this.polygonPathFbo=n.framebuffer()),this.polygonPathFbo({color:this.polygonPathTexture,depth:!1,stencil:!1})}findHoveredPoint(){var e,n;(e=this.clearHoveredFboCommand)==null||e.call(this),(n=this.findHoveredPointCommand)==null||n.call(this)}trackPointsByIndices(e){const{store:{pointsTextureSize:n},reglInstance:i}=this;if(this.trackedIndices=e,!(e!=null&&e.length))return;const r=Math.ceil(Math.sqrt(e.length)),s=new Float32Array(r*r*4).fill(-1);for(const[a,o]of e.entries())o!==void 0&&(s[a*4]=o%n,s[a*4+1]=Math.floor(o/n),s[a*4+2]=0,s[a*4+3]=0);this.trackedIndicesTexture||(this.trackedIndicesTexture=i.texture()),this.trackedIndicesTexture({data:s,width:r,height:r,type:"float"}),this.trackedIndicesFbo||(this.trackedIndicesFbo=i.framebuffer()),this.trackedIndicesFbo({color:this.trackedIndicesTexture,depth:!1,stencil:!1}),this.trackedPositionsFbo||(this.trackedPositionsFbo=i.framebuffer()),this.trackedPositionsFbo({shape:[r,r],depth:!1,stencil:!1,colorType:"float"}),this.trackPoints()}getTrackedPositionsMap(){const e=new Map;if(!this.trackedIndices)return e;const n=Vu(this.reglInstance,this.trackedPositionsFbo);for(let i=0;i<n.length/4;i+=1){const r=n[i*4],s=n[i*4+1],a=this.trackedIndices[i];r!==void 0&&s!==void 0&&a!==void 0&&e.set(a,[r,s])}return e}getSampledPointPositionsMap(){var e,n;const i=new Map;if(!this.sampledPointsFbo)return i;(e=this.clearSampledPointsFboCommand)==null||e.call(this),(n=this.fillSampledPointsFboCommand)==null||n.call(this);const r=Vu(this.reglInstance,this.sampledPointsFbo);for(let s=0;s<r.length/4;s++){const a=r[s*4],o=!!r[s*4+1],l=r[s*4+2],u=r[s*4+3];o&&a!==void 0&&l!==void 0&&u!==void 0&&i.set(a,[l,u])}return i}swapFbo(){const e=this.previousPositionFbo;this.previousPositionFbo=this.currentPositionFbo,this.currentPositionFbo=e}rescaleInitialNodePositions(){const{config:{spaceSize:e}}=this;if(!this.data.pointPositions||!e)return;const n=this.data.pointPositions,i=n.length/2;let r=1/0,s=-1/0,a=1/0,o=-1/0;for(let _=0;_<n.length;_+=2){const y=n[_],g=n[_+1];r=Math.min(r,y),s=Math.max(s,y),a=Math.min(a,g),o=Math.max(o,g)}const l=s-r,u=o-a,c=Math.max(l,u);if(c>e){this.scaleX=void 0,this.scaleY=void 0;return}const h=e*e*.001,d=(i>h?e*Math.max(1.2,Math.sqrt(i)/e):e*.1)/c,m=(c-l)/2*d,v=(c-u)/2*d;this.scaleX=_=>(_-r)*d+m,this.scaleY=_=>(_-a)*d+v;for(let _=0;_<i;_++)this.data.pointPositions[_*2]=this.scaleX(n[_*2]),this.data.pointPositions[_*2+1]=this.scaleY(n[_*2+1])}}var pB=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function dxe(){var t=new pB(9);return pB!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function mB(t,e,n){var i=e[0],r=e[1],s=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=n[0],m=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=a,t[4]=o,t[5]=l,t[6]=d*i+m*a+u,t[7]=d*r+m*o+c,t[8]=d*s+m*l+h,t}function H3(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function pxe(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}var tO={exports:{}},mxe=tO.exports,gB;function gxe(){return gB||(gB=1,function(t){(function(e,n,i){function r(l){var u=this,c=o();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function s(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var c=new r(l),h=u&&u.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&s(h,c),d.state=function(){return s(c,{})}),d}function o(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=a:this.alea=a})(mxe,t)}(tO)),tO.exports}var nO={exports:{}},vxe=nO.exports,vB;function yxe(){return vB||(vB=1,function(t){(function(e,n,i){function r(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var u=new r(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,m=(u.next()>>>0)/4294967296,v=(d+m)/(1<<21);while(v===0);return v},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&s(c,u),h.state=function(){return s(u,{})}),h}n&&n.exports?n.exports=a:this.xor128=a})(vxe,t)}(nO)),nO.exports}var iO={exports:{}},xxe=iO.exports,yB;function _xe(){return yB||(yB=1,function(t){(function(e,n,i){function r(o){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var u=new r(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,m=(u.next()>>>0)/4294967296,v=(d+m)/(1<<21);while(v===0);return v},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&s(c,u),h.state=function(){return s(u,{})}),h}n&&n.exports?n.exports=a:this.xorwow=a})(xxe,t)}(iO)),iO.exports}var rO={exports:{}},bxe=rO.exports,xB;function Sxe(){return xB||(xB=1,function(t){(function(e,n,i){function r(o){var l=this;l.next=function(){var c=l.x,h=l.i,d,m;return d=c[h],d^=d>>>7,m=d^d<<24,d=c[h+1&7],m^=d^d>>>10,d=c[h+3&7],m^=d^d>>>3,d=c[h+4&7],m^=d^d<<7,d=c[h+7&7],d=d^d<<13,m^=d^d<<9,c[h]=m,l.i=h+1&7,m};function u(c,h){var d,m=[];if(h===(h|0))m[0]=h;else for(h=""+h,d=0;d<h.length;++d)m[d&7]=m[d&7]<<15^h.charCodeAt(d)+m[d+1&7]<<13;for(;m.length<8;)m.push(0);for(d=0;d<8&&m[d]===0;++d);for(d==8?m[7]=-1:m[d],c.x=m,c.i=0,d=256;d>0;--d)c.next()}u(l,o)}function s(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var u=new r(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,m=(u.next()>>>0)/4294967296,v=(d+m)/(1<<21);while(v===0);return v},h.int32=u.next,h.quick=h,c&&(c.x&&s(c,u),h.state=function(){return s(u,{})}),h}n&&n.exports?n.exports=a:this.xorshift7=a})(bxe,t)}(rO)),rO.exports}var sO={exports:{}},Exe=sO.exports,_B;function wxe(){return _B||(_B=1,function(t){(function(e,n,i){function r(o){var l=this;l.next=function(){var c=l.w,h=l.X,d=l.i,m,v;return l.w=c=c+1640531527|0,v=h[d+34&127],m=h[d=d+1&127],v^=v<<13,m^=m<<17,v^=v>>>15,m^=m>>>12,v=h[d]=v^m,l.i=d,v+(c^c>>>16)|0};function u(c,h){var d,m,v,_,y,g=[],x=128;for(h===(h|0)?(m=h,h=null):(h=h+"\0",m=0,x=Math.max(x,h.length)),v=0,_=-32;_<x;++_)h&&(m^=h.charCodeAt((_+32)%h.length)),_===0&&(y=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,_>=0&&(y=y+1640531527|0,d=g[_&127]^=m+y,v=d==0?v+1:0);for(v>=128&&(g[(h&&h.length||0)&127]=-1),v=127,_=4*128;_>0;--_)m=g[v+34&127],d=g[v=v+1&127],m^=m<<13,d^=d<<17,m^=m>>>15,d^=d>>>12,g[v]=m^d;c.w=y,c.X=g,c.i=v}u(l,o)}function s(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var u=new r(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,m=(u.next()>>>0)/4294967296,v=(d+m)/(1<<21);while(v===0);return v},h.int32=u.next,h.quick=h,c&&(c.X&&s(c,u),h.state=function(){return s(u,{})}),h}n&&n.exports?n.exports=a:this.xor4096=a})(Exe,t)}(sO)),sO.exports}var aO={exports:{}},Axe=aO.exports,bB;function Txe(){return bB||(bB=1,function(t){(function(e,n,i){function r(o){var l=this,u="";l.next=function(){var h=l.b,d=l.c,m=l.d,v=l.a;return h=h<<25^h>>>7^d,d=d-m|0,m=m<<24^m>>>8^v,v=v-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-m|0,l.d=m<<16^d>>>16^v,l.a=v-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function s(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var u=new r(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,m=(u.next()>>>0)/4294967296,v=(d+m)/(1<<21);while(v===0);return v},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&s(c,u),h.state=function(){return s(u,{})}),h}n&&n.exports?n.exports=a:this.tychei=a})(Axe,t)}(aO)),aO.exports}var oO={exports:{}};const Mxe={},Cxe=Object.freeze(Object.defineProperty({__proto__:null,default:Mxe},Symbol.toStringTag,{value:"Module"})),Rxe=Cve(Cxe);var Dxe=oO.exports,SB;function Oxe(){return SB||(SB=1,function(t){(function(e,n,i){var r=256,s=6,a=52,o="random",l=i.pow(r,s),u=i.pow(2,a),c=u*2,h=r-1,d;function m(E,A,T){var C=[];A=A==!0?{entropy:!0}:A||{};var O=g(y(A.entropy?[E,S(n)]:E??x(),3),C),M=new v(C),D=function(){for(var P=M.g(s),F=l,G=0;P<u;)P=(P+G)*r,F*=r,G=M.g(1);for(;P>=c;)P/=2,F/=2,G>>>=1;return(P+G)/F};return D.int32=function(){return M.g(4)|0},D.quick=function(){return M.g(4)/4294967296},D.double=D,g(S(M.S),n),(A.pass||T||function(P,F,G,z){return z&&(z.S&&_(z,M),P.state=function(){return _(M,{})}),G?(i[o]=P,F):P})(D,O,"global"in A?A.global:this==i,A.state)}function v(E){var A,T=E.length,C=this,O=0,M=C.i=C.j=0,D=C.S=[];for(T||(E=[T++]);O<r;)D[O]=O++;for(O=0;O<r;O++)D[O]=D[M=h&M+E[O%T]+(A=D[O])],D[M]=A;(C.g=function(P){for(var F,G=0,z=C.i,Y=C.j,N=C.S;P--;)F=N[z=h&z+1],G=G*r+N[h&(N[z]=N[Y=h&Y+F])+(N[Y]=F)];return C.i=z,C.j=Y,G})(r)}function _(E,A){return A.i=E.i,A.j=E.j,A.S=E.S.slice(),A}function y(E,A){var T=[],C=typeof E,O;if(A&&C=="object")for(O in E)try{T.push(y(E[O],A-1))}catch{}return T.length?T:C=="string"?E:E+"\0"}function g(E,A){for(var T=E+"",C,O=0;O<T.length;)A[h&O]=h&(C^=A[h&O]*19)+T.charCodeAt(O++);return S(A)}function x(){try{var E;return d&&(E=d.randomBytes)?E=E(r):(E=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(E)),S(E)}catch{var A=e.navigator,T=A&&A.plugins;return[+new Date,e,T,e.screen,S(n)]}}function S(E){return String.fromCharCode.apply(0,E)}if(g(i.random(),n),t.exports){t.exports=m;try{d=Rxe}catch{}}else i["seed"+o]=m})(typeof self<"u"?self:Dxe,[],Math)}(oO)),oO.exports}var j3,EB;function Uxe(){if(EB)return j3;EB=1;var t=gxe(),e=yxe(),n=_xe(),i=Sxe(),r=wxe(),s=Txe(),a=Oxe();return a.alea=t,a.xor128=e,a.xorwow=n,a.xorshift7=i,a.xor4096=r,a.tychei=s,j3=a,j3}var zxe=Uxe();const Ixe=dI(zxe);function Lxe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Nxe(i.key),i)}}function mI(t,e,n){return e&&Lxe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Y7(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,lO(t,e)}function lO(t,e){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lO(t,e)}function Pxe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Nxe(t){var e=Pxe(t,"string");return typeof e=="symbol"?e:String(e)}var eM=function(){function t(){}var e=t.prototype;return e._seed=function(n,i){if(n===(n||0))return n;for(var r=""+n,s=0,a=0;a<r.length;++a)s^=r.charCodeAt(a)|0;return s},t}(),wB=function(t){Y7(e,t);function e(i,r){var s;return s=t.call(this)||this,s._rng=void 0,s.seed(i,r),s}var n=e.prototype;return n.next=function(){return this._rng()},n.seed=function(i,r){this._rng=i},n.clone=function(i,r){return new e(this._rng,r)},mI(e,[{key:"name",get:function(){return"function"}}]),e}(eM),AB=function(){var t=[].slice.call(arguments),e=t,n=e[0],i=n===void 0?"default":n;switch(typeof i){case"object":if(i instanceof eM)return i;break;case"function":return new wB(i);case"number":case"string":default:return new wB(Ixe.apply(void 0,t))}throw new Error('invalid RNG "'+i+'"')},Bxe=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),function(){return t.next()*(n-e)+e}};function ou(t){return new kxe(t)}var kxe=function(t){var e=this;this.n=void 0,this.isInt=function(){if(Number.isInteger(e.n))return e;throw new Error("Expected number to be an integer, got "+e.n)},this.isPositive=function(){if(e.n>0)return e;throw new Error("Expected number to be positive, got "+e.n)},this.lessThan=function(n){if(e.n<n)return e;throw new Error("Expected number to be less than "+n+", got "+e.n)},this.greaterThanOrEqual=function(n){if(e.n>=n)return e;throw new Error("Expected number to be greater than or equal to "+n+", got "+e.n)},this.greaterThan=function(n){if(e.n>n)return e;throw new Error("Expected number to be greater than "+n+", got "+e.n)},this.n=t},Fxe=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),n===void 0&&(n=e===void 0?1:e,e=0),ou(e).isInt(),ou(n).isInt(),function(){return Math.floor(t.next()*(n-e+1)+e)}},Gxe=function(t){return function(){return t.next()>=.5}},Vxe=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),function(){var i,r,s;do i=t.next()*2-1,r=t.next()*2-1,s=i*i+r*r;while(!s||s>1);return e+n*r*Math.sqrt(-2*Math.log(s)/s)}},Hxe=function(t,e,n){e===void 0&&(e=0),n===void 0&&(n=1);var i=t.normal(e,n);return function(){return Math.exp(i())}},jxe=function(t,e){return e===void 0&&(e=.5),ou(e).greaterThanOrEqual(0).lessThan(1),function(){return Math.floor(t.next()+e)}},Wxe=function(t,e,n){return e===void 0&&(e=1),n===void 0&&(n=.5),ou(e).isInt().isPositive(),ou(n).greaterThanOrEqual(0).lessThan(1),function(){for(var i=0,r=0;i++<e;)t.next()<n&&r++;return r}},Xxe=function(t,e){e===void 0&&(e=.5),ou(e).greaterThan(0).lessThan(1);var n=1/Math.log(1-e);return function(){return Math.floor(1+Math.log(t.next())*n)}},Yxe=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469],Zxe=function(t){return Yxe[t]},qxe=.9189385332046727,Kxe=function(t,e){if(e===void 0&&(e=1),ou(e).isPositive(),e<10){var n=Math.exp(-e);return function(){for(var l=n,u=0,c=t.next();c>l;)c=c-l,l=e*l/++u;return u}}else{var i=Math.sqrt(e),r=.931+2.53*i,s=-.059+.02483*r,a=1.1239+1.1328/(r-3.4),o=.9277-3.6224/(r-2);return function(){for(;;){var l=void 0,u=t.next();if(u<=.86*o)return l=u/o-.43,Math.floor((2*s/(.5-Math.abs(l))+r)*l+e+.445);u>=o?l=t.next()-.5:(l=u/o-.93,l=(l<0?-.5:.5)-l,u=t.next()*o);var c=.5-Math.abs(l);if(!(c<.013&&u>c)){var h=Math.floor((2*s/c+r)*l+e+.445);if(u=u*a/(s/(c*c)+r),h>=10){var d=(h+.5)*Math.log(e/h)-e-qxe+h-(.08333333333333333-(.002777777777777778-1/(1260*h*h))/(h*h))/h;if(Math.log(u*i)<=d)return h}else if(h>=0){var m,v=(m=Zxe(h))!=null?m:0;if(Math.log(u)<=h*Math.log(e)-e-v)return h}}}}}},Qxe=function(t,e){return e===void 0&&(e=1),ou(e).isPositive(),function(){return-Math.log(1-t.next())/e}},Jxe=function(t,e){return e===void 0&&(e=1),ou(e).isInt().greaterThanOrEqual(0),function(){for(var n=0,i=0;i<e;++i)n+=t.next();return n}},$xe=function(t,e){e===void 0&&(e=1),ou(e).isInt().isPositive();var n=t.irwinHall(e);return function(){return n()/e}},e1e=function(t,e){e===void 0&&(e=1),ou(e).greaterThanOrEqual(0);var n=1/e;return function(){return 1/Math.pow(1-t.next(),n)}},t1e=function(t){Y7(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.next=function(){return Math.random()},n.seed=function(i,r){},n.clone=function(){return new e},mI(e,[{key:"name",get:function(){return"default"}}]),e}(eM),Z7=function(){function t(n){var i=this;this._rng=void 0,this._patch=void 0,this._cache={},this.next=function(){return i._rng.next()},this.float=function(r,s){return i.uniform(r,s)()},this.int=function(r,s){return i.uniformInt(r,s)()},this.integer=function(r,s){return i.uniformInt(r,s)()},this.bool=function(){return i.uniformBoolean()()},this.boolean=function(){return i.uniformBoolean()()},this.uniform=function(r,s){return i._memoize("uniform",Bxe,r,s)},this.uniformInt=function(r,s){return i._memoize("uniformInt",Fxe,r,s)},this.uniformBoolean=function(){return i._memoize("uniformBoolean",Gxe)},this.normal=function(r,s){return Vxe(i,r,s)},this.logNormal=function(r,s){return Hxe(i,r,s)},this.bernoulli=function(r){return jxe(i,r)},this.binomial=function(r,s){return Wxe(i,r,s)},this.geometric=function(r){return Xxe(i,r)},this.poisson=function(r){return Kxe(i,r)},this.exponential=function(r){return Qxe(i,r)},this.irwinHall=function(r){return Jxe(i,r)},this.bates=function(r){return $xe(i,r)},this.pareto=function(r){return e1e(i,r)},n&&n instanceof eM?this.use(n):this.use(new t1e),this._cache={}}var e=t.prototype;return e.clone=function(){var n=[].slice.call(arguments);return n.length?new t(AB.apply(void 0,n)):new t(this.rng.clone())},e.use=function(){this._rng=AB.apply(void 0,[].slice.call(arguments))},e.patch=function(){if(this._patch)throw new Error("Math.random already patched");this._patch=Math.random,Math.random=this.uniform()},e.unpatch=function(){this._patch&&(Math.random=this._patch,delete this._patch)},e.choice=function(n){if(!Array.isArray(n))throw new Error("Random.choice expected input to be an array, got "+typeof n);var i=n==null?void 0:n.length;if(i>0){var r=this.uniformInt(0,i-1)();return n[r]}else return},e._memoize=function(n,i){var r=[].slice.call(arguments,2),s=""+r.join(";"),a=this._cache[n];return(a===void 0||a.key!==s)&&(a={key:s,distribution:i.apply(void 0,[this].concat(r))},this._cache[n]=a),a.distribution},mI(t,[{key:"rng",get:function(){return this._rng}}]),t}();new Z7;const uO=.001,cO=64;class n1e{constructor(){this.pointsTextureSize=0,this.linksTextureSize=0,this.alpha=1,this.transform=dxe(),this.screenSize=[0,0],this.mousePosition=[0,0],this.screenMousePosition=[0,0],this.selectedArea=[[0,0],[0,0]],this.isSimulationRunning=!1,this.simulationProgress=0,this.selectedIndices=null,this.maxPointSize=cO,this.hoveredPoint=void 0,this.focusedPoint=void 0,this.draggingPointIndex=void 0,this.adjustedSpaceSize=Nn.spaceSize,this.isSpaceKeyPressed=!1,this.hoveredPointRingColor=[1,1,1,Gve],this.focusedPointRingColor=[1,1,1,Vve],this.greyoutPointColor=[-1,-1,-1,-1],this.darkenGreyout=!1,this.alphaTarget=0,this.scalePointX=eO(),this.scalePointY=eO(),this.random=new Z7,this._backgroundColor=[0,0,0,0],this.alphaDecay=e=>1-Math.pow(uO,1/e)}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e;const n=Yve(e[0],e[1],e[2]);document.documentElement.style.setProperty("--cosmosgl-attribution-color",n>.65?"black":"white"),document.documentElement.style.setProperty("--cosmosgl-error-message-color",n>.65?"black":"white"),this.div&&(this.div.style.backgroundColor=`rgba(${e[0]*255}, ${e[1]*255}, ${e[2]*255}, ${e[3]})`),this.darkenGreyout=n<.65}addRandomSeed(e){this.random=this.random.clone(e)}getRandomFloat(e,n){return this.random.float(e,n)}adjustSpaceSize(e,n){e>=n?(this.adjustedSpaceSize=n/2,console.warn(`The \`spaceSize\` has been reduced to ${this.adjustedSpaceSize} due to WebGL limits`)):this.adjustedSpaceSize=e}updateScreenSize(e,n){const{adjustedSpaceSize:i}=this;this.screenSize=[e,n],this.scalePointX.domain([0,i]).range([(e-i)/2,(e+i)/2]),this.scalePointY.domain([i,0]).range([(n-i)/2,(n+i)/2])}scaleX(e){return this.scalePointX(e)}scaleY(e){return this.scalePointY(e)}setHoveredPointRingColor(e){const n=jp(e);this.hoveredPointRingColor[0]=n[0],this.hoveredPointRingColor[1]=n[1],this.hoveredPointRingColor[2]=n[2]}setFocusedPointRingColor(e){const n=jp(e);this.focusedPointRingColor[0]=n[0],this.focusedPointRingColor[1]=n[1],this.focusedPointRingColor[2]=n[2]}setGreyoutPointColor(e){if(e===void 0){this.greyoutPointColor=[-1,-1,-1,-1];return}const n=jp(e);this.greyoutPointColor[0]=n[0],this.greyoutPointColor[1]=n[1],this.greyoutPointColor[2]=n[2],this.greyoutPointColor[3]=n[3]}setFocusedPoint(e){e!==void 0?this.focusedPoint={index:e}:this.focusedPoint=void 0}addAlpha(e){return(this.alphaTarget-this.alpha)*this.alphaDecay(e)}}const i1e={passive:!1},v_={capture:!0,passive:!1};function W3(t){t.stopImmediatePropagation()}function M0(t){t.preventDefault(),t.stopImmediatePropagation()}function q7(t){var e=t.document.documentElement,n=Ws(t).on("dragstart.drag",M0,v_);"onselectstart"in e?n.on("selectstart.drag",M0,v_):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function K7(t,e){var n=t.document.documentElement,i=Ws(t).on("dragstart.drag",null);e&&(i.on("click.drag",M0,v_),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const W2=t=>()=>t;function fO(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:s,x:a,y:o,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}fO.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function r1e(t){return!t.ctrlKey&&!t.button}function s1e(){return this.parentNode}function a1e(t,e){return e??{x:t.x,y:t.y}}function o1e(){return navigator.maxTouchPoints||"ontouchstart"in this}function l1e(){var t=r1e,e=s1e,n=a1e,i=o1e,r={},s=QT("start","drag","end"),a=0,o,l,u,c,h=0;function d(E){E.on("mousedown.drag",m).filter(i).on("touchstart.drag",y).on("touchmove.drag",g,i1e).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(E,A){if(!(c||!t.call(this,E,A))){var T=S(this,e.call(this,E,A),E,A,"mouse");T&&(Ws(E.view).on("mousemove.drag",v,v_).on("mouseup.drag",_,v_),q7(E.view),W3(E),u=!1,o=E.clientX,l=E.clientY,T("start",E))}}function v(E){if(M0(E),!u){var A=E.clientX-o,T=E.clientY-l;u=A*A+T*T>h}r.mouse("drag",E)}function _(E){Ws(E.view).on("mousemove.drag mouseup.drag",null),K7(E.view,u),M0(E),r.mouse("end",E)}function y(E,A){if(t.call(this,E,A)){var T=E.changedTouches,C=e.call(this,E,A),O=T.length,M,D;for(M=0;M<O;++M)(D=S(this,C,E,A,T[M].identifier,T[M]))&&(W3(E),D("start",E,T[M]))}}function g(E){var A=E.changedTouches,T=A.length,C,O;for(C=0;C<T;++C)(O=r[A[C].identifier])&&(M0(E),O("drag",E,A[C]))}function x(E){var A=E.changedTouches,T=A.length,C,O;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),C=0;C<T;++C)(O=r[A[C].identifier])&&(W3(E),O("end",E,A[C]))}function S(E,A,T,C,O,M){var D=s.copy(),P=$c(M||T,A),F,G,z;if((z=n.call(E,new fO("beforestart",{sourceEvent:T,target:d,identifier:O,active:a,x:P[0],y:P[1],dx:0,dy:0,dispatch:D}),C))!=null)return F=z.x-P[0]||0,G=z.y-P[1]||0,function Y(N,k,j){var X=P,Q;switch(N){case"start":r[O]=Y,Q=a++;break;case"end":delete r[O],--a;case"drag":P=$c(j||k,A),Q=a;break}D.call(N,E,new fO(N,{sourceEvent:k,subject:z,target:d,identifier:O,active:Q,x:P[0]+F,y:P[1]+G,dx:P[0]-X[0],dy:P[1]-X[1],dispatch:D}),C)}}return d.filter=function(E){return arguments.length?(t=typeof E=="function"?E:W2(!!E),d):t},d.container=function(E){return arguments.length?(e=typeof E=="function"?E:W2(E),d):e},d.subject=function(E){return arguments.length?(n=typeof E=="function"?E:W2(E),d):n},d.touchable=function(E){return arguments.length?(i=typeof E=="function"?E:W2(!!E),d):i},d.on=function(){var E=s.on.apply(s,arguments);return E===s?d:E},d.clickDistance=function(E){return arguments.length?(h=(E=+E)*E,d):Math.sqrt(h)},d}const X2=t=>()=>t;function u1e(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function hf(t,e,n){this.k=t,this.x=e,this.y=n}hf.prototype={constructor:hf,scale:function(t){return t===1?this:new hf(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new hf(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var v1=new hf(1,0,0);hf.prototype;function X3(t){t.stopImmediatePropagation()}function Ax(t){t.preventDefault(),t.stopImmediatePropagation()}function c1e(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function f1e(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function TB(){return this.__zoom||v1}function h1e(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function d1e(){return navigator.maxTouchPoints||"ontouchstart"in this}function p1e(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),a>s?(s+a)/2:Math.min(0,s)||Math.max(0,a))}function m1e(){var t=c1e,e=f1e,n=p1e,i=h1e,r=d1e,s=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],o=250,l=b0e,u=QT("start","zoom","end"),c,h,d,m=500,v=150,_=0,y=10;function g(z){z.property("__zoom",TB).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",D).filter(r).on("touchstart.zoom",P).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",G).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(z,Y,N,k){var j=z.selection?z.selection():z;j.property("__zoom",TB),z!==j?A(z,Y,N,k):j.interrupt().each(function(){T(this,arguments).event(k).start().zoom(null,typeof Y=="function"?Y.apply(this,arguments):Y).end()})},g.scaleBy=function(z,Y,N,k){g.scaleTo(z,function(){var j=this.__zoom.k,X=typeof Y=="function"?Y.apply(this,arguments):Y;return j*X},N,k)},g.scaleTo=function(z,Y,N,k){g.transform(z,function(){var j=e.apply(this,arguments),X=this.__zoom,Q=N==null?E(j):typeof N=="function"?N.apply(this,arguments):N,H=X.invert(Q),$=typeof Y=="function"?Y.apply(this,arguments):Y;return n(S(x(X,$),Q,H),j,a)},N,k)},g.translateBy=function(z,Y,N,k){g.transform(z,function(){return n(this.__zoom.translate(typeof Y=="function"?Y.apply(this,arguments):Y,typeof N=="function"?N.apply(this,arguments):N),e.apply(this,arguments),a)},null,k)},g.translateTo=function(z,Y,N,k,j){g.transform(z,function(){var X=e.apply(this,arguments),Q=this.__zoom,H=k==null?E(X):typeof k=="function"?k.apply(this,arguments):k;return n(v1.translate(H[0],H[1]).scale(Q.k).translate(typeof Y=="function"?-Y.apply(this,arguments):-Y,typeof N=="function"?-N.apply(this,arguments):-N),X,a)},k,j)};function x(z,Y){return Y=Math.max(s[0],Math.min(s[1],Y)),Y===z.k?z:new hf(Y,z.x,z.y)}function S(z,Y,N){var k=Y[0]-N[0]*z.k,j=Y[1]-N[1]*z.k;return k===z.x&&j===z.y?z:new hf(z.k,k,j)}function E(z){return[(+z[0][0]+ +z[1][0])/2,(+z[0][1]+ +z[1][1])/2]}function A(z,Y,N,k){z.on("start.zoom",function(){T(this,arguments).event(k).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(k).end()}).tween("zoom",function(){var j=this,X=arguments,Q=T(j,X).event(k),H=e.apply(j,X),$=N==null?E(H):typeof N=="function"?N.apply(j,X):N,ne=Math.max(H[1][0]-H[0][0],H[1][1]-H[0][1]),q=j.__zoom,se=typeof Y=="function"?Y.apply(j,X):Y,ve=l(q.invert($).concat(ne/q.k),se.invert($).concat(ne/se.k));return function(pe){if(pe===1)pe=se;else{var xe=ve(pe),ot=ne/xe[2];pe=new hf(ot,$[0]-xe[0]*ot,$[1]-xe[1]*ot)}Q.zoom(null,pe)}})}function T(z,Y,N){return!N&&z.__zooming||new C(z,Y)}function C(z,Y){this.that=z,this.args=Y,this.active=0,this.sourceEvent=null,this.extent=e.apply(z,Y),this.taps=0}C.prototype={event:function(z){return z&&(this.sourceEvent=z),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(z,Y){return this.mouse&&z!=="mouse"&&(this.mouse[1]=Y.invert(this.mouse[0])),this.touch0&&z!=="touch"&&(this.touch0[1]=Y.invert(this.touch0[0])),this.touch1&&z!=="touch"&&(this.touch1[1]=Y.invert(this.touch1[0])),this.that.__zoom=Y,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(z){var Y=Ws(this.that).datum();u.call(z,this.that,new u1e(z,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:u}),Y)}};function O(z,...Y){if(!t.apply(this,arguments))return;var N=T(this,Y).event(z),k=this.__zoom,j=Math.max(s[0],Math.min(s[1],k.k*Math.pow(2,i.apply(this,arguments)))),X=$c(z);if(N.wheel)(N.mouse[0][0]!==X[0]||N.mouse[0][1]!==X[1])&&(N.mouse[1]=k.invert(N.mouse[0]=X)),clearTimeout(N.wheel);else{if(k.k===j)return;N.mouse=[X,k.invert(X)],AE(this),N.start()}Ax(z),N.wheel=setTimeout(Q,v),N.zoom("mouse",n(S(x(k,j),N.mouse[0],N.mouse[1]),N.extent,a));function Q(){N.wheel=null,N.end()}}function M(z,...Y){if(d||!t.apply(this,arguments))return;var N=z.currentTarget,k=T(this,Y,!0).event(z),j=Ws(z.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",ne,!0),X=$c(z,N),Q=z.clientX,H=z.clientY;q7(z.view),X3(z),k.mouse=[X,this.__zoom.invert(X)],AE(this),k.start();function $(q){if(Ax(q),!k.moved){var se=q.clientX-Q,ve=q.clientY-H;k.moved=se*se+ve*ve>_}k.event(q).zoom("mouse",n(S(k.that.__zoom,k.mouse[0]=$c(q,N),k.mouse[1]),k.extent,a))}function ne(q){j.on("mousemove.zoom mouseup.zoom",null),K7(q.view,k.moved),Ax(q),k.event(q).end()}}function D(z,...Y){if(t.apply(this,arguments)){var N=this.__zoom,k=$c(z.changedTouches?z.changedTouches[0]:z,this),j=N.invert(k),X=N.k*(z.shiftKey?.5:2),Q=n(S(x(N,X),k,j),e.apply(this,Y),a);Ax(z),o>0?Ws(this).transition().duration(o).call(A,Q,k,z):Ws(this).call(g.transform,Q,k,z)}}function P(z,...Y){if(t.apply(this,arguments)){var N=z.touches,k=N.length,j=T(this,Y,z.changedTouches.length===k).event(z),X,Q,H,$;for(X3(z),Q=0;Q<k;++Q)H=N[Q],$=$c(H,this),$=[$,this.__zoom.invert($),H.identifier],j.touch0?!j.touch1&&j.touch0[2]!==$[2]&&(j.touch1=$,j.taps=0):(j.touch0=$,X=!0,j.taps=1+!!c);c&&(c=clearTimeout(c)),X&&(j.taps<2&&(h=$[0],c=setTimeout(function(){c=null},m)),AE(this),j.start())}}function F(z,...Y){if(this.__zooming){var N=T(this,Y).event(z),k=z.changedTouches,j=k.length,X,Q,H,$;for(Ax(z),X=0;X<j;++X)Q=k[X],H=$c(Q,this),N.touch0&&N.touch0[2]===Q.identifier?N.touch0[0]=H:N.touch1&&N.touch1[2]===Q.identifier&&(N.touch1[0]=H);if(Q=N.that.__zoom,N.touch1){var ne=N.touch0[0],q=N.touch0[1],se=N.touch1[0],ve=N.touch1[1],pe=(pe=se[0]-ne[0])*pe+(pe=se[1]-ne[1])*pe,xe=(xe=ve[0]-q[0])*xe+(xe=ve[1]-q[1])*xe;Q=x(Q,Math.sqrt(pe/xe)),H=[(ne[0]+se[0])/2,(ne[1]+se[1])/2],$=[(q[0]+ve[0])/2,(q[1]+ve[1])/2]}else if(N.touch0)H=N.touch0[0],$=N.touch0[1];else return;N.zoom("touch",n(S(Q,H,$),N.extent,a))}}function G(z,...Y){if(this.__zooming){var N=T(this,Y).event(z),k=z.changedTouches,j=k.length,X,Q;for(X3(z),d&&clearTimeout(d),d=setTimeout(function(){d=null},m),X=0;X<j;++X)Q=k[X],N.touch0&&N.touch0[2]===Q.identifier?delete N.touch0:N.touch1&&N.touch1[2]===Q.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(Q=$c(Q,this),Math.hypot(h[0]-Q[0],h[1]-Q[1])<y)){var H=Ws(this).on("dblclick.zoom");H&&H.apply(this,arguments)}}}return g.wheelDelta=function(z){return arguments.length?(i=typeof z=="function"?z:X2(+z),g):i},g.filter=function(z){return arguments.length?(t=typeof z=="function"?z:X2(!!z),g):t},g.touchable=function(z){return arguments.length?(r=typeof z=="function"?z:X2(!!z),g):r},g.extent=function(z){return arguments.length?(e=typeof z=="function"?z:X2([[+z[0][0],+z[0][1]],[+z[1][0],+z[1][1]]]),g):e},g.scaleExtent=function(z){return arguments.length?(s[0]=+z[0],s[1]=+z[1],g):[s[0],s[1]]},g.translateExtent=function(z){return arguments.length?(a[0][0]=+z[0][0],a[1][0]=+z[1][0],a[0][1]=+z[0][1],a[1][1]=+z[1][1],g):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},g.constrain=function(z){return arguments.length?(n=z,g):n},g.duration=function(z){return arguments.length?(o=+z,g):o},g.interpolate=function(z){return arguments.length?(l=z,g):l},g.on=function(){var z=u.on.apply(u,arguments);return z===u?g:z},g.clickDistance=function(z){return arguments.length?(_=(z=+z)*z,g):Math.sqrt(_)},g.tapDistance=function(z){return arguments.length?(y=+z,g):y},g}class g1e{constructor(e,n){this.eventTransform=v1,this.behavior=m1e().scaleExtent([.001,1/0]).on("start",i=>{var r,s;this.isRunning=!0;const a=!!i.sourceEvent;(s=(r=this.config)==null?void 0:r.onZoomStart)==null||s.call(r,i,a)}).on("zoom",i=>{var r,s;this.eventTransform=i.transform;const{eventTransform:{x:a,y:o,k:l},store:{transform:u,screenSize:c}}=this,h=c[0],d=c[1];if(!h||!d)return;pxe(u,h,d),mB(u,u,[a,o]),H3(u,u,[l,l]),mB(u,u,[h/2,d/2]),H3(u,u,[h/2,d/2]),H3(u,u,[1,-1]);const m=!!i.sourceEvent;(s=(r=this.config)==null?void 0:r.onZoom)==null||s.call(r,i,m)}).on("end",i=>{var r,s;this.isRunning=!1;const a=!!i.sourceEvent;(s=(r=this.config)==null?void 0:r.onZoomEnd)==null||s.call(r,i,a)}),this.isRunning=!1,this.store=e,this.config=n}getTransform(e,n,i=.1){if(e.length===0)return this.eventTransform;const{store:{screenSize:r}}=this,s=r[0],a=r[1],o=aB(e.map(y=>y[0])),l=aB(e.map(y=>y[1]));o[0]=this.store.scaleX(o[0]),o[1]=this.store.scaleX(o[1]),l[0]=this.store.scaleY(l[0]),l[1]=this.store.scaleY(l[1]),o[0]===o[1]&&(o[0]-=.5,o[1]+=.5),l[0]===l[1]&&(l[0]+=.5,l[1]-=.5);const u=s*(1-i*2)/(o[1]-o[0]),c=a*(1-i*2)/(l[0]-l[1]),h=Zve(n??Math.min(u,c),...this.behavior.scaleExtent()),d=(o[1]+o[0])/2,m=(l[1]+l[0])/2,v=s/2-d*h,_=a/2-m*h;return v1.translate(v,_).scale(h)}getDistanceToPoint(e){const{x:n,y:i,k:r}=this.eventTransform,s=this.getTransform([e],r),a=n-s.x,o=i-s.y;return Math.sqrt(a*a+o*o)}getMiddlePointTransform(e){const{store:{screenSize:n},eventTransform:{x:i,y:r,k:s}}=this,a=n[0],o=n[1],l=(a/2-i)/s,u=(o/2-r)/s,c=this.store.scaleX(e[0]),h=this.store.scaleY(e[1]),d=(l+c)/2,m=(u+h)/2,v=1,_=a/2-d*v,y=o/2-m*v;return v1.translate(_,y).scale(v)}convertScreenToSpacePosition(e){const{eventTransform:{x:n,y:i,k:r},store:{screenSize:s}}=this,a=s[0],o=s[1],l=(e[0]-n)/r,u=(e[1]-i)/r,c=[l,o-u];return c[0]-=(a-this.store.adjustedSpaceSize)/2,c[1]-=(o-this.store.adjustedSpaceSize)/2,c}convertSpaceToScreenPosition(e){const n=this.eventTransform.applyX(this.store.scaleX(e[0])),i=this.eventTransform.applyY(this.store.scaleY(e[1]));return[n,i]}convertSpaceToScreenRadius(e){const{config:{scalePointsOnZoom:n},store:{maxPointSize:i},eventTransform:{k:r}}=this;let s=e*2;return n?s*=r:s*=Math.min(5,Math.max(1,r*.01)),Math.min(s,i)/2}}class v1e{constructor(e,n){this.isActive=!1,this.behavior=l1e().subject(i=>this.store.hoveredPoint&&!this.store.isSpaceKeyPressed?{x:i.x,y:i.y}:void 0).on("start",i=>{var r,s;this.store.hoveredPoint&&(this.store.draggingPointIndex=this.store.hoveredPoint.index,this.isActive=!0,(s=(r=this.config)==null?void 0:r.onDragStart)==null||s.call(r,i))}).on("drag",i=>{var r,s;(s=(r=this.config)==null?void 0:r.onDrag)==null||s.call(r,i)}).on("end",i=>{var r,s;this.isActive=!1,this.store.draggingPointIndex=void 0,(s=(r=this.config)==null?void 0:r.onDragEnd)==null||s.call(r,i)}),this.store=e,this.config=n}}function y1e(t){const e=document.createElement("div");return e.style.cssText=`
    color: var(--cosmosgl-error-message-color);
    padding: 0em 2em;
    position: absolute;
    top: 50%; left: 0; right: 0;
    transform: translateY(-50%);
    z-index: 1000;
    font-family: inherit;
    font-size: 1rem;
    text-align: center;
    user-select: none;
  `,e.textContent="Sorry, your device or browser does not support the required WebGL features for this visualization",t.appendChild(e),e}class x1e{constructor(e,n){this.config=new qve,this.graph=new xye(this.config),this.requestAnimationFrameId=0,this.isRightClickMouse=!1,this.store=new n1e,this.zoomInstance=new g1e(this.store,this.config),this.dragInstance=new v1e(this.store,this.config),this._findHoveredPointExecutionCount=0,this._isMouseOnCanvas=!1,this._isFirstRenderAfterInit=!0,this._needsPointPositionsUpdate=!1,this._needsPointColorUpdate=!1,this._needsPointSizeUpdate=!1,this._needsLinksUpdate=!1,this._needsLinkColorUpdate=!1,this._needsLinkWidthUpdate=!1,this._needsLinkArrowUpdate=!1,this._needsPointClusterUpdate=!1,this._needsForceManyBodyUpdate=!1,this._needsForceLinkUpdate=!1,this._needsForceCenterUpdate=!1,this._isDestroyed=!1,n&&this.config.init(n),this.store.div=e;const i=document.createElement("canvas");i.style.width="100%",i.style.height="100%",this.store.div.appendChild(i),this.addAttribution();const r=i.clientWidth,s=i.clientHeight;i.width=r*this.config.pixelRatio,i.height=s*this.config.pixelRatio,this.canvas=i;let a;try{a=Uve({canvas:this.canvas,attributes:{antialias:!1,preserveDrawingBuffer:!0},extensions:["OES_texture_float","ANGLE_instanced_arrays"]})}catch{y1e(this.store.div),this._isDestroyed=!0;return}this.reglInstance=a,this.store.adjustSpaceSize(this.config.spaceSize,this.reglInstance.limits.maxTextureSize),this.store.updateScreenSize(r,s),this.canvasD3Selection=Ws(this.canvas),this.canvasD3Selection.on("mouseenter.cosmos",()=>{this._isMouseOnCanvas=!0}).on("mousemove.cosmos",()=>{this._isMouseOnCanvas=!0}).on("mouseleave.cosmos",()=>{this._isMouseOnCanvas=!1}),Ws(document).on("keydown.cosmos",o=>{o.code==="Space"&&(this.store.isSpaceKeyPressed=!0)}).on("keyup.cosmos",o=>{o.code==="Space"&&(this.store.isSpaceKeyPressed=!1)}),this.zoomInstance.behavior.on("start.detect",o=>{this.currentEvent=o}).on("zoom.detect",o=>{o.sourceEvent&&this.updateMousePosition(o.sourceEvent),this.currentEvent=o}).on("end.detect",o=>{this.currentEvent=o}),this.dragInstance.behavior.on("start.detect",o=>{this.currentEvent=o,this.updateCanvasCursor()}).on("drag.detect",o=>{this.dragInstance.isActive&&this.updateMousePosition(o),this.currentEvent=o}).on("end.detect",o=>{this.currentEvent=o,this.updateCanvasCursor()}),this.canvasD3Selection.call(this.dragInstance.behavior).call(this.zoomInstance.behavior).on("click",this.onClick.bind(this)).on("mousemove",this.onMouseMove.bind(this)).on("contextmenu",this.onRightClickMouse.bind(this)),(!this.config.enableZoom||!this.config.enableDrag)&&this.updateZoomDragBehaviors(),this.setZoomLevel(this.config.initialZoomLevel??1),this.store.maxPointSize=(this.reglInstance.limits.pointSizeDims[1]??cO)/this.config.pixelRatio,this.points=new hxe(this.reglInstance,this.config,this.store,this.graph),this.lines=new Jye(this.reglInstance,this.config,this.store,this.graph,this.points),this.config.enableSimulation&&(this.forceGravity=new tye(this.reglInstance,this.config,this.store,this.graph,this.points),this.forceCenter=new $ve(this.reglInstance,this.config,this.store,this.graph,this.points),this.forceManyBody=this.config.useClassicQuadtree?new oye(this.reglInstance,this.config,this.store,this.graph,this.points):new sye(this.reglInstance,this.config,this.store,this.graph,this.points),this.forceLinkIncoming=new iB(this.reglInstance,this.config,this.store,this.graph,this.points),this.forceLinkOutgoing=new iB(this.reglInstance,this.config,this.store,this.graph,this.points),this.forceMouse=new uye(this.reglInstance,this.config,this.store,this.graph,this.points)),this.clusters=new dye(this.reglInstance,this.config,this.store,this.graph,this.points),this.store.backgroundColor=jp(this.config.backgroundColor),this.config.hoveredPointRingColor&&this.store.setHoveredPointRingColor(this.config.hoveredPointRingColor),this.config.focusedPointRingColor&&this.store.setFocusedPointRingColor(this.config.focusedPointRingColor),this.config.focusedPointIndex!==void 0&&this.store.setFocusedPoint(this.config.focusedPointIndex),this.config.pointGreyoutColor&&this.store.setGreyoutPointColor(this.config.pointGreyoutColor),this.config.showFPSMonitor&&(this.fpsMonitor=new sB(this.canvas)),this.config.randomSeed!==void 0&&this.store.addRandomSeed(this.config.randomSeed)}get progress(){return this._isDestroyed?0:this.store.simulationProgress}get isSimulationRunning(){return this._isDestroyed?!1:this.store.isSimulationRunning}get maxPointSize(){return this._isDestroyed?0:this.store.maxPointSize}setConfig(e){var n;if(this._isDestroyed||!this.reglInstance||!this.points||!this.lines||!this.clusters)return;const i={...this.config};this.config.init(e),i.pointColor!==this.config.pointColor&&(this.graph.updatePointColor(),this.points.updateColor()),i.pointSize!==this.config.pointSize&&(this.graph.updatePointSize(),this.points.updateSize()),i.linkColor!==this.config.linkColor&&(this.graph.updateLinkColor(),this.lines.updateColor()),i.linkWidth!==this.config.linkWidth&&(this.graph.updateLinkWidth(),this.lines.updateWidth()),i.linkArrows!==this.config.linkArrows&&(this.graph.updateArrows(),this.lines.updateArrow()),(i.curvedLinkSegments!==this.config.curvedLinkSegments||i.curvedLinks!==this.config.curvedLinks)&&this.lines.updateCurveLineGeometry(),i.backgroundColor!==this.config.backgroundColor&&(this.store.backgroundColor=jp(this.config.backgroundColor)),i.hoveredPointRingColor!==this.config.hoveredPointRingColor&&this.store.setHoveredPointRingColor(this.config.hoveredPointRingColor),i.focusedPointRingColor!==this.config.focusedPointRingColor&&this.store.setFocusedPointRingColor(this.config.focusedPointRingColor),i.pointGreyoutColor!==this.config.pointGreyoutColor&&this.store.setGreyoutPointColor(this.config.pointGreyoutColor),i.focusedPointIndex!==this.config.focusedPointIndex&&this.store.setFocusedPoint(this.config.focusedPointIndex),(i.spaceSize!==this.config.spaceSize||i.simulationRepulsionQuadtreeLevels!==this.config.simulationRepulsionQuadtreeLevels)&&(this.store.adjustSpaceSize(this.config.spaceSize,this.reglInstance.limits.maxTextureSize),this.resizeCanvas(!0),this.update(this.store.isSimulationRunning?this.store.alpha:0)),i.showFPSMonitor!==this.config.showFPSMonitor&&(this.config.showFPSMonitor?this.fpsMonitor=new sB(this.canvas):((n=this.fpsMonitor)==null||n.destroy(),this.fpsMonitor=void 0)),i.pixelRatio!==this.config.pixelRatio&&(this.store.maxPointSize=(this.reglInstance.limits.pointSizeDims[1]??cO)/this.config.pixelRatio),(i.enableZoom!==this.config.enableZoom||i.enableDrag!==this.config.enableDrag)&&this.updateZoomDragBehaviors()}setPointPositions(e,n){this._isDestroyed||!this.points||(this.graph.inputPointPositions=e,this.points.dontRescale=n,this._needsPointPositionsUpdate=!0,this._needsLinksUpdate=!0,this._needsPointColorUpdate=!0,this._needsPointSizeUpdate=!0,this._needsPointClusterUpdate=!0,this._needsForceManyBodyUpdate=!0,this._needsForceLinkUpdate=!0,this._needsForceCenterUpdate=!0)}setPointColors(e){this._isDestroyed||(this.graph.inputPointColors=e,this._needsPointColorUpdate=!0)}setPointSizes(e){this._isDestroyed||(this.graph.inputPointSizes=e,this._needsPointSizeUpdate=!0)}setLinks(e){this._isDestroyed||(this.graph.inputLinks=e,this._needsLinksUpdate=!0,this._needsLinkColorUpdate=!0,this._needsLinkWidthUpdate=!0,this._needsLinkArrowUpdate=!0,this._needsForceLinkUpdate=!0)}setLinkColors(e){this._isDestroyed||(this.graph.inputLinkColors=e,this._needsLinkColorUpdate=!0)}setLinkWidths(e){this._isDestroyed||(this.graph.inputLinkWidths=e,this._needsLinkWidthUpdate=!0)}setLinkArrows(e){this._isDestroyed||(this.graph.linkArrowsBoolean=e,this._needsLinkArrowUpdate=!0)}setLinkStrength(e){this._isDestroyed||(this.graph.inputLinkStrength=e,this._needsForceLinkUpdate=!0)}setPointClusters(e){this._isDestroyed||(this.graph.inputPointClusters=e,this._needsPointClusterUpdate=!0)}setClusterPositions(e){this._isDestroyed||(this.graph.inputClusterPositions=e,this._needsPointClusterUpdate=!0)}setPointClusterStrength(e){this._isDestroyed||(this.graph.inputClusterStrength=e,this._needsPointClusterUpdate=!0)}render(e){if(this._isDestroyed||!this.reglInstance)return;this.graph.update();const{fitViewOnInit:n,fitViewDelay:i,fitViewPadding:r,fitViewDuration:s,fitViewByPointsInRect:a,initialZoomLevel:o}=this.config;if(!this.graph.pointsNumber&&!this.graph.linksNumber){this.stopFrames(),Ws(this.canvas).style("cursor",null),this.reglInstance.clear({color:this.store.backgroundColor,depth:1,stencil:0});return}this._isFirstRenderAfterInit&&n&&o===void 0&&(this._fitViewOnInitTimeoutID=window.setTimeout(()=>{a?this.setZoomTransformByPointPositions(a,s,void 0,r):this.fitView(s,r)},i)),this._isFirstRenderAfterInit=!1,this.update(e)}zoomToPointByIndex(e,n=700,i=Hve,r=!0){if(this._isDestroyed||!this.reglInstance||!this.points||!this.canvasD3Selection)return;const{store:{screenSize:s}}=this,a=Vu(this.reglInstance,this.points.currentPositionFbo);if(e===void 0)return;const o=a[e*4+0],l=a[e*4+1];if(o===void 0||l===void 0)return;const u=this.zoomInstance.getDistanceToPoint([o,l]),c=r?i:Math.max(this.getZoomLevel(),i);if(u<Math.min(s[0],s[1]))this.setZoomTransformByPointPositions([o,l],n,c);else{const h=this.zoomInstance.getTransform([[o,l]],c),d=this.zoomInstance.getMiddlePointTransform([o,l]);this.canvasD3Selection.transition().ease(bve).duration(n/2).call(this.zoomInstance.behavior.transform,d).transition().ease(Sve).duration(n/2).call(this.zoomInstance.behavior.transform,h)}}zoom(e,n=0){this._isDestroyed||this.setZoomLevel(e,n)}setZoomLevel(e,n=0){this._isDestroyed||!this.canvasD3Selection||(n===0?this.canvasD3Selection.call(this.zoomInstance.behavior.scaleTo,e):this.canvasD3Selection.transition().duration(n).call(this.zoomInstance.behavior.scaleTo,e))}getZoomLevel(){return this._isDestroyed?0:this.zoomInstance.eventTransform.k}getPointPositions(){if(this._isDestroyed||!this.reglInstance||!this.points)return[];if(this.graph.pointsNumber===void 0)return[];const e=[],n=Vu(this.reglInstance,this.points.currentPositionFbo);e.length=this.graph.pointsNumber*2;for(let i=0;i<this.graph.pointsNumber;i+=1){const r=n[i*4+0],s=n[i*4+1];r!==void 0&&s!==void 0&&(e[i*2]=r,e[i*2+1]=s)}return e}getClusterPositions(){if(this._isDestroyed||!this.reglInstance||!this.clusters)return[];if(this.graph.pointClusters===void 0||this.clusters.clusterCount===void 0)return[];this.clusters.calculateCentermass();const e=[],n=Vu(this.reglInstance,this.clusters.centermassFbo);e.length=this.clusters.clusterCount*2;for(let i=0;i<e.length/2;i+=1){const r=n[i*4+0],s=n[i*4+1],a=n[i*4+2];r!==void 0&&s!==void 0&&a!==void 0&&(e[i*2]=r/a,e[i*2+1]=s/a)}return e}fitView(e=250,n=.1){this._isDestroyed||this.setZoomTransformByPointPositions(this.getPointPositions(),e,void 0,n)}fitViewByPointIndices(e,n=250,i=.1){if(this._isDestroyed)return;const r=this.getPointPositions(),s=new Array(e.length*2);for(const[a,o]of e.entries())s[a*2]=r[o*2],s[a*2+1]=r[o*2+1];this.setZoomTransformByPointPositions(s,n,void 0,i)}fitViewByPointPositions(e,n=250,i=.1){this._isDestroyed||this.setZoomTransformByPointPositions(e,n,void 0,i)}getPointsInRect(e){if(this._isDestroyed||!this.reglInstance||!this.points)return new Float32Array;const n=this.store.screenSize[1];return this.store.selectedArea=[[e[0][0],n-e[1][1]],[e[1][0],n-e[0][1]]],this.points.findPointsOnAreaSelection(),Vu(this.reglInstance,this.points.selectedFbo).map((i,r)=>r%4===0&&i!==0?r/4:-1).filter(i=>i!==-1)}getPointsInRange(e){return this.getPointsInRect(e)}getPointsInPolygon(e){if(this._isDestroyed||!this.reglInstance||!this.points)return new Float32Array;if(e.length<3)return new Float32Array;const n=this.store.screenSize[1],i=e.map(([r,s])=>[r,n-s]);return this.points.updatePolygonPath(i),this.points.findPointsOnPolygonSelection(),Vu(this.reglInstance,this.points.selectedFbo).map((r,s)=>s%4===0&&r!==0?s/4:-1).filter(r=>r!==-1)}selectPointsInRect(e){if(!(this._isDestroyed||!this.reglInstance||!this.points)){if(e){const n=this.store.screenSize[1];this.store.selectedArea=[[e[0][0],n-e[1][1]],[e[1][0],n-e[0][1]]],this.points.findPointsOnAreaSelection();const i=Vu(this.reglInstance,this.points.selectedFbo);this.store.selectedIndices=i.map((r,s)=>s%4===0&&r!==0?s/4:-1).filter(r=>r!==-1)}else this.store.selectedIndices=null;this.points.updateGreyoutStatus()}}selectPointsInRange(e){return this.selectPointsInRect(e)}selectPointsInPolygon(e){if(!(this._isDestroyed||!this.reglInstance||!this.points)){if(e){if(e.length<3){console.warn("Polygon path requires at least 3 points to form a polygon.");return}const n=this.store.screenSize[1],i=e.map(([s,a])=>[s,n-a]);this.points.updatePolygonPath(i),this.points.findPointsOnPolygonSelection();const r=Vu(this.reglInstance,this.points.selectedFbo);this.store.selectedIndices=r.map((s,a)=>a%4===0&&s!==0?a/4:-1).filter(s=>s!==-1)}else this.store.selectedIndices=null;this.points.updateGreyoutStatus()}}selectPointByIndex(e,n=!1){if(!this._isDestroyed)if(n){const i=this.graph.getAdjacentIndices(e)??[];this.selectPointsByIndices([e,...i])}else this.selectPointsByIndices([e])}selectPointsByIndices(e){this._isDestroyed||!this.points||(e?e.length===0?this.store.selectedIndices=new Float32Array:this.store.selectedIndices=new Float32Array(e.filter(n=>n!==void 0)):this.store.selectedIndices=null,this.points.updateGreyoutStatus())}unselectPoints(){this._isDestroyed||!this.points||(this.store.selectedIndices=null,this.points.updateGreyoutStatus())}getSelectedIndices(){if(this._isDestroyed)return null;const{selectedIndices:e}=this.store;return e?Array.from(e):null}getAdjacentIndices(e){if(!this._isDestroyed)return this.graph.getAdjacentIndices(e)}spaceToScreenPosition(e){return this._isDestroyed?[0,0]:this.zoomInstance.convertSpaceToScreenPosition(e)}screenToSpacePosition(e){return this._isDestroyed?[0,0]:this.zoomInstance.convertScreenToSpacePosition(e)}spaceToScreenRadius(e){return this._isDestroyed?0:this.zoomInstance.convertSpaceToScreenRadius(e)}getPointRadiusByIndex(e){var n;if(!this._isDestroyed)return(n=this.graph.pointSizes)==null?void 0:n[e]}trackPointPositionsByIndices(e){this._isDestroyed||!this.points||this.points.trackPointsByIndices(e)}getTrackedPointPositionsMap(){return this._isDestroyed||!this.points?new Map:this.points.getTrackedPositionsMap()}getSampledPointPositionsMap(){return this._isDestroyed||!this.points?new Map:this.points.getSampledPointPositionsMap()}getScaleX(){if(!(this._isDestroyed||!this.points))return this.points.scaleX}getScaleY(){if(!(this._isDestroyed||!this.points))return this.points.scaleY}start(e=1){var n,i;this._isDestroyed||this.graph.pointsNumber&&(this.store.isSimulationRunning=!0,this.store.alpha=e,this.store.simulationProgress=0,(i=(n=this.config).onSimulationStart)==null||i.call(n),this.stopFrames(),this.frame())}pause(){var e,n;this._isDestroyed||(this.store.isSimulationRunning=!1,(n=(e=this.config).onSimulationPause)==null||n.call(e))}restart(){var e,n;this._isDestroyed||(this.store.isSimulationRunning=!0,(n=(e=this.config).onSimulationRestart)==null||n.call(e))}step(){this._isDestroyed||(this.store.isSimulationRunning=!1,this.stopFrames(),this.frame())}destroy(){var e,n,i,r;this._isDestroyed||!this.reglInstance||(window.clearTimeout(this._fitViewOnInitTimeoutID),this.stopFrames(),this.canvasD3Selection&&this.canvasD3Selection.on("mouseenter.cosmos",null).on("mousemove.cosmos",null).on("mouseleave.cosmos",null).on("click",null).on("mousemove",null).on("contextmenu",null).on(".drag",null).on(".zoom",null),Ws(document).on("keydown.cosmos",null).on("keyup.cosmos",null),(e=this.zoomInstance)!=null&&e.behavior&&this.zoomInstance.behavior.on("start.detect",null).on("zoom.detect",null).on("end.detect",null),(n=this.dragInstance)!=null&&n.behavior&&this.dragInstance.behavior.on("start.detect",null).on("drag.detect",null).on("end.detect",null),(i=this.fpsMonitor)==null||i.destroy(),this.reglInstance.destroy(),this.reglInstance.clear({color:this.store.backgroundColor,depth:1,stencil:0}),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.attributionDivElement&&this.attributionDivElement.parentNode&&this.attributionDivElement.parentNode.removeChild(this.attributionDivElement),(r=document.getElementById("gl-bench-style"))==null||r.remove(),this.canvasD3Selection=void 0,this.reglInstance=void 0,this.attributionDivElement=void 0,this._isDestroyed=!0)}create(){var e,n,i,r,s;this._isDestroyed||!this.points||!this.lines||(this._needsPointPositionsUpdate&&this.points.updatePositions(),this._needsPointColorUpdate&&this.points.updateColor(),this._needsPointSizeUpdate&&this.points.updateSize(),this._needsLinksUpdate&&this.lines.updatePointsBuffer(),this._needsLinkColorUpdate&&this.lines.updateColor(),this._needsLinkWidthUpdate&&this.lines.updateWidth(),this._needsLinkArrowUpdate&&this.lines.updateArrow(),this._needsForceManyBodyUpdate&&((e=this.forceManyBody)==null||e.create()),this._needsForceLinkUpdate&&((n=this.forceLinkIncoming)==null||n.create(ZD.INCOMING),(i=this.forceLinkOutgoing)==null||i.create(ZD.OUTGOING)),this._needsForceCenterUpdate&&((r=this.forceCenter)==null||r.create()),this._needsPointClusterUpdate&&((s=this.clusters)==null||s.create()),this._needsPointPositionsUpdate=!1,this._needsPointColorUpdate=!1,this._needsPointSizeUpdate=!1,this._needsLinksUpdate=!1,this._needsLinkColorUpdate=!1,this._needsLinkWidthUpdate=!1,this._needsLinkArrowUpdate=!1,this._needsPointClusterUpdate=!1,this._needsForceManyBodyUpdate=!1,this._needsForceLinkUpdate=!1,this._needsForceCenterUpdate=!1)}flatten(e){return e.flat()}pair(e){const n=new Array(e.length/2);for(let i=0;i<e.length/2;i++)n[i]=[e[i*2],e[i*2+1]];return n}update(e=this.store.alpha){const{graph:n}=this;this.store.pointsTextureSize=Math.ceil(Math.sqrt(n.pointsNumber??0)),this.store.linksTextureSize=Math.ceil(Math.sqrt((n.linksNumber??0)*2)),this.create(),this.initPrograms(),this.store.hoveredPoint=void 0,this.start(e)}initPrograms(){var e,n,i,r,s,a;this._isDestroyed||!this.points||!this.lines||!this.clusters||(this.points.initPrograms(),this.lines.initPrograms(),(e=this.forceGravity)==null||e.initPrograms(),(n=this.forceLinkIncoming)==null||n.initPrograms(),(i=this.forceLinkOutgoing)==null||i.initPrograms(),(r=this.forceMouse)==null||r.initPrograms(),(s=this.forceManyBody)==null||s.initPrograms(),(a=this.forceCenter)==null||a.initPrograms(),this.clusters.initPrograms())}frame(){const{config:{simulationGravity:e,simulationCenter:n,renderLinks:i,enableSimulation:r},store:{alpha:s,isSimulationRunning:a}}=this;s<uO&&a&&this.end(),this.store.pointsTextureSize&&(this.requestAnimationFrameId=window.requestAnimationFrame(o=>{var l,u,c,h,d,m,v,_,y,g,x,S,E,A,T,C,O,M,D,P,F,G,z,Y,N,k;(l=this.fpsMonitor)==null||l.begin(),this.resizeCanvas(),this.dragInstance.isActive||this.findHoveredPoint(),r&&(this.isRightClickMouse&&this.config.enableRightClickRepulsion&&((u=this.forceMouse)==null||u.run(),(c=this.points)==null||c.updatePosition()),a&&!(this.zoomInstance.isRunning&&!this.config.enableSimulationDuringZoom)&&(e&&((h=this.forceGravity)==null||h.run(),(d=this.points)==null||d.updatePosition()),n&&((m=this.forceCenter)==null||m.run(),(v=this.points)==null||v.updatePosition()),(_=this.forceManyBody)==null||_.run(),(y=this.points)==null||y.updatePosition(),this.store.linksTextureSize&&((g=this.forceLinkIncoming)==null||g.run(),(x=this.points)==null||x.updatePosition(),(S=this.forceLinkOutgoing)==null||S.run(),(E=this.points)==null||E.updatePosition()),(this.graph.pointClusters||this.graph.clusterPositions)&&((A=this.clusters)==null||A.run(),(T=this.points)==null||T.updatePosition()),this.store.alpha+=this.store.addAlpha(this.config.simulationDecay??Nn.simulation.decay),this.isRightClickMouse&&this.config.enableRightClickRepulsion&&(this.store.alpha=Math.max(this.store.alpha,.1)),this.store.simulationProgress=Math.sqrt(Math.min(1,uO/this.store.alpha)),(D=(M=this.config).onSimulationTick)==null||D.call(M,this.store.alpha,(C=this.store.hoveredPoint)==null?void 0:C.index,(O=this.store.hoveredPoint)==null?void 0:O.position)),(P=this.points)==null||P.trackPoints()),(F=this.reglInstance)==null||F.clear({color:this.store.backgroundColor,depth:1,stencil:0}),i&&this.store.linksTextureSize&&((G=this.lines)==null||G.draw()),(z=this.points)==null||z.draw(),this.dragInstance.isActive&&((Y=this.points)==null||Y.drag(),(N=this.points)==null||N.drag()),(k=this.fpsMonitor)==null||k.end(o),this.currentEvent=void 0,this.frame()}))}stopFrames(){this.requestAnimationFrameId&&window.cancelAnimationFrame(this.requestAnimationFrameId)}end(){var e,n;this.store.isSimulationRunning=!1,this.store.simulationProgress=1,(n=(e=this.config).onSimulationEnd)==null||n.call(e)}onClick(e){var n,i,r,s;(s=(r=this.config).onClick)==null||s.call(r,(n=this.store.hoveredPoint)==null?void 0:n.index,(i=this.store.hoveredPoint)==null?void 0:i.position,e)}updateMousePosition(e){if(!e)return;const n=e.offsetX??e.x,i=e.offsetY??e.y;n===void 0||i===void 0||(this.store.mousePosition=this.zoomInstance.convertScreenToSpacePosition([n,i]),this.store.screenMousePosition=[n,this.store.screenSize[1]-i])}onMouseMove(e){var n,i,r,s;this.currentEvent=e,this.updateMousePosition(e),this.isRightClickMouse=e.which===3,(s=(r=this.config).onMouseMove)==null||s.call(r,(n=this.store.hoveredPoint)==null?void 0:n.index,(i=this.store.hoveredPoint)==null?void 0:i.position,this.currentEvent)}onRightClickMouse(e){e.preventDefault()}resizeCanvas(e=!1){var n,i,r;const s=this.canvas.width,a=this.canvas.height,o=this.canvas.clientWidth,l=this.canvas.clientHeight;if(e||s!==o*this.config.pixelRatio||a!==l*this.config.pixelRatio){const[u,c]=this.store.screenSize,{k:h}=this.zoomInstance.eventTransform,d=this.zoomInstance.convertScreenToSpacePosition([u/2,c/2]);this.store.updateScreenSize(o,l),this.canvas.width=o*this.config.pixelRatio,this.canvas.height=l*this.config.pixelRatio,(n=this.reglInstance)==null||n.poll(),(i=this.canvasD3Selection)==null||i.call(this.zoomInstance.behavior.transform,this.zoomInstance.getTransform([d],h)),(r=this.points)==null||r.updateSampledPointsGrid()}}setZoomTransformByPointPositions(e,n=250,i,r){var s;this.resizeCanvas();const a=this.zoomInstance.getTransform(this.pair(e),i,r);(s=this.canvasD3Selection)==null||s.transition().ease(Eve).duration(n).call(this.zoomInstance.behavior.transform,a)}updateZoomDragBehaviors(){var e,n,i,r;this.config.enableDrag?(e=this.canvasD3Selection)==null||e.call(this.dragInstance.behavior):(n=this.canvasD3Selection)==null||n.call(this.dragInstance.behavior).on(".drag",null),this.config.enableZoom?(i=this.canvasD3Selection)==null||i.call(this.zoomInstance.behavior):(r=this.canvasD3Selection)==null||r.call(this.zoomInstance.behavior).on("wheel.zoom",null)}findHoveredPoint(){var e,n,i,r,s;if(!this._isMouseOnCanvas||!this.reglInstance||!this.points)return;if(this._findHoveredPointExecutionCount<2){this._findHoveredPointExecutionCount+=1;return}this._findHoveredPointExecutionCount=0,this.points.findHoveredPoint();let a=!1,o=!1;const l=Vu(this.reglInstance,this.points.hoveredFbo);if(l[1]){const u=l[0];((e=this.store.hoveredPoint)==null?void 0:e.index)!==u&&(a=!0);const c=l[2],h=l[3];this.store.hoveredPoint={index:u,position:[c,h]}}else this.store.hoveredPoint&&(o=!0),this.store.hoveredPoint=void 0;a&&this.store.hoveredPoint&&((i=(n=this.config).onPointMouseOver)==null||i.call(n,this.store.hoveredPoint.index,this.store.hoveredPoint.position,this.currentEvent)),o&&((s=(r=this.config).onPointMouseOut)==null||s.call(r,this.currentEvent)),this.updateCanvasCursor()}updateCanvasCursor(){const{hoveredPointCursor:e}=this.config;this.dragInstance.isActive?Ws(this.canvas).style("cursor","grabbing"):this.store.hoveredPoint?!this.config.enableDrag||this.store.isSpaceKeyPressed?Ws(this.canvas).style("cursor",e):Ws(this.canvas).style("cursor","grab"):Ws(this.canvas).style("cursor",null)}addAttribution(){var e;this.config.attribution&&(this.attributionDivElement=document.createElement("div"),this.attributionDivElement.style.cssText=`
      user-select: none;
      position: absolute;
      bottom: 0;
      right: 0;
      color: var(--cosmosgl-attribution-color);
      margin: 0 0.6rem 0.6rem 0;
      font-size: 0.7rem;
      font-family: inherit;
    `,this.attributionDivElement.innerHTML=this.config.attribution,(e=this.store.div)==null||e.appendChild(this.attributionDivElement))}}class _1e{constructor(){this.cosmos=null,this.container=null,this.positionMap=new Map,this.pinnedNodes=new Set,this.nodeIdToIndex=new Map,this.createOffscreenContainer()}createOffscreenContainer(){this.container=document.createElement("div"),this.container.style.cssText=`
      position: fixed;
      left: -10000px;
      top: -10000px;
      width: 1px;
      height: 1px;
      overflow: hidden;
      pointer-events: none;
      visibility: hidden;
      z-index: -9999;
    `,document.body?document.body.appendChild(this.container):document.addEventListener("DOMContentLoaded",()=>{document.body.appendChild(this.container)})}initialize(e){if(!this.container){console.error("Container not created");return}try{this.cosmos=new x1e(this.container,{pointSize:1,linkWidth:1,renderLinks:!1,curvedLinks:!1,simulationGravity:(e==null?void 0:e.simulationGravity)??.1,simulationCenter:(e==null?void 0:e.simulationCenter)??.1,simulationRepulsion:(e==null?void 0:e.simulationRepulsion)??1,simulationLinkDistance:(e==null?void 0:e.simulationLinkDistance)??30,simulationLinkSpring:(e==null?void 0:e.simulationLinkSpring)??1,simulationFriction:(e==null?void 0:e.simulationFriction)??.85,spaceSize:1e3,pixelRatio:1,cameraDistance:500,...e}),console.log("Cosmos adapter initialized successfully")}catch(n){console.error("Failed to initialize Cosmos:",n)}}convertGraphologyToCosmos(e){const n=[],i=[];return e.forEachNode((r,s)=>{var l,u,c;const a=s,o={id:r,x:((l=a.position)==null?void 0:l.x)||Math.random()*100-50,y:((u=a.position)==null?void 0:u.y)||Math.random()*100-50,z:((c=a.position)==null?void 0:c.z)||0,...a.data};n.push(o)}),e.forEachEdge((r,s,a,o)=>{const u={source:a,target:o,...s.data};i.push(u)}),{nodes:n,links:i}}setData(e){if(!this.cosmos){console.error("Cosmos not initialized");return}this.nodeIdToIndex.clear();const n=new Float32Array(e.nodes.length*2);e.nodes.forEach((s,a)=>{this.nodeIdToIndex.set(s.id,a);const o=s.x||Math.random()*100-50,l=s.y||Math.random()*100-50;n[a*2]=o,n[a*2+1]=l,this.positionMap.set(s.id,{x:o,y:l,z:s.z||0})});const i=[];e.links.forEach(s=>{const a=this.nodeIdToIndex.get(s.source),o=this.nodeIdToIndex.get(s.target);a!==void 0&&o!==void 0&&i.push(a,o)});const r=new Float32Array(i);try{this.cosmos.setPointPositions(n),this.cosmos.setLinks(r),console.log(`Set data: ${e.nodes.length} nodes, ${e.links.length} links`)}catch(s){console.error("Failed to set data:",s)}}updatePositions(e){if(this.cosmos)try{const n=this.cosmos.getPointPositions();if(!n||n.length===0)return;this.nodeIdToIndex.forEach((i,r)=>{if(!this.pinnedNodes.has(r)){const s=n[i*2],a=n[i*2+1],o=0;this.positionMap.set(r,{x:s,y:a,z:o}),e.setNodeAttribute(r,"x",s),e.setNodeAttribute(r,"y",a),e.setNodeAttribute(r,"z",o)}})}catch(n){console.error("Failed to update positions:",n)}}getPositions(){return new Map(this.positionMap)}pinNode(e,n){this.pinnedNodes.add(e),this.positionMap.set(e,n)}unpinNode(e){this.pinnedNodes.delete(e)}isPinned(e){return this.pinnedNodes.has(e)}start(){if(this.cosmos)try{this.cosmos.start(),console.log("Cosmos simulation started")}catch(e){console.error("Failed to start simulation:",e)}}pause(){this.cosmos&&this.cosmos.pause()}restart(){this.cosmos&&this.cosmos.restart()}dispose(){if(this.cosmos){try{this.cosmos.destroy()}catch(e){console.error("Error destroying cosmos:",e)}this.cosmos=null}this.container&&this.container.parentNode&&(this.container.parentNode.removeChild(this.container),this.container=null),this.positionMap.clear(),this.pinnedNodes.clear(),this.nodeIdToIndex.clear()}getSimulationProgress(){return this.isSimulationRunning()?.5:1}isSimulationRunning(){return this.cosmos?this.cosmos.isSimulationRunning:!1}setConfig(e){this.cosmos&&this.cosmos.setConfig(e)}}function b1e({graph:t,iterations:e=300,nodeRepulsion:n=1,linkDistance:i=30,linkSpring:r=1,gravity:s=.1,centerForce:a=.1,velocityDecay:o=.15,is3d:l=!0,cosmosConfig:u,getNodePosition:c,drags:h}){const d=new _1e,{nodes:m}=mm(t),v=new Map(m.map(y=>[y.id,y]));d.initialize({...u,simulationGravity:s,simulationCenter:a,simulationRepulsion:n,simulationLinkDistance:i,simulationLinkSpring:r,simulationFriction:1-o});const _=d.convertGraphologyToCosmos(t);return d.setData(_),d.start(),{getNodePosition(y){var S;if(c){const E=c(y,{graph:t,drags:h,nodes:[],edges:[]});if(E)return E}if((S=h==null?void 0:h[y])!=null&&S.position)return h[y].position;const g=v.get(y);if(!g)return{x:0,y:0,z:0,id:y,data:{}};const x=d.getPositions();if(x.has(y)){const E=x.get(y);return{...g.position,x:E.x,y:E.y,z:E.z}}return g.position},step(){return d.updatePositions(t),!d.isSimulationRunning()}}}const MB={cosmosForceDirected:t=>b1e({...t,iterations:(t==null?void 0:t.maxIterations)||300,nodeRepulsion:(t==null?void 0:t.nodeRepulsion)||1,linkDistance:(t==null?void 0:t.linkDistance)||30,linkSpring:(t==null?void 0:t.linkStrength)||1,gravity:(t==null?void 0:t.gravity)||.1,centerForce:(t==null?void 0:t.centerStrength)||.1,velocityDecay:(t==null?void 0:t.velocityDecay)||.15,cosmosConfig:t==null?void 0:t.cosmosConfig})};function S1e(){return(t,e)=>t in MB?MB[t](e):pz({type:t,...e})}const Q7=({cosmosConfig:t,layoutOverrides:e,children:n,...i})=>{const r=V.useMemo(()=>{const s=S1e();return{...e,getLayout:(a,o)=>{const l=a==="custom"?"cosmosForceDirected":a,u={...o,cosmosConfig:t};return s(l,u)}}},[e,t]);return B.jsx(ym,{...i,layoutOverrides:r,children:n})};function E1e(){const t=If();return B.jsxs("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column"},children:[B.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid #e0e0e0",display:"flex",alignItems:"center",gap:"1rem"},children:[B.jsx("button",{onClick:()=>t("/experiments"),style:{padding:"0.5rem 1rem",cursor:"pointer"},children:"← Back to Experiments"}),B.jsx("h1",{style:{margin:0,fontSize:"1.5rem"},children:"Cosmos GPU Integration"}),B.jsx("span",{style:{marginLeft:"auto",fontSize:"0.875rem",color:"#666"},children:"GPU-accelerated graph layout using @cosmos.gl/graph"})]}),B.jsx("div",{style:{flex:1,position:"relative"},children:B.jsx(Q7,{nodes:Av,edges:xm,theme:Df,layoutType:"custom",defaultNodeSize:7})})]})}class CB{constructor(){this.frameCount=0,this.lastTime=performance.now(),this.fps=0,this.frameTime=0,this.renderStart=0,this.renderTime=0,this.layoutStart=0,this.layoutTime=0,this.metrics=[],this.maxMetrics=1e3}startFrame(){this.renderStart=performance.now()}endFrame(){const e=performance.now();this.renderTime=e-this.renderStart,this.frameTime=e-this.renderStart,this.frameCount++;const n=e-this.lastTime;n>=1e3&&(this.fps=this.frameCount*1e3/n,this.frameCount=0,this.lastTime=e)}startLayout(){this.layoutStart=performance.now()}endLayout(){this.layoutTime=performance.now()-this.layoutStart}recordMetrics(e,n){const i={fps:this.fps,frameTime:this.frameTime,renderTime:this.renderTime,layoutTime:this.layoutTime,memoryUsage:this.getMemoryUsage(),nodeCount:e,edgeCount:n,timestamp:Date.now()};return this.metrics.push(i),this.metrics.length>this.maxMetrics&&this.metrics.shift(),i}getMemoryUsage(){return"memory"in performance?performance.memory.usedJSHeapSize/1048576:0}getMetrics(){return[...this.metrics]}getLatestMetrics(){return this.metrics[this.metrics.length-1]||null}clear(){this.metrics=[],this.frameCount=0,this.fps=0}getAverageMetrics(){if(this.metrics.length===0)return null;const e=this.metrics.reduce((i,r)=>({fps:i.fps+r.fps,frameTime:i.frameTime+r.frameTime,renderTime:i.renderTime+r.renderTime,layoutTime:i.layoutTime+r.layoutTime,memoryUsage:i.memoryUsage+r.memoryUsage,nodeCount:r.nodeCount,edgeCount:r.edgeCount,timestamp:Date.now()}),{fps:0,frameTime:0,renderTime:0,layoutTime:0,memoryUsage:0,nodeCount:0,edgeCount:0,timestamp:0}),n=this.metrics.length;return{fps:e.fps/n,frameTime:e.frameTime/n,renderTime:e.renderTime/n,layoutTime:e.layoutTime/n,memoryUsage:e.memoryUsage/n,nodeCount:e.nodeCount,edgeCount:e.edgeCount,timestamp:e.timestamp}}}const RB=({title:t,metrics:e,color:n})=>e?B.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f5f5f5",borderRadius:"4px",border:`2px solid ${n}`},children:[B.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:n},children:t}),B.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",fontSize:"0.875rem"},children:[B.jsxs("div",{children:["FPS: ",B.jsx("strong",{children:e.fps.toFixed(1)})]}),B.jsxs("div",{children:["Frame Time: ",B.jsxs("strong",{children:[e.frameTime.toFixed(2),"ms"]})]}),B.jsxs("div",{children:["Render Time: ",B.jsxs("strong",{children:[e.renderTime.toFixed(2),"ms"]})]}),B.jsxs("div",{children:["Layout Time: ",B.jsxs("strong",{children:[e.layoutTime.toFixed(2),"ms"]})]}),B.jsxs("div",{children:["Memory: ",B.jsxs("strong",{children:[e.memoryUsage.toFixed(1),"MB"]})]}),B.jsxs("div",{children:["Nodes: ",B.jsx("strong",{children:e.nodeCount})," / Edges: ",B.jsx("strong",{children:e.edgeCount})]})]})]}):null;function w1e(){const t=If(),[e,n]=V.useState("simple"),[i,r]=V.useState(null),[s,a]=V.useState(null),o=V.useRef(new CB),l=V.useRef(new CB),u=e==="simple"?{nodes:Av,edges:xm}:{nodes:Fpe,edges:Gpe};return V.useEffect(()=>{const c=setInterval(()=>{const h=o.current.getLatestMetrics(),d=l.current.getLatestMetrics();h&&r(h),d&&a(d)},100);return()=>clearInterval(c)},[]),B.jsxs("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column"},children:[B.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid #e0e0e0",display:"flex",alignItems:"center",gap:"1rem"},children:[B.jsx("button",{onClick:()=>t("/experiments"),style:{padding:"0.5rem 1rem",cursor:"pointer"},children:"← Back to Experiments"}),B.jsx("h1",{style:{margin:0,fontSize:"1.5rem"},children:"CPU vs GPU Performance Comparison"}),B.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"1rem",alignItems:"center"},children:B.jsxs("label",{children:["Dataset:",B.jsxs("select",{value:e,onChange:c=>n(c.target.value),style:{marginLeft:"0.5rem",padding:"0.25rem"},children:[B.jsx("option",{value:"simple",children:"Simple (Few nodes)"}),B.jsx("option",{value:"complex",children:"Complex (Many nodes)"})]})]})})]}),B.jsxs("div",{style:{flex:1,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",padding:"1rem"},children:[B.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[B.jsx(RB,{title:"CPU Performance",metrics:i,color:"#3b82f6"}),B.jsx("div",{style:{flex:1,border:"2px solid #3b82f6",borderRadius:"4px",overflow:"hidden"},children:B.jsx(ym,{nodes:u.nodes,edges:u.edges,theme:Df,layoutType:"forceDirected2d",defaultNodeSize:7})})]}),B.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[B.jsx(RB,{title:"GPU Performance",metrics:s,color:"#10b981"}),B.jsx("div",{style:{flex:1,border:"2px solid #10b981",borderRadius:"4px",overflow:"hidden"},children:B.jsx(Q7,{nodes:u.nodes,edges:u.edges,theme:Df,layoutType:"custom",defaultNodeSize:7})})]})]}),i&&s&&B.jsxs("div",{style:{padding:"1rem",borderTop:"1px solid #e0e0e0",backgroundColor:"#f9fafb"},children:[B.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Performance Summary"}),B.jsxs("div",{style:{display:"flex",gap:"2rem",fontSize:"0.875rem"},children:[B.jsxs("div",{children:["FPS Improvement: ",B.jsxs("strong",{style:{color:"#10b981"},children:[((s.fps/i.fps-1)*100).toFixed(1),"%"]})]}),B.jsxs("div",{children:["Frame Time Reduction: ",B.jsxs("strong",{style:{color:"#10b981"},children:[((1-s.frameTime/i.frameTime)*100).toFixed(1),"%"]})]}),B.jsxs("div",{children:["Layout Time Reduction: ",B.jsxs("strong",{style:{color:"#10b981"},children:[((1-s.layoutTime/i.layoutTime)*100).toFixed(1),"%"]})]})]})]})]})}function A1e(){const t=If();return B.jsxs("div",{style:{padding:"20px"},children:[B.jsx("h1",{children:"GPU.js Integration Experiment"}),B.jsx("p",{children:"Accelerating graph computations with GPU.js"}),B.jsxs("div",{style:{display:"flex",gap:"20px",marginTop:"40px"},children:[B.jsx("button",{onClick:()=>t("/gpu-js/demo"),style:{padding:"10px 20px",fontSize:"16px",cursor:"pointer",background:"#007bff",color:"white",border:"none",borderRadius:"4px"},children:"GPU.js Demo"}),B.jsx("button",{onClick:()=>t("/gpu-js/comparison"),style:{padding:"10px 20px",fontSize:"16px",cursor:"pointer",background:"#28a745",color:"white",border:"none",borderRadius:"4px"},children:"Performance Comparison"}),B.jsx("button",{onClick:()=>t("/"),style:{padding:"10px 20px",fontSize:"16px",cursor:"pointer",background:"#6c757d",color:"white",border:"none",borderRadius:"4px"},children:"Back to Experiments"})]}),B.jsxs("div",{style:{marginTop:"40px"},children:[B.jsx("h2",{children:"Implementation Details"}),B.jsxs("ul",{children:[B.jsx("li",{children:"GPU-accelerated force-directed layout"}),B.jsx("li",{children:"Parallel computation of n-body forces"}),B.jsx("li",{children:"Maintains compatibility with React Three Fiber"}),B.jsx("li",{children:"Progressive enhancement with CPU fallback"})]})]})]})}let Wg=null;const Lh=class Lh{constructor(){this.gpu=null,this.isInitialized=!1,this.initPromise=null}static getInstance(){return Lh.instance||(Lh.instance=new Lh),Lh.instance}async initialize(){if(!this.isInitialized){if(this.initPromise)return this.initPromise;this.initPromise=this.loadGPU(),await this.initPromise}}async loadGPU(){try{if(typeof window<"u"&&!Wg&&(await this.loadScript("https://cdn.jsdelivr.net/npm/gpu.js@2.16.0/dist/gpu-browser.min.js"),Wg=window.GPU),!Wg)throw new Error("GPU.js failed to load");this.gpu=new Wg({mode:"gpu"});const e=this.gpu.createKernel(function(){return this.thread.x}).setOutput([1]);e(),e.destroy(),this.isInitialized=!0,console.log("GPU.js initialized successfully")}catch(e){if(console.warn("GPU initialization failed, falling back to CPU mode:",e),Wg)this.gpu=new Wg({mode:"cpu"}),this.isInitialized=!0;else throw new Error("GPU.js is not available")}}loadScript(e){return new Promise((n,i)=>{const r=document.createElement("script");r.src=e,r.onload=()=>n(),r.onerror=()=>i(new Error(`Failed to load script: ${e}`)),document.head.appendChild(r)})}getGPU(){if(!this.isInitialized)throw new Error("GPU not initialized. Call initialize() first.");return this.gpu}isAvailable(){return this.isInitialized&&this.gpu!==null}getMode(){var e;return((e=this.gpu)==null?void 0:e.mode)||"none"}destroy(){this.gpu&&(this.gpu=null),this.isInitialized=!1,Lh.instance=null}};Lh.instance=null;let y_=Lh;class T1e{constructor(){const e=y_.getInstance();this.gpu=e.getGPU(),this.initializeKernels()}initializeKernels(){this.manyBodyKernel=this.gpu.createKernel(function(e,n,i,r,s,a){const o=this.thread.x,l=this.output.x;let u=0,c=0,h=0;const d=e[o],m=n[o],v=i[o],_=r[o];for(let y=0;y<l;y++)if(o!==y){const g=d-e[y],x=m-n[y],S=v-i[y],E=g*g+x*x+S*S+1e-4,A=Math.sqrt(E),T=_*r[y]*s/E;u+=T*(g/A),c+=T*(x/A),h+=T*(S/A)}return[u,c,h]}).setOutput([1]).setPipeline(!0),this.linkForceKernel=this.gpu.createKernel(function(e,n,i,r,s,a,o){const l=this.thread.x,u=this.constants.linkCount;let c=0,h=0,d=0;for(let m=0;m<u;m++){const v=r[m][0],_=r[m][1];if(v===l||_===l){const y=v===l?_:v,g=e[y]-e[l],x=n[y]-n[l],S=i[y]-i[l],E=Math.sqrt(g*g+x*x+S*S+1e-4),A=(E-a[m])*s[m]*o;c+=A*(g/E),h+=A*(x/E),d+=A*(S/E)}}return[c,h,d]}).setOutput([1]).setPipeline(!0),this.centerForceKernel=this.gpu.createKernel(function(e,n,i,r,s,a,o){const l=this.thread.x,u=r-e[l],c=s-n[l],h=a-i[l];return[u*o,c*o,h*o]}).setOutput([1]).setPipeline(!0),this.integrateKernel=this.gpu.createKernel(function(e,n,i,r,s,a,o,l,u,c){const h=this.thread.x,d=(r[h]+o[h])*c,m=(s[h]+l[h])*c,v=(a[h]+u[h])*c,_=e[h]+d,y=n[h]+m,g=i[h]+v;return[_,y,g,d,m,v]}).setOutput([1]).setPipeline(!0)}calculateManyBodyForces(e,n,i,r=.9){const s=e.x.length;this.manyBodyKernel.setOutput([s]);const a=[];for(let c=0;c<s;c++){const h=this.manyBodyKernel(e.x,e.y,e.z,n,i,r);a.push(h)}const o=new Float32Array(s),l=new Float32Array(s),u=new Float32Array(s);for(let c=0;c<s;c++)o[c]=a[c][0][0],l[c]=a[c][0][1],u[c]=a[c][0][2];return{x:o,y:l,z:u}}calculateLinkForces(e,n,i,r,s){const a=e.x.length;this.linkForceKernel.setOutput([a]),this.linkForceKernel.setConstants({linkCount:n.length});const o=[];for(let h=0;h<a;h++){const d=this.linkForceKernel(e.x,e.y,e.z,n,i,r,s);o.push(d)}const l=new Float32Array(a),u=new Float32Array(a),c=new Float32Array(a);for(let h=0;h<a;h++)l[h]=o[h][0][0],u[h]=o[h][0][1],c[h]=o[h][0][2];return{x:l,y:u,z:c}}calculateCenterForce(e,n,i){const r=e.x.length;this.centerForceKernel.setOutput([r]);const s=[];for(let u=0;u<r;u++){const c=this.centerForceKernel(e.x,e.y,e.z,n.x,n.y,n.z,i);s.push(c)}const a=new Float32Array(r),o=new Float32Array(r),l=new Float32Array(r);for(let u=0;u<r;u++)a[u]=s[u][0][0],o[u]=s[u][0][1],l[u]=s[u][0][2];return{x:a,y:o,z:l}}integrate(e,n,i,r){const s=e.x.length;this.integrateKernel.setOutput([s]);const a=[];for(let m=0;m<s;m++){const v=this.integrateKernel(e.x,e.y,e.z,n.x,n.y,n.z,i.x,i.y,i.z,r);a.push(v)}const o=new Float32Array(s),l=new Float32Array(s),u=new Float32Array(s),c=new Float32Array(s),h=new Float32Array(s),d=new Float32Array(s);for(let m=0;m<s;m++)o[m]=a[m][0][0],l[m]=a[m][0][1],u[m]=a[m][0][2],c[m]=a[m][0][3],h[m]=a[m][0][4],d[m]=a[m][0][5];return{positions:{x:o,y:l,z:u},velocities:{x:c,y:h,z:d}}}destroy(){this.manyBodyKernel&&this.manyBodyKernel.destroy(),this.linkForceKernel&&this.linkForceKernel.destroy(),this.integrateKernel&&this.integrateKernel.destroy(),this.centerForceKernel&&this.centerForceKernel.destroy()}}function M1e({graph:t,iterations:e=300,nodeStrength:n=-30,linkDistance:i=30,linkStrength:r=1,centerStrength:s=.1,velocityDecay:a=.4,is3d:o=!0,alphaMin:l=.001,alphaDecay:u=.0228,getNodePosition:c,drags:h}){const{nodes:d,edges:m}=mm(t),v=new Map,_=new Map;d.forEach((z,Y)=>{const N=(c==null?void 0:c(z.id,{graph:t,drags:h,nodes:d,edges:m}))||z.position;v.set(z.id,{id:z.id,position:N,velocity:{x:0,y:0,z:0},mass:1}),_.set(z.id,Y)});const y=d.length,g={x:new Float32Array(y),y:new Float32Array(y),z:new Float32Array(y)},x={x:new Float32Array(y),y:new Float32Array(y),z:new Float32Array(y)},S=new Float32Array(y);d.forEach((z,Y)=>{const N=v.get(z.id);g.x[Y]=N.position.x,g.y[Y]=N.position.y,g.z[Y]=N.position.z||0,x.x[Y]=N.velocity.x,x.y[Y]=N.velocity.y,x.z[Y]=N.velocity.z,S[Y]=n});const E=m.map(z=>[_.get(z.source),_.get(z.target)]),A=new Float32Array(m.length).fill(r),T=new Float32Array(m.length).fill(i);let C=null,O=1,M=0,D=!1;const P=async()=>{if(!D)try{await y_.getInstance().initialize(),C=new T1e,D=!0}catch(z){console.warn("GPU initialization failed, falling back to CPU layout:",z)}},F=()=>{if(!C||!D)return;const z=C.calculateManyBodyForces(g,S,O),Y=C.calculateLinkForces(g,E,A,T,O),N=C.calculateCenterForce(g,{x:0,y:0,z:0},s),k={x:new Float32Array(y),y:new Float32Array(y),z:new Float32Array(y)};for(let X=0;X<y;X++)k.x[X]=z.x[X]+Y.x[X]+N.x[X],k.y[X]=z.y[X]+Y.y[X]+N.y[X],k.z[X]=z.z[X]+Y.z[X]+N.z[X];const j=C.integrate(g,x,k,a);g.x=j.positions.x,g.y=j.positions.y,g.z=j.positions.z,x.x=j.velocities.x,x.y=j.velocities.y,x.z=j.velocities.z,d.forEach((X,Q)=>{const H=v.get(X.id);H.position.x=g.x[Q],H.position.y=g.y[Q],H.position.z=g.z[Q],H.velocity.x=x.x[Q],H.velocity.y=x.y[Q],H.velocity.z=x.z[Q]}),O*=1-u,M++};return(async()=>{if(await P(),!(!C||!D))for(;O>l&&M<e;)F()})(),{getNodePosition(z){var N;if((N=h==null?void 0:h[z])!=null&&N.position)return h[z].position;const Y=v.get(z);return Y?Y.position:{x:0,y:0,z:0,id:z,data:{}}},async step(){return D||await P(),O>l&&M<e?(F(),!1):!0},destroy(){C&&(C.destroy(),C=null)}}}const DB={gpuForceDirected:t=>M1e({...t,iterations:(t==null?void 0:t.iterations)||300,nodeStrength:(t==null?void 0:t.nodeStrength)||-30,linkDistance:(t==null?void 0:t.linkDistance)||30,linkStrength:(t==null?void 0:t.linkStrength)||1,centerStrength:(t==null?void 0:t.centerStrength)||.1,velocityDecay:(t==null?void 0:t.velocityDecay)||.4,alphaMin:(t==null?void 0:t.alphaMin)||.001,alphaDecay:(t==null?void 0:t.alphaDecay)||.0228})};function C1e(){return(t,e)=>t in DB?DB[t](e):pz({type:t,...e})}const J7=({useGpuLayout:t=!0,layoutType:e="forceDirected",...n})=>{const[i,r]=V.useState(!1),[s,a]=V.useState("initializing");V.useEffect(()=>{(async()=>{if(!t){r(!0);return}try{const u=y_.getInstance();await u.initialize(),a(u.getMode()),r(!0)}catch(u){console.warn("GPU initialization failed:",u),a("disabled"),r(!0)}})()},[t]);const o=t&&e==="forceDirected"?"gpuForceDirected":e;return i?B.jsxs(B.Fragment,{children:[t&&B.jsxs("div",{style:{position:"absolute",top:10,right:10,padding:"8px 12px",background:s==="gpu"?"#28a745":s==="cpu"?"#ffc107":"#dc3545",color:"white",borderRadius:"4px",fontSize:"12px",zIndex:10},children:["GPU.js: ",s.toUpperCase()," mode"]}),B.jsx(ym,{...n,layoutType:o,layoutOverrides:t?C1e():void 0})]}):B.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#f0f0f0"},children:B.jsxs("div",{children:[B.jsx("div",{children:"Initializing GPU.js..."}),B.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"8px"},children:"This may take a moment on first load"})]})})};function Y3(t){const e=[],n=[];for(let r=0;r<t;r++)e.push({id:`node-${r}`,label:`Node ${r}`,fill:`hsl(${r*137.5%360}, 70%, 50%)`});const i=Math.floor(t*1.5);for(let r=0;r<i;r++){const s=Math.floor(Math.random()*t);let a=Math.floor(Math.random()*t);for(;a===s;)a=Math.floor(Math.random()*t);n.push({id:`edge-${r}`,source:`node-${s}`,target:`node-${a}`})}return{nodes:e,edges:n}}const R1e=()=>{console.log("GpuGraphScene rendering");const[t,e]=V.useState(100),[n,i]=V.useState(!0),[r,s]=V.useState(()=>Y3(t)),a=o=>{e(o),s(Y3(o))};return B.jsxs("div",{style:{width:"100%",height:"100vh",position:"relative"},children:[B.jsxs("div",{style:{position:"absolute",top:20,left:20,zIndex:10,background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[B.jsx("h3",{style:{margin:"0 0 16px 0"},children:"GPU.js Force-Directed Layout"}),B.jsx("div",{style:{marginBottom:"12px"},children:B.jsxs("label",{children:[B.jsx("input",{type:"checkbox",checked:n,onChange:o=>i(o.target.checked)})," ","Use GPU acceleration"]})}),B.jsx("div",{style:{marginBottom:"12px"},children:B.jsxs("label",{children:["Node Count: ",t,B.jsx("input",{type:"range",min:"10",max:"1000",step:"10",value:t,onChange:o=>a(Number(o.target.value)),style:{display:"block",width:"200px",marginTop:"4px"}})]})}),B.jsx("button",{onClick:()=>s(Y3(t)),style:{padding:"8px 16px",background:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Regenerate Graph"})]}),B.jsx(J7,{nodes:r.nodes,edges:r.edges,useGpuLayout:n,animated:t<200,edgeArrowPosition:"none",minNodeSize:2,maxNodeSize:10})]})},D1e=()=>{const[t,e]=V.useState(200),[n,i]=V.useState(()=>d(200)),[r,s]=V.useState({layoutTime:0,fps:0,frameCount:0}),[a,o]=V.useState({layoutTime:0,fps:0,frameCount:0}),l=V.useRef(0),u=V.useRef(0),c=V.useRef(0),h=V.useRef(0);function d(v){const _=[],y=[];for(let g=0;g<v;g++)_.push({id:`n${g}`,label:`${g}`,fill:`hsl(${g*137.5%360}, 70%, 50%)`});for(let g=0;g<v*2;g++){const x=Math.floor(Math.random()*v);let S=Math.floor(Math.random()*v);for(;S===x;)S=Math.floor(Math.random()*v);y.push({id:`e${g}`,source:`n${x}`,target:`n${S}`})}return{nodes:_,edges:y}}const m=v=>{e(v),i(d(v)),s({layoutTime:0,fps:0,frameCount:0}),o({layoutTime:0,fps:0,frameCount:0}),l.current=performance.now(),u.current=performance.now(),c.current=0,h.current=0};return V.useEffect(()=>{let v,_=performance.now(),y=0;const g=x=>{if(y++,x-_>=1e3){const S=y*1e3/(x-_);if(c.current++,h.current++,l.current>0&&c.current>0){const E=(performance.now()-l.current)/1e3;s(A=>({...A,fps:Math.round(S),frameCount:c.current,layoutTime:E}))}if(u.current>0&&h.current>0){const E=(performance.now()-u.current)/1e3;o(A=>({...A,fps:Math.round(S),frameCount:h.current,layoutTime:E}))}y=0,_=x}v=requestAnimationFrame(g)};return v=requestAnimationFrame(g),()=>{cancelAnimationFrame(v)}},[]),B.jsxs("div",{style:{width:"100%",height:"100vh",background:"#f5f5f5"},children:[B.jsxs("div",{style:{position:"fixed",top:20,left:"50%",transform:"translateX(-50%)",zIndex:100,background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[B.jsx("h3",{style:{margin:"0 0 16px 0",textAlign:"center"},children:"Performance Comparison"}),B.jsx("div",{style:{marginBottom:"16px"},children:B.jsxs("label",{children:["Node Count: ",t,B.jsx("input",{type:"range",min:"50",max:"1000",step:"50",value:t,onChange:v=>m(Number(v.target.value)),style:{display:"block",width:"300px",marginTop:"4px"}})]})}),B.jsxs("div",{style:{display:"flex",gap:"40px"},children:[B.jsxs("div",{children:[B.jsx("h4",{children:"CPU (Standard)"}),B.jsxs("div",{children:["FPS: ",r.fps]}),B.jsxs("div",{children:["Layout Time: ",r.layoutTime.toFixed(2),"s"]})]}),B.jsxs("div",{children:[B.jsx("h4",{children:"GPU (GPU.js)"}),B.jsxs("div",{children:["FPS: ",a.fps]}),B.jsxs("div",{children:["Layout Time: ",a.layoutTime.toFixed(2),"s"]})]})]})]}),B.jsxs("div",{style:{display:"flex",height:"100%"},children:[B.jsxs("div",{style:{flex:1,position:"relative"},children:[B.jsx("div",{style:{position:"absolute",top:10,left:10,background:"#dc3545",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"14px",fontWeight:"bold"},children:"CPU Rendering"}),B.jsx(ym,{nodes:n.nodes,edges:n.edges,layoutType:"forceDirected",animated:!1,edgeArrowPosition:"none",minNodeSize:2,maxNodeSize:8})]}),B.jsxs("div",{style:{flex:1,position:"relative"},children:[B.jsx("div",{style:{position:"absolute",top:10,left:10,background:"#28a745",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"14px",fontWeight:"bold"},children:"GPU Rendering"}),B.jsx(J7,{nodes:n.nodes,edges:n.edges,useGpuLayout:!0,animated:!1,edgeArrowPosition:"none",minNodeSize:2,maxNodeSize:8})]})]})]})};function O1e(){return B.jsxs(qY,{children:[B.jsx(Xl,{path:"/",element:B.jsx(Vpe,{})}),B.jsx(Xl,{path:"/baseline",element:B.jsx(jpe,{})}),B.jsx(Xl,{path:"/optimized",element:B.jsx(Jpe,{})}),B.jsx(Xl,{path:"/compare",element:B.jsx($pe,{})}),B.jsx(Xl,{path:"/metrics",element:B.jsx(eme,{})}),B.jsx(Xl,{path:"/cosmos-gpu",element:B.jsx(E1e,{})}),B.jsx(Xl,{path:"/cosmos-compare",element:B.jsx(w1e,{})}),B.jsx(Xl,{path:"/gpu-js",element:B.jsx(A1e,{})}),B.jsx(Xl,{path:"/gpu-js/demo",element:B.jsx(R1e,{})}),B.jsx(Xl,{path:"/gpu-js/comparison",element:B.jsx(D1e,{})})]})}function U1e(){const t=hd(),e=n=>({padding:"10px 20px",textDecoration:"none",color:t.pathname===n?"#fff":"#ddd",backgroundColor:t.pathname===n?"#0066cc":"transparent",borderRadius:"4px",transition:"all 0.2s"});return B.jsx("nav",{style:{backgroundColor:"#1a1a1a",padding:"15px 20px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:B.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",maxWidth:"1200px",margin:"0 auto"},children:[B.jsx("h1",{style:{color:"#fff",margin:0,fontSize:"20px"},children:"Reagraph Performance Experiments"}),B.jsxs("div",{style:{display:"flex",gap:"10px"},children:[B.jsx(Sp,{to:"/",style:e("/"),children:"Home"}),B.jsx(Sp,{to:"/baseline",style:e("/baseline"),children:"Baseline"}),B.jsx(Sp,{to:"/optimized",style:e("/optimized"),children:"Optimized"}),B.jsx(Sp,{to:"/compare",style:e("/compare"),children:"Compare"}),B.jsx(Sp,{to:"/metrics",style:e("/metrics"),children:"Metrics"})]})]})})}function z1e({children:t}){return B.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column"},children:[B.jsx(U1e,{}),B.jsx("main",{style:{flex:1,padding:"20px"},children:t})]})}function I1e(){return B.jsx(xZ,{basename:"/experiments",children:B.jsx(z1e,{children:B.jsx(V.Suspense,{fallback:B.jsx("div",{children:"Loading..."}),children:B.jsx(O1e,{})})})})}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{for(let e of t)e.unregister(),console.log("Unregistered service worker:",e)});qX.createRoot(document.getElementById("root")).render(B.jsx(iu.StrictMode,{children:B.jsx(I1e,{})}));
